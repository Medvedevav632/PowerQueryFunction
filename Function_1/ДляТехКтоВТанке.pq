[   –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ–±–∑–æ—Ä –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫–ª–∞—Å—Å–∞ Splitter:
    
    1. Splitter.SplitByNothing ‚Äì —Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–ø–ª–∏—Ç—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π ¬´–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç¬ª )
    2. Splitter.SplitTextByWhitespace ‚Äì –æ–±—Å—É–∂–¥–∞–µ–º, —á—Ç–æ —Ç–∞–∫–æ–µ Whitespace –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω –∞—Ä–≥—É–º–µ–Ω—Ç quoteStyle
    3. Splitter.SplitTextByDelimiter, Splitter.SplitTextByAnyDelimiter ‚Äì –æ–±—Å—É–∂–¥–∞–µ–º, —Ç–æ–ª—å–∫–æ –ª–∏ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π —Ä–∞–∑–Ω–∏—Ü–∞ (—Å–ø–æ–π–ª–µ—Ä ‚Äì –Ω–µ—Ç)
    4. Splitter.SplitTextByEachDelimiter ‚Äì —Ä–∞–∑–±–∏—Ä–∞–µ–º—Å—è –∑–∞—á–µ–º –æ–Ω —Ç–∞–∫–æ–π –Ω—É–∂–µ–Ω (–∫—Ç–æ –ø–ª–∞—á–µ—Ç –ø–æ —Ä–µ–≥—É–ª—è—Ä–∫–∞–º ‚Äì –æ–Ω –Ω—É–∂–µ–Ω)
    5. Splitter.SplitTextByCharacterTransition ‚Äì —á–∞—Å—Ç–æ —Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –≤ –∫–æ–¥–µ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä–µ–ø–∏–º –∫–∞–∫/–∑–∞—á–µ–º/–ø–æ—á–µ–º—É
    6. Splitter.SplitTextByRepeatedLengths, Splitter.SplitTextByLengths ‚Äì –¥–µ–ª–∏–º —Ç–µ–∫—Å—Ç –ø–æ –¥–ª–∏–Ω–∞–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
    7. Splitter.SplitTextByPositions, Splitter.SplitTextByRanges ‚Äì –¥–µ–ª–∏–º —Ç–µ–∫—Å—Ç –ø–æ –ø–æ–∑–∏—Ü–∏—è–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –Ω—ë–º
    ]
[ /* Splitter 1 - Splitter.SplitByNothing –∏–ª–∏ —Å–ø–ª–∏—Ç—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π "–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç"
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitByNothing

    –ò—Ç–∞–∫, –Ω–∞—á–∏–Ω–∞–µ–º —Ä–∞–∑–±–æ—Ä (https://youtu.be/1jetvaOY6oM) —Å —Å–∞–º–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞. 
    –í —Ü–µ–ª–æ–º –≤—Å–µ —Å–ø–ª–∏—Ç—Ç–µ—Ä—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∑–∞–º—ã–∫–∞–Ω–∏—è (https://t.me/pbi_pq_from_tank/41), —Ç.–µ. –≤ —Å–∫–æ–±–∫–∞—Ö –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é. –ß—Ç–æ–±—ã —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∞, –µ–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–æ –≤—Ç–æ—Ä—ã—Ö —Å–∫–æ–±–∫–∞—Ö
    
    Splitter.SplitByNothing()  //–ø—Ä–æ—Å—Ç–æ —Å–ø–ª–∏—Ç—Ç–µ—Ä –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è
    Splitter.SplitByNothing()("abc")  //–≤—ã–∑–æ–≤ –µ–≥–æ –æ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–∞ "abc"
    
    –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è? –û—Ç–≤–µ—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ ‚Äì –Ω–∏—á–µ–≥–æ, —Ç–æ—á–Ω–µ–µ, –æ–Ω–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç —Å —Å–∞–º–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º. 
    –ù–æ! –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ —Å–≤–æ–µ–º—É —Å–º—ã—Å–ª—É –¥–æ–ª–∂–µ–Ω –ø–æ—Ä–æ–∂–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –ø–æ—ç—Ç–æ–º—É –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ñ—É–Ω–∫—Ü–∏—è 
    –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –µ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    */
    Splitter.SplitByNothing()("abc")  //{"abc"}
    Splitter.SplitByNothing()(123)  //{123}
    Splitter.SplitByNothing()({1,2,3})   //{{1,2,3}}
    
    /*  –ò –≤–æ—Ç —Ç–µ–ø–µ—Ä—å –≤–æ–ø—Ä–æ—Å ‚Äì –∑–∞—á–µ–º –Ω—É–∂–µ–Ω —Å–ø–ª–∏—Ç—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –º–µ–Ω—è–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ?
        –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∑–∞–¥–∞—á—É: –≤ —Ç–∞–±–ª–∏—Ü—É –ø–æ—Å–ª–µ —Å—Ç–æ–ª–±—Ü–∞ ‚Äúd‚Äù –Ω—É–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –µ—â—ë —Ç—Ä–∏ —Å—Ç–æ–ª–±—Ü–∞ ("x","y" –∏ "z") , –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –Ω—É–ª—è–º–∏.
        –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Table.SelectColumns  –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫-—Ç–æ —Ç–∞–∫: */
    
    let
        from = #table({"a".."h"},List.Repeat({{1..8}},5)),
        nms = Table.ColumnNames(from),
        lst = {"x","y","z"},
        tbl = Table.SelectColumns(from,List.RemoveLastN(nms,(x)=>x<>"d")&lst&List.LastN(nms,(x)=>x<>"d"),MissingField.UseNull),
        to = Table.TransformColumns(tbl,List.Transform(lst,(x)=>{x,(i)=>0}))
    in
        to
    
    // –ù–æ –≤–µ–¥—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –¥—Ä—É–≥—É—é –ª–æ–≥–∏–∫—É ‚Äì —Ä–∞–∑–¥–µ–ª–∏—Ç—å —ç—Ç–æ—Ç —Å–∞–º—ã–π —Å—Ç–æ–ª–±–µ—Ü "d"‚Ä¶ –ø—Ä–æ—Å—Ç–æ –Ω–µ —Ä–∞–∑–¥–µ–ª—è—è –µ–≥–æ:
    let
        from = #table({"a".."h"},List.Repeat({{1..8}},5)),
        to = Table.SplitColumn(from,"d",Splitter.SplitByNothing(),{"d","x","y","z"},0)
    in
        to
    
    // –ü–æ–ª—É—á–∞–µ—Ç—Å—è —Å–ø–ª–∏—Ç—Ç–µ—Ä –æ—Ç—Ä–∞–±–æ—Ç–∞–ª, –Ω–∞ –≤—ã—Ö–æ–¥ –±—ã–ª –ø–æ–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ü–æ–ª—É—á–∏–ª–æ—Å—å –≤–µ—Å—å–º–∞ –ª–∞–∫–æ–Ω–∏—á–Ω–æ, —Ö–æ—Ç—è –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ Table.SelectColumns  –≤—Å—ë –∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ. 
    // –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ —Ä–∞–¥–∏ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –º–æ–∂–Ω–æ –±—ã–ª–æ –∏ —Ç–∞–∫
    let
        from = #table({"a".."h"},List.Repeat({{1..8}},5)),
        to = Table.SplitColumn(from,"d",(x)=>{x},{"d","x","y","z"},0)
    in
        to
    
    // –ò–ª–∏ –¥–∞–∂–µ —Ç–∞–∫
    let
        from = #table({"a".."h"},List.Repeat({{1..8}},5)),
        to = Table.SplitColumn(from,"d",(x)=>{x,0,0,0},{"d","x","y","z"})
    in
        to
    // –¢.–µ. –≤–æ–æ–±—â–µ –±–µ–∑ —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ –≤ –≥–æ–ª–æ–≤—É —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –æ –¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –¢–∞–∫ —á—Ç–æ –≤–µ—Ä–¥–∏–∫—Ç ‚Äì –¥–∞–Ω–Ω—ã–π —Å–ø–ª–∏—Ç—Ç–µ—Ä —Ç–æ—á–Ω–æ –Ω–µ –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω )))
    ]
[ /* Splitter 2 - Splitter.SplitTextByWhitespace, –∏–ª–∏ —Å–ø–ª–∏—Ç—Ç–µ—Ä, "–¥–µ–ª—è—â–∏–π –ø–æ –±–µ–ª–æ–º—É –ø—Ä–æ–±–µ–ª—É"
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByWhitespace
    –ù—É –∞ –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑ –≤—Å–µ—Ö 25 –ø—Ä–æ–±–µ–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –Ω–µ –∑–∞—á–∏—Ç—ã–≤–∞—è—Å—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –Æ–Ω–∏–∫–æ–¥–∞, —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ–±–∑–æ—Ä–µ –Ω–∞ –Æ—Ç—É–±–µ (https://youtu.be/nr9CvYlSeI4)
    
    Splitter.SplitTextByWhitespace(
        optional quoteStyle as nullable number
    ) as function

    –î–µ–ª–∏—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ whitespace character (–ø—Ä–æ–±–µ–ª—å–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É) –∏ –∏–º–µ–µ—Ç –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç quoteStyle.
    –û–±—Ä–∞—â–∞—é –Ω–∞ —ç—Ç–æ –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –ø—Ä–æ–±–µ–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª ‚Äì —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–±–µ–ª (U+0020), 
    —ç—Ç–æ –µ—â—ë –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±—É–ª—è—Ü–∏—è (U+0009), –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ (U+000A), –≤–æ–∑–≤—Ä–∞—Ç –∫–∞—Ä–µ—Ç–∫–∏ (U+000D), 
    –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω—ã–π –ø—Ä–æ–±–µ–ª (U+00A0) ‚Äì –≤—Å–µ–≥–æ 25 —Å–∏–º–≤–æ–ª–æ–≤ (–ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –Æ–Ω–∏–∫–æ–¥–∞).
    –ü–æ—ç—Ç–æ–º—É
    */
    
    Splitter.SplitTextByWhitespace()("–º–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É") //{"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"}
    Splitter.SplitTextByWhitespace()("–º–∞–º–∞#(tab)   –º—ã–ª–∞#(tab)—Ä–∞–º—É") //{"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"}
    Splitter.SplitTextByWhitespace()("–º–∞–º–∞#(00A0)  –º—ã–ª–∞ #(00A0)—Ä–∞–º—É") //{"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"}
    Splitter.SplitTextByWhitespace()("–º–∞–º–∞#(cr,lf)–º—ã–ª–∞#(lf,cr,tab)—Ä–∞–º—É") //{"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"}
    // –í–∞–∂–Ω–æ! –í–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö –ø–æ–ª—É—á–∞–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø—Ä–∏—á—ë–º –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ –¥–≤—É—Ö –∏ –±–æ–ª–µ–µ –ø—Ä–æ–±–µ–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –æ–¥–∏–Ω —Ä–∞–∑—Ä—ã–≤.

    // –¢–µ–ø–µ—Ä—å quoteStyle - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö: QuoteStyle.Csv –∏ QuoteStyle.None. –ü–µ—Ä–≤—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ç.–µ. 
    Splitter.SplitTextByWhitespace()
    
    // –≠—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ
    Splitter.SplitTextByWhitespace(QuoteStyle.Csv)

    // –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞–∑–Ω–∏—Ü—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ:
    Splitter.SplitTextByWhitespace()("–û–û–û ""–†–æ–≥–∞ –∏ –∫–æ–ø—ã—Ç–∞"" –ú–æ—Å–∫–≤–∞")                //{"–û–û–û","–†–æ–≥–∞ –∏ –∫–æ–ø—ã—Ç–∞","–ú–æ—Å–∫–≤–∞"}
    Splitter.SplitTextByWhitespace(QuoteStyle.None)("–û–û–û ""–†–æ–≥–∞ –∏ –∫–æ–ø—ã—Ç–∞"" –ú–æ—Å–∫–≤–∞") //{"–û–û–û","""–†–æ–≥–∞","–∏","–∫–æ–ø—ã—Ç–∞""","–ú–æ—Å–∫–≤–∞"}
    
    /* –¢.–µ. –≤ —Å–ª—É—á–∞–µ QuoteStyle.Csv, –∫–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –∫–∞–≤—ã—á–∫–∞, –≤–µ—Å—å –ø–æ—Å–ª–µ–¥—É—é—â–∏–π —Ç–µ–∫—Å—Ç –æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–º –≤–∏–¥–µ, –ø–æ–∫–∞ –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–∞–≤—ã—á–∫–∞; —Å–∞–º–∏ –∫–∞–≤—ã—á–∫–∏ –ø—Ä–∏ —ç—Ç–æ–º —É–¥–∞–ª—è—é—Ç—Å—è.
    –ê –≤ —Å–ª—É—á–∞–µ QuoteStyle.None –∫–∞–≤—ã—á–∫–∏ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –∫–∞–∫ –æ–¥–∏–Ω –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤ –∏ –µ—Å–ª–∏ –º–µ–∂–¥—É –Ω–∏–º–∏ –µ—Å—Ç—å –ø—Ä–æ–±–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã ‚Äì –ø–æ –Ω–∏–º –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ.

    –í–æ—Ç —Ç–∞–∫–æ–π, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤–µ—Å—å–º–∞ –ø–æ–ª–µ–∑–Ω—ã–π —Å–ø–ª–∏—Ç—Ç–µ—Ä, –µ—Å–ª–∏ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç )))
    (–∏ –¥–∞, —è –≤ –∫—É—Ä—Å–µ, —á—Ç–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–µ–∑—Ç—å –≤ –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—É—é –≤–∏–∫–∏–ø–µ–¥–∏—é - –Ω–æ —ç—Ç–æ —Å–∫—É—á–Ω–æ –∏ –±–µ–∑ —Å–ø–ª–∏—Ç—Ç–µ—Ä–æ–≤, –≤–æ—Ç ))))*/     ]
[ /* Splitter 3 - Splitter.SplitTextByDelimiter, Splitter.SplitTextByAnyDelimiter –∏–ª–∏ –∫–æ–≥–¥–∞ –ø–æ—Ä—è–¥–æ–∫ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ‚Ä¶
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByDelimiter, Splitter.SplitTextByAnyDelimiter
    
    –ê —á—Ç–æ —Ç—É—Ç –∫ —á–µ–º—É —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ–±–∑–æ—Ä–µ –Ω–∞ –Æ—Ç—É–±–µ (https://youtu.be/mnqCDDP2a-A)

    Splitter.SplitTextByDelimiter(
        delimiter as text, 
        optional quoteStyle as nullable number
    ) as function
    
    Splitter.SplitTextByAnyDelimiter(
        delimiters as list, 
        optional quoteStyle as nullable number, 
        optional startAtEnd as nullable logical
    ) as function
    
    –ü–µ—Ä–≤—ã–π –¥–µ–ª–∏—Ç —Ç–µ–∫—Å –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é, –≤—Ç–æ—Ä–æ–π ‚Äì –ø–æ –Ω–∞–±–æ—Ä—É —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π.
    */
    let
        from = #table({"num","txt"},{{1,"–º–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É"},{2,"–º–∞–º–∞  –º—ã–ª–∞ —Ä–∞–º—É"},{3,"–º–∞–º–∞,–º—ã–ª–∞, —Ä–∞–º—É"},{4,"–º–∞–º–∞–æ—á–µ–Ω—å–º—ã–ª–∞—á–∞—Å—Ç–æ—Ä–∞–º—É"}}),
        to  = Table.SplitColumn(from,"txt",Splitter.SplitTextByDelimiter(" ")),
        to1 = Table.SplitColumn(from,"txt",Splitter.SplitTextByAnyDelimiter({" "})),
        to2 = Table.SplitColumn(from,"txt",Splitter.SplitTextByAnyDelimiter({" ","  "})),
        to3 = Table.SplitColumn(from,"txt",Splitter.SplitTextByAnyDelimiter({"  "," "})),
        to4 = Table.SplitColumn(from,"txt",Splitter.SplitTextByAnyDelimiter({"  "," ",", ",","})),
        to5 = Table.SplitColumn(from,"txt",Splitter.SplitTextByAnyDelimiter({"  "," ",", ",",","–æ—á–µ–Ω—å","—á–∞—Å—Ç–æ"}))
    in
        to5
    
    /*  to, to1   - –ø–æ–¥–µ–ª–∏–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø–æ –ø—Ä–æ–±–µ–ª—É
        to2,to3   - —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤—ã—è—Å–Ω—è–µ–º, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
        to4, to5  - –ø—Ä–æ—Å—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è, —á—Ç–æ –Ω–∞–±–æ—Ä —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º
    
        –ß—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —Ç–æ–∂–µ –µ—Å—Ç—å –∫–µ–π—Å:
    */
   
    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞"]}[Content],
        to1 = Table.AddColumn(from,"–ù–æ–º–µ—Ä",(x)=>List.Last(Splitter.SplitTextByDelimiter("–ò–ò–ù/–ë–ò–ù ",QuoteStyle.None)(x[#"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –±–µ–Ω–µ—Ñ–∏—Ü–∏–∞—Ä–∞ / –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è"]))),
        to2 = Table.AddColumn(from,"–ù–æ–º–µ—Ä",(x)=>List.Last(Splitter.SplitTextByAnyDelimiter({"–ò–ò–ù/–ë–ò–ù "},null,true)(x[#"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –±–µ–Ω–µ—Ñ–∏—Ü–∏–∞—Ä–∞ / –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è"])))
    in
        to1
    // to  - —Ä–µ—à–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É —á–µ—Ä–µ–∑ quoteStyle, 
    // to1 - —á–µ—Ä–µ–∑ startAtEnd

    // –ù—É –∏ –Ω–∞ –∑–∞–∫—É—Å–∫—É –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–∫–æ–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä, —Ç–æ–∂–µ –ø—Ä–æ —Å–ø–ª–∏—Ç—Ç–µ—Ä—ã )))
    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞"]}[Content],
        f=(x)=>Function.Invoke(Record.FromList,List.Zip(List.Split(Splitter.SplitTextByAnyDelimiter({", "," "})(x),2))),
        tr   = Table.TransformColumns(from,{"–î–∞–Ω–Ω—ã–µ",f}),
        nms  = List.Distinct(List.Combine(List.Transform(tr[–î–∞–Ω–Ω—ã–µ],Record.FieldNames))),
        to   = Table.ExpandRecordColumn(tr, "–î–∞–Ω–Ω—ã–µ",nms)
    in
        to ]

[ /* Splitter 4 - Splitter.SplitTextByEachDelimiter –∏–ª–∏ –∫–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ‚Ä¶
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByEachDelimiter
    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é —Ä–∞–±–æ—Ç—ã –≤—ã—à–µ–ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ–±–∑–æ—Ä–µ –Ω–∞ –Æ—Ç—É–±–µ  (https://youtu.be/U3oivkgXe9Y)
    
    Splitter.SplitTextByEachDelimiter(
        delimiters as list, 
        optional quoteStyle as nullable number, 
        optional startAtEnd as nullable logical
    )
    
    –ù–∞–±–æ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ –∏ —É Splitter.SplitTextByAnyDelimiter. 
    
    –°—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏–∑ —Å–ø–∏—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, 
    —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –º—ã –º–æ–∂–µ–º –ø–æ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç —Ç–æ–ª—å–∫–æ –ø–æ –ø–µ—Ä–≤–æ–º—É –∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –ø—Ä–æ–±–µ–ª—É:
    */
    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞110"]}[Content],
        f=(x)=>Splitter.SplitTextByEachDelimiter({" "},null,true)(x){1},
        to   = Table.AddColumn(from,"new",(r)=>f(r[#"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –±–µ–Ω–µ—Ñ–∏—Ü–∏–∞—Ä–∞ / –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è"]))
    in
        to
    
    // –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π –∏ –¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –ø–æ –º–µ—Ä–µ –∏—Ö –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –Ω—ë–º:
    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞5"]}[Content][—Å–æ—Ç—Ä—É–¥–Ω–∏–∫],
        to   = Table.FromList(from,Splitter.SplitTextByEachDelimiter({". "," ",", ",", ",", "}))
    in
        to ]
[ /* Splitter 5 - Splitter.SplitTextByCharacterTransition –∏–ª–∏ List vs Text
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByCharacterTransition
    ‚Ä¶ –∞ —á—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ–±–∑–æ—Ä–µ –Ω–∞ –Æ—Ç—É–±–µ (https://youtu.be/7RwYZcbFWgc) 

    –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ç–µ–º—É —Å–ø–ª–∏—Ç—Ç–µ—Ä–æ–≤. –î–æ —ç—Ç–æ–≥–æ –º—ã –¥–µ–ª–∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é (–ø–æ–¥—Å—Ç—Ä–æ–∫–µ), –∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª—è–ª—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è. 
    –¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Å–∏–º–≤–æ–ª—ã. 
    
    Splitter.SplitTextByCharacterTransition(
        before as anynonnull, 
        after as anynonnull
    ) as function
    
    –î–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ - before  –∏ after - –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –Ω–∞–±–æ—Ä—ã —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ –ø–µ—Ä–µ—Ö–æ–¥—É —Å –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∏—Ç—å. –ö–∞–∂–¥—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –ª–∏–±–æ —Å–ø–∏—Å–∫–æ–º —Å–∏–º–≤–æ–ª–æ–≤, –ª–∏–±–æ —Ñ—É–Ω–∫—Ü–∏–µ–π –æ—Ç —Å–∏–º–≤–æ–ª–∞, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–π true/false. –ù—É –∏ —Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä:
    */
    let
        from = {"GC2SB230","OF+65HB","GC2SB250","GC2KP250S"},
        /* –Ω–∞–¥–æ –ø–æ–ª—É—á–∏—Ç—å {"GC2SB","OF+","GC2SB","GC2KP"} 
        - —Ç.–µ. —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –Ω–∞–±–æ—Ä —Ü–∏—Ñ—Ä –∏ –≤—Å—ë, —á—Ç–æ –ø–æ—Å–ª–µ –Ω–µ–≥–æ*/
        
        to = List.Transform(from,(x)=>Text.Combine(List.RemoveLastN(Splitter.SplitTextByCharacterTransition({"A".."Z","+"},{"0".."9"})(x),1))),

        to1 = List.Transform(from,(x)=>Text.Combine(List.RemoveLastN(Splitter.SplitTextByCharacterTransition((x)=>not List.Contains({"0".."9"},x),{"0".."9"})(x),1))),

        lst = List.Buffer({"0".."9"}),
        to2 = List.Transform(from,(x)=>Text.Combine(List.RemoveLastN(Splitter.SplitTextByCharacterTransition((x)=>not List.Contains(lst,x),lst)(x),1))),
        
        txt = "0123456789",
        to3 = List.Transform(from,(x)=>Text.Combine(List.RemoveLastN(Splitter.SplitTextByCharacterTransition((x)=>not Text.Contains(txt,x),(x)=>Text.Contains(txt,x))(x),1)))
    in
        to3
    /*
        to ‚Äì –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∏–º –ø–æ –¥–≤—É–º —Å–ø–∏—Å–∫–∞–º —Å–∏–º–≤–æ–ª–æ–≤, —ç—Ç–æ —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –ø–µ—Ä–µ—á–∏—Å–ª—è–µ–º –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤, –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏—Ö —Ü–∏—Ñ—Ä–∞–º
        to1 ‚Äì –ø–æ—Å—Ç—É–ø–∞–µ–º —É–º–Ω–µ–µ ‚Äì –¥–µ–ª–∏–º –ø–æ –ø–µ—Ä–µ—Ö–æ–¥—É —Å –Ω–µ —Ü–∏—Ñ—Ä –Ω–∞ —Ü–∏—Ñ—Ä—ã ‚Äì –∑–¥–µ—Å—å –∑–∞–º–µ–Ω–∏–ª–∏ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–µ–π, —Ç–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –∏–¥—Ç–∏ —à—É—Å—Ç—Ä–µ–µ
        to2 ‚Äì –≤—Å–ø–æ–º–Ω–∏–ª–∏, —á—Ç–æ ¬´..¬ª - —ç—Ç–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è, –∏ —á—Ç–æ–±—ã –æ–Ω –Ω–µ –≤—ã—á–∏—Å–ª—è–ª—Å—è –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑, –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —Ü–∏—Ñ—Ä –∏ –∑–∞–ø–∏—Ö–Ω—É–ª–∏ –µ–≥–æ –≤ –±—É—Ñ–µ—Ä ‚Äì –µ—â—ë –±–æ–Ω—É—Å –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏
        –∏ —Ä–∞–Ω—å—à–µ —è –±—ã –Ω–∞ —ç—Ç–æ–º –∑–∞–∫–æ–Ω—á–∏–ª‚Ä¶ –ù–û!
        to3 ‚Äì –∞ –∫—Ç–æ, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, —Å–∫–∞–∑–∞–ª, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω—É–∂–Ω–æ –∏–º–µ–Ω–Ω–æ —Å–ø–∏—Å–æ–∫‚Ä¶ –í–æ–∑—å–º—ë–º —Ç–µ–∫—Å—Ç –∏–∑ 10 —Ü–∏—Ñ—Ä –∏ –æ—Å—É—â–µ—Å—Ç–≤–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –Ω—ë–º‚Ä¶ 
    */
    ]

[ /* Splitter 6 - Splitter.SplitTextByRepeatedLengths, Splitter.SplitTextByLengths –∏–ª–∏ –∫–æ–≥–¥–∞ –¥–ª–∏–Ω–∞ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ‚Ä¶
        #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByRepeatedLengths, Splitter.SplitTextByLengths

        Splitter.SplitTextByRepeatedLengths(
            length as number, 
            optional startAtEnd as nullable logical
        )

        Splitter.SplitTextByLengths(
            lengths as list, 
            optional startAtEnd as nullable logical
        )
        –û–±–∞ —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞ –≤–æ–æ–±—â–µ –Ω–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã ‚Äì 
        –∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–ª–∏–Ω–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏.

    –°–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä—ã:
    */
    //  1. –ø—Ä–∏–≤–æ–¥–∏–º –≤ –±–æ–∂–µ—Å–∫–∏–π –≤–∏–¥ –ú–ê–°-–∞–¥—Ä–µ—Å–∞ (—Ä–∞–∑–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ 2 —Å–∏–º–≤–æ–ª–∞)
    let
        from = #table({"MAC"},{{"001A2B3C4D5E"},{"0815752B9ADC"},{"096C2ABD7534"}}),
        f=(x)=>Combiner.CombineTextByDelimiter("-")(Splitter.SplitTextByRepeatedLengths(2)(x)),
        to = Table.TransformColumns(from,{"MAC",f})
    in
        to

    // –¥–µ–ª–∞–µ–º ¬´–∫—Ä–∞—Å–∏–≤–æ–µ¬ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —á–∏—Å–µ–ª (–æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Ä–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —Ç—Ä–æ–π–∫–∞–º —Å –∫–æ–Ω—Ü–∞)
    let
        from = #table({"num"},{{1},{12},{123},{1234},{12345},{1234567},{12345678}}),
        f=(x)=>Text.Combine(Splitter.SplitTextByRepeatedLengths(3,true)(Text.From(x))," "),
        /*—Ö–æ—Ç—è –º–æ–∂–Ω–æ –∏ Number.ToText(x,"N0")*/
        to = Table.TransformColumns(from,{"num",f})
    in
        to

    // 3. –Ω–∞–≤–æ–¥–∏–º –ø–æ—Ä—è–¥–æ–∫ –≤ –Ω–æ–º–µ—Ä–∞—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ (–∑–∞–¥–∞—ë–º –Ω—É–∂–Ω—ã–µ –¥–ª–∏–Ω—ã —Å –∫–æ–Ω—Ü–∞, –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ –∏—Ç–æ–≥–µ –≤—ã–Ω–∏–º–∞—é—Ç—Å—è –Ω–µ –≤—Å–µ —Å–∏–º–≤–æ–ª—ã, –∞ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª–∏–Ω):
    let
        from = #table({"tel"},{{"+79871234567"},{"89876543210"}}),
        f=(x)=>[a=Splitter.SplitTextByLengths({2,2,3,3},true)(x),
                b=Text.Format("+7 (#{0}) #{1}-#{2}-#{3}",a)][b],
        to = Table.TransformColumns(from,{"tel",f})
    in
        to
    // –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ, –Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –ø—Ä—è–º –º–∞—Å—Ç—Ö–µ–≤)
    ]

[ /* Splitter 7 - Splitter.SplitTextByPositions, Splitter.SplitTextByRanges
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByPositions, Splitter.SplitTextByRanges
    –ö–∞–∫ –≤—ã –¥–æ–≥–∞–¥—ã–≤–∞–µ—Ç–µ—Å—å, –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ —Ç—É—Ç –∫ —á–µ–º—É, —Å–º–æ—Ç—Ä–∏–º  –Ω–∞ –Æ—Ç—É–±–µ  (https://youtu.be/X-3DfbxU-Yc) 
    
    Splitter.SplitTextByPositions(
        positions as list,                          // –ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Å–ø–∏—Å–æ–∫
        optional startAtEnd as nullable logical)    // –í—Ç–æ—Ä–æ–π –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å —Å –∫–æ–Ω—Ü–∞

    Splitter.SplitTextByRanges(
        ranges as list, 
        optional startAtEnd as nullable logical)
    */

    // –ö–µ–π—Å 1 ‚Äì —Ä–∞–∑–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç, –Ω–µ –∑–∞—Ç–∏—Ä–∞—è —Ç–µ–≥–∏ (–∏–ª–∏ –ø–æ –ø—Ä–æ—Å—Ç–æ–º—É ‚Äì –ø–æ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –ø–æ –ø–æ–∑–∏—Ü–∏—è–º –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è –∏ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º —Å–ª–µ–¥—É—é—â–∏–º –∑–∞ –¥—Ä—É–≥–∏–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º):
    let
        txt  = "<info><recnumber=1 type=A date=12.04.2012><name><first>–ò–º—è1</first><last>–§–∞–º–∏–ª–∏—è1</last><medium>–û—Ç—á–µ—Å—Ç–≤–æ1</medium></name><doc><type>–ø–∞—Å–ø–æ—Ä—Ç</type><number>23465</number></doc></info><info><recnumber=2 type=D date=15.04.2012><name><first>–ò–º—è2</first><last>–§–∞–º–∏–ª–∏—è2</last><medium>–û—Ç—á–µ—Å—Ç–≤–æ2</medium></name><doc><type>—Å–≤-–≤–æ</type><number>98745</number></doc></info>",
        pos  = Text.PositionOf(txt,"<",Occurrence.All),
        pos1 = List.Transform(Text.PositionOf(txt,">",Occurrence.All),(x)=>x+1),
        lst  = List.Sort(List.Distinct(pos&pos1)),
        splt = Splitter.SplitTextByPositions(lst)(txt),
        to   = List.Select(splt,(x)=>Text.Trim(x)<>"")
    in
        to

    // –ö–µ–π—Å 2 ‚Äì –ø–∏—à–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –≤ 2016 Splitter.SplitTextByCharacterTransition:
    let
        txt = "–∫–∞—Ä—Ç–æ—à–∫–∞ 123–º–æ—Ä–∫–æ–≤–∫–∞ 29—Å–≤—ë–∫–ª–∞ 11–ª—É–∫ 14—á–µ—Å–Ω–æ–∫ 13",
        lst = Splitter.SplitTextByRepeatedLengths(1)(txt),
        zip = List.Zip({lst,{""}&List.RemoveLastN(lst,1)}),
        f=(x)=>Text.Contains("0123456789",x),
        g=(x)=>not f(x{0}) and f(x{1}),
        pos = List.PositionOf(zip,g,Occurrence.All,(c,v)=>v(c)),
        to  = Splitter.SplitTextByPositions(pos)(txt)
    in
        to

    // –ö–µ–π—Å 3 ‚Äì –¥–µ–ª–∏–º —Ç–µ–∫—Å—Ç –ø–æ —Ü–∏—Ñ—Ä–æ-–¥–µ—Ñ–∏—Å–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è —Ç–æ—á–∫–æ–π:
    let
        txt = "1. –¢–µ–∫—Å—Ç 1-1. –¢–µ–∫—Å—Ç —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ 1-2. —Ç–µ–∫—Å—Ç —Å —á–∏—Å–ª–∞–º–∏ 123 2. –µ—â—ë —Ç–µ–∫—Å—Ç 3. —Ç–µ–∫—Å—Ç. 4. –∞ —Ç–µ–∫—Å—Ç-—Ç–æ –±—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–π... –∏–∑–¥–µ–≤–∞—Ç–µ–ª—å—Å—Ç–≤–æ 5. –Ω–∞–ø—Ä–∏–º–µ—Ä —Å —á–∏—Å–ª–∞–º–∏ 2.5 12. –∏ –Ω–æ–º–µ—Ä–æ–≤ –º–Ω–æ–≥–æ 123. –æ—á–µ–Ω—å –º–Ω–æ–≥–æ 1234. –ø—Ä—è–º —Å–æ–≤—Å–µ–º",
        f=(x)=>Text.Contains("0123456789.-",x),
        g=(x)=>Text.Contains("0123456789",x),
        lst = Splitter.SplitTextByRepeatedLengths(1)(txt),
        tbl = Table.FromList(lst,(x)=>{f(x),g(x),x="."},{"flag","num","dot"}),
        add = Table.AddIndexColumn(tbl,"ind"),
        gr  = Table.Group(add,"flag",{{"pos",(x)=>x{0}[ind]},{"dot",(x)=>List.Last(x[dot])=true},{"nums",(x)=>List.AnyTrue(x[num])}},GroupKind.Local),
        pos = Table.SelectRows(gr,(x)=>x[dot] and x[nums])[pos],
        to  = Splitter.SplitTextByPositions(pos)(txt)
    in
        to

    // –ö–µ–π—Å 4 ‚Äì —ç—Ç—É –∑–∞–¥–∞—á–∫—É –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ ‚Äì —Ç–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å —Ä–µ—à–∏–º –µ—ë –ø–æ-–¥—Ä—É–≥–æ–º—É –∏ –≤—ã—è—Å–Ω–∏–º, 
    // —á—Ç–æ Splitter.SplitTextByRanges –Ω–∏–∫–∞–∫–æ–π –Ω–µ —Å–ø–ª–∏—Ç—Ç–µ—Ä, –∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π ¬´–≤—ã–Ω–∏–º–∞—Ç–µ–ª—å –ø–æ–¥—Å—Ç—Ä–æ–∫¬ª :
    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞110"]}[Content],
        f=(x)=>[a = Splitter.SplitTextByRepeatedLengths(1)(x),
                b = (x)=>Text.Contains("0123456789 ",x),
                c = List.Zip({a,{""}&List.RemoveLastN(a,1)}),
                d = Text.PositionOf(x,"–±–∏—Ç/—Å",Occurrence.Last),
                e = List.PositionOf(c,null,Occurrence.All,(c,v)=>b(c{0}) and not b(c{1})),
                f = List.Max(e,null,(x)=>if x > d then 0 else x),
                g = {{0,Text.Length(x)},{f,d-f-2},{d-1,6}},
                z = Splitter.SplitTextByRanges(g)(x)][z],
        splt = Table.SplitColumn(from,"Custom",f,{"Custom","—Å–∫–æ–∫–∞","—á–µ–≥–æ"}),
        to   = Table.TransformColumns(splt,{"—Å–∫–æ–∫–∞",Number.From})
    in
        to
    ]





[   –ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –≤ PQ
        #–í—Å—è–∫–æ–†–∞–∑–Ω–æ
        –ò —Å–Ω–æ–≤–∞ –≤—Å–µ–º –¥–æ–±—Ä–∞. –î–æ–≤–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ –≥—Ä–∞–∂–¥–∞–Ω–µ –ø–æ —Ä–∞–±–æ—Ç–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω –∏–∑ –ø—Ä–∞–π—Å–∞ —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –ø—Ä–æ–¥–∞–∂, –Ω–æ –≤ –ø—Ä–∞–π—Å–µ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –∑–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–∏–æ–¥—ã, –∞ –≤ —Ñ–∞–∫—Ç–∞—Ö –∏–¥—É—Ç —Å–∫–≤–æ–∑–Ω—ã–µ –¥–∞—Ç—ã, —Ç.–µ. Table.Join –Ω–∞–º —Ç—É—Ç —Å–æ–≤—Å–µ–º –Ω–µ —Ç–æ–≤–∞—Ä–∏—â. –ò –≤–æ—Ç –ø–∞—Ä—É –ª–µ—Ç –Ω–∞–∑–∞–¥ –æ–¥–∏–Ω –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ —Å –ø–ª–∞–Ω–µ—Ç—ã—ç–∫—Å–µ–ª—å –ê–Ω–¥—Ä–µ–π VG –Ω–∞—É—á–∏–ª –º–µ–Ω—è —Ö–æ—Ä–æ—à–µ–º—É, –∞ —è –¥–µ–ª—é—Å—å —Å –≤–∞–º–∏. –£–∫–∞–∑–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤ Excel —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –±–∞–Ω–∞–ª—å–Ω–æ–π –í–ü–† –≤ —Ä–µ–∂–∏–º–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞, –Ω—É –∞ –≤ PQ —ç—Ç–æ—Ç –ø–æ–∏—Å–∫ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ —Ç–∞–∫–æ–π —Å—Ö–µ–º–µ:
        - —Å–Ω–∞—á–∞–ª–∞ –∫–æ–º–±–∞–π–Ω–∏–º (Table.Combine –∏–ª–∏ &) —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫,
        - —Å–æ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö –ø–æ –¥–∞—Ç–µ,
        - –∑–∞–ø–æ–ª–Ω—è–µ–º –≤–Ω–∏–∑/–≤–≤–µ—Ä—Ö –ø–æ –≤–∫—É—Å—É —Å—Ç–æ–ª–±–µ—Ü —Å —Ü–µ–Ω–∞–º–∏ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
        - —É–±–∏—Ä–∞–µ–º –Ω–µ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, –Ω–∞–≤–æ–¥–∏–º –∫—Ä–∞—Å–æ—Ç—É.
        –î–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –∑–∞–¥–∞—á, –º–æ–∂–Ω–æ —Ä–∞–∑–º–Ω–æ–∂–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞, —Ç–∞–∫ —á—Ç–æ–±—ã —Å–ø–∏—Å–æ–∫ –¥–∞—Ç –≤ –Ω–µ–º –ø–æ–∫—Ä—ã–≤–∞–ª –≤–µ—Å—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –∏–∑ —Ñ–∞–∫—Ç–æ–≤, –∞ –ø–æ—Ç–æ–º –¥–∂–æ–π–Ω–∏—Ç—å —ç—Ç–æ –≤—Å–µ. –ù–æ –∏–∑ –≤—Å–µ—Ö –º–Ω–æ—é –æ–ø—Ä–æ–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ - —Å–∞–º—ã–π —à—É—Å—Ç—Ä—ã–π.
        –ó.–´. –î–æ–±–∞–≤–ª—é –æ–¥–Ω–æ –ø–æ—è—Å–Ω–µ–Ω–∏–µ: —Ç.–∫. –ø—Ä–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –ø–æ –ø–æ–ª—é –¥–∞—Ç–∞ –ø–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –ø–æ –æ—Å—Ç–∞–ª—å–Ω—ã–º –ø–æ–ª—è–º –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è (—Ä–∞–∑–±–∏—Ä–∞–ª–æ—Å—å –∑–¥–µ—Å—å) –∫ –æ–¥–Ω–æ–π –∏–∑ –æ–±—ä–µ–¥–∏–Ω—è–µ–º—ã—Ö —Ç–∞–±–ª–∏—Ü —è –¥–æ–±–∞–≤–∏–ª —Å—Ç–æ–ª–±–µ—Ü —Å –µ–¥–∏–Ω–∏—á–∫–∞–º–∏ –∏ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª –µ–≥–æ –≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ.
        –ü–æ —Å—Å—ã–ª–∫–µ –µ—Å—Ç—å —Ñ–∞–π–ª–∏–∫ —Å –ø—Ä–∏–º–µ—Ä–æ–º.
        –ê –∑–¥–µ—Å—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞. –¢–∞–º –∂–µ –∫–æ–ª–ª–µ–≥–∞ –ø–æ–∫–∞–∑–∞–ª –∫–∞–∫ –æ–Ω –∏–∑–º–µ–Ω–∏–ª –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –º–Ω–æ–π –∫–æ–¥ –¥–ª—è –µ—â—ë –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –±–æ–ª—å—à–æ–º –º–∞—Å—Å–∏–≤–µ.
        –£–¥–∞—á–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏!üòâ
        let
            to = Table.TransformColumnTypes(Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞_–¥–ª—è_–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"]}[Content],{{"–î–∞—Ç–∞", type date}}),
            from = Table.TransformColumnTypes(Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞_–∏—Å—Ç–æ—á–Ω–∏–∫"]}[Content],{{"–î–∞—Ç–∞", type date}}),
            combine = Table.AddColumn(from, "–î–∞—Ç–∞–ò—Å—Ç–æ—á–Ω–∏–∫", each [–î–∞—Ç–∞], Date.Type) & Table.AddColumn(to, "tab", each 1, Int64.Type),
            sorted = Table.Sort(combine,{{"–ü—Ä–æ–¥–∞–≤–µ—Ü", Order.Ascending}, {"–î–∞—Ç–∞", Order.Ascending}, {"tab", Order.Ascending}}),
            filledDown = Table.FillDown(sorted,{"–í—ã—Ä—É—á–∫–∞", "–î–∞—Ç–∞–ò—Å—Ç–æ—á–Ω–∏–∫"}),
            filtered = Table.SelectRows(filledDown, each ([tab] = 1)),
            removed = Table.RemoveColumns(filtered,{"tab"})
        in
            removed
    ]

[   Web.Contents –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
    #–ù–µ–í—Å–µ–ô–æ–≥—É—Ä—Ç—ã–û–¥–∏–Ω–∞–∫–æ–≤–æ–ü–æ–ª–µ–∑–Ω—ã
    –ß—Ç–æ-—Ç–æ –º–µ–Ω—è —Ä–∞–±–æ—Ç–æ–π –ø—Ä–∏–≤–∞–ª–∏–ª–æ –º–∞–ª–æ—Å—Ç—å. –ù–æ —è –≤—ã–±—Ä–∞–ª—Å—è –∏ —Å–Ω–æ–≤–∞ –Ω–∞—É—á—É –≤–∞—Å –Ω–∞–Ω–æ—Å–∏—Ç—å –¥–æ–±—Ä–æ –∏ –ø—Ä–∏—á–∏–Ω—è—Ç—å –ø–æ–ª—å–∑—É —Å–µ–±–µ –∏ –æ–∫—Ä—É–∂–∞—é—â–∏–º.
    –í –º–æ–µ–º —Å–∞–º–æ–º –≤—Ç–æ—Ä–æ–º –ø–æ—Å—Ç–µ —è –∫–æ–µ —á–µ–≥–æ –æ–±–µ—â–∞–ª, –≤–æ—Ç —Å–¥–µ—Ä–∂–∏–≤–∞—é —Å–ª–æ–≤–æ.
    –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≤–µ–± —Å—Å—ã–ª–∫—É —Å –∏–∑–º–µ–Ω—è–µ–º—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º —á—Ç–æ–±—ã –æ–±–ª–∞—á–Ω–∞—è —Å–ª—É–∂–±–∞ PBI –Ω–µ —Ä—É–≥–∞–ª–∞—Å—å –Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

    let
    // –í–û–¢ –¢–ê–ö –°–ï–†–í–ò–° –ë–£–î–ï–¢ –†–£–ì–ê–¢–¨–°–Ø, –µ—Å–ª–∏ —Å—Å—ã–ª–∫—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Ç–µ–∫—Å—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
    Source = Xml.Tables(Web.Contents( "http://www.cbr.ru/scripts/XML_daily.asp?date_req=02/03/2002" )),

    // –í–û–¢ –¢–ê–ö —Ä—É–≥–∞—Ç—å—Å—è –Ω–µ –±—É–¥–µ—Ç, –µ—Å–ª–∏ Url —ç—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –∞ –Ω–µ —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞/–∑–∞–ø–∏—Å–∏
    // –ø—Ä–∏ —ç—Ç–æ–º –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä Query –º–æ–∂–Ω–æ –ø–∏—Ö–∞—Ç—å –≤—Å–µ —á—Ç–æ —Ö–æ—á–µ—Ç—Å—è, –ª–∏—à—å –±—ã API –≤–∞—Å –ø–æ–Ω—è–ª
        Url = "http://www.cbr.ru/scripts/XML_daily.asp",
        Query = [Query = [date_req="02/03/2002"]],
        Source1 = Xml.Tables(Web.Contents( Url, Query )),

    // –í–û–¢ –¢–ê–ö —Ç–æ–∂–µ —Ä—É–≥–∞—Ç—å—Å—è –Ω–µ –±—É–¥–µ—Ç, –µ—Å–ª–∏ Url —ç—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –∞ –Ω–µ —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞/–∑–∞–ø–∏—Å–∏
    // –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –æ–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∑–∞–ø–∏—Å–∏ Query2 –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        Url2 = "http://www.cbr.ru/scripts/",
        Query2 = [ 
            RelativePath = "XML_daily.asp",
            Query = [date_req="02/03/2002"]
        ],
        Source2 = Xml.Tables(Web.Contents( Url2, Query2 ))
    in
        Source2
    
    ]
[   –ö–∞–∫ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –ª–∏—Å—Ç–µ Excel —Å –ø–æ–º–æ—â—å—é —Ñ–æ—Ä–º—É–ª DAX
    #–í—Å—è–∫–æ–†–∞–∑–Ω–æ
    –í—Å–µ–º –¥–æ–±—Ä–∞. –ò —Å–Ω–æ–≤–∞ –≥—Ä–∞–∂–¥–∞–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç—Å—è —Å—Ç—Ä–∞–Ω–Ω—ã–º, –∞ —è –∏—Ö —É—á—É –Ω–µ—Ö–æ—Ä–æ—à–µ–º—É. –†–∞—Å—Å–∫–∞–∂—É –∏ –≤–∞–º.
    –°—Ü–µ–Ω–∞—Ä–∏–π —Ç–∞–∫–æ–π:
    - –•–æ—á—É —É–≤–∏–¥–µ—Ç—å –Ω–∞ –ª–∏—Å—Ç–µ Excel —Ç–∞–±–ª–∏—Ü—É –∏–∑ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö.
    - –ù—É, —Ä–∞–∑ —Ö–æ—Ç–∏—Ç–µ...
    –ò—Ç–∞–∫, –º–æ–∂–Ω–æ –≤—Å–µ–≥–¥–∞ —Å–æ—Å–ª–∞—Ç—å—Å—è –Ω–∞ –ª—é–±—É—é —Ç–∞–±–ª–∏—Ü—É –∏–∑ –º–æ–¥–µ–ª–∏, –≤–æ—Ç –ø—Ä–∏–º–µ—Ä. 
    –î–æ–±–∞–≤–ª—è–π—Ç–µ –ª—é–±—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏ DAX, –æ–Ω–∏ —Ç—É—Ç –∂–µ –ø–æ—è–≤—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ –Ω–∞ –ª–∏—Å—Ç–µ. 
    –•–æ—Ç—è —Ç–∞–±–ª–∏—Ü–∞ –≤ –º–æ–¥–µ–ª—å –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –∏–∑ –±—É—Ñ–µ—Ä–∞ –∏ –≤–æ–æ–±—â–µ –Ω–µ –∏–º–µ–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
    –ù–µ–±–æ–ª—å—à–æ–π –≥–∞–π–¥ –∫–∞–∫ —Ç–∞–∫–æ–µ —Å–¥–µ–ª–∞—Ç—å:
    –ï—Å–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ç–∞–±–ª–∏—Ü—ã —è–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å PQ, —Ç–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ –≤ –º–µ–Ω—é –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤... –∫—Ä–æ–º–µ –≥–∞–ª–æ—á–∫–∏ –æ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö, 
    –Ω—É–∂–Ω–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–±—Ä–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–≥—Ä—É–∑–∫–∏ –µ—â–µ –∏ –≤ —Ç–∞–±–ª–∏—Ü—É.
    –î–æ–ø—É—Å—Ç–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫ - –Ω–µ –∑–∞–ø—Ä–æ—Å PQ,
    1. –ò–º–µ–µ–º –≤ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–∫—É—é —Ç–∞–±–ª–∏—Ü—É, –∫ –∫–æ—Ç–æ—Ä–æ–π —Ö–æ—Ç–∏–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –ª–∏—Å—Ç–∞ –∏ –≤–∏–¥–µ—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –¥–æ–ø—É—Å—Ç–∏–º –≤ –º–æ–¥–µ–ª–∏ –æ–Ω–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ü—Ä–æ–¥–∞–∂–∏
    2. —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –Ω–∏ —Å –æ–¥–Ω–æ–π –∏–∑ —Ç–∞–±–ª–∏—Ü –≤ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–∞ —è—á–µ–π–∫–∞ –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏–π.
    3. —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∂–∞–µ–º –∏ –≤ –º–æ–¥–µ–ª—å –∏ –≤ —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –ª–∏—Å—Ç
    4. —Ç—ã–∫–∞–µ–º –ü–ö–ú –ø–æ –≤—ã–≥—Ä—É–∂–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤—ã–±–∏—Ä–∞–µ–º –ø—É–Ω–∫—Ç –∏–∑–º–µ–Ω–∏—Ç—å DAX –∫–∞–∫ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ
    5. —É–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è –Ω—É–∂–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –º–æ–¥–µ–ª–∏
    6. —É–¥–∞–ª—è–µ–º —Ç–µ–ø–µ—Ä—å –Ω–µ –Ω—É–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–æ–Ω –≤–º–µ—Å—Ç–µ —Å —Å–æ–±–æ–π —É–¥–∞–ª–∏—Ç –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é –Ω–µ–Ω—É–∂–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∏–∑ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö)
    7. –ø–æ–ª—å–∑—É–µ–º—Å—è –∏ —Ä–∞–¥—É–µ–º—Å—è.
    ] 

[   –ö–∞–∫ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤
    #–í—Å—è–∫–æ–†–∞–∑–Ω–æ
    –î–µ–ª—é—Å—å —Ñ—É–Ω–∫—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤ —Ç–∞–±–ª–∏—Ü–µ, –∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –ª–æ–º–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤. 
    –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—ã–≥—Ä—É–∑–æ–∫ –∏–∑ 1–° –∏–ª–∏ —Ñ–∞–π–ª–æ–≤, 
    –∑–∞–ø–æ–ª–Ω—è–µ–º—ã—Ö —à–∞–ª–æ–≤–ª–∏–≤—ã–º–∏ —Ä—É—á–∫–∞–º–∏. –ö–æ–¥ –ø—Ä–∏–≤–µ–¥–µ–Ω —Å—Ä–∞–∑—É —Å –ø—Ä–∏–º–µ—Ä–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.
    let
        FnRemoveEmptyColumns = 
            (tab as table) =>
                Table.RemoveColumns(
                    tab,
                    Table.SelectRows(Table.Buffer( Table.Profile( tab ) ),
                    each [NullCount] = [Count] )[Column] 
                ),
        Source = #table( {"a","b","c"}, {{1,1,null},{2,2,null}} ),
        Custom1 = FnRemoveEmptyColumns( Source )
    in
        Custom1
    ]

[   –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –ø—É—Å—Ç—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤  / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.Profile
    
    –î–µ–ª—é—Å—å —Ä–µ—à–µ–Ω–∏–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ –≤–æ–∑–Ω–∏–∫–∞—é—â–µ–π –∑–∞–¥–∞—á–∫–∏ - –∞ –∏–º–µ–Ω–Ω–æ: –Ω–∞ –≤—Ö–æ–¥–µ –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É, —á–∞—Å—Ç—å —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–æ—Ç–æ—Ä–æ–π —è–≤–ª—è—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏, 
    —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –∏—Ö —É–¥–∞–ª–∏—Ç—å. –ß—Ç–æ –∂, –Ω–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é:
    
    fnRemEmptyColumns = (tbl)=>
        [   a = List.Sort(Table.ColumnNames(tbl)),
            b = Table.Profile(tbl,{{"tmp", (x)=>true,List.NonNullCount}})[tmp],
            c = List.PositionOf(b,0,Occurrence.All),
            d = List.Transform(c,(x)=>a{x}),
            e = Table.RemoveColumns(tbl,d)
        ][e]

    –†–∞–∑–±–µ—Ä–µ–º –ø–æ —à–∞–≥–∞–º:
    a - –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –µ–≥–æ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
    b - –∏–∑—é–º–∏–Ω–∫–∞ —Ä–µ—à–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑—É–µ–º Table.Profile(), –Ω–æ —Å–æ –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º (–±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ –Ω–µ–≥–æ - —Å–º. —Å—Ü—ã–ª—å –Ω–∏–∂–µ). –¢.–µ. –¥–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∞–≥—Ä–µ–≥–∞—Ü–∏—é "tmp" –¥–ª—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ ((x)=>true) —Å —Ñ—É–Ω–∫—Ü–∏–µ–π List.NonNullCount. –ò –∑–∞–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü Table.Profile(...)[tmp]
    —Å - –≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–∑–∏—Ü–∏–∏ –ø—É—Å—Ç—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ Occurence.All - –º–æ—â–Ω–∞—è —à—Ç—É–∫–∞)
    d - –Ω–æ–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π –∑–∞–º–µ–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ (—Ç–æ–∂–µ –ø—Ä–∏–µ–º—á–∏–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π - –∫–∞–∫ –≤—ã—Ç–∞—â–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–π –∏–∑ —Å–ø–∏—Å–∫–∞)
    e - —É–¥–∞–ª—è–µ–º - –í—É–∞–ª—è! –ó–∞–¥–∞—á–∫–∞ —Ä–µ—à–µ–Ω–∞.
    ]

[   –ó–∞—á–µ–º –ø–∏—Å–∞—Ç—å (x)=> –≤–º–µ—Å—Ç–æ each _  / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –æ—Å–Ω–æ–≤—ã, List.Transform
    //  –í–æ–∑—å–º—ë–º –ø—Ä–æ—Å—Ç—É—é –∑–∞–¥–∞—á–∫—É ‚Äì –∏–º–µ–µ–º —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—Å—Ç–∞
        lst = {"1","2","3"} –∏ —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª
    //  –†–µ—à–µ–Ω–∏–µ –±–∞–Ω–∞–ª—å–Ω–æ–µ:
        to = List.Transform(lst, each Number.From(_))
    //  –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–æ–≥—É—Ç —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ—â–µ:
        to = List.Transform(lst,Number.From)
    //  –ò –±—É–¥—É—Ç —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –ø—Ä–∞–≤—ã, –≤–µ–¥—å —Å–ø—Ä–∞–≤–∫–∞ –Ω–∞–º –≥–æ–≤–æ—Ä–∏—Ç
        List.Transform(list as list, transform as function)
    //  –¢.–µ. –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –∏–¥—ë—Ç –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –§–£–ù–ö–¶–ò–Ø ‚Äì –º—ã –µ—ë —É–∫–∞–∑–∞–ª–∏, –∏ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ, –ª–æ–≥–∏—á–Ω–æ.
    //  –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ —è–∑—ã–∫ M —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è each _ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–º —Å–∞—Ö–∞—Ä–æ–º –¥–ª—è (x)=> x; –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º:
        to = List.Transform(lst, (x)=>Number.From(x))
    //  –¢–∞–∫ —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –∑–∞—á–µ–º –Ω–∞–º —ç—Ç–æ? –ê –≤–æ—Ç –∑–∞—á–µ–º:
    //  –í–æ-–ø–µ—Ä–≤—ã—Ö, –º–æ–∂–Ω–æ —Å–æ–æ–±—Ä–∞–∑–∏—Ç—å, —á—Ç–æ List.Transform —Ö–æ—á–µ—Ç –æ—Ç –Ω–∞—Å –õ–Æ–ë–£–Æ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç x –∏ —á—Ç–æ-—Ç–æ —Å –Ω–∏–º –¥–µ–ª–∞–µ—Ç
        f=(x)=>Number.From(x)*8-11
        to = List.Transform(lst,f)
    //  —Ç.–µ. –ø–∏—à–µ–º –ª—é–±—É—é –Ω—É–∂–Ω—É—é –Ω–∞–º —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç –æ–¥–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –∏ –¥–∞–ª–µ–µ –ø—Ä–æ—Å—Ç–æ –µ—ë –ø–µ—Ä–µ–¥–∞–µ–º ‚Äì –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —É–¥–æ–±–Ω–æ, –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º.
    //  –ê –≤–æ-–≤—Ç–æ—Ä—ã—Ö, –ø–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –≤–∫–ª–∞–¥—ã–≤–∞—Ç—å –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é –≤ –¥—Ä—É–≥—É—é.
    //  –ù–∞–ø—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∫–∞ ‚Äì –∏–∑ –¥–≤—É—Ö —Å–ø–∏—Å–∫–æ–≤ –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω (–ø—Ä–∏—á–µ–º –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –ø–µ—Ä–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç 
    //  —Å—Ü–µ–ø–∫–∏ —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–∞–∂–¥—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –≤—Ç–æ—Ä–æ–≥–æ), –ø–æ–ø—Ä–æ–±—É–µ–º —Ä–µ—à–∏—Ç—å:
    let
        lst1 =  {"1".."3"},
        lst2 =  {"1".."9"},
        lst  =  List.Transform(
                    lst1,
                    (x)=>{x} & List.Transform(
                        lst2,
                        (y) => x & y
                    )
                ),
        to = List.Combine(lst)
    in
        to
    // –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —à–∞–≥ lst ‚Äì –≤ —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç (x)=> –≤–ª–æ–∂–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç (y)=> . –° each _ —Ç–∞–∫ —Å–¥–µ–ª–∞—Ç—å –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è 
    // (–ø–æ—Ç–æ–º—É —á—Ç–æ –≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö each _ –æ—Ç _ –Ω–∏–∫–∞–∫ –Ω–µ–ª—å–∑—è –æ—Ç–ª–∏—á–∏—Ç—å))), –∞ —Ç–µ–ø–µ—Ä—å –º—ã –ø–æ–ª—É—á–∏–ª–∏ (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å–µ–≥–¥–∞ –∏–º–µ–ª–∏, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏) 
    // –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –≤–º–µ—Å—Ç–æ _ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∫–æ–¥–∞.
    // –í —Ü–µ–ª–æ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (x)=> —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º (–µ—â—ë —Ä–∞–∑ –Ω–∞–ø–æ–º–∏–Ω–∞—é ‚Äì –æ—Ç –Ω–∞—Å –æ–±—ã—á–Ω–æ —Ö–æ—Ç—è—Ç –§–£–ù–ö–¶–ò–Æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –º—ã –ø–∏—à–µ–º –µ—ë –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ) 
    // –∏ –ø–æ —Ö–æ—Ä–æ—à–µ–º—É —Å—Ç–∞–≤–∏—Ç –º–æ–∑–≥–∏ –Ω–∞ –º–µ—Å—Ç–æ, –ø–æ–∑–≤–æ–ª—è—è –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ —É–π—Ç–∏ –æ—Ç –Ω–∞–∫–ª–∞—Ü–∞–Ω–Ω—ã—Ö –º—ã—à–∫–æ–π —à–∞–≥–æ–≤ –∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –∫–æ–¥–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ö.
    // –ù—É –∏ –ø—ã—Ç–ª–∏–≤—ã–µ —É–º—ã –∫–æ–Ω–µ—á–Ω–æ —Å–∫–∞–∂—É—Ç ‚Äì –∞ –º–æ–∂–Ω–æ –ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø—Ä–∏–º–µ—Ä–µ –∏–∑ —à–∞–≥–∞ lst —Å–¥–µ–ª–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é? –ö–æ–Ω–µ—á–Ω–æ, –º—ã –∂–µ —Ç–µ–ø–µ—Ä—å –∑–Ω–∞–µ–º, 
    // –∫–∞–∫ –æ–±–æ–∑–Ω–∞—á–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
    let
        f=(x,y)=>List.Transform(
                    x,
                    (i)=>{i} & List.Transform(
                            y,
                            (j)=>i&j
                    )
                ),
        lst1 = {"1".."3"},
        lst2 = {"1".."9"},
        lst = f(lst1,lst2),
        to = List.Combine(lst)
    in
        to
    –í—Ä–æ–¥–µ –Ω–µ —Å–ª–æ–∂–Ω–æ, –∞ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ ‚Äì –∏–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —è –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é each _ –∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é (x)=>
    ]

[   #PQ, #pbi - –°–µ–≥–æ–¥–Ω—è –ø–æ–∫–∞–∂—É –∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å —Å–ø–∏—Å–∫–∏ –∏–∑ —Å–æ—Å–µ–¥–Ω–∏—Ö —è—á–µ–µ–∫.
    
    /*–î–∞–Ω–æ. –ü–æ–ª—É—á–∏–ª–∏ –∏–∑ API –Ω–µ–∫–∏–π JSON –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –≤—ã—Ö–æ–¥–µ –≤—ã–¥–∞–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ –∫–∞–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ tbl (—Å–º. –≤ –∫–æ–¥–µ –Ω–∏–∂–µ). 
    –ù–∞–¥–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø–∏—Å–∫–æ–≤ –≤ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, –Ω–æ –µ—Å–ª–∏ –º—ã —ç—Ç–æ —Å–¥–µ–ª–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –º—ã—à–∏–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º —Å 
    —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ–º —Å–ø–∏—Å–∫–æ–≤ –≤ —Å—Ç—Ä–æ–∫–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ, –Ω–µ —Ç–∞–∫–æ–µ –∫—Ä–∞—Å–∏–≤–æ–µ –∫–∞–∫ 
    —ç—Ç–æ –Ω–æ —Ç–æ–∂–µ –Ω–∏—á–µ–≥–æ. –ß—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å? –ê –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤—Å–µ –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ: –Ω–∞–¥–æ –Ω–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã, 
    –∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ Table.FromColumns —Å–æ–±—Ä–∞—Ç—å –∏–∑ –Ω–∏—Ö –≥–æ—Ç–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É –≤ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ:*/
    let
        tbl = Table.FromRecords (
            {
                [ Company = 1, Phone = { "1".."9" }, Mail = { "1".."6", "", "8".."9" } ],
                [ Company = 2, Phone = { "1".."5" }, Mail = { "2".."6" } ]
            }
            ),
        gentabs = Table.AddColumn(
            tbl,
            "tabs",
            each Table.FromColumns(
                {List.Repeat({[Company]}, List.Count([Phone])),[Phone],[Mail]},
                Table.ColumnNames(tbl)
            )
        ),
        tabs = Table.Combine(gentabs[tabs])
    in
        tabs
    
    /*–ù–æ –º–æ–∂–µ—Ç –µ—â–µ —Å–ª—É—á–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –ø—Ä–æ—Å—Ç—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º (–Ω–µ —Å–ø–∏—Å–∫–∏) –±—É–¥–µ—Ç –º–Ω–æ–≥–æ, –∏ —Ç–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 
    List.Repeat —Å—Ç–∞–Ω–µ—Ç —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –¥–∞ –∏ –∫–æ–¥ —Å–∏–ª—å–Ω–æ –ø–æ—Ç–µ—Ä—è–µ—Ç —Å–≤–æ—é –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç—å. 
    –ù–æ –¥–ª—è —ç—Ç–æ–≥–æ —Å–ª—É—á–∞—è –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–æ—é –ª—é–±–∏–º—É—é —Ñ—É–Ω–∫—Ü–∏—é Table.FillDown –¥–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏ –ø–æ–ª—É—á–∏–º —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.*/
    let
        tbl = Table.FromRecords (
        {
            [ Company = 1, Phone = { "1".."9" }, Mail = { "1".."6", "", "8".."9" } ],
            [ Company = 2, Phone = { "1".."5" }, Mail = { "2".."6" } ]
        }
        ),
        gentabs = Table.AddColumn(tbl,"tabs",
                each Table.FromColumns(
                    {{[Company]},[Phone],[Mail]},
                    Table.ColumnNames(tbl)
                )
            ),
        filled = Table.AddColumn(gentabs, "tabs_", each Table.FillDown([tabs],{"Company"})),
        tabs = Table.Combine(filled[tabs_])
    in
        tabs
    ]

[   –ó–∞—á–µ–º –Ω—É–∂–µ–Ω [ ][ ] –∫–æ–≥–¥–∞ –µ—Å—Ç—å let in  / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - –æ—Å–Ω–æ–≤—ã
    // –í–æ–∑—å–º–µ–º –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–∞–∫ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—å –≤ –≤–∞–∫—É—É–º–µ –∑–∞–ø—Ä–æ—Å:
    let
        a = 8,
        b = 16,
        c  = a*b,
        d = a/b
    In
        d
    // –ù–∞ –≤—ã—Ö–æ–¥–µ, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, –ø–æ–ª—É—á–∏–º 0,5.
    // –§–∏—à–∫–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤ –Ω–µ–¥—Ä–∞—Ö —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ —è–∑—ã–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ ¬´–í—ã—Ä–∞–∂–µ–Ω–∏–µ let –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π 
    // —Å–∞—Ö–∞—Ä –¥–ª—è –Ω–µ—è–≤–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏¬ª.
    // –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º:
    [   a = 8,
        b = 16,
        c  = a*b,
        d = a/b ][d]
    // –í—ã–¥–∞—Å—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ.
    // –ü–æ—á–µ–º—É? –ó–∞–ø–∏—Å—å ‚Äì —ç—Ç–æ –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π (–µ—ë –µ—â—ë –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã), –Ω–æ –∫—Ç–æ —Å–∫–∞–∑–∞–ª, —á—Ç–æ –Ω–µ –±—ã–≤–∞–µ—Ç –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö –ø–æ–ª–µ–π? –ü—Ä–∏–º–µ—Ä –≤—ã—à–µ –∫–∞–∫ —Ä–∞–∑ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –≤–ø–æ–ª–Ω–µ —Å–µ–±–µ –±—ã–≤–∞—é—Ç.
    // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è [ ][d] ‚Äì —ç—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—é –∑–∞–ø–∏—Å–∏ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ in d).
    // –ó–∞—á–µ–º –Ω–∞–º –≤—Å—ë —ç—Ç–æ? –ù—É –¥–ª—è –Ω–∞—á–∞–ª–∞ ‚Äì –∞ –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –≤—ã–≤–µ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ, –∏ —á–∞—Å—Ç–Ω–æ–µ:
    [   a = 8,
        b = 16,
        c  = a*b,
        d = a/b ][[c],[d]]
    // –°—Ä–∞–∑—É –¥–∞—Å—Ç [c=128, d=0,5]
    // –ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥ —ç—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ, —á–µ–º
    let
        a = 8,
        b = 16,
        c  = a*b,
        d = a/b
    in
        [c=c, d=d]
    // –•–æ—Ç—è —ç—Ñ—Ñ–µ–∫—Ç –±—É–¥–µ—Ç —Ç–µ–º –∂–µ.
    // –ê –¥–∞–ª—å—à–µ ‚Äì –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±—ã–≤–∞—é—Ç —Ä–∞–∑–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –∏–Ω–æ–≥–¥–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø —Ç—Ä–µ–±—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö 
    // —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ —Ç–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è, –ª–∏–±–æ –≤–∫–ª–∞–¥—ã–≤–∞—Ç—å let in –¥—Ä—É–≥ –≤ –¥—Ä—É–≥–∞:
    let
        f=(x)=>let 
                    a=Text.From(x),
                    b=Text.ToList(a),
                    c=List.Distinct(b),
                    d=b=c 
                in  
                    d,
        from = List.Numbers(0,1024),
        to = List.Select(from,f)
    in
        to
    // –ª–∏–±–æ –º–æ–∂–Ω–æ —É–ø–∞–∫–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —à–∞–≥–∏ –≤ –∑–∞–ø–∏—Å—å:
    let
        f=(x)=>[a=Text.From(x), b=Text.ToList(a), c=List.Distinct(b), d=b=c][d],
        from = List.Numbers(0,1024),
        to = List.Select(from,f)
    in
        to
    // –ü–æ –º–Ω–µ –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–æ—â–µ, —Ö–æ—Ç—è —ç—Ç–æ –¥–µ–ª–æ –≤–∫—É—Å–∞.
    // –°–∏–Ω—Ç–∞–∫—Å–∏—Å —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Å–∏ –æ–±—ã—á–Ω–æ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ [ ].
    // –ù–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∏–∫–∞–∫ –Ω–µ —Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É –∫–∞–∫ —É–¥–æ–±–Ω–µ–µ - —Ä–µ—à–∞—Ç—å –≤–∞–º.
    ]

[   List.Generate, –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –∏ –ø–æ—â–∞–¥–Ω—ã–π / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Generate
    // –î—É–º–∞—é –Ω–µ—Å–ª–æ–∂–Ω–æ –¥–æ–≥–∞–¥–∞—Ç—å—Å—è, —á—Ç–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª—é —á–∏—Ç–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é, –∏–±–æ —Ç–∞–º —Å–∫–∞–∑–∞–Ω–æ:
    
    List.Generate( 
        initial as function,
        condition as function,
        next as function,
        optional selector as nullable function)
    
    –ò—Ç–∞–∫, —Ñ—É–Ω–∫—Ü–∏—è, —É –∫–æ—Ç–æ—Ä–æ–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤—ã—Å—Ç—É–ø–∞—é—Ç —á–µ—Ç—ã—Ä–µ —Ñ—É–Ω–∫—Ü–∏–∏. –£–∂–µ —Å—Ç—Ä–∞—à–Ω–æ.
    –î–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –¥–∞–ª–µ–µ –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å (x)=> (–ø–æ–¥—Ä–æ–±–Ω–µ–µ —á–∏—Ç–∞–µ–º —Ç—É—Ç).
    –î–ª—è –Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫ –æ—Ç 1 –¥–æ 10 (–µ—Å–ª–∏ —á—Ç–æ —è –∑–Ω–∞—é –ø—Ä–æ {1..10} –Ω–æ —É –Ω–∞—Å —Ç—É—Ç –ø—Ä–æ –¥—Ä—É–≥–æ–µ:
    List.Generate(  ()=>[i=1],
                    (x)=>x[i]<=10,
                    (x)=>[i=x[i]+1],
                    (x)=>x[i])
    initial - –ø—Ä–æ—Å—Ç–æ –¥–∞—ë—Ç –Ω–∞–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 1, –Ω–æ –≤ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, —Ç–∞–º –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è, –ø–æ—ç—Ç–æ–º—É —Å—Ä–∞–∑—É –ø–∏—à–µ–º –∫–∞–∫ –Ω–∞–¥–æ ‚Äì —Ç.–µ. —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Å—å
    condition ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–ø—Ä–æ—Å –≤ —Ç–æ–º –æ—Ç —á–µ–≥–æ? –ö–∞–∫ –Ω–∏ —Å—Ç—Ä–∞–Ω–Ω–æ, –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, x[i] ‚Äì —ç—Ç–æ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞ –∏ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –ø—Ä–µ–≤—ã—Å–∏–ª–æ –ª–∏ –æ–Ω–æ 10
    next ‚Äì –∞ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞ –≤—Ö–æ–¥–µ —É –Ω–∞—Å –±—ã–ª–∞ –∑–∞–ø–∏—Å—å [i=‚Ä¶], –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ç–æ–∂–µ –±—É–¥–µ—Ç –æ–Ω–∞ [i=x[i]+1] ‚Äì —Ç.–µ. –≤ –ø–æ–ª–µ i –∑–∞–ø–∏—Å–∞–ª–∏ —Ç–µ–∫—É—â–µ–µ, —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É
    selector ‚Äì –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –≤—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –Ω–∞—Å –ø–æ–ª—è, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ x[i].
    –î–∞, –Ω–µ–º–Ω–æ–∂–∫–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ, –Ω–æ —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –≤—ã–≤–µ–¥–µ–º –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 10, –∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –¥–ª—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∫–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—ã—á–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):
    
    List.Generate(  ()=>[i=1, s= i],
                    (x)=>x[i]<=10,
                    (x)=>[i=x[i]+1, s=x[s]+i],
                    (x)=>x[s])
    /*
    –¢–µ–ø–µ—Ä—å: initial     ‚Äì —ç—Ç–æ —É–∂–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è [i,s], –ø—Ä–∏—á–µ–º s –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ i (–ø—Ä–æ [ ] –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å —Ç—É—Ç)
            condition   ‚Äì —Ç–∞–∫–æ–π –∂–µ
            next        ‚Äì —Ç–µ–ø–µ—Ä—å –≤ –∑–∞–ø–∏—Å–∏ i –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–±–∞–≤–ª–µ–Ω–∏–µ–º –µ–¥–∏–Ω–∏—Ü—ã, –∞ s ‚Äì –ø—Ä–∏–±–∞–≤–ª–µ–Ω–∏–µ–º i –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
            selector    ‚Äì –Ω–∞ –≤—ã—Ö–æ–¥–µ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∏–º–µ–Ω–Ω–æ s, —Ç–∞–∫ —á—Ç–æ —Å—á—ë—Ç—á–∏–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º, –Ω–æ –Ω–µ –≤—ã–≤–æ–¥–∏–º.
    */
    // –ù—É –∏ —á—Ç–æ-–Ω–∏–±—É–¥—å –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ –±–æ–µ–≤–æ–π –ø—Ä–∏–º–µ—Ä:
    let
        tbl =   Table.FromRecords({
                    [a="–í–∞—Å—è", b = 2],
                    [a="–ö–æ–ª—è", b = 4],
                    [a="–ü–µ—Ç—è", b = 8],
                    [a="–ï–≤–ª–∞–º–ø–∏–π", b = 16]
                }),
        lst =   List.Buffer(tbl[b]),
        n   =   List.Count(lst),
        gen =   List.Generate(
                    ()=>[i=0, s=lst{i}],
                    (x)=>x[i]<n,
                    (x)=>[i=x[i]+1, s=x[s]+lst{i}],
                    (x)=>x[s]
                ),
        to =    Table.FromColumns(
                    Table.ToColumns(tbl)&{gen},
                    Table.ColumnNames(tbl)&{"cusum"}
                )
    in
        to
    /*
    –†–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —à–∞–≥–∞–º
        tbl - –Ω–∞ –≤—Ö–æ–¥ –ø–æ—Å—Ç—É–ø–∏–ª–∞ —Ç–∞–±–ª–∏—Ü–∞, –¥–æ–ø—É—Å—Ç–∏–º –Ω–∞–º –Ω—É–∂–Ω–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É b
        lst ‚Äì –ø–æ–ª—É—á–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ List.Buffer ‚Äì –∑–¥–µ—Å—å –æ–Ω–æ –Ω—É–∂–Ω–æ, –ø–æ—Ç–æ–º—É –∫–∞–∫ –∫ —ç—Ç–æ–º—É —Å–ø–∏—Å–∫—É –º—ã –±—É–¥–µ–º –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è
        n   ‚Äì –ø–æ—Å—á–∏—Ç–∞–ª–∏ —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ (–Ω–∞–º –∂–µ –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è —Å—á—ë—Ç—á–∏–∫–∞)
        gen ‚Äì –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–∞, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ, –Ω–æ —Å –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏:
        initial - i=0 ‚Äì –ø–æ—Ç–æ–º—É –∫–∞–∫ –Ω—É–º–µ—Ä–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –Ω—É–ª—è, s=lst{i} ‚Äì –≤ —Å—É–º–º—É –∏–¥—ë—Ç i-—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ lst
        condition ‚Äì –∑–¥–µ—Å—å —É—Å–ª–æ–≤–∏–µ x[i]<n, –ø–æ—Ç–æ–º—É –∫–∞–∫ –Ω—É–º–µ—Ä–∞—Ü–∏—è –±—ã–ª–∞ —Å –Ω—É–ª—è –∏ <= –¥–∞—Å—Ç –Ω–∞–º –Ω–∞ –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –±–æ–ª—å—à–µ, —á–µ–º –Ω–∞–¥–æ
        next ‚Äì —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –Ω–∞ 1, –∫ —Å—É–º–º–µ –ø—Ä–∏–±–∞–≤–ª—è–µ–º i-—ã–π —ç–ª–µ–º–µ–Ω—Ç
        selector ‚Äì –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å—É–º–º–∞
        to ‚Äì –∞ –≤–æ—Ç —Ç–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø—Ä–∏–ª–µ–ø–∏—Ç—å –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∫ —Ç–∞–±–ª–∏—Ü–µ, –¥–ª—è —ç—Ç–æ–≥–æ :
        Table.ToColumns(tbl)&{gen} - –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–º–µ—é—â–∏—Ö—Å—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–º—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
        Table.ColumnNames(tbl)&{"cusum"} ‚Äì –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–º—É –Ω—É–∂–Ω–æ –µ –∏–º—è
        –ù—É –∏ —É–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —ç—Ç–æ –≤—Å—ë —á–µ—Ä–µ–∑ Table.FromColumns
        –í—É–∞–ª—è ‚Äì —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–π —Å—É–º–º—ã –¥–æ–±–∞–≤–ª–µ–Ω!
    
        –Ø –∑–Ω–∞—é, —á—Ç–æ –ø—Ä–∏–º–µ—Ä—ã –≤ —Å–ø—Ä–∞–≤–∫–µ –ø–æ–ø—Ä–æ—â–µ –∏ –Ω–∞–ø–∏—Å–∞–Ω—ã —á–µ—Ä–µ–∑ each, –∏ –∫–æ–¥ –≤—ã—à–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø—Ä–æ—â–µ, –Ω–æ –≤ –æ–±—â–µ–º –≤–∏–¥–µ –æ–Ω–æ –≤—ã–≥–ª—è–¥–∏—Ç –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ ‚Äì –∑–∞–ø–∏—Å—å –Ω–∞ –≤—Ö–æ–¥–µ, —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Äì –æ–¥–Ω–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –≤—Ç–æ—Ä–∞—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ (–∫–æ—Ç–æ—Ä–∞—è –≤–æ–æ–±—â–µ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è, –Ω–æ –≤–æ—Ç –ø–æ—á–µ–º—É-—Ç–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).
    */
    ]

[   !!! –ó–∞–º—ã–∫–∞–Ω–∏—è, –∏–ª–∏ —á—Ç–æ –∑–∞ –∑–≤–µ—Ä—å (y)=>(x)=>‚Ä¶ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –æ—Å–Ω–æ–≤—ã
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç, —Å –æ–∫–∞–∑–∏–µ–π —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å —Ç–∞–∫—É—é —à—Ç—É–∫—É, –∫–∞–∫ –∑–∞–º—ã–∫–∞–Ω–∏—è (closure).
    –°—É—Ç—å –≤–æ—Ç –≤ —á—ë–º. –ù–∞–ø–∏—à–µ–º –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä:
    let
        f=(x,y)=>x/y,
        a   = 2,
        b   = 5,
        to  = f(a,b),
    in
        to
    –û—á–µ–≤–∏–¥–Ω–æ, –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–º 0,4. –ù–æ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∏ –ø–æ-–¥—Ä—É–≥–æ–º—É:
    let
        f=(x)=>(y)=>x/y,
        a   = 2,
        b   = 5,
        to  = f(a)(b)
    in
        to
    –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–º —Ç–æ –∂–µ —Å–∞–º–æ–µ. –ù–æ –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ. –ò —Ä–∞–∑—Ä—ã–≤ –º–æ–∑–≥–∞ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –∑–¥–µ—Å—å:
    let
        f=(x)=>(y)=>x/y,
        a   = 2,
        b   = 5,
        c   = f(a),
        to  = c(b)
    in
        to
    –¢–æ–∂–µ –≤—ã–¥–∞—Å—Ç 0,4! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è:
    c ‚Äì –ø–µ—Ä–µ–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ f —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç, a –ø–æ–¥—Å—Ç–∞–≤–∏–ª–æ—Å—å –≤–º–µ—Å—Ç–æ x –∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏‚Ä¶ —Å=(y)=>2/y, —Ç.–µ. –§–£–ù–ö–¶–ò–Æ
    to ‚Äì —ç—Ç–æ–π –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞–ª–∏ b, –∏ —É–∂–µ –æ–Ω–∞ –≤—ã–¥–∞–ª–∞ –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
    –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∑–∞–º—ã–∫–∞–Ω–∏–µ (–∫–ª–æ–∂—É—Ä–∞!) ‚Äì —ç—Ç–æ —É–ø–∞–∫–æ–≤–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é (—ç—Ç–æ —É–ø—Ä–æ—â–µ–Ω–∏–µ - –¥–∞ –ø—Ä–æ—Å—Ç—è—Ç –º–µ–Ω—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ–æ—Ä–µ—Ç–∏–∫–∏). 
    –î—É–º–∞—é, —É –≤–∞—Å –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å ‚Äì –∑–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ?! –ê –≤–æ—Ç –∑–∞—á–µ–º. –†–∞–∑–±–µ—Ä–µ–º –Ω–µ–º–Ω–æ–≥–æ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –±–æ–µ–≤–æ–π –ø—Ä–∏–º–µ—Ä:
    let
        from = Table.FromRecords({  [n="–í–∞—Å—è",a=90,b=70,c=50],
                                    [n="–ö–æ–ª—è",a=120,b=130,c=110],
                                    [n="–ü–µ—Ç—è",a=75,b=80,c=130]}),
        nms= Table.ColumnNames(from),
        lst=List.Skip(nms),
        f=(y)=>(x)=>[   a = Record.Field(x,y) , 
                        b = if a < 80 
                            then "–Ω–∏–∂–µ –ø—Ä–µ–¥–µ–ª–∞" 
                            else    if a > 120 
                                    then "–≤—ã—à–µ –ø—Ä–µ–¥–µ–ª–∞" 
                                    else "–æ–∫"][b],
        g=(x)=>"–ü—Ä–æ–≤–µ—Ä–∫–∞ "&x,
        acc = List.Accumulate(lst,from,(s,c)=>Table.AddColumn(s,g(c),f(c))),
        to = Table.SelectColumns(acc,{nms{0}}&List.Combine(List.Transform(lst,(x)=>{x,g(x)})))
    in
        to
    from ‚Äì  –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü —Å –æ—Ü–µ–Ω–∫–æ–π 
            (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 80 –¥–æ 120). (–∞ —Å–∞–º—ã–π –∂–µ—Å—Ç–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç —É –º–µ–Ω—è –±—ã–ª - 34 —Å—Ç–æ–ª–±—Ü–∞ –∏ ABC-–∞–Ω–∞–ª–∏–∑)
    nms  ‚Äì  –ø–æ–ª—É—á–∏–ª–∏ –≤—Å–µ –∏–º–µ–Ω–∞,
    lst  ‚Äì  –ø–æ–ª—É—á–µ–Ω —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Å—Ç–æ–ª–±—Ü–æ–≤, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–∞ –æ—Ü–µ–Ω–∫–∞
    acc  ‚Äì  –Ω—É —Å–∞–º–æ–µ —Ä–∞–∑—É–º–Ω–æ–µ –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ —Å–ø–∏—Å–∫—É lst - List.Accumulate(lst‚Ä¶ –∏ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ü–µ–Ω–∫—É 
            Table.AddColumn(‚Ä¶; —Ç–æ–ª—å–∫–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ ‚Äì –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ Table.AddColumn –º—ã –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞—Ç—å 
            —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç –æ–¥–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –∞ –∏–º–µ–Ω–Ω–æ ‚Äì –æ—Ç –∑–∞–ø–∏—Å–∏ (—Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏) –≤ —Ç–∞–±–ª–∏—Ü–µ. 
            –ê –Ω–∞–º –Ω—É–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ä–∞–∑–Ω—ã–º –ø–æ–ª—è–º, –≤–æ—Ç —Ç–∞–∫ –∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
    
    f=(y)=>(x)=>[  
        a = Record.Field(x,y) , 
        b = if a < 80 then "–Ω–∏–∂–µ –ø—Ä–µ–¥–µ–ª–∞" else    if a > 120 then "–≤—ã—à–µ –ø—Ä–µ–¥–µ–ª–∞" else "–æ–∫"
    ][b],
    
    –¢.–µ. —Å–Ω–∞—á–∞–ª–∞ –º—ã —Ñ—É–Ω–∫—Ü–∏–∏ f –±—É–¥–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å y ‚Äì –∏ —ç—Ç–æ –±—É–¥–µ—Ç –∏–º—è –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—è –∑–∞–ø–∏—Å–∏, –∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é 
    –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ–≥–æ –ø–æ–ª—è, —á—Ç–æ –º—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–µ:
    (s,c)=>Table.AddColumn(s,g(c),f(c))
    
    –¢.–µ. –¥–æ–±–∞–≤–∏—Ç—å –∫ —Ç–∞–±–ª–∏—Ü–µ s –æ—Ü–µ–Ω–∫—É –ø–æ –ø–æ–ª—é c - f(c) –∏ –Ω–∞–∑–≤–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü g(c)
    –ó–∞—á–µ–º –Ω–∞–¥–æ –±—ã–ª–æ –ø–∏—Å–∞—Ç—å –µ—â—ë –∏ —Ñ—É–Ω–∫—Ü–∏—é g? –î–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–æ –Ω—É–∂–Ω–æ –µ—â—ë –∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —à–∞–≥–µ ‚Äì —Ç–∞–∫ –Ω–µ–º–Ω–æ–∂–∫–æ –∫–æ—Ä–æ—á–µ. 
    –ú—ã –∂–µ —Ö–æ—Ç–∏–º –æ—Ü–µ–Ω–∫—É –ø–æ–ª—É—á–∏—Ç—å —Ä—è–¥–æ–º, –∞ –Ω–µ –≤ –∫–æ–Ω—Ü–µ —Ç–∞–±–ª–∏—Ü—ã, –ø–æ—Ç–æ–º—É-—Ç–æ –Ω–∞ —à–∞–≥–µ to –º—ã –∏ –≤—ã–±–∏—Ä–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã –≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–º –Ω–∞—Å –ø–æ—Ä—è–¥–∫–µ.
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë. –ó–∞–º—ã–∫–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –Ω–µ—á–∞—Å—Ç–æ, –Ω–æ –±—ã–≤–∞—é—Ç –ø—Ä–æ—Å—Ç–æ –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã.
    ]

[   –ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä –∫ –ø–∞–ø–∫–µ OneDrive Personal / #–í—Å—è–∫–∏–µ–ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã
    /*–ö –Ω–æ–≤–æ–º—É –≥–æ–¥—É –Ω–µ–±–æ–ª—å—à–æ–π –ø–æ–¥–∞—Ä–æ—á–µ–∫. –° –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º –Ω–∞ –Ω–∞—à–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –û–° Windows 10/11 –≤—Å–µ –±–æ–ª—å—à–µ –≥—Ä–∞–∂–¥–∞–Ω –ø–æ–ª—É—á–∞—é—Ç 
    –≤ —Å–≤–æ–µ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–µ –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å OneDrive Personal. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ç–∞–∫–æ–≥–æ –∂–µ –æ–±–ª–∞–∫–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ –¥–ª—è –Ω–µ–≥–æ 
    –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ PQ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø–∞–ø–∫–µ, —á—Ç–æ–±—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥–æ–±–∞–≤–ª—è–µ–º—ã—Ö –≤ –Ω–µ—ë —Ñ–∞–π–ª–æ–≤. 
    –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ —Å–∞–º–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç–∞–∫–æ–≥–æ –∑–∞–±–æ—Ä–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã Microsoft –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ API. 
    –ù–∏–∂–µ –ø—Ä–∏–ª–∞–≥–∞—é –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π Folder.Files —Ç–æ—á–Ω–æ —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–º –∫–∞–∫–∏–µ 
    —Ñ–∞–π–ª—ã –∏–º–µ—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ –Ω–∞ –æ–±–ª–∞–∫–µ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º—ã–º. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å? –ó–∞—Ö–æ–¥–∏–º –≤ –æ–±–ª–∞–∫–æ, 
    —Ç—ã–∫–∞–µ–º –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –ø–æ –ø–∞–ø–∫–µ –∏ –≤—ã–±–∏—Ä–∞–µ–º –ø—É–Ω–∫—Ç "–ø–æ–¥–µ–ª–∏—Ç—å—Å—è", –≤ –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –º–µ–Ω—é –∂–º–µ–º "–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É" 
    –∏ —É–∂–µ —ç—Ç—É —Å—Å—ã–ª–∫—É —Å–∫–∞—Ä–º–ª–∏–≤–∞–µ–º –º–æ–µ–π —Ñ—É–Ω–∫—Ü–∏–∏. –¢–∏–ø –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤—ã–±–∏—Ä–∞–µ–º –∞–Ω–æ–Ω–∏–º–Ω—ã–π. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ. */
    OneDriveFolderFiles = (url)=>
    let
        //  –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–∫–∏ –≤ –ø–æ–Ω—è—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è API
            fx = (t)=> Binary.ToText( Text.ToBinary( t, TextEncoding.Utf8 ), BinaryEncoding.Base64 ),
            API_URL = "https://api.onedrive.com/v1.0/shares/"
        
        //—Ç–∞—â–∏–º –ø—É—Ç—å –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Å –∞–¥—Ä–µ—Å–æ–º –∫ –æ–±—â–µ–π –ø–∞–ø–∫–µ –∏–∑ –æ–±–ª–∞–∫–∞ Onedrive
            FolderUrl = url,
        
        //–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –¥–ª—è API
            UrlToBase64 = fx( FolderUrl ),
        
        //–∑–∞–º–µ–Ω—è–µ–º –≤—Å—è–∫–æ–µ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å—Å—ã–ª–∫–µ:
        //https://docs.microsoft.com/ru-ru/onedrive/developer/rest-api/api/shares_get?view=odsp-graph-online#encoding-sharing-urls
            Replaced = Text.Replace( Text.Replace( Text.TrimEnd( UrlToBase64, "=" ), "/", "_" ), "+", "-" ),
        
        //—Ñ–æ—Ä–º–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ RelativePath
            EncodedPath = "u!" & Replaced & "/root/children",
        
        //—Ç–∞—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ –∏–∑ API
            Source = Json.Document(Web.Contents( API_URL, [RelativePath = EncodedPath] ) ),
        
        //  –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π JSON –≤ —Ç–∞–±–ª–∏—á–∫—É —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –ø–∞–ø–∫–∏
            TableFromRecords = Table.FromRecords( Source[value] )[[name],[webUrl]],
        
        //  –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ RelativePath
            AddColEncodedPaths = Table.AddColumn(
            TableFromRecords,
            "GetRelativePath",
            each "u!" & fx([webUrl]) & "/root/content"
        ),
        //–¥–æ—Å—Ç–∞–µ–º –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ –ø–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å—Å—ã–ª–∫–∞–º, –¥–∞–ª—å—à–µ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ –∫–∞–∫ —Å –æ–±—ã—á–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ —Å –¥–∏—Å–∫–∞
            GetBinaries = Table.AddColumn(
                AddColEncodedPaths,
                "Content",
                each Web.Contents(API_URL, [RelativePath = [GetRelativePath]] ),
                Binary.Type
            )
        in
            GetBinaries
    –ó.–´. –ï—Å–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω—ã –≤—Å—è–∫–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –µ—â–µ –∫–∞–∫–∏–µ-—Ç–æ –∞—Ç—Ä–∏–±—É—Ç—ã, —Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤ —à–∞–≥–µ TableFromRecords —É–¥–∞–ª–∏—Ç—å –≤–æ—Ç —ç—Ç–æ –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö: [[name],[webUrl]]. –¢–æ–≥–¥–∞ —É–≤–∏–¥–∏—Ç–µ –≤—Å–µ, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å API –ø—Ä–æ –≤–∞—à—É –ø–∞–ø–∫—É.
    ]    

[   –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ / #–ü–æ–ª–µ–∑–Ω—ã–µ–°—Å—ã–ª–∫–∏
    
    –ò–º–µ–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∞—è –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ PQ –≤ —Å—Ä–µ–¥–µ MS Excel. –í–º–µ—Å—Ç–µ —Å–æ —Å–ø—Ä–∞–≤–∫–æ–π —Å–ª–æ–∂–µ–Ω–∞ –Ω–∞ –≥–∏—Ç—Ö–∞–±:
    https://github.com/buchlotnik/Merka
    ]

[   –ï–≤–ª–∞–º–ø–∏–π, –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º!!! –∏–ª–∏ –∫–∞–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Text.*

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º!
    –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –Ω–µ–±–æ–ª—å—à–∞—è –ª—ë–≥–∫–∞—è –∑–∞–º–µ—Ç–∫–∞ )))
    –í–æ–∑—å–º–µ–º –ø—Ä–æ—Å—Ç—É—é –∑–∞–¥–∞—á–∫—É - –µ—Å—Ç—å –∏–º—è –∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–∞–¥–æ –∏—Ö –∫–∞–∫-—Ç–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å.
    –°—Ä–∞–∑—É –Ω–∞–∫–∏–¥–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:

    let
    name = "–ï–≤–ª–∞–º–ø–∏–π",
    congratulation = "–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º !!!",
    lst = {"–ê–∫–∞–∫–∏–π","–ï–≤–ª–∞–º–ø–∏–π","–ì–ª–∞—Ñ–∏—Ä–∞"},

    out1 = name & ", " & congratulation,
    out2 = Text.Combine({name,congratulation},", "),
    out3 = Text.Format("#{0}, #{1}",{name,congratulation}),
    out3a = Text.Format("–ì–ª—É–±–æ–∫–æ—É–≤–∞–∂–∞–µ–º—ã–π –∏ –≥–æ—Ä—è—á–æ –ª—é–±–∏–º—ã–π #{0}, –≤ —ç—Ç–æ—Ç –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å–Ω—ã–π –¥–µ–Ω—å –ø–∏—à—É –í–∞–º, —á—Ç–æ–±—ã —Å–∫–∞–∑–∞—Ç—å - #{1}. –ñ–µ–ª–∞—é –∑–¥–æ—Ä–æ–≤—å—è, —Å—á–∞—Å—Ç—å—è –∏ —É—Å–ø–µ—Ö–æ–≤!",{name,congratulation}),
    out4 = Text.Insert(congratulation,0,name&", "),
    out5 = Text.ReplaceRange(congratulation,0,0,name&", "),

    fnComb = (x,y)=> Text.ReplaceRange(y,0,0,x&", "),
    out6 = fnComb(name,congratulation),
    fnClojureComb=(x)=>(y)=>Text.Insert(x,0,y&", "),
    out7 = List.Transform(lst,fnClojureComb(congratulation))
    in
    out7

    –ò —Ä–∞–∑–±–µ—Ä–µ–º -
    out1 - –ø—Ä–æ—Å—Ç–µ–π—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ –∞–º–ø–µ—Ä—Å–∞–Ω–¥
    out2 - —Ç–æ –∂–µ, –Ω–æ —á–µ—Ä–µ–∑ Text.Combine - –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ —Å–æ–µ–¥–∏–Ω—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Å–ø–∏—Å–∫–∞ (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ - –≤ —Å–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–Ω—ã—Ö —à–∞–≥–æ–≤ –∑–∞–ø—Ä–æ—Å–∞)
    out3 - –Ω–µ —Å–∞–º—ã–π –æ—á–µ–≤–∏–¥–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –Ω–æ –±—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–º, –∫–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π —Ç–µ–∫—Å—Ç, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –Ω—É–∂–Ω–æ —Ä–∞—Å–∫–∏–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - –∫–∞–∫ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ out3a (–æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–ø—è—Ç—å –∂–µ –ø–µ—Ä–µ–¥–∞–µ–º —Å–ø–∏—Å–∫–æ–º, —Ö–æ—Ç—è –µ—Å—Ç—å –∏ –≤–∞—Ä–∏–∞–Ω—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö –∑–∞–ø–∏—Å—å—é)
    out4 - —Ç–µ–∫—Å—Ç –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å, –º–æ–∂–Ω–æ –∂–µ –∏ –∑–∞–ø–∏—Ö–Ω—É—Ç—å –æ–¥–∏–Ω –≤ –¥—Ä—É–≥–æ–π
    out5 - –ø—Ä–∏—á–µ–º –∑–∞–ø–∏—Ö–∏–≤–∞—Ç—å –º–æ–∂–Ω–æ –∏ —á–µ—Ä–µ–∑ –∑–∞–º–µ–Ω—É - –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –ø—Ä–æ—Å—Ç–æ –∑–∞–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –Ω—É–ª–µ–≤–æ–π –¥–ª–∏–Ω—ã - –∑–∞—á–µ–º —Ç–∞–∫? –¥–∞ –Ω–µ–∑–∞—á–µ–º - –ø—Ä–æ—Å—Ç–æ –Ω–µ –±—ã–≤–∞–µ—Ç –∫–∞–∫–æ–≥–æ-—Ç–æ –æ–¥–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –∏—Ö –≤—Å–µ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±–∏—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –¥–ª—è —Å–µ–±—è
    fnComb - –∏ —Ä–∞–∑ —É–∂ –º—ã –ø—Ä–æ —Ñ—É–Ω–∫—Ü–∏–∏ - –ª—é–±–æ–π —Ç–∞–∫–æ–π —à–∞–≥ –º–æ–∂–Ω–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—é, –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, –ø—Ä–æ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —à–∞–≥–æ–≤ –º–µ–Ω—è–µ–º –Ω–∞ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    out6 - –∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞–µ–º —Ç–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
    fnClojureComb - –Ω—É –∏ –∫—É–¥–∞ –∂ –±–µ–∑ –∑–∞–º—ã–∫–∞–Ω–∏–π - –º–∞–ª–æ –ª–∏ —Ç–µ–∫—Å—Ç –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è, –¥–∞ –∏ —Å–ø–∏—Å–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º
    out7 - –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–æ—Å–æ–±–æ –Ω–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Å—å - –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –±—ã–ª–∏ —Ç—É—Ç)

    –ö —á–µ–º—É —ç—Ç–æ –≤—Å—ë? –î–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –æ—á–µ–Ω—å –ø–æ-—Ä–∞–∑–Ω–æ–º—É, –∞ –∫–∞–∫–æ–π –ø—É—Ç—å –≤—ã–±—Ä–∞—Ç—å - —Ä–µ—à–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ.
    –ü–æ—ç—Ç–æ–º—É –≤ –ù–æ–≤–æ–º –ì–æ–¥—É –∂–µ–ª–∞—é –∫–∞–∂–¥–æ–º—É –Ω–∞–π—Ç–∏ —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é –∏ —É—Å–ø–µ—à–Ω–æ –µ–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å üòâ
    ]

[   (x,y)=>x[y] –∏–ª–∏ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø–æ–ª—è–º –≤ —Ñ—É–Ω–∫—Ü–∏–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.Column, Record.Field
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü—Ä–æ–¥–æ–ª–∂–∏–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –°–µ–≥–æ–¥–Ω—è –Ω–∞ –ø–æ–≤–µ—Å—Ç–∫–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –∏ –ø–æ–ª—è–º.
    –ù–∞—á–Ω—ë–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ:
    let
    lst = {1,2,3,4,5},
    f = (x,y)=>x{y},
    to = f(lst,2)
    in
    to
    –í–µ—Ä–Ω—ë—Ç –Ω–∞–º 3. –ó–¥–µ—Å—å –ª–æ–≥–∏–∫–∞, –¥—É–º–∞—é, –ø–æ–Ω—è—Ç–Ω–∞ ‚Äì –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç y-—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ x. –ù—É–º–µ—Ä–∞—Ü–∏—è —Å –Ω—É–ª—è, –ø–æ—ç—Ç–æ–º—É 2 –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç —Ç—Ä–µ—Ç–∏–π))). –ó–∞—á–µ–º —Ç–∞–∫–æ–µ –ø–∏—Ö–∞—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—é? –ù—É –Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–∏—Å–∞—Ç—å –≤–æ—Ç —Ç–∞–∫:
    f = (x,y)=>x{y-1},
    to = f(lst,3)
    —á—Ç–æ —Ç–∞–∫–∂–µ –≤–µ—Ä–Ω—ë—Ç –Ω–∞–º 3, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–æ—Ç —Ä–∞–∑ –º—ã —è–≤–Ω–æ –ø–æ–ø—Ä–æ—Å–∏–ª–∏ —Ç—Ä–µ—Ç–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏ –Ω–µ –¥—É–º–∞–ª–∏ –∫–∞–∫ —Ç–∞–º –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∏–¥–µ—Ç –Ω—É–º–µ—Ä–∞—Ü–∏—è. –¢–∞–∫ –±—ã–≤–∞–µ—Ç —É–¥–æ–±–Ω–æ.
    –ù–æ —á—Ç–æ –∂–µ —Å –ø–æ–ª—è–º–∏ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—ã?
    let
    rec = [a=1,b=2,c=3],
    tbl = Table.FromRecords({rec}),
    f = (x,y)=>x[y],
    to1 = f(rec,"b"),
    to2 = f(tbl,"b")
    in
    to2
    –£–ø—Å‚Ä¶
    to1 - ¬´–ø–æ–ª–µ y –∑–∞–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ¬ª.
    to2 ‚Äì ¬´—Å—Ç–æ–ª–±–µ—Ü y —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –Ω–∞–π–¥–µ–Ω¬ª
    –î–µ–ª–∞–µ–º –≤—ã–≤–æ–¥ ‚Äì —Ç–∞–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ö–æ—Ç—è –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ —è–∑—ã–∫ —è–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è x[y], –Ω–æ —Ç–∞–º –ø–æ–¥ y –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è, –∞ –Ω–µ –Ω–µ–∫–æ–µ –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ).
    –†–µ—à–µ–Ω–∏–µ –µ—Å—Ç—å ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏—á–µ–º –¥–ª—è –∑–∞–ø–∏—Å–µ–π –∏ —Ç–∞–±–ª–∏—Ü –æ–Ω–∏ —Ä–∞–∑–Ω—ã–µ ‚Äì Record.Field –∏ Table.Column —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ:
    let
    rec = [a=1,b=2,c=3],
    tbl = Table.FromRecords({rec}),
    f = (x,y)=>Record.Field(x,y),
    g = (x,y)=>Table.Column(x,y),
    to1 = f(rec,"b"),
    to2 = g(tbl,"b")
    in
    to2
    –ò —Ç–µ–ø–µ—Ä—å –≤—Å—ë –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
    –ó–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äì –∞ –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Ö–∏–≤–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø–æ–ª—è–º –≤ —Ñ—É–Ω–∫—Ü–∏–∏? –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã:
    let
    tbl = Table.FromRecords({ [n="–í–∞—Å—è",a=1,b=2,c=3,d=4],
    [n="–ê–Ω—Ç–æ–Ω",a=1,b=3,c=5,d=7],
    [n="–í–∞—Å—è",a=5,b=6,c=7,d=8],
    [n="–ê–Ω—Ç–æ–Ω",a=2,b=4,c=6,d=8]}),
    group = Table.Group(tbl, {"n"}, {{"—Å—É–º–º–∞ –ø–æ a", each List.Sum([a]), type number}})
    in
    group
    –¢–∞–∫ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, —Ä–∞–±–æ—Ç–∞–µ—Ç. –ù–æ —á—Ç–æ –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ —É –Ω–∞—Å –±—É–¥–µ—Ç –Ω–∞–π—Ç–∏ —Å—É–º–º—ã –ø–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º, –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ? –õ–∞–¥–Ω–æ –∫–æ–≥–¥–∞ –∏—Ö 4, –∞ –µ—Å–ª–∏ –ø–∞—Ä–∞ –¥–µ—Å—è—Ç–∫–æ–≤? –ê –µ—Å–ª–∏ –∏—Ö —Å–ø–∏—Å–æ–∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è?
    –î–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞—Ç–∏–º –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç—Ç—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é -
    {"—Å—É–º–º–∞ –ø–æ a", each List.Sum([a]), type number}
    - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑ —Ç—Ä—ë—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ {–Ω–∞–∑–≤–∞–Ω–∏–µ,—Ñ—É–Ω–∫—Ü–∏—è,—Ç–∏–ø} (—Ö–æ—Ç—è –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å —Ç–æ–ª—å–∫–æ –ø–∞—Ä–æ–π {–Ω–∞–∑–≤–∞–Ω–∏–µ,—Ñ—É–Ω–∫—Ü–∏—è})
    –î–∞–ª–µ–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–º–æ—Ç—Ä–∏–º –Ω–∞
    each List.Sum([a])
    , –≤—Å–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ —ç—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ (x)=>List.Sum(x[a]) (–∫–æ–º—É –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ - —á–∏—Ç–∞–µ–º —Ç—É—Ç )
    –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—Ä–∞–∑–∏—Ç—å, —á—Ç–æ –ø–æ–¥ x –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ (—Ç–∞ —Å–∞–º–∞—è, –∫–æ—Ç–æ—Ä—É—é –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≤—ã–±—Ä–∞–≤ –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ "–≤—Å–µ —Å—Ç—Ä–æ–∫–∏").
    –¢–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–º –ø—Ä–∏—ë–º–æ–º:
    let
    tbl = Table.FromRecords({ [n="–í–∞—Å—è",a=1,b=2,c=3,d=4],
    [n="–ê–Ω—Ç–æ–Ω",a=1,b=3,c=5,d=7],
    [n="–í–∞—Å—è",a=5,b=6,c=7,d=8],
    [n="–ê–Ω—Ç–æ–Ω",a=2,b=4,c=6,d=8]}),
    nms = Table.ColumnNames(tbl),
    lst = List.Transform(List.Skip(nms),(x)=>{"–°—É–º–º–∞ –ø–æ "&x,(y)=>List.Sum(Table.Column(y,x)),Int64.Type}),
    group = Table.Group(tbl, nms{0}, lst)
    in
    group

    nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –∏–º–µ–Ω–∞ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
    lst ‚Äì –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π - –¥–ª—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ (List.Skip), –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –∫–∞–∂–¥–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –≤ —Ç—Ä–æ–π–∫—É {–Ω–∞–∑–≤–∞–Ω–∏–µ,—Ñ—É–Ω–∫—Ü–∏—è,—Ç–∏–ø}. –ù–µ –∑–∞–ø—É—Ç–∞–π—Ç–µ—Å—å ‚Äì x ‚Äì —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞, –æ—Ç –Ω–µ–≥–æ –ø–∏—à–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, "–°—É–º–º–∞ –ø–æ "&x ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏; (y)=>List.Sum(Table.Column(y,x)) ‚Äì –≤–ª–æ–∂–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥—Ä—É–≥–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è y, –∑–∞–ø–∏—Å—å –æ–∑–Ω–∞—á–∞–µ—Ç ¬´–≤ —Ç–∞–±–ª–∏—Ü–µ y –≤–æ–∑—å–º–∏ —Å—Ç–æ–ª–±–µ—Ü x –∏ –Ω–∞–π–¥–∏ —Å—É–º–º—É –∑–Ω–∞—á–µ–Ω–∏–π¬ª
    group ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ –ø–µ—Ä–≤–æ–º—É —Å—Ç–æ–ª–±—Ü—É (nms{0}) –∏—Å–ø–æ–ª—å–∑—É—è —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π lst

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë (–µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ). –°—Ç–æ–ª–±—Ü—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞—á–∫–æ–π. –ò —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã—Ö –∏ –æ—á–µ–≤–∏–¥–Ω—ã—Ö –∑–∞–¥–∞—á, —Ä–µ—à–∞–µ–º—ã—Ö –ø–æ–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º.
    ]
    
[   –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø–æ–ª—è–º –≤ —Ñ—É–Ω–∫—Ü–∏–∏ (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ) / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π

    –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –≤–ª–µ–∑–ª–æ –≤ –æ–±—ä–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Å—Ç–∞:
    1. –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π record[[ ],[ ],[ ]] –∏ table[[ ],[ ],[ ]] –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Record.SelectFields –∏ Table.SelectColumns —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ
    2. –¥–ª—è –±–æ–ª—å—à–µ–π –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ —Ö–æ—Ä–æ—à–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–º—ã–∫–∞–Ω–∏—è (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –Ω–∏—Ö —Ç—É—Ç):
    let
        tbl = Table.FromRecords({   [n="–í–∞—Å—è",a=1,b=2,c=3,d=4],
                                    [n="–ê–Ω—Ç–æ–Ω",a=1,b=3,c=5,d=7],
                                    [n="–í–∞—Å—è",a=5,b=6,c=7,d=8],
                                    [n="–ê–Ω—Ç–æ–Ω",a=2,b=4,c=6,d=8]}),
        nms = Table.ColumnNames(tbl),
        f=(x)=>(y)=>List.Sum(Table.Column(y,x)),
        lst = List.Transform(List.Skip(nms),(x)=>{"–°—É–º–º–∞ –ø–æ "&x,f(x),Int64.Type}),
        to = Table.Group(tbl, nms{0}, lst)
    in
        to
    ]

[   List.Accumulate ‚Äì –∞ –Ω–∞–¥–æ –ª–∏? /  #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Accumulate
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ –ø—Ä–æ—Å—å–±–∞–º —Ç—Ä—É–¥—è—â–∏—Ö—Å—è —Ä–∞–∑–±–µ—Ä–µ–º —Ñ—É–Ω–∫—Ü–∏—é List.Accumulate. –ß–∏—Ç–∞–µ–º —Å–ø—Ä–∞–≤–∫—É:
    List.Accumulate(list as list, seed as any, accumulator as function)
    list ‚Äì –Ω–∞—à —Å–ø–∏—Å–æ–∫, seed - –æ–ø–æ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, accumulator ‚Äì —Ñ—É–Ω–∫—Ü–∏—è.
    accumulator ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö- (state,current)=> –≥–¥–µ state- —Ç–µ–∫—É—â–µ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —ç—Ç–æ seed), current ‚Äì —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞.
    –î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è? –í —Å–µ—Ç–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –¥–æ–∫–∞–∑—ã–≤–∞—é—â–∏—Ö ¬´—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å¬ª —Ñ—É–Ω–∫—Ü–∏–∏. –¢—É—Ç –≤–∞–º –∏ —Å—É–º–º–∞
    List.Accumulate({1..10},0,(s,c)=>s+c)
    –ò –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤
    List.Accumulate({1..10},{},(s,c)=>s&{‚ÄúColumn‚Äù&Text.From(c)})
    –ò –¥–∞–∂–µ —Ä–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
    List.Accumulate({1..9},Table.FromColumns({{1..9}},{"n"}),(s,c)=>Table.AddColumn(s,Text.From(c),(r)=>Record.Field(r,"n")*c))
    –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ —Å—É–º–º—É –≥–æ—Ä–∞–∑–¥–æ –ø—Ä–æ—â–µ –Ω–∞–π—Ç–∏ —á–µ—Ä–µ–∑ List.Sum, —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—â–µ (–∏ –±—ã—Å—Ç—Ä–µ–µ) –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ List.Transform. –≠—Ç–æ –∫ —Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—é List.Accumulate –ø—Ä–∏–º–æ—Ç–∞—Ç—å –º–æ–∂–Ω–æ –∫ –±–æ–ª—å—à–æ–º—É —á–∏—Å–ª—É –∑–∞–¥–∞—á, –Ω–æ —ç—Ç–æ –Ω–µ –±—É–¥–µ—Ç —Å–∞–º—ã–º –ø—Ä–æ—Å—Ç—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º —Ä–µ—à–µ–Ω–∏–µ–º. –ü–æ —Å–ª—É—á–∞—é –ø–æ—Ä—ã–ª—Å—è –≤ –∞—Ä—Ö–∏–≤–∞—Ö –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–∞—Ä—É –ø—Ä–∏–º–µ—Ä–æ–≤, –≥–¥–µ —Ä–µ–∞–ª—å–Ω–æ –≤ –ø–µ—Ä–≤–æ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –±–µ–∑ Accumulate –Ω–µ –æ–±–æ–π—Ç–∏—Å—å.
    let
        f=(x,y)=>[a=Text.Split(y,":"), b= Record.AddField(x,a{0},a{1})][b],
        g=(x)=>List.Accumulate(Text.Split(x,";"),[],f),

        from = {"–Ω–∞–∑–≤–∞–Ω–∏–µ:–∫–æ—Ä–æ–±–∫–∞;–≤—ã—Å–æ—Ç–∞:11;—à–∏—Ä–∏–Ω–∞:120;–¥–ª–∏–Ω–∞:54",
                "–Ω–∞–∑–≤–∞–Ω–∏–µ:–±–∞–∫;—à–∏—Ä–∏–Ω–∞:50;–≤—ã—Å–æ—Ç–∞:120",
                "–Ω–∞–∑–≤–∞–Ω–∏–µ:—è—â–∏–∫;–¥–ª–∏–Ω–∞:123;—à–∏—Ä–∏–Ω–∞:12"},
        tr = List.Transform(from,g),
        to = Table.FromRecords(tr,null,MissingField.UseNull)
    in
        to
    from ‚Äì –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–Ω–∞ –Ω–µ–∫–∞—è –≤—ã–≥—Ä—É–∑–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–∞—Ä—ã ¬´–ø–∞—Ä–∞–º–µ—Ç—Ä:–∑–Ω–∞—á–µ–Ω–∏–µ¬ª, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π ‚Äì –∞ –Ω–∞–¥–æ —Å–æ–±—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É
    tr ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å–ø–∏—Å–æ–∫ –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π (–Ω–∞–º –∂–µ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≥–¥–µ –ø–æ–ª–µ, –≥–¥–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
    to - –Ω—É –∏ —Å–æ–±–∏—Ä–∞–µ–º —Ç–∞–±–ª–∏—Ü—É (–≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç null ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π –Ω–∞–º –∑–∞—Ä–∞–Ω–µ–µ –Ω–µ –∏–∑–≤–µ—Å—Ç–µ–Ω, —Ç—Ä–µ—Ç–∏–π - MissingField.UseNull ‚Äì –µ—Å–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø–æ–ª—è –Ω–µ –±—É–¥–µ—Ç –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏ –≤—ã–¥–∞—Å—Ç null ‚Äì —É–¥–æ–±–Ω–æ, –±–µ—Ä–µ–º –Ω–∞ –∑–∞–º–µ—Ç–∫—É)
    –¢–µ–ø–µ—Ä—å –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º:
    g ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –æ–¥–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞; –µ—ë —Ä–∞–±–æ—Ç–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ ¬´;¬ª –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ –∑–∞–ø–∏—Å—å, –ø–æ—ç—Ç–æ–º—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ seed ‚Äì [ ] (–ø—É—Å—Ç–∞—è –∑–∞–ø–∏—Å—å), –∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä ‚Äì f
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (—ç—Ç–æ —Ç–µ –∂–µ state –∏ current ‚Äì –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã x –∏ y –¥–∞–±—ã –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è!) ‚Äì –∑–¥–µ—Å—å –≤—Å—ë –ø—Ä–æ—Å—Ç–æ: a ‚Äì –ø–æ–¥–µ–ª–∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ ¬´:¬ª, b ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º –∫ –∑–∞–ø–∏—Å–∏ –Ω–æ–≤–æ–µ –ø–æ–ª–µ (–º–æ–∂–Ω–æ –±—ã–ª–æ –∏ —á–µ—Ä–µ–∑ let, –Ω–æ —è —Ç–∞–∫ –Ω–µ –ª—é–±–ª—é, –æ–±—ä—è—Å–Ω—è–ª —Ç—É—Ç)
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞. –ú–Ω–µ –ø—Ä–æ—â–µ –±—ã–ª–æ —á–µ—Ä–µ–∑ Accumulate, –µ—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ç–æ—á–∫–∞ –∑—Ä–µ–Ω–∏—è ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∫—É—Ä—Å–∏—é (Poohkrd –æ—Ü–µ–Ω–∏, —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ –¥–ª—è —Ç–µ–±—è):
    let
    f=(x,y)=>[a=Text.Split(y,":"), b= Record.AddField(x,a{0},a{1})][b],
    g=(x,y)=>if Text.Contains(y,";") then @g(f(x,Text.BeforeDelimiter(y,";")),Text.AfterDelimiter(y,";")) else f(x,y),

        from = {"–Ω–∞–∑–≤–∞–Ω–∏–µ:–∫–æ—Ä–æ–±–∫–∞;–≤—ã—Å–æ—Ç–∞:11;—à–∏—Ä–∏–Ω–∞:120;–¥–ª–∏–Ω–∞:54",
                "–Ω–∞–∑–≤–∞–Ω–∏–µ:–±–∞–∫;—à–∏—Ä–∏–Ω–∞:50;–≤—ã—Å–æ—Ç–∞:120",
                "–Ω–∞–∑–≤–∞–Ω–∏–µ:—è—â–∏–∫;–¥–ª–∏–Ω–∞:123;—à–∏—Ä–∏–Ω–∞:12;–≤—ã—Å–æ—Ç–∞:1"},
        tr = List.Transform(from,(x)=>g([],x)),
        to = Table.FromRecords(tr,null,MissingField.UseNull)
    in
        to
    –°–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–º—É –∫–∞–∫ —É–¥–æ–±–Ω–µ–µ, –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ. –ü—Ä–æ—Å—Ç–æ –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ —Ä–µ–∫—É—Ä—Å–∏—è ‚Äì —ç—Ç–æ –Ω–µ –±—ã—Å—Ç—Ä–æ, Accumulate –≤—ã–∏–≥—Ä—ã—à–∞ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–µ –¥–∞—Å—Ç, –∞ –∑–Ω–∞—á–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–∏—ë–º —Å—Ç–æ–∏—Ç —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ—Ç –ø—Ä—è–º–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å —Ç–µ—Ä–Ω–∏—Å—Ç –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è.
    ]
    
[   –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Accumulate
    –ü—ã.–°—ã. (–æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç)
    —Ç–∞–º –∂–µ –≤ –∞—Ä—Ö–∏–≤–∞—Ö –Ω–∞—à–ª–∞—Å—å –¥—Ä—É–≥–∞—è, –≤–µ—Å—å–º–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∫–∞, —Ç–∞–∫–∂–µ –≤–µ—Å—å–º–∞ –ø—Ä–æ—Å—Ç–æ —Ä–µ—à–∞–µ–º–∞—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–æ–º, –Ω–æ –Ω–∞ –º–æ–π –≤–∫—É—Å —ç—Ç–æ —Å–∫–æ—Ä–µ–µ —É—á–µ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä ‚Äì –Ω–µ –Ω–∞–¥–æ —Ç–∞–∫ –¥–∞–Ω–Ω—ã–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å:
    let
        from = Table.FromRecords({
                                [n="–í–∞—Å—è",#"a.1"=1,#"b.1"=2,#"c.1"=3,#"a.2"=4,#"b.2"=5,#"c.2"=6,#"a.3"=7,#"b.3"=8,#"c.3"=9],
                                [n="–ü–µ—Ç—è",#"a.1"=1,#"b.1"=3,#"c.1"=5,#"a.2"=7,#"b.2"=9,#"c.2"=11,#"a.3"=13,#"b.3"=15,#"c.3"=17],
                                [n="–ö–æ–ª—è",#"a.1"=2,#"b.1"=4,#"c.1"=6,#"a.2"=8,#"b.2"=10,#"c.2"=12,#"a.3"=14,#"b.3"=16,#"c.3"=18]}),
        lst = Table.ColumnNames(from),
        nms = List.Distinct(List.Transform(List.Skip(lst),(x)=>Text.BeforeDelimiter(x,"."))),
        cmb = List.Zip({nms,List.Transform(nms, (x)=>List.Select(lst,(y)=>Text.Contains(y,x)))}),
        tbl = Table.TransformColumnTypes(from,List.Transform(List.Skip(lst),(x)=>{x,Text.Type})),
        to = List.Accumulate(cmb,tbl,(s,c)=>Table.CombineColumns(s,c{1},(x)=>Text.Combine(x," "),c{0}))
    in
        to
    ]

[   List.Accumulate WITH recursion ‚Äì –∞ —á—Ç–æ, —Ç–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Accumulate
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ß—Ç–æ–±—ã –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –≤–æ–ø—Ä–æ—Å —Å –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–æ–º –∏ —Ä–µ–∫—É—Ä—Å–∏–µ–π (–Ω–∞—á–∞–ª–∏ —Ç—É—Ç) –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ—â—ë –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä. –ò—Ç–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Å–∞–π—Ç–∞, –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –Ω–µ–∫–∏–π —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –∞ –≤–∞–º –Ω—É–∂–Ω—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ. –ù—É –û–ö ‚Äì —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–π –∫–æ–¥:
    let
        lst = {1,2,3,1,2,3,1,2,3},
        to = List.Distinct(lst)
    in
        to
    –ù–æ –µ—Å–ª–∏ –± –≤—Å—ë –±—ã–ª–æ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –Ω–µ –±—ã–ª–æ –±—ã —Å—Ç–∞—Ç—å–∏. –î–∞–ª–µ–∫–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∏–¥—É—Ç –ø–æ –æ–¥–Ω–æ–º—É:
    let
        lst = {1,2,3,{1,4,5},2,{3,6,7},1,2,3},
        acc = List.Accumulate(lst,{},(s,c)=> s & (if Value.Is(c,List.Type) then c else {c})),
        to = List.Distinct(acc)
    in
        to
    –ó–¥–µ—Å—å –Ω–∞ —à–∞–≥–µ acc –º—ã —Ä–µ–∞–ª–∏–∑—É–µ–º —Å–ª–µ–¥—É—é—â—É—é –ª–æ–≥–∏–∫—É: ¬´–µ—Å–ª–∏ –æ—á–µ—Ä–µ–¥–Ω–æ–π —ç–ª–µ–º–µ–Ω—Ç ‚Äì —Å–ø–∏—Å–æ–∫, —Å–¥–µ–ª–∞–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é —Å–ø–∏—Å–∫–æ–≤ s & c, –∏–Ω–∞—á–µ –¥–æ–±–∞–≤—å –∫ —Å–ø–∏—Å–∫—É —ç–ª–µ–º–µ–Ω—Ç s &{c}¬ª. –¢–æ–∂–µ –≤—Ä–æ–¥–µ –ø—Ä–æ—Å—Ç–æ. –ù–µ–º–Ω–æ–≥–æ —É—Å–ª–æ–∂–Ω—é –∫–æ–¥:
    let
        lst = {1,2,3,{1,4,5},2,{3,6,7},1,2,3},
        f=(x)=>List.Accumulate(x,{},(s,c)=> s & (if c is list then c else {c})),
        to = List.Distinct(f(lst))
    in
        to
    –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —à–∞–≥ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–µ–≤—Ä–∞—â—ë–Ω –≤ —Ñ—É–Ω–∫—Ü–∏—é (–∑–∞–æ–¥–Ω–æ if then –∑–∞–ø–∏—Å–∞–Ω –Ω–µ–º–Ω–æ–∂–∫–æ –ø–æ-–¥—Ä—É–≥–æ–º—É - –º–æ–∂–µ—Ç —Ç–∞–∫ –∫–æ–º—É –ø–æ–Ω—è—Ç–Ω–µ–µ –∏–ª–∏ —É–¥–æ–±–Ω–µ–µ –±—É–¥–µ—Ç), –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ. –ù–æ –∑–∞—á–µ–º —ç—Ç–æ –Ω–∞–¥–æ? –ê –≤–æ—Ç –∑–∞—á–µ–º ‚Äì –∫—Ç–æ —Å–∫–∞–∑–∞–ª, —á—Ç–æ –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ —Å–ø–∏—Å–∫–∏, –∞ –Ω–µ —Å–ø–∏—Å–∫–∏ —Å–ø–∏—Å–∫–æ–≤ –∏–ª–∏ —Å–ø–∏—Å–∫–∏ —Å–ø–∏—Å–∫–æ–≤ —Å–ø–∏—Å–∫–æ–≤‚Ä¶ (—á—É–≤—Å—Ç–≤—É–µ—Ç–µ –∫–∞–∫ —Ä–µ–∫—É—Ä—Å–∏–µ–π –∑–∞–ø–∞—Ö–ª–æ)?
    let
        lst = {1,2,3,{1,4,{5,8}},2,{3,{6,9},7},1,2,3},
        f=(x)=>List.Accumulate(x,{},(s,c)=> s & (if c is list then @f(c) else {c})),
        to = List.Distinct(f(lst))
    in
        to
    –ê –≤–æ—Ç —ç—Ç–æ —É–∂–µ –≥–µ–º–æ—Ä. –ò –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —á–∏—Å–ª–∞ —É—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏, –º—ã —Ä–µ—à–∞–µ–º –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á–∫—É —Å –ø–æ–º–æ—â—å—é @f(), —Ç.–µ. —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –Ω–∞—à–µ–≥–æ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞. –ù–∞ –º–æ–π –≤–∫—É—Å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ.
    ]
    
[   Table.FromList vs Table.AddColumn ‚Äì –∫—Ç–æ –∫–æ–≥–æ? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.FromList, Table.AddColumn

    –û–¥–∏–Ω –∏–∑–≤–µ—Å—Ç–Ω—ã–π –≤–∞–º –º–µ–¥–≤–µ–¥—å –æ—Ç–ø—Ä–∞–≤–∏–ª –º–µ–Ω—è —á–∏—Ç–∞—Ç—å —Ç–∞–∫–∏—Ö –∂–µ —É–ø–æ—Ä–æ—Ç—ã—Ö, –∫–∞–∫ –∏ —è. –ù—É –∏ –ø–æ–¥—Å–º–æ—Ç—Ä–µ–ª –∏–¥–µ–π–∫—É. –ò—Ç–∞–∫, –Ω–∞ –≤—Ö–æ–¥–µ –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —á–∏—Å–ª–æ–≤—ã–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏ –∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ ‚Äì —Å—É–º–º—É, —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω—É. –î–µ–ª–æ–≤-—Ç–æ:
       
        let
            from =  Table.FromRecords({
                        [n="–í–∞—Å—è",jan=1,feb=2,mar=3,apr=4,may=5,jun=6],
                        [n="–ö–æ–ª—è",jan=1,feb=3,mar=5,apr=7,may=9,jun=9],
                        [n="–ü–µ—Ç—è",jan=2,feb=4,mar=6,apr=8,may=8,jun=6]
                    }),
            tbl  = Table.Buffer(Table.Repeat(from,99999)),
            add1 = Table.AddColumn(tbl,"—Å—É–º–º–∞",(r)=>List.Sum(List.Skip(Record.ToList(r)))),
            add2 = Table.AddColumn(tbl,"—Å—Ä–µ–¥–Ω–µ–µ",(r)=>List.Average(List.Range(Record.ToList(r),1,6))),  
            to   = Table.AddColumn(tbl,"–º–µ–¥–∏–∞–Ω–∞",(r)=>List.Median(List.Range(Record.ToList(r),1,6)))
        in
            to
    
    –ß—Ç–æ —Å–º—É—â–∞–µ—Ç –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –∫–æ–¥–µ ‚Äì –æ–±–∏–ª–∏–µ —à–∞–≥–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –≤—ã—á–∏—Å–ª—è—Ç—å —Ç—Ä–µ–±—É–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞, –Ω—É –∏ Table.Buffer - –µ—Å–ª–∏ –∑–∞–±—É–¥–µ—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å, –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –∫—Ä–∞–π–Ω–µ –¥–æ–ª–≥–æ, –∞ —Ç–∞–∫ –Ω–∞ –º–æ–µ–π –º–∞—à–∏–Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å 13 —Å–µ–∫—É–Ω–¥. –ú—ã—Å–ª—å —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Å—Ä–∞–∑—É –≤—Å–µ—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º Table.ExpandRecordColumn –æ—Ç–º–µ—Ç–∞–π—Ç–µ - —ç—Ç–æ –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö ‚Äì –ø–æ–ª—É—á–∏–ª–æ—Å—å –≤–æ–æ–±—â–µ 17 —Å–µ–∫—É–Ω–¥.
    –ù–æ —á—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å? –ß—É–π–∫–∞ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ —Ä–∞–±–æ—Ç–∞ —à—É—Å—Ç—Ä–µ–µ, —á–µ–º –Ω–∞ –∑–∞–ø–∏—Å—è—Ö. –ß—Ç–æ –∂, –ø—Ä–æ–±—É–µ–º:
       
        let
            f=(x)=>x &
                [a = List.Skip(x),
                 b = {List.Sum(a), List.Average(a), List.Median(a)}
                ][b],
            
            from =  Table.FromRecords({
                        [n="–í–∞—Å—è",jan=1,feb=2,mar=3,apr=4,may=5,jun=6],
                        [n="–ö–æ–ª—è",jan=1,feb=3,mar=5,apr=7,may=9,jun=9],
                        [n="–ü–µ—Ç—è",jan=2,feb=4,mar=6,apr=8,may=8,jun=6]
                    }),

            tbl = Table.Repeat(from,99999),
            lst = Table.ToRows(tbl),
            tr  = List.Transform(lst,f),
            nms = Table.ColumnNames(from) & {"—Å—É–º–º–∞","—Å—Ä–µ–¥–Ω–µ–µ","–º–µ–¥–∏–∞–Ω–∞"},
            to  = Table.FromRows(tr,nms)
        in
            to

    –í—Ä–æ–¥–µ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ–ø–ª–æ—Ö–æ: 
        lst ‚Äì —Ä–∞–∑–±–∏–ª–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∏, 
        tr  ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ —Å—Ç—Ä–æ–∫–∏ —Å–ø–∏—Å–∫–æ–º, 
        f   - —Ñ—É–Ω–∫—Ü–∏—è, –¥–æ–±–∞–≤–ª—è—é—â–∞—è –∫ —Å–ø–∏—Å–∫—É –µ–≥–æ —Å—É–º–º—É, —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω—É, 
        nms ‚Äì —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã, 
        to  - —Å–æ–±—Ä–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É –∏–∑ —Å—Ç—Ä–æ–∫. 
    
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –±—É—Ñ–µ—Ä–∏—Ç—å –Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å, –ù–û —Å–∫–æ—Ä–æ—Å—Ç—å —Ç–∞ –∂–µ - 13 —Å–µ–∫—É–Ω–¥. –ú–¥—è. 
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, —Å —ç—Ç–æ–π –º—ã—Å–ª—å—é —è –∏ –∂–∏–ª –¥–æ –≤—á–µ—Ä–∞. –ù–æ —Ç—É—Ç –Ω–∞–ø–æ–º–Ω–∏–ª–∏, —á—Ç–æ –≤ Table.FromList –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ Splitter:

        let
            f=(x)=>x&[a=List.Skip(x),b={List.Sum(a),List.Average(a),List.Median(a)}][b],
            
            from = Table.FromRecords({[n="–í–∞—Å—è",jan=1,feb=2,mar=3,apr=4,may=5,jun=6],
                                      [n="–ö–æ–ª—è",jan=1,feb=3,mar=5,apr=7,may=9,jun=9],
                                      [n="–ü–µ—Ç—è",jan=2,feb=4,mar=6,apr=8,may=8,jun=6]}),
            tbl = Table.Repeat(from,99999),
            lst = Table.ToRows(tbl),
            nms = Table.ColumnNames(from) & {"—Å—É–º–º–∞","—Å—Ä–µ–¥–Ω–µ–µ","–º–µ–¥–∏–∞–Ω–∞"},
            to  = Table.FromList(lst,f,nms)
        in
            to

    –ß—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å? –î–∞ –ø–æ—á—Ç–∏ –Ω–∏—á–µ–≥–æ ‚Äì –ø—Ä–æ—Å—Ç–æ –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö —à–∞–≥–æ–≤ (tr –∏ to) –æ—Å—Ç–∞–ª—Å—è –æ–¥–∏–Ω; —Ñ—É–Ω–∫—Ü–∏—è f —Ç–∞ –∂–µ, —Ç–æ–ª—å–∫–æ —Å–∫–æ—Ä–æ—Å—Ç—å ‚Äì 10 —Å–µ–∫—É–Ω–¥! - 25% –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –ø—É—Å—Ç–æ–º –º–µ—Å—Ç–µ. –í–æ—Ç —Ç–∞–∫, –º–∏—Ä –Ω–µ —Ä—É—Ö–Ω—É–ª ‚Äì –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö –≤—Å—ë-—Ç–∞–∫–∏ –±—ã—Å—Ç—Ä–µ–µ üòâ
    ]

[   Splitter.SplitTextByPositions –∏–ª–∏ –ø–ª–∞—á –ø–æ —Ä–µ–≥—É–ª—è—Ä–∫–∞–º / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Splitter.SplitTextByPositions
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –†–∞–∑–±–µ—Ä–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π —Å–∞–±–∂ –ø–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é —Ç–µ–∫—Å—Ç–∞. –ò–º–µ–µ–º:
    let
        from = Table.FromRecords({
            [name = "–í–∞—Å—è",txt = "1. –¢–µ–∫—Å—Ç 1-1. –¢–µ–∫—Å—Ç —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ 1-2. —Ç–µ–∫—Å—Ç —Å —á–∏—Å–ª–∞–º–∏ 123 2. –µ—â—ë —Ç–µ–∫—Å—Ç"],
            [name = "–ö–æ–ª—è", txt = "3. —Ç–µ–∫—Å—Ç. 4. –∞ —Ç–µ–∫—Å—Ç-—Ç–æ –±—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–π 5. –Ω–∞–ø—Ä–∏–º–µ—Ä —Å —á–∏—Å–ª–∞–º–∏ 2.5"],
            [name = "–ï–≤–ª–∞–º–ø–∏–π", txt ="12. –∏ –Ω–æ–º–µ—Ä–æ–≤ –º–Ω–æ–≥–æ 123. –æ—á–µ–Ω—å –º–Ω–æ–≥–æ 1234. –ø—Ä—è–º —Å–æ–≤—Å–µ–º"]
        }),
        tr = Table.TransformColumns(from,{"txt",SplitByAnyChars({"0".."9","-"},{"."})}),
        to = Table.ExpandListColumn(tr, "txt")
    in
        to
    –¢–µ–∫—Å—Ç –≤ —Ç–∞–±–ª–∏—á–∫–µ –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –ø—É–Ω–∫—Ç—ã, –ø—Ä–∏—á–µ–º: —Å–∞–º–∏ –Ω–æ–º–µ—Ä–∞ –ø—É–Ω–∫—Ç–æ–≤ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å; –Ω–æ–º–µ—Ä –ø—É–Ω–∫—Ç–∞ ‚Äì —ç—Ç–æ –Ω–∞–±–æ—Ä —Ü–∏—Ñ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã (–≤–æ–∑–º–æ–∂–Ω—ã –ø–æ–¥–ø—É–Ω–∫—Ç—ã —á–µ—Ä–µ–∑ –¥–µ—Ñ–∏—Å) –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–æ—á–∫–∞ –≤ –∫–æ–Ω—Ü–µ; –≤ —Ç–µ–∫—Å—Ç–µ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –∏ —Ü–∏—Ñ—Ä—ã, –∏ –¥–µ—Ñ–∏—Å—ã, –∏ —Ç–æ—á–∫–∏.
    –ú–¥—è, –∑–∞–¥–∞—á–∫–∞ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã—Ö –≤ M —Ç–æ–ª–∫–æ–º –∏ –Ω–µ –∑–∞–≤–µ–∑–ª–∏. –ù–æ –∫–∞–∫ –≤–∏–¥–∏–º –ø—Ä–æ–±–ª–µ–º–∞ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ —Ä–µ—à–∞–µ—Ç—Å—è –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ SplitByAnyChars, —Ç–æ–ª—å–∫–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ ‚Äì —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ—Ç –∏ –µ—ë –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å )))
    –ù–µ –ø—Ä–µ—Ç–µ–Ω–¥—É—é –Ω–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –¥—É–º–∞—é, —á—Ç–æ –ª–æ–≥–∏–∫–∞ —Ä–µ—à–µ–Ω–∏—è –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –Ω–µ–±–µ–∑—ã–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π. –ü–æ–µ—Ö–∞–ª–∏:
    SplitByAnyChars = (chars as list, last as list)=>(txt as text)=>
    let
        lst = Text.ToList(txt),
        tbl = Table.FromList(lst,
                            (x)=>[ a = List.Contains(chars,x),b = List.Contains(last,x),c = a or b,d = {a,b,c}][d],
                            {"chars","last","all"}),
        index = Table.AddIndexColumn(tbl, "i", 0, 1),
        group = Table.Group(index, "all", {{"n", each List.Min([i])},
                                            {"l", each List.Last([last])},
                                            {"c", each List.First([chars])}},
                                            GroupKind.Local),
        filtr = Table.SelectRows(group, each ([l] = true) and ([c] = true)),
        to = Splitter.SplitTextByPositions(filtr[n])(txt)
    in
        to
    –í–æ-–ø–µ—Ä–≤—ã—Ö, –∞—Ä–≥—É–º–µ–Ω—Ç—ã ‚Äì chars ‚Äì —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ, last ‚Äì —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, txt ‚Äì —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–π —Ç–µ–∫—Å—Ç (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã ‚Äì —Ç–∞–∫ –ø—Ä–æ—â–µ –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∏ –Ω–µ –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≥–æ—Ä–æ–¥–∏—Ç—å (x)=>Split‚Ä¶ –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–º—ã–∫–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–æ —Ç—É—Ç).
    lst ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –Ω–∞—à —Ç–µ–∫—Å—Ç –≤ —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤
    tbl ‚Äì –ø–µ—Ä–≤–∞—è –∏–∑—é–º–∏–Ω–∫–∞ —Ä–µ—à–µ–Ω–∏—è ‚Äì –≤–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∏–∑ —Ç—Ä–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤: ¬´chars¬ª - –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ —Å–∏–º–≤–æ–ª –∫ —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ; ¬´last¬ª-–æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ –∫ –∫–æ–Ω–µ—á–Ω—ã–º; ¬´all¬ª - –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ –∫ –æ–¥–Ω–æ–π –∏–∑ —ç—Ç–∏—Ö –¥–≤—É—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    index ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π —Å –Ω—É–ª—è, –∫–∞–∫ –≤ —Å–ø–∏—Å–∫–∞—Ö
    group ‚Äì –≤—Ç–æ—Ä–∞—è –∏–∑—é–º–∏–Ω–∫–∞ ‚Äì —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞–º –±—ã–ª–∞ –Ω—É–∂–Ω–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ —Å—Ç–æ–ª–±—Ü—É ¬´all¬ª, –ø—Ä–∏—á–µ–º —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º GroupKind.Local ‚Äì –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∏ –∫–∞–∂–¥–∞—è –≥—Ä—É–ø–ø–∞ —Å–∏–º–≤–æ–ª–æ–≤, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏—Ö —É—Å–ª–æ–≤–∏—é, –ø–æ–ª—É—á–∏—Ç —Å–≤–æ—é —Å—Ç—Ä–æ–∫—É. –ü—Ä–∏ —ç—Ç–æ–º –º—ã –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±—Ü—ã: n ‚Äì –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å, —Ç.–µ. —Å –∫–∞–∫–æ–π –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≥—Ä—É–ø–ø–∞; l ‚Äì –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–º–≤–æ–ª –≤ –≥—Ä—É–ø–ø–µ –∫ —Ç–µ–º, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å; —Å ‚Äì –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ª–∏ –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª –≤ –≥—Ä—É–ø–ø–µ –∫ —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ç–µ–ª–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è.
    filtr ‚Äì —Ç–µ–ø–µ—Ä—å –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ —Å—Ç—Ä–æ–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
    to ‚Äì –Ω—É –∏ –≤–∏—à–µ–Ω–∫–∞ ‚Äì –≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –≤ –∏–Ω–¥–µ–∫—Å–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è —Ä–æ–≤–Ω–æ —Ç–µ –ø–æ–∑–∏—Ü–∏–∏, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç. –ü–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞–µ–º –≤ Splitter.SplitTextByPositions ‚Äì –¥—É–º–∞—é –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –í–æ—Ç —Ç–æ–ª—å–∫–æ —É —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞ –Ω–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –æ—Ç–≤–µ—á–∞—é—â–µ–≥–æ –∑–∞ —Å–∞–º —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–π —Ç–µ–∫—Å—Ç, —è –¥–∞–∂–µ –æ—Ç –∫–æ–≥–æ-—Ç–æ —Å–ª—ã—à–∞–ª, —á—Ç–æ –µ–≥–æ –≤–æ–æ–±—â–µ –Ω–∞–¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Å–æ—Å—Ç–∞–≤–µ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π‚Ä¶ –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –º—ã –∂–µ –∑–Ω–∞–µ–º –ø—Ä–æ –∑–∞–º—ã–∫–∞–Ω–∏—è ‚Äì –±–µ—Ä–µ–º –∏ –Ω–∞—Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–∫—Å—Ç –≤–æ –≤—Ç–æ—Ä—ã—Ö —Å–∫–æ–±–∫–∞—Ö‚Ä¶ –∏ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!
    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –°–∫–æ—Ä–æ—Å—Ç—å –Ω–µ –∑–∞–æ–±–ª–∞—á–Ω–∞—è, –Ω–æ –≤–ø–æ–ª–Ω–µ —Ç–µ—Ä–ø–∏–º–∞—è.
    –ù–∞–¥–µ—é—Å—å, –±—ã–ª–æ –ø–æ–ª–µ–∑–Ω–æ.
    ]    

[   –ó–∞–ø—Ä–æ—Å –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–≥–∏?
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ—Ç—è–Ω—É–ª–æ –ø–æ—Ñ–∏–ª–æ—Å–æ—Ñ—Å—Ç–≤–æ–≤–∞—Ç—å. –ò—Ç–∞–∫, –≤–æ–∑—å–º–µ–º –∑–∞–ø—Ä–æ—Å
    let
        lst = {1..12},
        trnsf = List.Transform(lst,(x)=>Date.ToText(#date(2022,x,1),"MMMM yyyy")),
        to = Text.Combine(trnsf,"#(lf)")
    in
        to
    –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–∏—Å–∞—Ç—å –∫–∞–∫ –≤—ã—à–µ, –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –¥–≤–∞ —Ä–∞–∑–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥:
    let
        lst = {1..12},
        trnsf = List.Transform(lst,(x)=>Date.ToText(#date(2022,x,1),"MMMM yyyy"))
    in
        Text.Combine(trnsf,"#(lf)")
    –†–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—á–∏—Ç–∞—é—Ç, —á—Ç–æ —Ç–∞–∫ –¥–∞–∂–µ –Ω–∞–≥–ª—è–¥–Ω–µ–µ (–∞–≤—Ç–æ—Ä –Ω–µ —Ä–∞–∑–¥–µ–ª—è–µ—Ç –¥–∞–Ω–Ω—É—é —Ç–æ—á–∫—É –∑—Ä–µ–Ω–∏—è). –í —Ü–µ–ª–æ–º –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å (—É–ø—Ä–æ—â—ë–Ω–Ω–æ), —á—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∫—É—Å–∫–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–º –¥–∞–ª–∏ –∏–º—è, –∏ –∫–æ–≥–¥–∞ –≤—ã —Å—Å—ã–ª–∞–µ—Ç–µ—Å—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —à–∞–≥ ‚Äì –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ —ç—Ç–æ—Ç –∫—É—Å–æ–∫ –∫–æ–¥–∞ –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –º—ã –Ω–∞–ø–∏—à–µ–º –ø—Ä–æ—Å—Ç–æ:
    Text.Combine(List.Transform({1..12},(x)=>Date.ToText(#date(2022,x,1),"MMMM yyyy")),"#(lf)")

    —ç—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –≤–µ—Å—å –∑–∞–ø—Ä–æ—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–¥–Ω–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –¥–µ–ª–∏—Ç—å –Ω–∞ —à–∞–≥–∏ –∏ –ø–∏—Å–∞—Ç—å –≤–æ—Ç —Ç–∞–∫ –≤ –æ–¥–Ω—É (–Ω–æ –æ—á–µ–Ω—å –±–æ–ª—å—à—É—é –∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ—á–∏—Ç–∞–µ–º—É—é) —Å—Ç—Ä–æ–∫—É (—Ç.–µ. –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PQ –∫–∞–∫ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä ‚Äì –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ 8*(127-13) –∏ –æ–Ω –≤–∞–º –≤—ã–¥–∞—Å—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç).
    –ù–æ –≤–µ–¥—å –º–æ–∂–Ω–æ –∑–∞–¥—É–º–∞—Ç—å—Å—è –∏ –æ–± –æ–±—Ä–∞—Ç–Ω–æ–º ‚Äì –º—ã –¥–ª—è —Ç–æ–≥–æ –∏ –¥–µ–ª–∏–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —à–∞–≥–∏, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –µ–≥–æ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, –∞ –∑–Ω–∞—á–∏—Ç –≤–º–µ—Å—Ç–æ –≤–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è –∫—É—á–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥—Ä—É–≥ –≤ –¥—Ä—É–≥–∞, –º–æ–∂–Ω–æ –ø–æ–¥–µ–ª–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —à–∞–≥–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –∏–ª–∏ —Å–ª–æ–∂–Ω—ã–π –∏ —Ç—Ä–µ–±—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π let in ‚Äì –≤—ã–Ω–æ—Å–∏–º –µ–≥–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º, –ø–æ—Ç–æ–º –≤—ã–∑—ã–≤–∞–µ–º –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
    –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–¥ –≤—ã—à–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–∞–∫:
    let
        lst = {1..12},
        f=(x)=> Date.ToText(#date(2022,x,1),"MMMM yyyy"),
        trnsf = List.Transform(lst,f),
        to = Text.Combine(trnsf,"#(lf)")
    in
        to
    –ø–æ–ª—É—á–∏–ª–æ—Å—å ‚Äì f ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–∞ –º–µ—Å—è—Ü–∞ –≤ –¥–∞—Ç—É —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∞ –Ω–∞ —à–∞–≥–µ trnsf ‚Äì –º—ã —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø–∏—Å–∫–∞. –ü–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã, –Ω–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ –º–æ–π –≤–∫—É—Å –ª—É—á—à–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –º—ã –≥–æ–≤–æ—Ä–∏–º –ø—Ä–æ —Å–ª–æ–∂–Ω—ã–µ –±–æ–µ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã:
    let
        from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
        group = Table.Group(from, "a", {{"sum b", each List.Sum(List.FirstN(List.Sort([b],Order.Descending),3))},{"sum c",each List.Sum(List.FirstN(List.Sort([c],Order.Descending),3))}})
    in
        group
    —Ö–æ—Ä–æ—à–æ, –µ—Å–ª–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–≤–∞, –∞ –∫–æ–≥–¥–∞ –±–æ–ª—å—à–µ? –ê —Ç–∞–∫ –º—ã –≤—ã–Ω–æ—Å–∏–º —Ñ—É–Ω–∫—Ü–∏—é –∏ –ø–æ–ª—É—á–∞–µ–º —Å—á–∞—Å—Ç—å–µ:
    let
        from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
        f=(y,z)=>(x)=>[ a = Table.Column(x,y),
                        b = List.Sort(a,Order.Descending),
                        c = List.FirstN(b,z),
                        d = List.Sum(c)][d],
        group = Table.Group(from, "a", {{"sum b", f("b",3)},{"sum c",f("c",3)}})
    in
        group
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –Ω–∞ —à–∞–≥–µ f –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–∞–º—ã–∫–∞–Ω–∏–µ ‚Äì –º—ã –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ –∏ —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –ø—Ä–æ—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å ‚Äì –º–∞–ª–æ –ª–∏ —á—Ç–æ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è; —Ä–∞—Å–ø–∏—Å–∞–ª–∏ –ø–æ —à–∞–≥–∞–º ‚Äì —Ç–∞–∫ –Ω–∞–≥–ª—è–¥–Ω–µ–µ, –Ω–æ —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å ‚Äì –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞ –≤—ã –±—ã –≤—Ä—è–¥ –ª–∏ —Å—Ç–∞–ª–∏ —ç—Ç–æ –¥–µ–ª–∞—Ç—å. –°–∞–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Å–∏ –æ–±—Å—É–∂–¥–∞–ª—Å—è —Ç—É—Ç, –∞ –∫–∞–∫ –µ—â—ë —Å–∏–ª—å–Ω–µ–µ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å/—É–ø—Ä–æ—Å—Ç–∏—Ç—å –∫–æ–¥ ‚Äì –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å –∑–¥–µ—Å—å.
    –í —Ü–µ–ª–æ–º —ç—Ç–∏–º –ø–æ—Å—Ç–æ–º —è —Ö–æ—Ç–µ–ª —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π ‚Äì —ç—Ç–æ –Ω–µ –∫–∞–∫–∞—è-—Ç–æ –∑–∞–ø—Ä–µ–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–Ω–µ—Å–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —à–∞–≥–æ–≤ –≤ —à–∞–≥ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º –¥–ª—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –∏ —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ.
    ]
    
[   Table.Group ‚Äì –ß–∞—Å—Ç—å 1. –¢—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ –∑–∞–ø—Ä–æ—Å–∞–º —Å—Ç—Ä–∞–∂–¥—É—â–∏—Ö –Ω–µ–º–Ω–æ–∂–∫–æ –æ–ø–∏—à—É —Ä–∞–±–æ—Ç—É —Å —ç—Ç–æ–π –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π.–ù–∞—á–Ω—ë–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ:
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
            f=(x)=>List.Sum(x[b]),
            group = Table.Group(from, "a", {"sum b",f})
        in
            group
    
    –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ã Table.Group:
    
        –ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Å–∞–º–∞ —Ç–∞–±–ª–∏—Ü–∞
        
        –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Å—Ç–æ–ª–±–µ—Ü –∏–ª–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –º—ã—à–∫–æ–∫–ª–∞—Ü–∞–Ω–∏–µ–º –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ - {‚Äúc‚Äù}. –ö–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞? ‚Äì —Å–ø—Ä–æ—Å–∏—Ç–µ –≤—ã ‚Äì –î–æ–π–¥–µ–º –¥–æ –ø—è—Ç–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ ‚Äì –æ–±—ä—è—Å–Ω—é ‚Äì –æ—Ç–≤–µ—á—É —è )
        
        –¢—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì –∞–≥—Ä–µ–≥–∞—Ü–∏—è –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∞–≥—Ä–µ–≥–∞—Ü–∏–π, —Ç.–µ. –ª–∏–±–æ {¬´–∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü¬ª,—Ñ—É–Ω–∫—Ü–∏—è_–∞–≥—Ä–µ–≥–∞—Ü–∏–∏}, –ª–∏–±–æ {{¬´–∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü1¬ª,—Ñ—É–Ω–∫—Ü–∏—è_–∞–≥—Ä–µ–≥–∞—Ü–∏–∏1 },{¬´–∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü2¬ª,—Ñ—É–Ω–∫—Ü–∏—è_–∞–≥—Ä–µ–≥–∞—Ü–∏–∏2}}
    
    –ò –≤–æ—Ç —Ç—É—Ç –Ω—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è. –§—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç —á—Ç–æ-—Ç–æ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏, –Ω–æ —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —ç—Ç–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º? –ü–æ–¥—Å—Ç–∞–≤—å—Ç–µ –≤ –∑–∞–ø—Ä–æ—Å –≤—ã—à–µ –≤–º–µ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ f —Ç–∞–∫–æ–µ f=(x)=>x ‚Äì –∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞. –ò —ç—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ.
    
    –†–∞–∑–±–µ—Ä–µ–º f=(x)=>List.Sum(x[b]) - x[b] ‚Äì —ç—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å—Ç–æ–ª–±—Ü—É —Ç–∞–±–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞–µ—Ç –Ω–∞–º —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –¥–∞–ª–µ–µ –º—ã —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ —Å—É–º–º–∏—Ä—É–µ–º (–≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ each List.Sum([b]) –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –º—ã—à–∫–æ–∫–ª–∞—Ü–∞–Ω–∏–µ–º —ç—Ç–æ –Ω–µ –æ—á–µ–≤–∏–¥–Ω–æ ‚Äì –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å —Ç—É—Ç).
        
    –¢–µ–ø–µ—Ä—å –∂–µ –º—ã –ø–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ —Å —Ç–∞–±–ª–∏—Ü–µ–π –º–æ–∂–Ω–æ —Ç–≤–æ—Ä–∏—Ç—å –≤—Å—è–∫–æ–µ ‚Äì –¥–æ–ø—É—Å—Ç–∏–º –≤–∞–º –Ω—É–∂–Ω–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏—Ç—å —Å—É–º–º—É, –∞ –Ω–∞–π—Ç–∏ —Å—É–º–º–∞—Ä–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É –ø–æ –¥–≤—É–º —Å—Ç–æ–ª–±—Ü–∞–º (–º–æ–∂–Ω–æ –∫–æ–Ω–µ—á–Ω–æ –¥–æ–ø—Å—Ç–æ–ª–±–µ—Ü –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ –ø–æ–π—Ç–∏ —á–µ—Ä–µ–∑ CombineColumns, –Ω–æ –º—ã –∂–µ –Ω–µ —Ö–æ—Ç–∏–º –Ω–∏—á–µ–≥–æ —É—Å–ª–æ–∂–Ω—è—Ç—å):
        
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
            f=(x)=> List.Sum(x[b])-List.Sum(x[c]),
            group = Table.Group(from, "a", {"diff b c",f})
        in
            group
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Å –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–º–µ–Ω—è–ª–∞—Å—å —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—è f (—ç—Ç–æ –∫ —Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—é –ª—É—á—à–µ –≤—ã–Ω–µ—Å—Ç–∏, —á–µ–º –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ª–∞–∑–∞—Ç—å –≤ –¥–µ–±—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞). –ö–∞–∫ –≤–∏–¥–∏–º ‚Äì —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ª—è–º–∏ –≤—Å—ë —Ç–∞–∫–∂–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.
    –ù—É –∏ —Ä–∞–∑ —É–∂ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞, –º–æ–∂–µ–º –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –≤—Å—é –º–æ—â—å —Ç–∞–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä, —á–∞—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω—É–º–µ—Ä–∞—Ü–∏—é, –Ω–æ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã:
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
            f=(x)=> Table.AddIndexColumn(x,"i",1,1),
            group = Table.Group(from, "a", {"tmp",f} ),
            to    = Table.Combine(group[tmp])
        in
            to
    –î—É–º–∞—é, —Å —Ä–∞–±–æ—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç. –ê –≤–æ—Ç —à–∞–≥ to ‚Äì –ø—Ä–æ—Å—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –≤ —Å—Ç–æ–ª–±—Ü–µ tmp —É –Ω–∞—Å —Ç–∞–±–ª–∏—Ü—ã, group[tmp] ‚Äì —Å–ø–∏—Å–æ–∫ —ç—Ç–∏—Ö —Ç–∞–±–ª–∏—Ü, –∏ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ –º—ã –æ—Ç–¥–∞—ë–º Table.Combine ‚Äì –≤—Å—ë, –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞.
    –ò–ª–∏ —Ç–∞–∫–æ–µ ‚Äì –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É –ª—É—á—à—É—é –ø—Ä–æ–¥–∞–∂—É –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–∞—Ç—É ‚Äì —ç—Ç–æ —Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Table.Max:
        let
            from = ...//–≤–∑—è—Ç—å –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞,
            f=(x)=>Table.Max(x,"b"),
            group = Table.Group(from, "a", {"tmp",f}),
            to = Table.FromRecords(group[tmp])
        in
            to
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì Table.Max –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–ø–∏—Å—å, –ø–æ—ç—Ç–æ–º—É –≤ —à–∞–≥–µ to –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Table.FromRecords.
    –í–æ—Ç, –ø–æ–∂–∞–ª—É–π, –∏ –≤—Å—ë ‚Äì –µ—Å–ª–∏ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç–µ (—Ç–æ—á–Ω–µ–µ —Å —á–µ–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –≤–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏) –∑–∞–¥–∞—á–∏ —Ä–µ—à–∞—é—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ.
    ]
    
[   Table.Group ‚Äì –ß–∞—Å—Ç—å 1.1 –¢—Ä–µ—Ç–∏–π —ç–ª–µ–º–µ–Ω—Ç —Ç—Ä–µ—Ç—å–µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ ‚Äì —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–∑—ã—Å–∫–∞–Ω–∏—è –ø–æ Table.Group ‚Äì –Ω–∞–¥–æ –æ–±—Å—É–¥–∏—Ç—å —Ç—Ä–µ—Ç–∏–π —ç–ª–µ–º–µ–Ω—Ç (—ç—Ç–æ –Ω–µ –≤–ª–µ–∑–ª–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–æ—Å—Ç), –∞ –∏–º–µ–Ω–Ω–æ: –ø–æ–ª–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ {¬´–∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü1¬ª,—Ñ—É–Ω–∫—Ü–∏—è_–∞–≥—Ä–µ–≥–∞—Ü–∏–∏1, —Ç–∏–ø_–¥–∞–Ω–Ω—ã—Ö_–∞–≥—Ä–µ–≥–∞—Ü–∏–∏ }
    –°—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –º—ã –º–æ–∂–µ–º —Å—Ä–∞–∑—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø —Å—Ç–æ–ª–±—Ü–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ. –í–æ–∑—å–º–µ–º –ø—Ä–∏–º–µ—Ä –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –ø–æ—Å—Ç–∞:
        
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
            f=(x)=>List.Sum(x[b]),
            group = Table.Group(from, "a", {"sum b",f,Int64.Type} )
            
        in
            group

    –ó–¥–µ—Å—å –¥–æ–±–∞–≤–ª–µ–Ω —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π —Ç–∏–ø Int64.Type ‚Äì –º–Ω–µ —Ç–∞–∫ –∑–∞—Ö–æ—Ç–µ–ª–æ—Å—å, –ø–æ—Å–∫–æ–ª—å–∫—É —Å—Ç–æ–ª–±–µ—Ü —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π. –ù–æ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –º—ã—à–∫–æ–∫–ª–∞—Ü–∞–Ω–∏–µ–º –≤—ã –ø–æ–ª—É—á–∏—Ç–µ type number ‚Äì —Ç.–µ. —á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π (—Å—É–¥—è –ø–æ –≤—Å–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π —Ç–∏–ø, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–æ–π —Å—Ç–æ–ª–±–µ—Ü –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç—Å—è), –ø–æ—ç—Ç–æ–º—É –±—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, –µ—Å–ª–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
    –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã:
        
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
            f=(x)=>Table.AddIndexColumn(x,"i",1,1),
            group = Table.Group(from, "a", 
                        {"tmp", f, type table [b = Int64.Type, c = Int64.Type, i = Int64.Type]}
                    ),
            to = Table.ExpandTableColumn(group, "tmp", {"b", "c", "i"})
        in
            to

    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Ç–∏–ø –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∑–∞–¥–∞–Ω –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏—Å—Ö–æ–¥–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –Ω–æ –∏ –¥–ª—è –¥–æ–±–∞–≤–ª—è–µ–º–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∏–Ω–¥–µ–∫—Å–∞ "i", —Ç.–µ. —Ç–∏–ø–∏–∑–∏—Ä—É–µ–º –º—ã –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á—Ç–æ —É–¥–æ–±–Ω–æ –∏ –Ω–µ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–¥–æ–≤–∞—Ç—å.

    –õ–æ–∂–∫–∞ –¥—ë–≥—Ç—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –µ—Å–ª–∏ –≤–º–µ—Å—Ç–æ ExpandTableColumn –≤–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Combine - –¥–∞–Ω–Ω—ã–µ –æ —Ç–∏–ø–∞—Ö —Å–ª–µ—Ç–∞—é—Ç (–ø–æ—á–µ–º—É - –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–ª –ú–∞–∫—Å–∏–º –ó–µ–ª–µ–Ω—Å–∫–∏–π —Ç—É—Ç), –Ω–æ —ç—Ç–æ –¥–µ–ª–æ –ø–æ–ø—Ä–∞–≤–∏–º–æ–µ - –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏–º —Ç–∏–ø–∏–∑–∞—Ü–∏—é –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥:
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZM7EsIwDETv4jpFJPkj5ypAQQK5ARWTuzNoU5BOjmm28DyttbJ8eYd7mML1NUZh0/GrkUzXMIQ5TJyHsISplm3w4Al4Hn247O7kw1kNJ6e7JsNT9uF5RDPqdK+Gx+qMSk29ixjuHDtF9CIH3EB5GIjSJ05QVBCglJaizBhSailSOlNUMDBtak9O3MTYE2oaHvb80Byln1eaf1wW09VUTev+brCR2GeDX6Slz4Uxu9SZqeAbxc5MhO3kzlCa/xKKscGJttsH"),Compression.Deflate))),
            f=(x)=>Table.AddIndexColumn(x,"i",1,1),
            group = Table.Group(from, "a", {"tmp",f}),
            to    = Table.Combine(
                        group[tmp], 
                        type table [a = text, b = Int64.Type,c = Int64.Type,i = Int64.Type]
                    )
        in
            to
    –í—É–∞–ª—è - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞–¥–æ, —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞, –∫–∞–∫ –º—ã –∏ —Ö–æ—Ç–µ–ª–∏.
    ]

[   Table.Group ‚Äì –ß–∞—Å—Ç—å 2. –ß–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ó–∞–∫–æ–Ω—á–∏–ª–∏ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏—è–º–∏ - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —á–µ—Ç–≤–µ—Ä—Ç–æ–º—É –∞—Ä–≥—É–º–µ–Ω—Ç—É. –ó–¥–µ—Å—å –Ω–µ –±—É–¥—É –≤–∞—Å –¥–æ–ª–≥–æ —É—Ç–æ–º–ª—è—Ç—å:
    –í–æ-–ø–µ—Ä–≤—ã—Ö, –æ–Ω –µ—Å—Ç—å
    –í–æ-–≤—Ç–æ—Ä—ã—Ö, –≤–æ–∑–º–æ–∂–Ω—ã –≤—Å–µ–≥–æ –ª–∏—à—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Äì GroupKind.Global –∏ GroupKind.Local
    –ï—Å–ª–∏ –≤—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∏—Å–∞–ª–∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –∏–º–µ–π—Ç–µ –≤ –≤–∏–¥—É, —á—Ç–æ –≤—ã –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å GroupKind.Global
    –†–∞–∑–Ω–∏—Ü–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ Global –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –¥–∞–Ω–Ω—ã–º –∫–ª—é—á–æ–º –≤ –æ–¥–Ω—É –≥—Ä—É–ø–ø—É, –∞ Local ‚Äì –≤—Å–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∏–¥—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –∫–ª—é—á–æ–º –≤ –æ–¥–Ω—É –≥—Ä—É–ø–ø—É.
    –ö–æ–≥–¥–∞ –Ω–∞–º —ç—Ç–æ –Ω–∞–¥–æ? –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç–µ –ø–æ –º–µ—Å—è—Ü–∞–º, –Ω–æ –Ω–µ —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è–Ω–≤–∞—Ä—å 2021 —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª—Å—è —Å —è–Ω–≤–∞—Ä—ë–º 2022, –∏–ª–∏ –∏–¥—ë—Ç —Å–º–µ–Ω–Ω–∞—è/–≤–∞—Ö—Ç–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞, –∏ –≤–∞–º –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å –≤—ã—Ä–∞–±–æ—Ç–∫—É –∑–∞ –∫–∞–∂–¥—É—é –≤–∞—Ö—Ç—É:
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("zZe7agNBDEX/ZWsL9JjZh78jXZwigXyCK+N/t2aNiZ3CXJAKwSC2GC2n2KO9+rxMpzM3a3vlUZven6fjpKxKLH4+mI/7mQ73Bn1q6P/a3l+Ql1e0n73y322Tvf4+9Xw/Xi3XAwRsXATYIGAlXYsAdwjYSLciwAsE3EiXIsAbBNxJ5yLAglk3k7YqxJh2C6klEmuEGPNuJc0cxSFiTLyNJHNShIgh84RJModxhFgh80RIMmdFiBgyT/z0KsSAeTYyhWTOish0U8A8G6FCqsQ2BcyzkSpEixAbYJ6NWCFlkiZgno1cwVWSm2Hmzf6jrkKMmbc4dJHpZph5q3/KRYgbZt7mA64KMWSe54rUNTpEDJnnxKl7dIgYMs+TUOoiHSKGzPMklLqYRoi7XL9u"),Compression.Deflate))),
            f=(x)=>
                [   a=(y)=>Text.From(Date.From(Text.Split(y,"T"){0})),
                    b = a(List.Min(x))&" - "&a(List.Max(x))
                ]   [b],
            to = Table.Group(from, "–≤–∞—Ö—Ç–∞", 
                    {  
                        {"–ø–µ—Ä–∏–æ–¥",   (x)=>f(x[–¥–∞—Ç–∞]), Text.Type},
                        {"–≤—ã—Ä–∞–±–æ—Ç–∫–∞",(x)=>List.Sum(x[–≤—ã—Ä–∞–±–æ—Ç–∫–∞]), Int64.Type}
                    },
                    GroupKind.Local)
        in
            to
    –ü—Ä–æ—Å—Ç–æ —Å—Ä–∞–≤–Ω–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å —á–µ—Ç–≤—ë—Ä—Ç—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –∏ –±–µ–∑.
    –ï—â—ë –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —à–∞–≥ f ‚Äì —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ —É–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì –ø–æ—á–µ–º—É –±—ã –∏ –Ω–µ—Ç, –∫–æ–º–ø–∞–∫—Ç–Ω–æ –∏ –Ω–∞–¥–µ—é—Å—å –Ω–∞–≥–ª—è–¥–Ω–æ.
    –ù—É –∏ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –µ—â—ë –ø–∞—Ä—É –∑–∞–º–µ—á–∞–Ω–∏–π - GroupKind.Global –∏ GroupKind.Local ‚Äì —ç—Ç–æ –ù–ï —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã ‚Äì –≤ —á—ë–º –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è –≤—ã–ø–æ–ª–Ω–∏–≤ Number.From(GroupKind.Global) –∏ Number.From(GroupKind.Local) ‚Äì –≤—ã–¥–∞—Å—Ç 1 –∏ 0 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. 
    –¢. –µ. –µ—Å–ª–∏ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –ª—é–¥—è–º, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ—Ä—è—Ç, —á—Ç–æ —á–µ–º –∫–æ—Ä–æ—á–µ –∫–æ–¥, —Ç–µ–º –æ–Ω –±—ã—Å—Ç—Ä–µ–µ ‚Äì –∑–∞–º–µ–Ω—è–π—Ç–µ –≥—Ä–æ–º–æ–∑–¥–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —á–∏—Å–ª–æ–≤–æ–µ (–Ω–æ –≤–æ–æ–±—â–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é ‚Äì –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç –±—ã—Å—Ç—Ä–æ –∑–∞–±—ã–≤–∞—é—Ç—Å—è, –Ω–æ –ø–æ–º–Ω–∏—Ç—å –æ –Ω–∏—Ö –Ω–∞–¥–æ ‚Äì –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤—Å—Ç—Ä–µ—á–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —Ç–µ–ø–µ—Ä—å –≤—ã –±—É–¥–µ—Ç–µ –∑–Ω–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –∑–∞ –Ω–æ–ª–∏–∫).
    –ù—É –∏ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äì —Å–∞–º –ø–æ —Å–µ–±–µ GroupKind.Local –Ω–µ –æ—Å–æ–±–æ –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω, –≤—Å—è –µ–≥–æ –º–æ—â—å –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –º—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–∏—à–µ–º –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì –æ –Ω—ë–º –º—ã –∏ –ø–æ–≥–æ–≤–æ—Ä–∏–º –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏.
    ]

[   Table.Group ‚Äì –ß–∞—Å—Ç—å 3.1 –ü—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç - –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–º–µ—Ä –∏ –æ–ø–∏—Å–∞–Ω–∏–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group, #buchlotnik
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–∞–º –æ—Å—Ç–∞–ª–æ—Å—å —Å—Ç–∞–ª–æ—Å—å —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ. –ú—ã —É–∂–µ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å —Ç–µ–º, —á—Ç–æ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±—ã–º–∏, –∏—Ö —É–¥–æ–±–Ω–æ –¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π, –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –º–æ–∂–Ω–æ –∏–¥—Ç–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ —Å—Ç—Ä–æ–∫–∞–º, –∏—Å–ø–æ–ª—å–∑—É—è GroupKind.Local. –ê —Ç–µ–ø–µ—Ä—å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å ‚Äì —á—Ç–æ –µ—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫–∏-—Ç–æ –º–µ—Ç–∫–∏ (—Ä–∞–∑–Ω—ã–µ) –∏ –º—ã —Ö–æ—Ç–∏–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–∞–∫–∏–º-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –∏–∑ —Å–ø–∏—Å–∫–∞, –∏–ª–∏ –º—ã —Ö–æ—Ç–∏–º —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ –Ω–µ–¥–µ–ª—è–º (–º–æ–∂–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, —Å–¥–µ–ª–∞—Ç—å –¥–æ–ø—Å—Ç–æ–ª–±–µ—Ü —Å –Ω–æ–º–µ—Ä–æ–º –Ω–µ–¥–µ–ª–∏, –Ω–æ –º—ã —Ö–æ—Ç–∏–º –∫–∞–∫-—Ç–æ –ø—Ä–æ—â–µ) –∏–ª–∏ –Ω–∞–¥–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏ ‚Äì –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ä–∞—Å—Ç–µ—Ç –∏ —Ç.–ø. –î—É–º–∞—é –≤—ã –¥–æ–≥–∞–¥–∞–ª–∏—Å—å, —á—Ç–æ —Ç–∞–∫ –ú–û–ñ–ù–û. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∫–∞–∫.

    –ü—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì comparer ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è 0 –∏–ª–∏ 1. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤—ã—Å—Ç—É–ø–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ —á–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≥—Ä—É–ø–ø–∞ –∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - state –∏ current (s –∏ c, x –∏ y ‚Äì –∫–æ–º—É –∫–∞–∫ –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è). –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –ø–æ–∫–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–ª—å ‚Äì —Å—Ç—Ä–æ–∫–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—Ü—É ‚Äì –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –≥—Ä—É–ø–ø–∞. –ò —ç—Ç–æ –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç ‚Äì –Ω–∞–º –Ω—É–∂–Ω—ã –∏–º–µ–Ω–Ω–æ 0 –∏ 1.
    –ü—Ä–∏–º–µ—Ä –≤–æ–∑—å–º–µ–º –æ–±—â–∏–π, –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º —à–∞–≥ from —è –Ω–µ –±—É–¥—É –∑–∞–Ω–æ–≤–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∏ —Å–∞–º—É –∞–≥—Ä–µ–≥–∞—Ü–∏—é –≤–æ–∑—å–º–µ–º —Å–∞–º—É—é –ø—Ä–æ—Å—Ç—É—é {"tmp", each _ } - —á—Ç–æ–±—ã –ø—Ä–æ—Å—Ç–æ –±—ã–ª –≤–∏–¥–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:
        let
            from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("5ZrLboMwEEX/hXUiecZjXr/SdtG8VlF3WVX99xJDhBsaehtsC7AUWSRge8KRDWfsl8/s9aJEiy3VtRRuj7M6Y8W8VdR8so29TnJ7rrTluy13WU3tSX205cmWxl6unGadqnJqGrdfD/0Feucci9OD6jrv6rLTl+7aEW1LGgRQOr0cb+3YFmR3H6GmvuWul1sAtfqlqnECkayuzMa9l8e+gTY6ve/jaiMS7sInezHZwFltlWpu+NcGQ8OjaD4u5/PTdP64OXPgQgiY3CMYhsHopMFw7BGjYTCSNBiNgBGPYAQGY8KBYW6DWwoAn1OWgQHkSY8MQcCUHsHkMJhiFAyvmYqJTaWAqZRJD5ccAENKeSRTwmSqWZOh+7q6msLBRH6eVCgGUuEwLMYcITzV83haMLrHA6sjjVu9XvPkVSBUCo9UYG+ktIW+DDybDcDA3khpC30FgJn0uB+QgcWRxo1e1oyFVOwBA+skBfT5JZCh2GRgn6S0RZ84NhnYKWnc9Ke9Mu/dfzioeHA6LB42FdtuIFb+NLOt3iBr3AVFFjANsBjLwYbUBM15QAmXnXmnBILz0VGH0RUNbDwcME2wBDQS2EUHZGDl4fEMgVk1FoNgYY9YYN/htFMEBKXUPC4JEKw8PO8cgedXsyLySibBgsMB1/iX804G8fE5TmDN4cRTA2XstTOC1854PDeQr5pLFXvEwGtpHDAxsAAyrCI/axj2f057GwAjWzC9zmUMSz+nLf0cehPmzzyn/Un+tVFDB1T/GW35w0D4XG5unitv3w=="),Compression.Deflate))),
            group = Table.Group(from, "–∏—Ç–æ–≥", {"tmp", each _}, GroupKind.Local, (s,c)=>if c="—É—Å–ø–µ—à–Ω–æ" then 0 else 1)
        in
            group

    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –ø—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–µ true –∏–ª–∏ false, –≤–æ—Å–ø—Ä–∏–Ω—è—Ç–æ –Ω–µ –±—É–¥–µ—Ç, –ø–æ—ç—Ç–æ–º—É –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è if then else. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ —á–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç:
        group = Table.Group(from, "–∏—Ç–æ–≥", {"tmp", each _}, GroupKind.Local, (s,c)=>Number.From(c<>"—É—Å–ø–µ—à–Ω–æ"))

    –ü–æ–ª—É—á–∏–º —Ç–æ –∂–µ —Å–∞–º–æ–µ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ Number.From() –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, –Ω–µ –≤–∞–∂–Ω–æ –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã 0 –∏ 1, –ø—Ä–æ—Å—Ç–æ —Å –Ω–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —á–µ—Ä–µ–∑ if, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø–∏—Å–∞—Ç—å –∫–∞–∫ –≤–∞–º —É–¥–æ–±–Ω–µ–µ.
    ]

[   Table.Group ‚Äì –ß–∞—Å—Ç—å 3.2 –ü—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç - –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group

    –û—Å–≤–æ–∏–ª–∏ –±–∞–∑—É, —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–π–¥—ë–º—Å—è –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º:
    1. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ª—é–±–æ–º—É –Ω–µ–Ω—É–ª–µ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
        group = Table.Group(from, "—Ü–∏–∫–ª", {"tmp", each _},GroupKind.Local,(s,c)=>Number.From(c<>null))
    
    2. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
        group = Table.Group(from, "–∏—Ç–æ–≥", {"tmp", each _}, GroupKind.Local, (s,c)=>Number.From(c="—Å–±–æ–π"))
    
    3. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞
        group = Table.Group(from, "–æ–ø–µ—Ä–∞—Ü–∏—è", {"tmp", each _},GroupKind.Local,(s,c)=>Number.From(List.Contains({"–Ω–∞–ª–∞–¥–∫–∞","–¢–û"},c)))
    
    4. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É—Å–ª–æ–≤–∏—é
        group = Table.Group(from, "–≤—ã—Ö–æ–¥", {"tmp", each _},GroupKind.Local,(s,c)=>Number.From(c<95))

    –°–º—ã—Å–ª, –¥—É–º–∞—é, –ø–æ–Ω—è—Ç–µ–Ω. –ù–æ —á—Ç–æ –∂–µ —Å–æ state-—Ç–æ–º? –ú—ã –µ–≥–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º ‚Äì –æ–Ω, —á—Ç–æ —Å–æ–≤—Å–µ–º –Ω–µ –Ω—É–∂–µ–Ω? –ù—É–∂–µ–Ω! –û–π –∫–∞–∫ –Ω—É–∂–µ–Ω! 
    
    5. –ì—Ä—É–ø–ø–∏—Ä—É–µ–º, –∫–æ–≥–¥–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ/–ª—é–±—ã–µ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–∏–º–≤–æ–ª—ã –≤ –∑–Ω–∞—á–µ–Ω–∏–∏:
        group = Table.Group(from, "–¥–æ–∫—É–º–µ–Ω—Ç", {"tmp", each _}, GroupKind.Local, (s,c)=>Number.From(Text.Start(s,3)<>Text.Start(c,3)))
    
    6. –ì—Ä—É–ø–ø–∏—Ä—É–µ–º, –µ—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–æ–π –≤ –≥—Ä—É–ø–ø–µ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        group = Table.Group(from, "–≤—ã—Ä–∞–±–æ—Ç–∫–∞", {"tmp", each _},GroupKind.Local,(s,c)=>Number.From(c-s>50))

    7. –ï—â—ë –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –º–æ–º–µ–Ω—Ç ‚Äì –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å-—Ç–æ –º–æ–∂–Ω–æ –∏ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º:
        group = Table.Group(from, {"–¥–∞—Ç–∞","—Ü–∏–∫–ª","–≤—ã—Ä–∞–±–æ—Ç–∫–∞"}, {"tmp", each _},GroupKind.Local, (s,c)=>Number.From(c[—Ü–∏–∫–ª]<>null)) 
    
    –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –≤—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤, –ø—Ä–∏—á–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –Ω–∏—Ö –±—É–¥—É—Ç –ø–æ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –≤ –≥—Ä—É–ø–ø–µ, –∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –ø–æ —Å—É—Ç–∏, —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ —Ü–∏–∫–ª.
    –ò –≤–æ—Ç —Ç—É—Ç –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ: 
    ‚Äì –µ—Å–ª–∏ –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ - "—Ü–∏–∫–ª" ‚Äì —Ç–æ –∏ –≤ —Ñ–æ—Ä–º—É–ª–µ –º—ã –ø—Ä–æ—Å—Ç–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ–º—Å—è –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ (–ø–∏—à–µ–º c<>null), 
    ‚Äì –∞ –µ—Å–ª–∏ –≤—ã –Ω–∞–º—ã—à–∫–æ–∫–ª–∞—Ü–∞–ª–∏ {"—Ü–∏–∫–ª"} ‚Äì —Ç–æ (–≤–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏–∫—É), —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π, –∞ –∑–Ω–∞—á–∏—Ç –Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∏–º‚Ä¶ –∑–∞–ø–∏—Å—å. 
    –ò –æ–±—Ä–∞—â–∞—Ç—å—Å—è —É–∂–µ –Ω—É–∂–Ω–æ c[—Ü–∏–∫–ª]<>null ‚Äì –≤–æ—Ç —Ç–∞–∫, –∏ –±–æ–ª—å—à–µ –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ, –ø–æ—á–µ–º—É —è –æ–±—ã—á–Ω–æ –Ω–µ –ø–∏—à—É —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ –≤–æ–ø—Ä–µ–∫–∏ ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É¬ª –≤–∏–¥—É.

    –ù–∞–ø–æ—Å–ª–µ–¥–æ–∫ —Ö–æ—á–µ—Ç—Å—è —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –µ—Å–ª–∏ —É –≤–∞—Å –ø–æ–ª—É—á–∏–ª–∞—Å—å —Å–ª–æ–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ‚Äì –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å ‚Äì –¥–∞–π—Ç–µ –µ–π –∏–º—è –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥, –∫–∞–∫ –º—ã —É–∂–µ –Ω–µ–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –¥–µ–ª–∞–ª–∏:
    
        f=(x,y)=> 
            [   a =(z)=> Text.Start(z,3), 
                b = Number.From(a(x)<>a(y))
            ]  [b], 
        group = Table.Group(from, "–¥–æ–∫—É–º–µ–Ω—Ç", {"tmp", each _}, GroupKind.Local, f)

    –ù–∞ —ç—Ç–æ–º –Ω–∞ —Å–µ–≥–æ–¥–Ω—è, –¥—É–º–∞—é, –∑–∞–∫–æ–Ω—á–∏–º.
    –ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥: Table.Group ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ü–Ø–¢–ò –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –∏ —Ö–æ—Ç—å –¥–≤–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã, –Ω–æ –≤ —É–º–µ–ª—ã—Ö —Ä—É–∫–∞—Ö –±—ã–≤–∞—é—Ç –∫—Ä–∞–π–Ω–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã ‚Äì —Ç–∞–∫ —á—Ç–æ –ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö –Ω–∞ –±–ª–∞–≥–æ —Å–≤–µ—Ç–ª–æ–≥–æ –±—É–¥—É—â–µ–≥–æ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞.
    ]

[   Table.Group ‚Äì –ß–∞—Å—Ç—å 3.3 –ü—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç + GroupKind.Global / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! 
    –ú–µ–Ω—è —Ç—É—Ç —É–ª–∏—á–∏–ª–∏ –≤ –Ω–µ–ø–æ–ª–Ω–æ—Ç–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Ç–µ–º—ã, –ø–æ—ç—Ç–æ–º—É –≤—ã–Ω—É–∂–¥–µ–Ω –¥–∞—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.
    –ò—Ç–∞–∫, –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç —É Table.Group –∏ —è —Ç–æ–≥–¥–∞ –Ω–∞–ø–∏—Å–∞–ª, —á—Ç–æ –µ–≥–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å GroupKind.Local. 
    –ù–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–º–æ—Ç–∞—Ç—å –∏ –¥–ª—è GroupKind.Global.
    –†–∞–∑–±–µ—Ä–µ–º –ø—Ä–∏–º–µ—Ä:
    let
        tbl = #table({"Date","Num"},{{#date(2021,1,1),1},{#date(2020,1,1),2},{#date(2021,3,1),3},{#date(2020,1,12),4},{#date(2022,1,1),5}}),
        f=(x,y)=>Value.Compare(Date.Year(x),Date.Year(y)),
        to =    Table.Group(tbl,
                    "Date",
                    {"Sum", (t)=>List.Sum(t[Num])},
                    GroupKind.Global, 
                    f
                )
    in
        to
    tbl - –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É ‚Äì –¥–∞—Ç–∞/–∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Ö–æ—Ç–∏–º —Å–¥–µ–ª–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ –≥–æ–¥–∞–º.
    to  - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –¥–µ–ª–∞–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É, —Å—Ä–∞–∑—É –≤ –æ–¥–∏–Ω —à–∞–≥, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ f
    f   - –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –∫–∞–∫ –≤—Å–µ–≥–¥–∞ –ø–∏—à–µ–º –æ—Ç –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. –í —Å–ª—É—á–∞–µ GrouKind.Local –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ 0 –∏–ª–∏ 1 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –Ω–∞–¥–æ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–æ–≤—É—é  –≥—Ä—É–ø–ø—É –∏–ª–∏ –Ω–µ—Ç. –ù–æ –≤ —Ç–æ–º-—Ç–æ –∏ –¥–µ–ª–æ, —á—Ç–æ —Ç–∞–º —Å—Ç—Ä–æ–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∞ –≤–æ—Ç –≤ —Å–ª—É—á–∞–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–º–µ–Ω–Ω–æ –ø–æ—Ä—è–¥–æ–∫ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –µ–π –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. –°–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º Value.Compare - –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—ë—Ç -1 0 –∏–ª–∏ 1 –∫–æ–≥–¥–∞ x –º–µ–Ω—å—à–µ, —Ä–∞–≤–µ–Ω –∏–ª–∏ –±–æ–ª—å—à–µ y —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

    –ù—É –∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ —Ç–∞–∫–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –¥–∞—Ç—ã –≤ —Å—Ç–æ–ª–±—Ü–µ Date –æ—Å—Ç–∞–Ω—É—Ç—Å—è –¥–∞—Ç–∞–º–∏, —Ö–æ—Ç—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–¥–µ–ª–∞–Ω–∞ –∏–º–µ–Ω–Ω–æ –ø–æ –≥–æ–¥–∞–º. –ê –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ –º—ã —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏ –≤ —Ä–∞–º–∫–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, Value.Compare ‚Äì –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ò —Å —Ä–æ—Å—Ç–æ–º –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö ¬´—Ç—É–ø–∏—Ç—å¬ª –±—É–¥–µ—Ç –≤—Å—ë —Å–∏–ª—å–Ω–µ–µ.
    –ú–æ–∂–Ω–æ –ª–∏ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å? –ù—É –≤ —Ü–µ–ª–æ–º –¥–∞ ‚Äì –ø–µ—Ä–µ–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:
    
    f=(x,y)=>Date.Year(x)-Date.Year(y)

    –í–º–µ—Å—Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–Ω–∏—Ü—É –∏ –æ–Ω–∞ –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ, —Ä–∞–≤–Ω–∞ –∏–ª–∏ –±–æ–ª—å—à–µ –Ω—É–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É x –∏ y. –í —Ç–∞–∫–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –ø–æ–ª—É—á–∏–º –ø—Ä–∏—Ä–æ—Å—Ç –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —Ç–∞–∫ –Ω–∞ 20 ‚Äì 25 (–∑–∞–º–µ—Ä—è–ª –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ –≤ 100k —Å—Ç—Ä–æ–∫) ‚Äì —á—Ç–æ, –∫–æ–Ω–µ—á–Ω–æ, –æ—â—É—Ç–∏–º–æ.
    –ò –∫–æ–º—É-—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ –≤–æ—Ç –ø—Ä—è–º –∫—Ä—É—Ç–æ ‚Äì –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–¥–∏–Ω —à–∞–≥, –Ω–æ –µ—Å—Ç—å –º–∞–∞–∞–ª–µ–Ω—å–∫–æ–µ –ù–û, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ —è –¥–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–µ –æ–ø–∏—Å—ã–≤–∞–ª. –ê —Å–æ—Å—Ç–æ–∏—Ç –æ–Ω–æ –≤–æ—Ç –≤ —á—ë–º:
    let
        tbl = #table({"Date","Num"},{{#date(2021,1,1),1},{#date(2020,1,1),2},{#date(2021,3,1),3},{#date(2020,1,12),4},{#date(2022,1,1),5}}),
        tr  = Table.TransformColumns(tbl,{"Date", Date.Year}),
        to  = Table.Group(tr,"Date",{"Sum",(t)=>List.Sum(t[Num])})
    in
        to
    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –≤ –¥–≤–∞ —à–∞–≥–∞
    tr ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –¥–∞—Ç—ã –≤ –≥–æ–¥—ã
    to ‚Äì —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∏ –ø–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–º—É —Å—Ç–æ–ª–±—Ü—É
    –ù–∞ —Ç–æ–π –∂–µ –≤—ã–±–æ—Ä–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ.

    –ò –¥–∞–∂–µ –µ—Å–ª–∏ –≤–∞–º –Ω–∞–¥–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞—Ç—ã ‚Äì –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –≥–æ–¥–∞ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Äì –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –≤ —Ä–∞–∑—ã –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –≤–æ—Ç —ç—Ç–æ—Ç ¬´—Ñ–∏–Ω—Ç —É—à–∞–º–∏¬ª. –ü—Ä–∏—á–∏–Ω–∞ ‚Äì –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏–¥—ë—Ç –ø–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º (—Ç.–µ. —Å—Ç—Ä–æ–∫–∞ –ø–æ–ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –≤ –Ω—É–∂–Ω—É—é –≥—Ä—É–ø–ø—É), –∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—è—Ç–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –º—ã –ø–æ—Ä–æ–∂–¥–∞–µ–º –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø–∞—Ä–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π ‚Äì —Ö–æ—Ç—å –∏ –≤—ã–≥–ª—è–¥–∏—Ç –≤—Å—ë –≤–ø–æ–ª–Ω–µ –ª–∞–∫–æ–Ω–∏—á–Ω–æ ‚Äì —ç—Ç–æ –Ω–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å.

    –ü–æ—ç—Ç–æ–º—É –µ—â—ë —Ä–∞–∑ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Å–∞–º –ø–æ —Å–µ–±–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–∏–ª—å–Ω–æ —Ä–∞–∑–≤—è–∑—ã–≤–∞–µ—Ç —Ä—É–∫–∏ –∏ –¥–∞, —É –ø–∏—à—É—â–µ–≥–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–Ω–æ–≥–æ ¬´–º–æ–∂–Ω–æ¬ª. –ù–æ –º–æ–∂–Ω–æ –ù–ï –∑–Ω–∞—á–∏—Ç –Ω—É–∂–Ω–æ. –î–µ–ª–æ –≤—Å–µ–≥–¥–∞ –Ω–µ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, –∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ü—Ä–æ–±—É–π—Ç–µ, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ, –Ω–æ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ –∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ—á–∫–æ–π –∫–æ–¥–∞, –ø—Ä–∏ –¥–æ–ª–∂–Ω–æ–º —É–º–µ–Ω–∏–∏, –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞.
    ]
   
[   Table.ReverseRows –∏ –ø—Ä–∏—á—ë–º —Ç—É—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.ReverseRows
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç–µ–º—ã –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ ‚Äì –Ω–µ–¥–∞–≤–Ω–æ –±—ã–ª–∞ –∑–∞–¥–∞—á–∫–∞. –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–æ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É –≤ –ü–û–°–õ–ï–î–ù–ï–ô —Å—Ç—Ä–æ–∫–µ –≥—Ä—É–ø–ø—ã. –ü–æ —Å—Å—ã–ª–∫–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–ª–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ—Ç –ü—É—Ö–∞ ‚Äì –¥–æ–ø—Å—Ç–æ–ª–±–µ—Ü —Å –∏–Ω–¥–µ–∫—Å–æ–º, —É—Å–ª–æ–≤–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü, FillUp, –ø–æ—Ç–æ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Äì –≤ –æ–±—â–µ–º –≤—Å–µ –ª–æ–≥–∏—á–Ω–æ –∏ –±–µ—Ä–∏—Ç–µ –Ω–∞ –≤–æ–æ—Ä—É–∂–µ–Ω–∏–µ - —É —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –µ—Å—Ç—å –º–∞—Å—Å–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

    –ù–æ —Ö–æ—á–µ—Ç—Å—è –∂–µ —Å–¥–µ–ª–∞—Ç—å —Ñ–∏–Ω—Ç —É—à–∞–º–∏ - –∏–Ω–∞—á–µ –±—ã –ø–æ—Å—Ç–∞ –Ω–µ –±—ã–ª–æ. –ü–æ—ç—Ç–æ–º—É:
    let
        from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("5ZXBCoMwDIZfZfS8QZPGVn2VbYc59Q12Gnv3aToxMBA8JBQECY0m+eNHSq5vd3t5Appt8LMlzOcTO8DOwDaxFaGhZ1tz5Ohahx7x4mF63Hm7cGCHOj6PQqQThattEVxEkmhJCv7eTzkcNqxdkBcpSQjkr8+l8iiCc3pcO8twCFwbPmclkGgBMuwE+RAy/R9UIb8bJKiBDBYgqZiJjGogyQJkVQxIVANZWYCMB7ja0QJkKmYi9ZZNsgBZH2AiawuQTTETqbdsGgOQ4IsBqbZs1n/UBAkFXe37Fw=="),Compression.Deflate))),
        typ = Table.TransformColumnTypes(from,{{"–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è", type date}, {"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è", type date}, {"–ü—Ä–æ—Ü–µ—Å—Å", Int64.Type}, {"–ó–∞–¥–∞—á–∞", type text}}),
        tbl = Table.ReverseRows(typ),
        group = Table.Group(tbl, {"–ü—Ä–æ—Ü–µ—Å—Å","–ó–∞–¥–∞—á–∞"},
                            {{"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è", (x)=>List.Min(x[–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è]), Date.Type},
                            {"–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è", (x)=>List.Max(x[–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è]), Date.Type}},
                            GroupKind.Local,
                            (s,c)=>Number.From(c[–ó–∞–¥–∞—á–∞]="–ö–æ–Ω—Ç—Ä–æ–ª—å")),
        to = Table.ReverseRows(group)
    in 
        to
    tbl ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º Table.ReverseRows ‚Äì —Å—Ç—Ä–æ—á–∫–∏ –º–µ–Ω—è—é—Ç—Å—è —Å –Ω–æ–≥ –Ω–∞ –≥–æ–ª–æ–≤—É ‚Äì –∏ –Ω—É–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É‚Ä¶ –≤ –ü–ï–†–í–û–ô —Å—Ç—Ä–æ–∫–µ –≥—Ä—É–ø–ø—ã
    group ‚Äì –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ ¬´–ü—Ä–æ—Ü–µ—Å—Å¬ª –∏ ¬´–ó–∞–¥–∞—á–∞¬ª - —Å—Ä–∞–∑—É –ø–æ –æ–±–æ–∏–º, —á—Ç–æ–±—ã –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –Ω–∞–¥–æ –±—ã–ª–æ –≤—ã–Ω–∏–º–∞—Ç—å –∏–∑ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã, GroupKind –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ Local, –Ω—É –∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –∑–∞–±—ã–ª–∏ —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –Ω–∞—Å —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ ¬´–∑–∞–¥–∞—á–∞¬ª
    to ‚Äì –∏ —Å–Ω–æ–≤–∞ ReverseRows, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π
    –í–æ—Ç –∏ –≤—Å—ë. –†–µ–¥–∫–æ –ø–æ–ª—å–∑—É—é—Å—å —Ä–µ–≤–µ—Ä—Å–∞–º–∏, –Ω–æ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –∫—Ä–∞—Ç–Ω–æ.
    –ö—É—Ä–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É ‚Äì —Ç–∞–º –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ.
    ]

[   –ß–µ–º –∑–∞–º–µ–Ω–∏—Ç—å Table.AddColumn? ‚Äì —ç–ø–∏—á–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.FromList –∏ –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ú—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏, —á—Ç–æ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö –±—ã—Å—Ç—Ä–µ–µ ))). –¢–∞–∫ –≤–æ—Ç, –∏—Å—Ç–æ—Ä–∏—è –ø–æ–ª—É—á–∏–ª–∞ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ. –°–µ–≥–æ–¥–Ω—è –≤ —á–∞—Ç–µ —Å–æ—Å—Ç–æ—è–ª—Å—è —á–µ–ª–ª–µ–Ω–¥–∂. @MaximZelensky ‚Äì —Å–ø–∞—Å–∏–±–æ –∑–∞ –∏–¥–µ—é –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é!
    –°—É—Ç—å –∑–∞–¥–∞—á–∏ ‚Äì –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ Table.AddColumn. –í —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –Ω–æ–≤—ã–º —Å—Ç–æ–ª–±—Ü–æ–º, —ç—Ç–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è —Ç–µ –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —á—Ç–æ –∏ —à—Ç–∞—Ç–Ω–∞—è, –ø—Ä–∏ —ç—Ç–æ–º —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤ —É –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤ –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ, –∫–∞–∫ –∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —à—Ç–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ü–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Äì –≤—Å–µ (–≤—Å–µ, –ö–∞—Ä–ª!) —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–∫–∞–∑–∞–ª–∏—Å—å –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —à—Ç–∞—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ—á—Ç–∏ –≤ –¥–≤–∞ —Ä–∞–∑–∞! (–≤–∞–∂–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ - –≤ —Ö–æ–¥–µ –ø—Ä–∏—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤—ã—è—Å–Ω–µ–Ω–æ, —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —à—É—Å—Ç—Ä–µ–µ, –µ—Å–ª–∏ –µ—ë –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –≤ Table.Buffer, –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ç–∞–∫–∏—Ö –∏–∑—ã—Å–∫–æ–≤ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ –ø—Ä–∏—è—Ç–Ω–æ).
    –ù—É –∞ –ª—É—á—à–∏–º –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–∫–∞–∑–∞–ª—Å—è, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, –≥–∏–±—Ä–∏–¥ –∏–¥–µ–π ‚Äì –µ–≥–æ –∏ —Ä–∞–∑–±–µ—Ä–µ–º:
    (table as table, newColumnName as text, columnGenerator as function, optional columnType as nullable type) as table =>
    [
        //–∫—É—Å–æ–∫ –æ—Ç buchlotnik
        rec=Table.ToRecords(table),
        gen=(x)=>Record.FieldValues(x)&{columnGenerator(x)},
        newtyp = if columnType = null then Type.FunctionReturn(Value.Type(columnGenerator)) else columnType,
        //–∫—É—Å–æ–∫ –æ—Ç Maxim Zelensky
        TypeAsRecord = Record.AddField(Type.RecordFields(Type.TableRow(Value.Type(table))), newColumnName, [Type = newtyp, Optional = false]),
        NewTableType = type table Type.ForRecord(TypeAsRecord, false),
        //–∏ –∏—Ç–æ–≥ –ø–æ—Å–ª–µ—á–µ–ª–ª–µ–Ω–¥–∂–µ–≤–æ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è
        to = Table.FromList(rec,gen,NewTableType)    
    ][to]
    ()=> –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ã ‚Äì –æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ —Å–ø—Ä–∞–≤–∫–∏ - –º—ã –∏–≥—Ä–∞–µ–º –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º üôÇ
    rec ‚Äì –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É –≤ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π - –∑–∞–ø–∏—Å–∏ –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ , columnGenerator —à—Ç–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ–ª—è–º–∏ –∑–∞–ø–∏—Å–∏
    gen ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã ‚Äì –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∑–∞–ø–∏—Å—å, –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ—ë –≤ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –Ω–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è columnGenerator –Ω–∞–¥ —ç—Ç–æ–π –∑–∞–ø–∏—Å—å—é
    newtyp ‚Äì –ø—Ä–æ–≤–µ—Ä—è–µ–º, –ø–µ—Ä–µ–¥–∞–Ω –ª–∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –µ—Å–ª–∏ –¥–∞ ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö columnGenerator

    –®–∞–≥–∏ –æ—Ç –ú–∞–∫—Å–∏–º–∞:
    TypeAsRecord ‚Äì –ø–æ–ª—É—á–∞–µ–º —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ –∏ –µ–≥–æ —Ç–∏–ø–µ
    NewTableType ‚Äì —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Ç–∏–ø —Ç–∞–±–ª–∏—Ü—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —É–∂–µ –æ–±–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö
    (–ú–∞–∫—Å–∏–º, –µ—â—ë —Ä–∞–∑ —Å–ø–∞—Å–∏–±–æ, —á–µ–≥–æ —è —Ç–∞–º –Ω–∞–≥–æ—Ä–æ–¥–∏–ª —á–µ—Ä–µ–∑ Table.Schema –∏ #shared ‚Äì –ø—Ä—è–º —Å—Ç—ã–¥–Ω–æ üò≥)

    –ù—É –∏ –æ—Å—Ç–∞–ª–æ—Å—å –Ω–µ–º–Ω–æ–≥–æ:
    to ‚Äì –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ Table.FromList: gen - –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ø–∏—Å–æ–∫ - –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è —ç—Ç–æ–º—É —É—Å–ª–æ–≤–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç, —Ç—Ä–µ—Ç—å–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —Å—Ä–∞–∑—É –ø–µ—Ä–µ–¥–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–µ
    (–∫—Ç–æ –∑–∞–±—ã–ª –∫–∞–∫ —Ç–∞–∫–æ–µ —á–∏—Ç–∞—Ç—å - [ ][to] - –≤—Å–ø–æ–º–∏–Ω–∞–µ–º)

    –í—Å—ë! –ó–∞–¥–∞—á–∫–∞ —Ä–µ—à–µ–Ω–∞. –ü—Ä–æ—Å—Ç–æ, —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ, –∏ —á—ë—Ä—Ç –ø–æ–±–µ—Ä–∏, —à—É—Å—Ç—Ä–æ!
    –ö—É—Ä–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ, —á–∏—Ç–∞–π—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é, –Ω–∞–¥–µ—é—Å—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —á–µ–ª–ª–µ–Ω–¥–∂–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ üòâ
    ]

[   List.Sort ‚Äì –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –µ—ë –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Sort, Value.Compare
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –°–µ–≥–æ–¥–Ω—è –æ–±—Å—É–¥–∏–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å–ø–∏—Å–∫–æ–≤. –ß–∏—Ç–∞–µ–º —Å–ø—Ä–∞–≤–∫—É:
    List.Sort(list as list, optional comparisonCriteria as any) as list 
    –°–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ ‚Äì –ø—Ä–æ—Å—Ç–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å )))
    List.Sort({8,3,4,11,6})
    List.Sort({"a","f","b","z","m"})
    –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–¥—ë—Ç –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –ø–æ—Ä—è–¥–æ–∫ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º
    List.Sort({"a","f","b","z","m"},Order.Descending)
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ - Order.Ascending –∏ Order.Descending ‚Äì —ç—Ç–æ —á–∏—Å–ª–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ 0 –∏ 1 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
    –ù—É, –û–ö. –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –µ—â—ë –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π –æ—Ç –æ–¥–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–ª—é—á –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏. –ó–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ? –î–∞ –≤–æ—Ç —Å—Ä–∞–≤–Ω–∏—Ç–µ
    List.Sort({"8","3","4","11","6"})
    List.Sort({"8","3","4","11","6"},(x)=>Number.From(x))
    –í –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ ¬´11¬ª –æ–∫–∞–∂–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ ‚Äì –æ–Ω–æ –∂–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1, –≤–æ –≤—Ç–æ—Ä–æ–º ‚Äì —Å–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
    –§—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ—Ä—è–¥–∫–æ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:
    List.Sort({"8","3","4","11","6"},{(x)=>Number.From(x), Order.Descending})
    –ó–∞—á–µ–º –≤–æ–æ–±—â–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á–∏—Å–ª–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ? –î–∞ –ø—Ä–æ—Å—Ç–æ –æ–±—ã—á–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —á—Ç–æ-—Ç–æ —Ç–∞–∫–æ–µ:
    List.Sort({"8 abc","3 cde","4 efg","11 ghi","6 ijk"},(x)=>Number.From(Text.BeforeDelimiter(x," ")))
    –ö–∞–∫ –≤–∏–¥–∏–º, —Ñ—É–Ω–∫—Ü–∏—è-—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.
    –ü–æ–∫–∞ –≤—Å—ë –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ, –Ω–æ —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äì –≤–º–µ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏ –ø–æ—Ä—è–¥–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç -1, 0 –∏–ª–∏ 1 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –º–µ–Ω—å—à–µ, —Ä–∞–≤–µ–Ω –∏–ª–∏ –±–æ–ª—å—à–µ –≤—Ç–æ—Ä–æ–≥–æ. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Value.Compare. –ü—Ä—è–º–æ–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫
    List.Sort({"a","f","b","z","m"},(x,y)=>Value.Compare(x,y))
    –ù–æ –∫–∞–∫ —Ç–µ–ø–µ—Ä—å –∑–∞–¥–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫? (—è —Ä–µ–¥–∫–æ –∫—Ä–∏—Ç–∏–∫—É—é —Å–ø—Ä–∞–≤–∫—É, –Ω–æ —ç—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ—Ç —Å–ª—É—á–∞–π):
    List.Sort({"a","f","b","z","m"},(x,y)=>Value.Compare(y,x))
    –ù–∞–¥–µ—é—Å—å, —Ä–∞–∑–Ω–∏—Ü—É –Ω–µ –Ω—É–∂–Ω–æ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å. –ù–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–¥–æ, —á—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ—Ç –Ω–∞—Å —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ -1, 0 –∏ 1; –∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ, –Ω–æ–ª—å –∏–ª–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ.
    List.Sort({8,3,4,11,6},(x,y)=>x-y)
    –¢–∞–∫ —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ä–∞–∑–Ω–∏—Ü–∞ –¥–≤—É—Ö —á–∏—Å–µ–ª —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ç–æ—Ä–æ–µ –∏–∑ –Ω–∏—Ö –±–æ–ª—å—à–µ), –∞ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
    List.Sort({8,3,4,11,6},(x,y)=>y-x)
    –° –¥—Ä–æ–±–Ω—ã–º–∏ –∫–æ–¥ —á—É—Ç—å –Ω–∞–ø—Ä—è–∂–Ω–µ–µ
    List.Sort({8.2,3.1,4.6,11.4,6.9},(x,y)=>Number.Sign(y-x))
    –¢—É—Ç –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–Ω–∞–∫ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã - —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ —á–µ–º Value.Compare, –ø—Ä–∞–≤–¥–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º –æ–±—ã—á–Ω—ã–π Order.Descending. –¢–æ–≥–¥–∞ –∑–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ? –ù—É –≤–æ—Ç –±—ã–ª –≤ —á–∞—Ç–µ –ø—Ä–∏–º–µ—Ä (–∑–¥–µ—Å—å —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π):
    let 
    f=(x,y)=>[g=(x)=>List.Transform(Text.Split(Text.BeforeDelimiter(x," "),"."),Number.From),
                a=g(x),
                b=g(y),
                c= if a{0}=b{0} then a{1}-b{1} else a{0}-b{0}
            ][c]
    in 
    List.Sort({"1.6 abc","3.3 cde","3.12 efg","11.2 ghi","1.24 ijk"},f)
    –í–æ-–ø–µ—Ä–≤—ã—Ö, –∫–∞–∫ —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å - —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—ã–Ω–æ—Å–∏–º –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –î–∞–ª–µ–µ, —á—Ç–æ —Ç—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç - –ø–æ–ª—É—á–∏–ª–∏ –Ω–æ–º–µ—Ä –ø—É–Ω–∫—Ç–∞, –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ —á–∏—Å–ª–æ –¥–æ —Ç–æ—á–∫–∏ –∏ –ø–æ—Å–ª–µ, –ø—Ä–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —á–∏—Å–ª–∞ –¥–æ —Ç–æ—á–∫–∏, –∞ –µ—Å–ª–∏ –æ–Ω–∏ —Ä–∞–≤–Ω—ã ‚Äì —á–∏—Å–ª–∞ –ø–æ—Å–ª–µ —Ç–æ—á–∫–∏. –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–∞–¥–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–µ –±—ã—Å—Ç—Ä–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –∫—É—á—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (—Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π). –ì–æ—Ä–∞–∑–¥–æ –ª—É—á—à–µ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤—Å—ë –≤ —Ç–∞–±–ª–∏—Ü—É –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–µ –ø–æ –¥–≤—É–º —Å—Ç–æ–ª–±—Ü–∞–º. –ù–æ –µ—Å–ª–∏ –≤–∞–º –≤—Å—ë –∂–µ –Ω—É–∂–µ–Ω —Å–ø–∏—Å–æ–∫ ‚Äì —Å–¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏:
    let 
    f=(x)=>[g=(y)=>List.Transform(Text.Split(Text.BeforeDelimiter(y," "),"."),Number.From)&{y},//—Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –Ω–∞ –≤—ã—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ {—á–∏—Å–ª–æ –¥–æ —Ç–æ—á–∫–∏,—á–∏—Å–ª–æ –ø–æ—Å–ª–µ —Ç–æ—á–∫–∏, –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ}
            a = Table.FromList(x,g,{"a","b","c"}),//—Å–æ–±—Ä–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É
            b = Table.Sort(a,{"a", "b"})[c]//–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø–æ a –∏ b, –∞ –Ω–∞ –≤—ã—Ö–æ–¥ –ø–æ–¥–∞–ª–∏ c
        ][b]
    in 
    f({"1.6 abc","3.3 cde","3.12 efg","11.2 ghi","1.24 ijk"})
    –ö–∞–∫-—Ç–æ —Ç–∞–∫, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–∂–Ω–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É, –Ω–æ Value.Compare ‚Äì –Ω–µ –ª—É—á—à–∏–π –≤—ã–±–æ—Ä. –ï—Å—Ç—å –¥–æ—Å—Ç–æ–π–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ —è –∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª.
    ]

[   #–ì–æ—Å—Ç–µ–≤–æ–π–¢–∞–Ω–∫ - –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç @MaximZelensky

    –î–æ–ø–æ–ª–Ω—é –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ø–æ—Å—Ç–∞ –ø—Ä–æ List.Sort –≤–æ—Ç —Ç–∞–∫–∏–º:
        List.Sort(
            {
            "–ê–ª–µ–Ω–∞", 
            "–ê–õ–ï–ù–ê", 
            "–ê–õ–Å–ù–ê", 
            "–ê–ª—ë–Ω–∞"
            } 
        )

    –û–±—ã—á–Ω–æ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã —Å—Ç–∞—Ä—à–µ, —á–µ–º —Å—Ç—Ä–æ—á–Ω—ã–µ, –∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–µ –ï –∏–¥—ë—Ç –ø–µ—Ä–µ–¥ –Å, –ø–æ—ç—Ç–æ–º—É –º—ã –æ–∂–∏–¥–∞–µ–º —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:
        {"–ê–õ–ï–ù–ê", "–ê–õ–Å–ù–ê", "–ê–ª–µ–Ω–∞",  "–ê–ª—ë–Ω–∞"}

    –û–¥–Ω–∞–∫–æ PQ —Å—á–∏—Ç–∞–µ—Ç –ø–æ-–¥—Ä—É–≥–æ–º—É:
    {
    "–ê–õ–Å–ù–ê",
    "–ê–õ–ï–ù–ê",
    "–ê–ª–µ–Ω–∞",
    "–ê–ª—ë–Ω–∞"
    }
    –ö–∞–∫ –≤–∏–¥–∏–º, –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —Å–ª–æ–≤–∞ —Å—Ç–æ—è—Ç –≤ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è - —Å–æ—Å—Ç–∞–≤–∏—Ç–µ–ª–∏ –∫–æ–¥–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã (–≥–¥–µ —Å–∏–º–≤–æ–ª—É —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω —á–∏—Å–ª–æ–≤–æ–π –∫–æ–¥) –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã —Å–Ω–∞—á–∞–ª–∞ –∑–∞–±—ã–ª–∏ –ø—Ä–æ –±—É–∫–≤—É –Å, –∏ –∑–∞—Ç–µ–º –≤ —Ü–µ–ª—è—Ö –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (—á—Ç–æ–±—ã –Ω–µ –ø–æ—Ä—É—à–∏—Ç—å —É–∂–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ —Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã –ü–û) –µ–µ –ø—Ä–∏—à–ª–æ—Å—å –≤—Å—Ç–∞–≤–ª—è—Ç—å –Ω–∞ —Å–≤–æ–±–æ–¥–Ω—ã–µ –º–µ—Å—Ç–∞ - –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –±—ã—Ç—å —è–≤–Ω–æ —Å—Ç–∞—Ä—à–µ, —á–µ–º —Å—Ç—Ä–æ—á–Ω–∞—è –±—É–∫–≤–∞, –Ω–æ –º–µ—Å—Ç–∞ –º–µ–∂–¥—É –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –∏ —Å—Ç—Ä–æ—á–Ω—ã–º–∏ –≤ –∫–∏—Ä–∏–ª–ª–∏—Ü–µ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å. –ü–æ—ç—Ç–æ–º—É –∑–∞–≥–ª–∞–≤–Ω—É—é "–Å" –≤–ø–∏—Ö–Ω—É–ª–∏ –¥–æ "–ê", –∞ —Å—Ç—Ä–æ—á–Ω—É—é "—ë" - –ø–æ—Å–ª–µ "—è". –≠—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏ —É–∂–µ –¥–µ—Å—è—Ç–∫–∏ –ª–µ—Ç –∏ –Ω–∏–∫—Ç–æ –Ω–∏—á–µ–≥–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ –±—É–¥–µ—Ç.
    –í —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ç–∞–∫–∏–º–∏ —Ç–æ–Ω–∫–æ—Å—Ç—è–º–∏ –º–æ–∂–Ω–æ –ø—Ä–µ–Ω–µ–±—Ä–µ—á—å, –æ–¥–Ω–∞–∫–æ –¥–∞–≤–∞–π—Ç–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –µ–∂–µ–π, —É–∂–µ–π –∏ –∞—Ä–±—É–∑—ã:
    = List.Sort( {"–ê—Ä–±—É–∑", "–Å–∂", "–µ–∂–∏—Ö–∞", "—ë–∂–∏–∫", "–µ–∂–∏—â–µ", "—É–∂–∏–∫", "–£–∂" })
    –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —É–∂–µ –Ω–µ —Ç–∞–∫–∏–º –ø—Ä–∏—è—Ç–Ω—ã–º:
    {
    "–Å–∂",
    "–ê—Ä–±—É–∑",
    "–£–∂",
    "–µ–∂–∏—Ö–∞"
    "–µ–∂–∏—â–µ"
    "—É–∂–∏–∫",
    "—ë–∂–∏–∫"
    }
    –ü–æ–ø—ã—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–¥–æ–≤ —Å–∏–º–≤–æ–ª–æ–≤ –∑–¥–µ—Å—å –≤–æ–∑–º–æ–∂–Ω–∞ (–∫—Ç–æ —Å–º–µ–ª—ã–π - –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º), –Ω–æ –≤–µ—Å—å–º–∞ –≥—Ä–æ–º–æ–∑–¥–∫–∞ –∏, –ø–æ–¥–æ–∑—Ä–µ–≤–∞—é, –º–µ–¥–ª–µ–Ω–Ω–∞ (–≤–µ–¥—å –Å/—ë –º–æ–∂–µ—Ç –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —Å—Ç—Ä–æ–∫–∏, –∑–Ω–∞—á–∏—Ç, —Å–≤–µ—Ä–∫—É –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ).

    –û—Ç—á–∞—Å—Ç–∏ —Å–ø–∞—Å–µ–Ω–∏–µ –ª–µ–∂–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏-–∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä–µ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PQ: Comparer.FromCulture. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç–æ–∂–µ –∏–º–µ–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –Ω–æ —Å–æ–≤—Å–µ–º –Ω–µ —Ç–µ, —á—Ç–æ Value.Compare:

    * —É–∫–∞–∑–∞–Ω–∏–µ –ª–æ–∫–∞–ª–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ .Net Framework (–Ω–∞–ø—Ä–∏–º–µ—Ä, "ru-ru")
    * –ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä —Å–∏–º–≤–æ–ª–æ–≤ –ø—Ä–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω —Ä–∞–≤–µ–Ω false

    –ê —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ - –Ω–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è-—Å—Ä–∞–≤–Ω–∏–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–∫–∞–∫ Value.Compare –∏–ª–∏ –≤–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è).
    –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ —Å —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –≤—ã–≥–ª—è–¥–∏—Ç –≤–æ—Ç —Ç–∞–∫:

    = List.Sort( {"–ê—Ä–±—É–∑", "–Å–∂", "–µ–∂–∏—Ö–∞", "—ë–∂–∏–∫", "–µ–∂–∏—â–µ", "—É–∂–∏–∫", "–£–∂" }, Comparer.FromCulture("ru-ru"))

    /*
    {
    "–ê—Ä–±—É–∑",
    "–Å–∂",
    "—ë–∂–∏–∫"
    "–µ–∂–∏—Ö–∞",
    "–µ–∂–∏—â–µ",
    "–£–∂",
    "—É–∂–∏–∫"
    }
    */

    –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ:

    * –≤ —Ä—É—Å—Å–∫–æ–π –ª–æ–∫–∞–ª–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–¥—ë—Ç –ø–æ —Ç–∞–∫–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É: –ê, –∞, –ë, –±, .... , –ï, –µ, –Å, —ë, , ... –Ø, —è.
    * –ü–æ—á–µ–º—É-—Ç–æ –Å —Å—Ç–∞—Ä—à–µ, —á–µ–º –ï, –Ω–æ —Ö–æ—Ç—è –±—ã –º–ª–∞–¥—à–µ, —á–µ–º –î. (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –∏ –¥–æ–≥–∞–¥–∫–∏ –ø–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É - –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö)
    ]

[   List.Accumulate ‚Äì –∫–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å ¬´–ø—É—Å—Ç–æ–π¬ª –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Accumulate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –î–∞–≤–Ω–æ –∑—Ä–µ–ª–æ –∏ –≤–æ—Ç –Ω–∞—à—ë–ª—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–≤–æ–¥.
    –ò—Ç–∞–∫, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –Ω–∞—à–µ–º—É List.Accumulate (–ø–æ–º–Ω–∏–º, —á—Ç–æ –º–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–æ –∏–Ω–æ–≥–¥–∞ —É–¥–æ–±–Ω—ã–π).
    List.Accumulate(list as list, seed as any, accumulator as function) as any

    –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì seed - –æ–ø–æ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º, –Ω–æ —Å–µ–≥–æ–¥–Ω—è –º—ã –µ–≥–æ —Ö–æ—Ç–∏–º —Å–¥–µ–ª–∞—Ç—å –ø—É—Å—Ç—ã–º (–∏–ª–∏ –Ω—É–ª–µ–≤—ã–º, –Ω–æ –Ω–µ null —á—Ç–æ–±—ã –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ).
    –î–æ–ø—É—Å—Ç–∏–º –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—á—ë—Ç–Ω—ã–µ —á–∏—Å–ª–∞ –≤ —Å–ø–∏—Å–∫–µ:
    List.Accumulate({1,2,3,4,5},0,(s,c)=>if Number.IsOdd(c) then s+c else s)
    –¢—É—Ç —É –Ω–∞—Å –ø—Ä–æ—Å—Ç–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞, –ø–æ—ç—Ç–æ–º—É seed - 0 - –ø—Ä–æ—Å—Ç–æ –Ω–æ–ª—å, —Å –∫–æ—Ç–æ—Ä—ã–º –≤—Å—ë —Å—É–º–º–∏—Ä—É–µ–º

    –°–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞, —á—å—è –¥–ª–∏–Ω–∞ –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ —Ç—Ä–µ–º —Å–∏–º–≤–æ–ª–∞–º
    List.Accumulate({"–ª—É—á—à–∏–µ","–∑–∞–ø—Ä–æ—Å—ã","–æ–ø—Ç–æ–º","–∏","–≤","—Ä–æ–∑–Ω–∏—Ü—É"},"",(s,c)=>if Text.Length(c)>2 then Text.Combine({s,c}," ") else s)
    –ù–∞ –≤—ã—Ö–æ–¥ –ø–æ–¥–∞—ë–º —Å—Ç—Ä–æ–∫—É, –ø–æ—ç—Ç–æ–º—É seed ‚Äì ""- –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—Å—ë –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ–º

    –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ ‚Äì –æ–ø—è—Ç—å –≤—ã–±–∏—Ä–∞–µ–º –Ω–µ—á—ë—Ç–Ω—ã–µ —á–∏—Å–ª–∞, –Ω–æ —Ç–µ–ø–µ—Ä—å —Å–ø–∏—Å–∫–æ–º:
    List.Accumulate({1,2,3,4,5},{},(s,c)=>if Number.IsOdd(c) then s&{c} else s)
    –ó–¥–µ—Å—å –æ–ø–æ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–ø–∏—Å–∫–æ–º, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –º—ã –≤—Å—ë –¥–æ–±–∞–≤–ª—è–µ–º, –ø–æ—ç—Ç–æ–º—É seed ‚Äì {} ‚Äì –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ (—Ç–∞–∫–∂–µ –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Å–ø–∏—Å–∫—É ‚Äì —Å–∫–æ–±–æ—á–∫–∏ —Ç–∞–º –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫)

    –ê –≤–æ—Ç —Å–∏—Ç—É–∞—Ü–∏—è c –∑–∞–ø–∏—Å—è–º–∏ (—Å –Ω–µ–π —Å—Ç–∞–ª–∫–∏–≤–∞–µ–º—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ, –∫–æ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª–µ–π –∏–¥—É—Ç –∫–∞–∫ –æ–¥–Ω–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ):
    List.Accumulate({{"–¥–ª–∏–Ω–∞",100},{"—à–∏—Ä–∏–Ω–∞",50},{"–≤—ã—Å–æ—Ç–∞",10}},[],(s,c)=>Record.AddField(s,c{0},c{1}))
    –ù–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–ø–æ–ª–µ ‚Äì –∑–Ω–∞—á–µ–Ω–∏–µ), –Ω–æ –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ö–æ—Ç–∏–º –∑–∞–ø–∏—Å—å ‚Äì –∑–Ω–∞—á–∏—Ç seed ‚Äì [ ] ‚Äì –ø—É—Å—Ç–∞—è –∑–∞–ø–∏—Å—å. –¢–∞–∫–∂–µ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –Ω–µ —á–µ—Ä–µ–∑ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é, –∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é (–ø—Ä–æ–±–ª–µ–º–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–π, –∫–æ—Ç–æ—Ä—É—é –æ–ø–∏—Å—ã–≤–∞–ª —Ä–∞–Ω–µ–µ). –ù—É –∏ –ø–æ–º–Ω–∏–º, —á—Ç–æ –ø—Ä–∏ –∞–∫–∫—É–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ —Å–ø–∏—Å–∫–æ–≤ ‚Äì c ‚Äì —ç—Ç–æ —Ç–æ–∂–µ —Å–ø–∏—Å–æ–∫ –∏ –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –æ—Ç–¥–µ–ª—å–Ω—ã–º –µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ.

    –ù—É –∏ –≤—Å—ë —ç—Ç–æ –≤—Ä–æ–¥–µ –∏ —Ç–∞–∫ –ø–æ–Ω—è—Ç–Ω–æ, –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏. –í—á–µ—Ä–∞ –≤ –º–∏—Ä—É –±—ã–ª –ø—Ä–∏–º–µ—Ä. –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω–æ–µ –¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ ‚Äì –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ –¥–∂–æ–∏–Ω —É–∂–µ –æ–ø–∏—Å—ã–≤–∞–ª –ü—É—Ö. –í–æ–ø—Ä–æ—Å —Ç–µ–ø–µ—Ä—å –≤ –¥—Ä—É–≥–æ–º ‚Äì –∞ –∫–∞–∫ —Å–¥–∂–æ–π–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü? –°–º–æ—Ç—Ä–∏–º –∫–æ–¥:
    let
    lst={"–ì–æ—Ä–æ–¥","–ì–æ–¥","–ü—Ä–æ–¥—É–∫—Ç"},
    f=(x)=> Excel.CurrentWorkbook(){[Name=x]}[Content],
    g=(x,y)=>Table.Join(x,{},f(y),{}),
    to = List.Accumulate(lst,#table({},{{}}),g)
    in
    to
    –ü–æ —à–∞–≥–∞–º:
    lst - —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü (–º–æ–∂–Ω–æ –µ–≥–æ –∏ –∑–∞–ø—Ä–æ—Å–æ–º –ø–æ–ª—É—á–∏—Ç—å, —è –≤ –∫—É—Ä—Å–µ, –Ω–æ –±—ã–ª–æ –±—ã –Ω–µ —Ç–∞–∫ –Ω–∞–≥–ª—è–¥–Ω–æ)
    f ‚Äì –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äì –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ (–æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞–º –º–æ–ª—á–∞—Ç—å! –º–æ–∂–Ω–æ –≤–æ–æ–±—â–µ –±–µ–∑ –∏–º—ë–Ω, –æ–¥–Ω–∏–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–≤ —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—É —Å–∞–º–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞... –î–ê –ú–û–ñ–ù–û –∏ –∑–∞–∫—Ä—ã–ª–∏ —Ç–µ–º—É)
    g ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ (–º—ã –∂–µ –ø–æ–º–Ω–∏–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–æ–∏—Ç –≤—ã–Ω–æ—Å–∏—Ç—å) ‚Äì —Ç—É—Ç –∫ —Ç–∞–±–ª–∏—Ü–µ x (–∫–æ–º—É —É–¥–æ–±–Ω–µ–µ ‚Äì –ø–∏—à–∏—Ç–µ s –∏–ª–∏ state ‚Äì —ç—Ç–æ –Ω–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ), –¥–∂–æ–π–Ω–∏—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ f(y) ‚Äì —Ç.–µ. —Ç–∞–±–ª–∏—Ü–∞ –∏–∑ —Ñ–∞–π–ª–∞ —Å –∏–º–µ–Ω–µ–º y
    to ‚Äì –Ω—É –∏ —Å–∞–º –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä ‚Äì —Å–º–æ—Ç—Ä–∏–º –Ω–∞ seed - #table({},{{}}) ‚Äì –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –ø—É—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Äì –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç—Ä–æ–∫ ‚Äì —ç—Ç–æ –Ω–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç - –º–Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–æ–≥–¥–∞ –º–Ω–æ–≥–æ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫ üòâ
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≤—Å—ë ‚Äì –∫ –ø—É—Å—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–∂–æ–π–Ω—è—Ç—Å—è –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ - –∑–∞–¥–∞—á–∫–∞ —Ä–µ—à–µ–Ω–∞.
    –¢–∞–∫ —á—Ç–æ –∞–∫–∫—É–º—É–ª–∏—Ä—É—è —á—Ç–æ-—Ç–æ —Å –Ω—É–ª—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ—Å—å —Å —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—ã—Ö–æ–¥–µ –∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π seed - —Ç–æ–≥–¥–∞ –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è.
    ]
    
[   LinearTrend ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç, –Ω–æ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –û—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –≤ —á–∞—Ç–µ –±—ã–ª –∑–∞–¥–∞–Ω –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ M.
    –û–Ω–∏ –µ—Å—Ç—å, –≤—Å–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ List: .Average, .Count, .Covariance, .Median, .Min, .Max, .Mode, .Modes –∏ .StandardDeviation. –ù–∞–±–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, –≤–ø–æ–ª–Ω–µ –¥–æ—Å—Ç–æ–π–Ω—ã–π, –Ω–æ —É–∂ –±–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –ø—Ä–æ –æ—Ü–µ–Ω–∫—É —Ç—Ä–µ–Ω–¥–æ–≤ ‚Äì –∞ –≤–æ—Ç –µ—ë –Ω–µ –ø–æ–¥–≤–µ–∑–ª–∏. –Ø –Ω–µ —Å–æ–±–∏—Ä–∞—é—Å—å –Ω–∏–∫–æ–≥–æ –º—É—á–∞—Ç—å –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä–æ–π –∏ —Ä–µ—à–µ–Ω–∏–µ–º –∑–∞–¥–∞—á–∏ –≤ –æ–±—â–µ–º –≤–∏–¥–µ –≤ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–æ—Ä–º–µ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–≤–µ–¥—É –≤–∞—Ä–∏–∞–Ω—Ç —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–Ω–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª—É—á–∞—è:
    LinearTrend = (x as list, y as list) as record =>//–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è y = a + b*x
    [   
        x2 = List.Transform(x,(y)=>y*y),
        y2 = List.Transform(y,(x)=>x*x),
        xy = List.Transform(List.Zip({x,y}),(x)=>x{0}*x{1}),
            
        n = List.Count(x),
        sumx = List.Sum(x),
        sumy = List.Sum(y),
        sumx2 = List.Sum(x2),
        sumy2 = List.Sum(y2),
        sumxy = List.Sum(xy),
        
        a = if n>2 then (sumx2*sumy-sumx*sumxy)/(n*sumx2- sumx*sumx) else y{0},//–û–¢–†–ï–ó–û–ö()
        b = if n >1 then (n*sumxy-sumx*sumy)/(n*sumx2- sumx*sumx) else 0,//–ù–ê–ö–õ–û–ù()
        syx = if n>2 then (sumy2-a*sumy-b*sumxy) else 0,
        sy = sumy2-sumy*sumy/n,
        s = if n >2 then Number.Sqrt(syx/(n-2)) else 0,//–°–¢–û–®YX()
        R2 = 1-syx/sy,//R^2 - —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—Ç, –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –µ—Å—Ç—å 
        r = Number.Sign(b)*Number.Sqrt(R2)//–ö–û–†–†–ï–õ()
    ][[n],[a],[b],[s],[R2],[r]]
    –ü–æ —à–∞–≥–∞–º:
    x,y ‚Äì –∞–±—Å—Ü–∏—Å—Å–∞ –∏ –æ—Ä–¥–∏–Ω–∞—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ ‚Äì —Å–ø–∏—Å–∫–∞–º–∏
    x2,y2,xy ‚Äì –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –Ω–∞–º —Ç—Ä–µ–±—É—é—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç—ã –ø–æ –æ–±–µ–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –∏ –ø–æ–ø–∞—Ä–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    n ‚Äì —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–≤–∑—è—Ç–æ –ø–æ –∞–±—Å—Ü–∏—Å—Å–µ, –≤ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–∏, —á—Ç–æ —Å–ø–∏—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏)
    sumx, sumy, sumx2, sumy2, sumxy ‚Äì —Å—É–º–º—ã ‚Äì –≤–µ–ª–∏—á–∏–Ω, –∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤, –ø–æ–ø–∞—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π
    a,b ‚Äì –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –∏ –Ω–∞–∫–ª–æ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ (–≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ö –∫ –∫–æ–¥—É –Ω–∞–∑–≤–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ Excel)
    syx ‚Äì –æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏
    sy ‚Äì —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
    s ‚Äì –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    R2 ‚Äì –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ (–æ–Ω —Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö, –µ–≥–æ –∂–µ –≤—ã—á–∏—Å–ª—è–µ—Ç –õ–ò–ù–ï–ô–ù())
    r ‚Äì –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ‚Äì –ø–æ—Å—á–∏—Ç–∞–Ω –∏–∑ R2, –ø—Ä–æ—Å—Ç–æ —á—Ç–æ–± –±—ã–ª–æ, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –æ–Ω ‚Äì –Ω–µ –Ω–∞–¥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π ‚Äì –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—é ‚Äì –æ–Ω–æ –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ, –ø–æ–≤–µ—Ä—å—Ç–µ

    –ù—É –∏ –≤—Å—ë ‚Äì –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ª—É—á–∞–µ–º –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏. –í—Ä–æ–¥–µ –≥—Ä–æ–º–æ–∑–¥–∫–æ, –Ω–æ –Ω–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ.
    –ï—Å–ª–∏ —Ç–µ–º–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞ ‚Äì –ø–∏—à–∏—Ç–µ –≤ –∫–∞–º–µ–Ω—Ç–∞—Ö, –±—É–¥–µ–º –¥–≤–∏–≥–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –ú.
    ]
    
[   Table.AddColumn –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ ‚Äì –ß–∞—Å—Ç—å 1 / #–ì–æ—Å—Ç–µ–≤–æ–π–¢–∞–Ω–∫ - –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç @MaximZelensky

    –ü–æ –º–æ—Ç–∏–≤–∞–º –∏ –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —á–µ–ª–ª–µ–Ω–¥–∂—É –ø–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—é Table.AddColumn

    –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ PQ –≤ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö Power Pivot –≤ Excel –∏–ª–∏ –≤ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö Power BI –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü –∏–º–µ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø (–∏–Ω–∞—á–µ –≤—Å–µ –Ω–µ—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –±—É–¥—É—Ç –≤–æ—Å–ø—Ä–∏–Ω—è—Ç—ã –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ, –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ).

    –û–∫, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –º—ã —Ä–µ—à–∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ —Å—Ç–æ–ª–±–µ—Ü —Å –∏–º–µ–Ω–µ–º "new" –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –µ–¥–∏–Ω–∏—á–∫–∞–º–∏. –ö–æ–≥–¥–∞ –º—ã —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å PQ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–¥ —Ç–∞–∫–æ–≥–æ –≤–∏–¥–∞: Table.AddColumn(TableName, "new", each 1). –ù–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –±—É–¥–µ—Ç –∏–º–µ—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö any - —Ç–æ –µ—Å—Ç—å –±—É–¥–µ—Ç –Ω–µ—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω. –¢–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è each 1 –Ω–µ –∏–º–µ–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ –∞–ø—Ä–∏–æ—Ä–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á—ë—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ - –¥–æ—Ä–æ–≥–æ –∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.
    –ù–æ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞–º –≤–∞–∂–µ–Ω —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (–º—ã —Ö–æ—Ç–∏–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —ç—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü –≤ –º–æ–¥–µ–ª—å)? –ú–æ–∂–Ω–æ –ª–∏ —Å—Ä–∞–∑—É —É–∫–∞–∑–∞—Ç—å, –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ —ç—Ç–æ—Ç –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü? –ú—ã –∂–µ –∑–Ω–∞–µ–º –µ–≥–æ –∑–∞—Ä–∞–Ω–µ–µ (1 —ç—Ç–æ —è–≤–Ω–æ —á–∏—Å–ª–æ, –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —É –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—Ç). –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤.

    –°–ø–æ—Å–æ–± 0
    –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —à–∞–≥–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–æ–ª–±—Ü–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –≤ –∫–æ–¥–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ Table.TransformColumnTypes - –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä—è–º–æ–π, –Ω–æ —Ä–∞—Å—Ç–æ—á–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –∫—Ä–æ–º–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –Ω–µ–º –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –Ω–∞–º–∏ —Ç–∏–ø—É, –∏ –µ—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–∏–ø –Ω–µ–ª—å–∑—è, –ø–æ—è–≤–∏—Ç—Å—è –æ—à–∏–±–∫–∞ —è—á–µ–π–∫–∏. –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º—ã —É–≤–∏–¥–∏–º —É–∂–µ –Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö –æ–±—ä–µ–º–∞—Ö. –û–¥–Ω–∞–∫–æ –µ—Å—Ç—å —Å–ª—É—á–∞–∏ (–∑–∞ —Ä–∞–º–∫–∞–º–∏ —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞), –∫–æ–≥–¥–∞ —Ç–∞–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –∏ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –ø–æ–ª–µ–∑–Ω–∞.

    –°–ø–æ—Å–æ–± 1
    –ú—ã –º–æ–∂–µ–º —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä. –ù–∞–ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å –µ–¥–∏–Ω–∏—á–∫–∞–º–∏ –≤–æ—Ç —Ç–∞–∫ (–Ω–µ —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ, –∞ –≤ —Å—Ç—Ä–æ–∫–µ —Ñ–æ—Ä–º—É–ª):
    (row) as number => 1
    –ù–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç —Ç–∏–ø number - –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–∫ —Å–∫–∞–∑–∞–Ω–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ ( as number). –ò –¥–∞–∂–µ –±–æ–ª–µ–µ —Ç–æ–≥–æ - –µ—Å–ª–∏ –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º –æ–±—Ö–∏—Ç—Ä–∏—Ç—å PQ –∏ –≤–º–µ—Å—Ç–æ –µ–¥–∏–Ω–∏—á–µ–∫ –≤–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–∞–∫–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É —è—á–µ–π–∫–∏:
    (row) as number => "1" // Expression.Error: –ù–µ —É–¥–∞–µ—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ "1" –≤ —Ç–∏–ø Number
    –¢–∞–∫ —á—Ç–æ, –µ—Å–ª–∏ –º—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞, –º—ã –º–æ–∂–µ–º —Å–º–µ–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥, –∏ –¥–∞–∂–µ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏.
    –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–µ—Ä–≤—ã–π —Å–ø–æ—Å–æ–± –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è ‚Äì –∫–∞–∫–∏–µ –∏ –∫–∞–∫ —Å –Ω–∏–º–∏ –±–æ—Ä–æ—Ç—å—Å—è –±—É–¥–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ –≤–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏.
    ]
    
[   Table.AddColumn –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ ‚Äì –ß–∞—Å—Ç—å 2 / #–ì–æ—Å—Ç–µ–≤–æ–π–¢–∞–Ω–∫ - –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç @MaximZelensky

    –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ - –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å

    –°–ø–æ—Å–æ–± 2
    –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–µ—Ä–≤—ã–π —Å–ø–æ—Å–æ–± –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è - –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ç–∏–ø–∞ as —Ç–æ–ª—å–∫–æ —Å –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ - —Ç–∞–∫–∏–º–∏ –∫–∞–∫ text, number, date –∏ —Ç.–ø., –ª–∏–±–æ –∏—Ö nullable –≤–µ—Ä—Å–∏—è–º–∏: nullable text, nullable number –∏ —Ç.–ø.
    –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –µ–¥–∏–Ω–∏—á–∫–∞ - –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ, –∞ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –º—ã –Ω–µ –º–æ–∂–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ as Int64.Type - —Ç–∞–∫–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É —à–∞–≥–∞ Expression.SyntaxError: –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ Int64.Type - —ç—Ç–æ –Ω–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π (–±–∞–∑–æ–≤—ã–π) —Ç–∏–ø, –∞ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π —Ñ–∞—Å–µ—Ç (–ø–æ–¥—Ç–∏–ø), —Å –∫–æ—Ç–æ—Ä—ã–º –Ω–µ —Ö–æ—á–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä as.
    –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å 4-–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ Table.AddColumn - —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞:
    Table.AddColumn(TableName, "new", each 1, Int64.Type)
    –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —É–∫–∞–∑–∞–ª–∏ –ª–∏ –º—ã, –∫–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—É–∫–Ω—Ü–∏—è-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –ø–æ–ª—É—á–∏—Ç —Ç–æ—Ç —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑–∞–Ω –≤ 4-–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ - —Ü–µ–ª–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
    –ü—Ä–∏ —ç—Ç–æ–º –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å:
    * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ —Ä–µ–∞–ª—å–Ω–æ–º—É —Ç–∏–ø—É –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –Ω–∞ —ç—Ç–∞–ø–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ (–Ω–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —è—á–µ–π–∫–∏, –Ω–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —à–∞–≥–∞). –ú—ã –º–æ–∂–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å Table.AddColumn(TableName, "new", each 1, type text), –∏ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–∏–ø "–¢–µ–∫—Å—Ç", –Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 1 –≤ "1" –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ.
    * –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –≤ –º–æ–¥–µ–ª—å (–∫–∞–∫ –º–∏–Ω–∏–º—É–º –≤ Power BI), —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ, –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –µ–≥–æ —è—á–µ–π–∫–∞—Ö, –∏ –º—ã –æ—á–µ–Ω—å –ª–µ–≥–∫–æ –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–≥—Ä–æ–º–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.
    –ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 4-–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω—É–∂–Ω–æ –æ—á–µ–Ω—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ - —Ç–æ–ª—å–∫–æ –±—É–¥—É—á–∏ —É–≤–µ—Ä–µ–Ω–Ω—ã–º, —á—Ç–æ —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏–π –≤ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–º—É.

    –£ –≤—Ç–æ—Ä–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –µ—Å—Ç—å —Ç–∞–∫–∂–µ –æ–¥–Ω–æ –≤–∞–∂–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ - –º—ã –º–æ–∂–µ–º –∑–∞–¥–∞–≤–∞—Ç—å —Ç–∞–º –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ –∏–ª–∏ —Ñ–∞—Å–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã, –Ω–æ –∏ —Å–ª–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ —Ç–∏–ø—ã.
    –ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü —Å–æ —Å–ø–∏—Å–∫–æ–º –≥–æ–¥–æ–≤ –∏ –º—ã —Ö–æ—Ç–∏–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–¥–∞ —Å–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–∫–∏ "–ø–µ—Ä–≤—ã—Ö —á–∏—Å–µ–ª –º–µ—Å—è—Ü–µ–≤", —á—Ç–æ–±—ã –∑–∞—Ç–µ–º —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —ç—Ç–∏ —Å–ø–∏—Å–∫–∏ –≤ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏:
    YearsTable = #table(type table [Year=Int64.Type], List.Zip({{2019, 2020, 2021}})),
    AddMonths = Table.AddColumn(YearsTable, "MonthStart", each List.Transform({1..12}, (m) as date =>#date([Year], m, 1)))
    ExpandMonths = Table.ExpandListColumn(AddMonths, "MonthStart")
    –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –º—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª–∏ –ø—Ä–æ–ø–∏—Å–∞—Ç—å as date –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, —ç—Ç–æ –Ω–∞–º –Ω–µ –æ—Å–æ–±–æ –ø–æ–º–æ–≥–ª–æ - –ø–æ—Å–ª–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∏–º–µ–µ—Ç —Ç–∏–ø any - —Ç–∞–∫–æ–π —Ç–∏–ø —É –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ each. –ï—Å–ª–∏ –º—ã –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª–∏ –±—ã –≤–º–µ—Å—Ç–æ each –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (row)=> (–ø–æ –ø–µ—Ä–≤–æ–º—É —Å–ø–æ—Å–æ–±—É –≤—ã—à–µ), —Ç–æ –º–∞–∫—Å–∏–º—É–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –±—ã–ª –±—ã –ø–æ–∑–≤–æ–ª–µ–Ω - (row) as list =>. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ç–∏–ø –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ (–¥–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è) –ø–æ–ª—É—á–∏–ª –±—ã —Ç–∏–ø "—Å–ø–∏—Å–æ–∫" (—ç—Ç–æ –±—É–¥–µ—Ç –∑–∞–º–µ—Ç–Ω–æ –ø–æ –∏–∫–æ–Ω–∫–µ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–∞), –Ω–æ –Ω–∞ —ç—Ç–æ–º –∏ –≤—Å—ë - –ø–æ—Å–ª–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –º—ã –ø—ã—Ç–∞–ª–∏—Å—å –∑–∞–¥–∞—Ç—å —Ç–∏–ø date, –Ω–æ–≤—ã–π (—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π) —Å—Ç–æ–ª–±–µ—Ü –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–∏–ø any.

    –ó–¥–µ—Å—å –Ω–∞ –≤—ã—Ä—É—á–∫—É –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–æ—Ç —Å–∞–º—ã–π –°–ø–æ—Å–æ–± 2 - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 4-–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
    AddMonths = Table.AddColumn(YearsTable, "MonthStart", each List.Transform({1..12}, (m) as date =>#date([Year], m, 1)), type {date})
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ —Å–ª–æ–∂–Ω—ã–π —Å–æ—Å—Ç–∞–≤–Ω–æ–π —Ç–∏–ø type {date}, –º—ã —è–≤–Ω–æ —É–∫–∞–∑–∞–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–µ, —á—Ç–æ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–∞—Ç. –¢–µ–ø–µ—Ä—å –¥–∞–∂–µ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ —Å—Ç–æ–ª–±–µ—Ü —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ "–¥–∞—Ç—ã".
    ]
    
[   Table.Max ‚Äì –∏–ª–∏ –º–Ω–æ–≥–æ–ª–∏–∫–∏–π –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Max

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –°–µ–≥–æ–¥–Ω—è –≤ —á–∞—Ç–µ –≤—Å–ø–ª—ã–ª –≤–æ–ø—Ä–æ—Å –ø—Ä–æ Table.Max ‚Äì –∏ –≤ –ª–∏—á–∫–µ —Å–ø—Ä–æ—Å–∏–ª–∏ –∑–∞—á–µ–º —è –µ–µ —Ç–∞–∫ —Å—Ç—Ä–∞–Ω–Ω–æ –ø–∏—à—É. –û—Ç–≤–µ—Ç –ø—Ä–æ—Å—Ç ‚Äì –º–Ω–æ–≥–∏–µ –≤–µ—â–∏ —è –ø–æ –ø—Ä–∏–≤—ã—á–∫–µ –ø–∏—à—É —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏. –ù–æ –≤–æ—Ç –∫–∞–∫ –ú–û–ñ–ù–û –ø–∏—Å–∞—Ç—å, –¥—É–º–∞—é —Å—Ç–æ–∏—Ç –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ.
    –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ç–µ–Ω–¥:
    let
    from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("fdJJisMwEIXhq4haG+MqyXLiqzS9yNTzvA25e0RZtuu5kSCLYPh4Tv56uNKBRm7oSOO+oZN+P9NI0om4ThwzNXRJDzpu0yc9ZnegW2PcTp1snGTHfnFHdMO0B4Ps2M+D0nKGJ4RRYbDOOw6zC4s7o+vV9RvXZydxedELuqAubt4zZue7Nk2qe0Ln1Q2FvTTGMrlndKJuV9gzIV7Qsbp9Yc+EeJ2dlMLbvbXDG7opvC/9vrXDO7ocfigMmhAfCGN10IT4RNf/Pxj8Q+cQX+hC9WBMiG90vnowJsQPOqkfzBriFx3XD2YN8Ue3xzs="),Compression.Deflate))),
    f = "a",
    to = Table.Max(from,f)
    in
    to
    from ‚Äì –∏—Å—Ö–æ–¥–Ω–∏–∫
    f ‚Äì —É—Å–ª–æ–≤–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º–∞
    to ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç Table.Max (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –Ω–∞ –≤—ã—Ö–æ–¥ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –∑–∞–ø–∏—Å—å ‚Äì —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Å –º–∞–∫—Å–∏–º—É–º–æ–º –ø–æ –Ω–∞—à–µ–º—É —É—Å–ª–æ–≤–∏—é)
    –î–∞–ª–µ–µ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –±—É–¥—É –º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —à–∞–≥ f .
    –ò—Ç–∞–∫, –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –≤ –∫–æ–¥–µ –≤—ã—à–µ, —á—Ç–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ –º–æ–∂–Ω–æ –≤—ã–Ω–æ—Å–∏—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ –∏ —Å–ø–∏—Å–∫–∏ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –¥–∞ –≤–æ–æ–±—â–µ –≤—Å—ë, —á—Ç–æ —É–≥–æ–¥–Ω–æ (–≤—ã–Ω–µ—Å–µ–Ω–∏–µ —à–∞–≥–æ–≤ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å —Ç—É—Ç).
    f = "a" ‚Äì –ø—Ä–æ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞, –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–º –∑–∞–ø–∏—Å—å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ –¥–∞–Ω–Ω–æ–º—É –ø–æ–ª—é, –ø—Ä–∏—á—ë–º ‚Äì –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å (–≤ –ø—Ä–∏–º–µ—Ä–µ —Ç–∞–∫–∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ).
    –î–Ω—ë–º —è –Ω–∞–ø–∏—Å–∞–ª –ø–æ-–¥—Ä—É–≥–æ–º—É:
    f = (x)=>x[a]
    —Ç.–µ. –Ω–∞–ø–∏—Å–∞–ª —Ñ—É–Ω–∫—Ü–∏—é ‚Äì –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –Ω–∞ –≤—Ö–æ–¥ –ø–æ—Å—Ç—É–ø–∞–µ—Ç —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã ‚Äì –∑–∞–ø–∏—Å—å, –∏ –º—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—Å–∏–º –≤–∑—è—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ ‚Äì —Ç.–µ. —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Ç–∞–∫–∏–º –∂–µ. –ó–∞—á–µ–º —Ç–∞–∫–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏? –î–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü "e" ‚Äì —Ö–æ—Ç–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É, –∞ –æ–Ω–∞ —Å–ø—Ä—è—Ç–∞–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ, —Ä–µ—à–µ–Ω–∏–µ —Ä–∞–∑—É–º–µ–µ—Ç—Å—è:
    f = (x)=> Date.From(Text.BeforeDelimiter(x[e]," "))
    —Ç.–µ. –º—ã —É–∂–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ, –Ω–æ –∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º —Å –Ω–∏–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ‚Äì –≤—ã–Ω–∏–º–∞–µ–º –¥–∞—Ç—É (–º–æ–∂–Ω–æ –∫–æ–Ω–µ—á–Ω–æ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–æ—Ä—É–¥–∏—Ç—å –¥–æ–ø—Å—Ç–æ–ª–±–µ—Ü –∏ –ø–æ—Ç–æ–º –±—Ä–∞—Ç—å –º–∞–∫—Å–∏–º—É–º –ø–æ –Ω–µ–º—É, –∞ –º–æ–∂–Ω–æ –≤–æ—Ç —Ç–∞–∫ —Å—Ä–∞–∑—É)
    –ù—É –æ–∫, –∞ —á—Ç–æ –µ—Å–ª–∏ –Ω–∞—Å –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—ã–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏? –•–æ—Ç–∏–º –º–∞–∫—Å–∏–º—É–º –ø–æ "a", –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π ‚Äì –º–∞–∫—Å–∏–º—É–º –ø–æ "b" –∏ —Ç.–¥. –î–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:
    f = {"a","b","c"}
    —Ç.–µ. –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤, –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞–∫—Å–∏–º—É–º. –≠—Ç–æ –≤–∞–∂–Ω–æ -
    f = {"a","c","b"}
    –¥–∞—Å—Ç —É–∂–µ –¥—Ä—É–≥–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ø–æ–∏–≥—Ä–∞–π—Ç–µ—Å—å —Å –ø—Ä–∏–º–µ—Ä–æ–º).

    –ù—É –∏ –≤–µ—Ä–Ω–µ–º—Å—è –∫ —Ñ—É–Ω–∫—Ü–∏—è–º ‚Äì –∞ —á—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–Ω—É—Ç—å –¥–∞—Ç—É –∏–∑ "e", –∞ –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤–∑—è—Ç—å –º–∞–∫—Å–∏–º—É–º –ø–æ —Å—Ç–æ–ª–±—Ü—É "c"? –î–∞ –∫–∞–∫ –±—ã —Ç–æ–∂–µ –Ω–µ—Å–ª–æ–∂–Ω–æ:
    f = {(x)=> Date.From(Text.BeforeDelimiter(x[e]," ")),"c"}
    –¢.–µ. —Å–ø–∏—Å–æ–∫ –º–æ–∂–µ—Ç —Å–æ—Å—Ç–æ—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤, –Ω–æ –∏ –≤–∫–ª—é—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –µ—Å–ª–∏ –≤ —Å–ø—Ä–∞–≤–∫–µ –ø—Ä–æ –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–æ as any ‚Äì —ç—Ç–æ —Å—Ç–æ–∏—Ç –∫–æ–≤—ã—Ä–Ω—É—Ç—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å —Å–µ–±–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –∂–∏–∑–Ω—å )))
    ]
    
[   TableToBinaryText, TableFromBinaryText ‚Äì –∏–ª–∏ —Ç—É–¥–∞ –∏ –æ–±—Ä–∞—Ç–Ω–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Json, Binary –∏ —Ç.–ø.

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —Å–µ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤ –ø—Ä–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ—è–≤–∏–ª—Å—è –ø—Ä–∏–º–µ—Ä –∏—Å—Ö–æ–¥–Ω–∏–∫–∞ –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ —Å—Ç—Ä–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–∞: "i65Wiik1MDFJAZNGINI4VcnKUAcsbJwGFjaACIPZhqgKjbAotACTyWDSFCKuZGUMUQjVCVEINss4CaHJxAxMJilZmdTGAgA="
    –í—Ä–æ–¥–µ —á—Ç–æ —ç—Ç–æ, –∫–∞–∫ –∏ –æ—Ç–∫—É–¥–∞ —É–∂–µ –æ–±—Å—É–¥–∏–ª–∏ –≤ —á–∞—Ç–µ, –Ω–æ —Ä–∞–∑ –≤–æ–ø—Ä–æ—Å—ã –≤ –ª–∏—á–∫—É –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è –∑–∞–∫—Ä–µ–ø–ª—é –∑–¥–µ—Å—å.
    –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
    –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –ø–æ—Å—Ç –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ –ø—Ä–∏–º–µ—Ä–æ–º —Ç–∞–±–ª–∏—Ü—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ —Ö–æ—Ç—è –±—ã –¥–µ—Å—è—Ç–∫–æ–º —Å—Ç—Ä–æ–∫. –ü–∏—Å–∞—Ç—å —Ç–∞–∫–æ–µ –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Table.FromRecords) –¥–æ–ª–≥–æ, –º—É—Ç–æ—Ä–Ω–æ –∏ –≤–æ–æ–±—â–µ –º–æ–∂–µ—Ç –Ω–µ –≤–ª–µ–∑—Ç—å –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∞ –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—Ç—å —Ñ–∞–π–ª-–ø—Ä–∏–º–µ—Ä —Ç–∞–∫–∂–µ –Ω–µ –æ—á–µ–Ω—å ‚Äì —É –Ω–∞—Å –∑–¥–µ—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Ç–æ–ª—å–∫–æ, –¥–∞ –∏ –Ω–µ —Å—Ç–æ–ª—å–∫–æ excel, —Å–∫–æ–ª—å–∫–æ pbi, –ø–ª—é—Å —Å–∫–∞—á–∏–≤–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ —Ä–∞–±–æ—Ç–µ –Ω–µ —É –≤—Å–µ—Ö –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å
    –õ–æ–≥–∏–∫–∞ —Ä–µ—à–µ–Ω–∏—è
    –ß—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–Ω–∏–º–∞–ª–∏ –∫—É—á—É —Å–∏–º–≤–æ–ª–æ–≤ –∏—Ö —Å–ª–µ–¥—É–µ—Ç —Å–∂–∞—Ç—å. PQ —É–º–µ–µ—Ç —Å–∂–∏–º–∞—Ç—å —Ç–æ–ª—å–∫–æ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏, –∑–Ω–∞—á–∏—Ç –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫. –ù–∞–ø—Ä—è–º—É—é —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å –Ω–µ–ª—å–∑—è, –ø–æ—ç—Ç–æ–º—É —Ç–∞–±–ª–∏—Ü—É –Ω–∞–¥–æ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò–∑ –≤—Å–µ–≥–æ –∏–º–µ—é—â–µ–≥–æ—Å—è –≤ –∞—Ä—Å–µ–Ω–∞–ª–µ (–º—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—É –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π) –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç Json - —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏. –ü–æ—Å–ª–µ —Å–∂–∞—Ç–∏—è –Ω–∞ –≤—ã—Ö–æ–¥–µ –±—É–¥–µ—Ç –±–∏–Ω–∞—Ä–Ω–∏–∫, –∞ –Ω–∞–º –Ω–∞–¥–æ –µ–≥–æ –≤ –≤–æ—Ç–∫–Ω—É—Ç—å –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Äì –∑–Ω–∞—á–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç—Ç–∞–ø–æ–º –º—ã –¥–æ–ª–∂–Ω—ã –±—É–¥–µ–º –ø–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
    –§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –≤ —Å–∂–∞—Ç—ã–π —Ç–µ–∫—Å—Ç:
    TableToBinaryText = (tbl as table) as text=>[
    json = Json.FromValue(tbl),
    bin = Binary.From(json),
    compr = Binary.Compress(bin,Compression.Deflate),
    txt = Binary.ToText(compr)][txt]
    json ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É –≤ json (—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)
    bin ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –±–∏–Ω–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Ç–µ–∫—Å—Ç–∞
    compr ‚Äì –æ—Å—É—â–µ—Å—Ç–≤–∏–ª–∏ —Å–∂–∞—Ç–∏–µ (–≤—ã–±—Ä–∞–Ω–æ Compression.Deflate ‚Äì –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —Ç–∞–∫ —Å–∂–∏–º–∞—é—Ç—Å—è ZIP-—ã)
    txt ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞

    –ù—É –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã ‚Äì —ç—Ç–æ —Ç–µ –∂–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
    TableFromBinaryText = (txt as text) as table =>[
    bin = Binary.FromText(txt),
    dec = Binary.Decompress(bin,Compression.Deflate),
    json = Json.Document(dec),
    tbl = Table.FromRecords(json)][tbl]
    bin ‚Äì —Å—Ç—Ä–æ–∫—É –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∏–Ω–∞—Ä–Ω–∏–∫
    dec ‚Äì –±–∏–Ω–∞—Ä–Ω–∏–∫ –≤–µ—Ä–Ω—É–ª–∏ –≤ –Ω–µ—Å–∂–∞—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    json ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –∏–∑ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ json ‚Äì –æ–Ω –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π
    tbl ‚Äì —Å–æ–±—Ä–∞–ª–∏ –∏–∑ –∑–∞–ø–∏—Å–µ–π —Ç–∞–±–ª–∏—Ü—É

    –í–æ—Ç, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –∏ –≤—Å—ë.
    –ö–∞–∫–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ —Å–æ–±—Ä–∞–ª–∏—Å—å —Ä–µ—à–∞—Ç—å –≤–æ–ø—Ä–æ—à–∞—é—â–∏–µ –Ω–µ –∑–Ω–∞—é. –ü–æ –º–Ω–µ —Ç–∞–∫ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–µ—à–∞—Ç—å —Å–≤–æ–∏ —á–∞—Å—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∏–º–µ—é—â–∏–π—Å—è –∞—Ä—Å–µ–Ω–∞–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —è–∑—ã–∫–∞. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –µ—Å–ª–∏ –Ω–∞—á–Ω–µ—Ç–µ –∫–æ–ø–∞—Ç—å –≤ —Å—Ç–æ—Ä–æ–Ω—É Binary.*, —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ word –∏–ª–∏ –¥–æ–±—ã–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–∑–º–µ—Ç–∫–µ –≤ excel –º–æ–≥—É—Ç –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –±—ã—Ç—å –∫–∏—Ç–∞–π—Å–∫–æ–π –≥—Ä–∞–º–æ—Ç–æ–π ‚Äì —Ç–∞–º –∂–µ –≤—Å—ë —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ zip-–∞—Ä—Ö–∏–≤–æ–≤, –∫–æ–∏–º–∏ –∏ —è–≤–ª—è—é—Ç—Å—è .docx –∏ .xlsx. –¢–∞–∫ —á—Ç–æ –¥–∞ ‚Äì —á–∞—Å—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –∫ –∏–∑—É—á–µ–Ω–∏—é –≤–µ—Å—å–º–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
    ]

[   #–ü–æ–ª–µ–∑–Ω—ã–µ–°—Å—ã–ª–∫–∏

    –í—Å–µ–º –¥–æ–±—Ä–∞! –í—ã–ø—Ä—ã–≥–Ω—É–ª –∏–∑ —Å—É–º—Ä–∞–∫–∞ –∏ –ø—Ä–∏–≤–µ–ª –∫ –æ–±—â–µ–º—É –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—é —Å—Ç–∞—Ä—ã–π –ø–æ—Å—Ç (–∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª–∏–ª) —á—Ç–æ–±—ã –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ª—É—á—à–µ –∏—Å–∫–∞–ª–∏—Å—å –Ω–∞—à–∏–º –±–æ—Ç–æ–º, –∞ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–∏–ª —Å—Å—ã–ª–æ—á–∫—É –Ω–∞ –ë–µ–Ω–∞ –Ω–∞—à–µ–≥–æ –ì—Ä–∏–±–∞—É–¥–æ.
    PQ:
    01. –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —è–∑—ã–∫–∞ PowerQuery M - —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç, –±—É–∫–≤–∞—Ä—å, –±–µ–∑ –Ω–µ–≥–æ –¥–∞–ª—å—à–µ —Ç—è–∂–µ–ª–æ;
    01a. M language specification - –æ—Ä–∏–≥–∏–Ω–∞–ª —ç—Ç–æ–≥–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (@buchlotnik –ø—Ä—è–º –Ω–∞—Å—Ç–∞–∏–≤–∞–µ—Ç –Ω–∞ —á—Ç–µ–Ω–∏–∏ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏);
    02. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ —è–∑—ã–∫—É —Ñ–æ—Ä–º—É–ª Power Query M;
    03. finalytics.pro –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö;
    04. blog by Maxim Zelensky –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º, –Ω–æ –Ω–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö;
    05. –¢–æ–≤–∞—Ä–∏—â Excel –∫—Ä–∞—Ç–∫–æ, –µ–º–∫–æ;
    06. planetaexcel.ru –æ–±—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏;
    07. –ö–Ω–∏–≥–∞ "–°–∫—É–ª—å–ø—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ Excel —Å Power Query";
    08. –ö–µ–Ω –ü—É–ª—å—Å –∏ –ú–∏–≥–µ–ª—å –≠—Å–∫–æ–±–∞—Ä. "–Ø–∑—ã–∫ –ú –¥–ª—è Power Query" —Ä—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ –æ—Ç–ª–∏—á–Ω–æ–π –∫–Ω–∏–≥–∏;
    09. –ü—Ä–∏—Ä—É—á–∏ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Power Query –≤ Excel –∏ Power BI –≤—Ç–æ—Ä–æ–µ –∏–∑–¥–∞–Ω–∏–µ —à–∏–∫–∞—Ä–Ω–æ–π –∫–Ω–∏–≥–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –æ—Ç –ö–µ–Ω –ü—É–ª—å—Å –∏ –ú–∏–≥–µ–ª—å –≠—Å–∫–æ–±–∞—Ä.
    10. BI –±–ª–æ–≥ –ú–∞–∫—Å–∏–º–∞ –£–≤–∞—Ä–æ–≤–∞ –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç–∞—Ç–µ–π –ö—Ä–∏—Å–∞ –í–µ–±–±–∞ –∏ —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã..;
    11. The BIccountant –≥—Ä–∞–º–æ—Ç–Ω—ã–π –±—É—Ö —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ BI;
    12. Chris Webb's BI Blog Chris Webb's BI Blog –ú–µ–≥–∞ –¥—è–¥—å–∫–∞ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–æ –≤—Å–µ–º –Ω–∞ —Å–≤–µ—Ç–µ. –ü—Ä–æ—Å—Ç–æ –∫–ª–∞–¥–µ–∑—å!;
    13. The Environment concept in M for Power Query and Power BI Desktop, Part 1 –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –∏ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Å –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ–º;
    14. –ü—Ä–æ–º–æ–∫–æ–¥—ã –æ—Ç –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ì–∏–Ω—å–∫–æ –Ω–∞ –æ—Ç–ª–∏—á–Ω—ã–µ –∫–Ω–∏–≥–∏;
    15. Power Query Formatter –ö—Ä–∞—Å–æ—Ç–∞ —Å–ø–∞—Å–µ—Ç –º–∏—Ä... –∏ –º–æ–∏ –≥–ª–∞–∑–∞.

    DAX:
    01. –û—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ DAX –≤ Power BI Desktop –æ–ø—è—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç;
    02. Articles - SQLBI –ú–µ–≥–∞ –¥—è–¥—å–∫–∏ –ø—Ä–æ –≤—Å–µ –ø–æ–¥—Ä—è–¥;
    03. Patterns ‚Äì DAX Patterns –ú–µ–≥–∞ –¥—è–¥—å–∫–∏ –ø—Ä–æ —Ä–∞—Å—á–µ—Ç—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ. ABC –∏ –≤–æ—Ç —ç—Ç–æ –≤–æ—Ç –≤—Å–µ;
    04. BI –±–ª–æ–≥ –ê–Ω—Ç–æ–Ω–∞ –ë—É–¥—É–µ–≤–∞. –†–∞–∑–±–æ—Ä —Ñ–æ—Ä–º—É–ª DAX –ø–æ-—Ä—É—Å—Å–∫–∏;
    05. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–æ–º–æ—â–∏ Microsoft Power BI –∏ Power Pivot –¥–ª—è Excel;
    06. –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ DAX;
    07. –®–∞–±–ª–æ–Ω—ã DAX;
    08. DAX Formatter by SQLBI –ö—Ä–∞—Å–æ—Ç–∞ —Å–ø–∞—Å–µ—Ç –º–∏—Ä... –∏ –º–æ–∑–≥ —Ç–µ—Ö, –∫—Ç–æ —á–∏—Ç–∞–µ—Ç –≤–∞—à–∏ —Ñ–æ—Ä–º—É–ª—ã.
    ]
    
[   –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Ñ–∞–π–ª–∞–º –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–µ / #–í—Å—è–∫–∏–µ–ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã
    –ò —Å–Ω–æ–≤–∞ –∑–¥—Ä–∞—Å—å—Ç–µ. –ù–∞ —Ö–∞–π–ø–µ –ø–æ —Ç–µ–º–µ –∏–º–ø–æ—Ä—Ç–æ–∑–∞–º–µ—â–µ–Ω–∏—è –≤—Å–µ —á–∞—â–µ –≥—Ä–∞–∂–¥–∞–Ω–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—é—Ç —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±–ª–∞–∫–∞. –ò –¥–∞–ª–µ–µ –≤—Å—Ç–∞—ë—Ç –≤–æ–ø—Ä–æ—Å, –∞ –∫–∞–∫ –∏—Ö –æ—Ç—Ç—É–¥–∞ –∑–∞—Ç–∞—â–∏—Ç—å –≤ Power Query? –†–µ—à–µ–Ω–∏–µ–º –ø–æ–¥–µ–ª–∏–ª—Å—è –¥–æ–±—Ä—ã–π —á–µ–ª–æ–≤–µ–∫ @IlyaNazarov.
    –ü–æ–∫–∞ —á—Ç–æ —Å–∞–º —è –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª. –ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –¥–æ–ø–æ–ª–Ω—é –ø–æ—Å—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏.

[   Table.FromList ‚Äì !!! –ø—è—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Å—á–∞—Å—Ç—å—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.FromList

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í—Å—ë —Ä—É–∫–∏ –Ω–µ –¥–æ—Ö–æ–¥–∏–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ –æ–¥–Ω—É –∏–∑ –º–æ–∏—Ö –ª—é–±–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
    –°–Ω–∞—á–∞–ª–∞ —á–∏—Ç–∞–µ–º —Å–ø—Ä–∞–≤–∫—É:
    Table.FromList(list as list, optional splitter as nullable function, optional columns as any, optional default as any, optional extraValues as nullable number) as table

    –û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì list. –ü—Ä–æ–≤–µ—Ä—è–µ–º:
    Table.FromList({"a,b,c,1","d,e,f,2","g,h,i,3"})

    –†–∞–±–æ—Ç–∞–µ—Ç, –∑–∞–æ–¥–Ω–æ —É–∑–Ω–∞–µ–º, —á—Ç–æ –ø–æ –¥–µ—Ñ–æ–ª—Ç—É –æ–Ω–∞ –µ—â—ë –∏ —Ç–µ–∫—Å—Ç –ø–æ –∑–∞–ø—è—Ç–æ–π –¥–µ–ª–∏—Ç, —Ç.–µ. —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –≤—ã–¥–∞—Å—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ:
    Table.FromList({"a,b,c,1","d,e,f,2","g,h,i,3"},Splitter.SplitTextByDelimiter(","))

    –¢–æ–≥–¥–∞ –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –ø–∏—Å–∞—Ç—å splitter? –ù—É –≤–æ-–ø–µ—Ä–≤—ã—Ö —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –Ω–µ –≤—Å–µ–≥–¥–∞ –∑–∞–ø—è—Ç–∞—è:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3"},Splitter.SplitTextByDelimiter(";"))

    –ê –≥–ª–∞–≤–Ω–æ–µ –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–∞—è –¥—Ä—É–≥–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —Å–ø–∏—Å–æ–∫:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3"},(x)=>Text.Split(x,";"))
    –∏–ª–∏ –Ω–∞–ø—Ä–∏–º–µ—Ä
    Table.FromList({"abc1","def2","ghi3"},Text.ToList)

    –ù—É –û–ö, –∞ –≤–æ—Ç —Ç–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"))
    –î–∞—Å—Ç –æ—à–∏–±–∫—É –≤ —Ç—Ä–µ—Ç—å–µ–π —Å—Ç—Ä–æ–∫–µ. –ü—Ä–∏—á–∏–Ω–∞ - —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –∞ –≤ —Ç—Ä–µ—Ç—å–µ–π —Å—Ç–æ–ª–±—Ü–æ–≤ –æ–∫–∞–∑–∞–ª–æ—Å—å –±–æ–ª—å—à–µ.
    –†–µ—à–µ–Ω–∏–µ - –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç (columns):
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"),6)
    –¢.–µ. –≤ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ–º–µ—Å—Ç–∏–ª–∏ —Ü–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ (–≤ –æ–±—â–µ–º –≤–∏–¥–µ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ ‚Äì –µ–≥–æ –º–æ–∂–Ω–æ –∏ –≤—ã—á–∏—Å–ª–∏—Ç—å).

    –¢–∞–∫–∂–µ –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ null, –Ω–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ - –ø—Ä–∏–≤–ª–µ–∫–∞–µ–º —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç (default):
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"),6,"-")

    –û–±—Ä–∞—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è ‚Äì –Ω–∞–º –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å—Ç–æ–ª–±—Ü–∞:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"),3,"-",ExtraValues.Ignore)
    –¢.–µ. –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç (extraValues) –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ - –≤ —Å–∏—Ç—É–∞—Ü–∏–∏ –≤—ã—à–µ –æ–Ω–∏ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã, –∞ –≤–æ—Ç –≤ —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–∏–∂–µ ‚Äì —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"),4,"-",ExtraValues.List)
    –≠—Ç–æ –±—ã–≤–∞–µ—Ç —É–¥–æ–±–Ω–æ.

    –ù–æ —á—Ç–æ, –µ—Å–ª–∏ –º—ã –Ω–µ —Ö–æ—Ç–∏–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ - –¥–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"),{"–∞","–±","–≤","–≥","–¥","e"})
    –¢.–µ. –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω.

    –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Ç–∏–ø—ã:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>Text.Split(x,";"),type table [–∞=text,–±=text,–≤=text,–≥=number,–¥=number,–µ=number])

    –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏ –æ–±—Ä–∞—Ç—è—Ç –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ–º–µ–Ω—è–ª–∏—Å—å, –∞ –≤–æ—Ç —Å–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏.
    –û–± —ç—Ç–æ–º –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, –Ω–æ –ø–æ—Å–∫–æ–ª—å–∫—É —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π, –º–æ–∂–Ω–æ —á—É—Ç–∫–∞ —É—Å–ª–æ–∂–Ω–∏—Ç—å:
    Table.FromList({"a;b;c;1","d;e;f;2","g;h;i;3;4;5"},(x)=>List.Transform(Text.Split(x,";"),(y)=>try Number.From(y) otherwise y),type table [–∞=text,–±=text,–≤=text,–≥=number,–¥=number,–µ=number])

    –í–æ—Ç —Ç–∞–∫, –æ–¥–Ω–∏–º —à–∞–≥–æ–º —Å–ø–∏—Å–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü—É —Å –±–ª—ç–∫-–¥–∂–µ–∫–æ–º –∏‚Ä¶
    –ù—É –∞ —á—Ç–æ –¥–æ –±–æ–µ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ ‚Äì —Ç–∞–∫ –∏—Ö –µ—Å—Ç—å —É–∂–µ –Ω–∞ –∫–∞–Ω–∞–ª–µ: —ç–ø–∏—á–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂, –ø–ª–∞—á –ø–æ —Ä–µ–≥—É–ª—è—Ä–∫–∞–º, –¥–∞–∂–µ –≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –∑–∞—Å–≤–µ—Ç–∏–ª–∞—Å—å.
    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ü—Ä–æ—Å—Ç–∞—è, –≥–∏–±–∫–∞—è –∏ —à—É—Å—Ç—Ä–∞—è, –º–µ—á—Ç–∞, –∞ –Ω–µ —Ñ—É–Ω–∫—Ü–∏—è! –Æ–∑–∞–π—Ç–µ —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º.
    –ù–∞–¥–µ—é—Å—å, –±—ã–ª–æ –ø–æ–ª–µ–∑–Ω–æ.
    ]

[   List.Select –∏ –≤—Å–µ –≤—Å–µ –≤—Å–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Select

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –±—ã–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ –æ—Ç–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ —É—Å–ª–æ–≤–∏—é. –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å List.Select, –ø–æ—Å–∫–æ–ª—å–∫—É –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Ä–∞–±–æ—Ç—ã —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤—Å—ë –≤ –æ–±—â–µ–º –∏ —Å–≤–æ–¥–∏—Ç—Å—è.
    –ß–∏—Ç–∞–µ–º —Å–ø—Ä–∞–≤–∫—É
    List.Select(list as list, selection as function) as list
    –í—Å—ë –∫–∞–∫ –æ–±—ã—á–Ω–æ ‚Äì —Å–ø–∏—Å–æ–∫ (list) –∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ (selection). –ü—Ä–∏–º–µ—Ä –¥–∞—ë—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π:
    List.Select({1..100}, each _>90)
    –°—Ä–∞–∑—É –≤—Å–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ —ç—Ç–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é
    List.Select({1..100}, (x)=>x>90)
    –≥–¥–µ x ‚Äì —ç–ª–µ–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ —Å–ø–∏—Å–∫–∞, –Ω–∞–º —ç—Ç–æ –µ—â—ë –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è.
    –ö–∞–∫ –≤–æ–¥–∏—Ç—Å—è, —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π (–≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–Ω–∞ –¥–∞–≤–∞–ª–∞ true –∏–ª–∏ false).

    –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–≤–æ–¥–∏–º —á–∏—Å–ª–∞, –∫—Ä–∞—Ç–Ω—ã–µ –ø—è—Ç–∏:
    List.Select({1..100}, (x)=>Number.Mod(x,5)=0)

    –∏–ª–∏ –≤—ã–≤–æ–¥–∏–º –¥–∞—Ç—ã —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π (—Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –ø—è—Ç–Ω–∏—Ü—É):
    List.Select(List.Dates(#date(2022,1,1),365,#duration(1,0,0,0)),(x)=>Date.DayOfWeek(x,1)<5)

    –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏—è.
    –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–≤–æ–¥–∏–º —á–∏—Å–ª–∞, –∫—Ä–∞—Ç–Ω—ã–µ —Ç—Ä—ë–º –ò–õ–ò –ø—è—Ç–∏:
    List.Select({1..100}, (x)=>Number.Mod(x,3)=0 or Number.Mod(x,5)=0)

    –ê —Ç–∞–∫ –∫—Ä–∞—Ç–Ω—ã–µ —Ç—Ä—ë–º –ò –∫—Ä–∞—Ç–Ω—ã–µ –ø—è—Ç–∏ :
    List.Select({1..100}, (x)=>Number.Mod(x,3)=0 and Number.Mod(x,5)
    (—è –∑–Ω–∞–∫–æ–º —Å –º–∞—Ç–µ–º–∞—Ç–∏–∫–æ–π, –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–ª–∏–º–æ—Å—Ç—å –Ω–∞ –ø—è—Ç–Ω–∞–¥—Ü–∞—Ç—å, –Ω–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ—Ä)

    –ù—É –∏ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —Å–ø–∏—Å–∫–∏ –º–æ–≥—É—Ç —Å–æ—Å—Ç–æ—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
    –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–ø–∏—Å–∫—É —Å–ø–∏—Å–∫–æ–≤:
    List.Select({{1,1},{1,2},{2,1},{2,2}},(x)=>x{0}>1)
    –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ x ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∏ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ–≥–æ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç x{0}

    –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Å–µ–π:
    List.Select({[a=1,b=1],[a=1,b=2],[a=2,b=1],[a=2,b=2]},(x)=>x[a]>1)
    –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ x ‚Äì —ç—Ç–æ –∑–∞–ø–∏—Å—å, –∏ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –µ—ë –ø–æ–ª–µ ‚Äì x[a].

    –û—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä,–∫–æ–º–±–∏–Ω–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏—è:
    List.Select({[a=1,b=1],[a=1,b=2],[a=2,b=1],[a=2,b=2]},(x)=>x[a]>1 or x[b]<2)

    –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç? –†–æ–≤–Ω–æ —Ç–∞–∫ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç Table.SelectRows:
    Table.SelectRows(Table.FromRecords({[a=1,b=1],[a=1,b=2],[a=2,b=1],[a=2,b=2]}),(x)=>x[a]>1 or x[b]<2)
    –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Å—Ç—Ä–æ–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–∞–∂–¥–∞—è –∏–∑ –Ω–∏—Ö, –Ω–æ —Å—Ç—Ä–æ–∫–∞ ‚Äì —ç—Ç–æ –∑–∞–ø–∏—Å—å, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –∏ –µ—Å—Ç—å —Ä–∞–±–æ—Ç–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–ø–∏—Å–µ–π.

    –î–∞ –∏ –≤ —Å–ª—É—á–∞–µ Table.SelectColumns –±–µ–∑ List.Select –±—ã–≤–∞–µ—Ç –Ω–µ –æ–±–æ–π—Ç–∏—Å—å:
    let
    from = #table({"–∏–º—è","a1","a2","–∏—Ç–æ–≥–æ a","b1","b2","b3","–∏—Ç–æ–≥–æ b"},{{"–≤–∞—Å—è",1,2,3,4,5,6,15},{"–ø–µ—Ç—è",1,3,4,5,7,9,21},{"–∫–æ–ª—è",2,4,6,8,10,12,30}}),
    lst = List.Select(Table.ColumnNames(from),(x)=>x="–∏–º—è" or Text.Contains(x,"–∏—Ç–æ–≥–æ")),
    to = Table.SelectColumns(from,lst)
    in
    to
    —Ç.–µ. lst - –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –º—ã –ø–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –≤—ã–±–∏—Ä–∞–µ–º ¬´–∏–º—è¬ª –∏–ª–∏ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç ¬´–∏—Ç–æ–≥–æ¬ª.
    to - –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤ SelectColumns.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –æ—Ç –∫–∞–∫–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Å–ª–µ–¥—É–µ—Ç –ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º —É—Å–ª–æ–≤–∏–µ (–∏–ª–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é —É—Å–ª–æ–≤–∏–π) –∏ –ø–æ–ª—É—á–∞–µ–º –Ω—É–∂–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. List.Select —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º –ø–æ —Å–µ–±–µ, –∞ –≤–æ—Ç –≤ —Å–≤—è–∑–∫–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ - –≤–µ—Å—å–º–∞ –ø–æ–ª–µ–∑–Ω–∞—è —à—Ç—É–∫–∞.
    ]
    
[   Text.Remove, Text.Select, Text.Trim –Ω–∞ —Å—Ç—Ä–∞–∂–µ —á–∏—Å—Ç–æ—Ç—ã —Ç–µ–∫—Å—Ç–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –≤—Å—è–∫–æ–µ –ø—Ä–æ —Ç–µ–∫—Å—Ç
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑–±–µ—Ä–µ–º –∑–∞–¥–∞—á–∫—É, —á–∞—Å—Ç–µ–Ω—å–∫–æ –≤–æ–∑–Ω–∏–∫–∞—é—â—É—é –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ, –∞ –∏–º–µ–Ω–Ω–æ ‚Äì –∏–º–µ–µ—Ç—Å—è —Ç–µ–∫—Å—Ç, –∞ –Ω–∞–º –Ω–∞–¥–æ –ø–æ—á–∏—Å—Ç–∏—Ç—å –µ–≥–æ –æ—Ç –≤—Å—è–∫–æ–≥–æ –ª–∏—à–Ω–µ–≥–æ.
    –î–ª—è —ç—Ç–æ–≥–æ –≤ –∞—Ä—Å–µ–Ω–∞–ª–µ –º—ã –∏–º–µ–µ–º Text.Remove, Text.Select, Text.Trim, Text.TrimStart, Text.TrimEnd –∏ –¥–∞–∂–µ Text.Clean. –ß—Ç–æ –∂, –ø–æ–µ—Ö–∞–ª–∏!
    –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å—Ç–µ–Ω—å–∫–æ–µ:
    Text.Remove("<–º–∞–º–∞ <–º—ã–ª–∞ <—Ä–∞–º—É","<")
    –ó–¥–µ—Å—å –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —è–≤–Ω–æ –ª–∏—à–Ω–∏–π —Å–∏–º–≤–æ–ª <, –ø–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –∏ —Ä–∞–¥—É–µ–º—Å—è –∂–∏–∑–Ω–∏

    Text.Remove("<–º–∞–º–∞> <–º—ã–ª–∞> <—Ä–∞–º—É>",{"<",">"})
    —Å–∏–º–≤–æ–ª–æ–≤ —É–∂–µ –¥–≤–∞, –ø–æ—ç—Ç–æ–º—É –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ø–∏—Å–æ–∫.
    –°–ø–∏—Å–æ–∫ –º–æ–∂–µ—Ç —Ä–∞—Å—Ç–∏:
    Text.Remove("<–º–∞–º–∞/> <–º—ã–ª–∞/> <—Ä–∞–º—É/>",{"<",">","/"})
    Text.Remove("<-–º–∞9–º–∞098/> 67-.908<–º—ãABC–ª–∞/> <—Ä–∞123qwer–º—É/>",{"<",">","/",".","-","0".."9","A".."Z","a".."z"})
    —Ç—É—Ç –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —É–∂–µ —Å—É—â–µ–µ –±–µ–∑—É–º–∏–µ - –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –¥–∏–∞–ø–∞–∑–æ–Ω—ã —Å–∏–º–≤–æ–ª–æ–≤ - –º–æ–∂–Ω–æ –ª–∏ —ç—Ç–æ –∫–∞–∫-—Ç–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å?
    –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è ‚Äúa‚Äù..‚Äùz‚Äù –¥–∞—ë—Ç –Ω–∞–º –≤—Å–µ —Å–∏–º–≤–æ–ª—ã —Å –Ω–æ–º–µ—Ä–∞–º–∏ –æ—Ç 97 (–∫–æ–¥ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π —Å—Ç—Ä–æ—á–Ω–æ–π a) –¥–æ 122 (–∫–æ–¥ —Å—Ç—Ä–æ—á–Ω–æ–π z). –í–æ–æ—Ä—É–∂–∏–≤—à–∏—Å—å —ç—Ç–∏–º –∑–Ω–∞–Ω–∏–µ–º –º–æ–∂–µ–º –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–æ–¥:
    Text.Remove("<-–º–∞9–º–∞098/> 67-.908<–º—ãABC–ª–∞/> <—Ä–∞123qwer–º—É/>",List.Transform({33..127},Character.FromNumber))
    –ó–¥–µ—Å—å –º—ã –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ –≥–µ–Ω–µ—Ä–∏–º –≤—Å–µ —á–∏—Å–ª–∞ –æ—Ç 33 –¥–æ 127 –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –∏—Ö –≤ —Å–∏–º–≤–æ–ª—ã (32 –Ω–µ —Ç—Ä–æ–≥–∞–µ–º ‚Äì —ç—Ç–æ –ø—Ä–æ–±–µ–ª –∏ –æ–Ω –Ω–∞–º –Ω—É–∂–µ–Ω). –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–∂–Ω–æ –±–æ—Ä–æ—Ç—å—Å—è –∏ —Å –Ω–µ–ø–µ—á–∞—Ç–∞–µ–º—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ (—Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–æ–∫–∏, –ø–µ—Ä–µ–≤–æ–¥ –∫–∞—Ä–µ—Ç–∫–∏, —Ç–∞–±—É–ª—è—Ü–∏—è –∏ —Ç.–ø.):
    Text.Remove("<-–º–∞9–º#(lf)–∞098/> 67-.908<–º—ãA#(cr)BC–ª–∞/> <—Ä–∞123qwer–º—É/>",List.Transform({1..31,33..127},Character.FromNumber))
    –í–æ–æ–±—â–µ –¥–ª—è –Ω–µ–ø–µ—á–∞—Ç–∞–µ–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (—Å 1 –ø–æ 31) –µ—Å—Ç—å —Å–≤–æ—è —Ñ—É–Ω–∫—Ü–∏—è - Text.Clean, –Ω–æ —Ä–∞–∑ —É–∂ —É –Ω–∞—Å —Ç—É—Ç –∏ —Ç–∞–∫ —Å–ø–∏—Å–æ–∫ –≤—Å—è–∫–æ–≥–æ ‚Äì –º—ã –∏—Ö –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏.

    –û–∫, –Ω–æ –Ω–µ–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å, —á—Ç–æ —á–µ–º –¥–ª–∏–Ω–Ω–µ–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π —Å–ø–∏—Å–æ–∫, —Ç–µ–º –º–µ–¥–ª–µ–Ω–Ω–µ–µ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é ‚Äì –Ω–µ –ø—ã—Ç–∞—Ç—å—Å—è —É–¥–∞–ª–∏—Ç—å –≤—Å—ë –ª–∏—à–Ω–µ–µ, –∞ —Ç–æ–ª—å–∫–æ –æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å—ë –Ω—É–∂–Ω–æ–µ:
    Text.Select("<-–º–∞9–º#(lf)–∞098/> 67-.908<–º—ãA#(cr)BC–ª–∞/> <—Ä–∞123qwer–º—É/>",{"–ê".."—è"," "})
    –í–ø–æ–ª–Ω–µ —Å–∏–º–ø–∞—Ç–∏—á–Ω–æ, –Ω–æ –ø–æ–±–æ—Ä–Ω–∏–∫–∏ —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞ –ø–æ–ø—Ä–æ—Å—è—Ç –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å:
    Text.Select("<-–º–∞9–º#(lf)–∞098/> 67-.908<–º—ãA#(cr)BC–ª–∞/> <—Ä–∞123qwer–º—É/>",{"–ê".."—è","–Å","—ë"," "})
    –ó–¥–µ—Å—å —Ñ–∏—à–∫–∞ –≤ —Ç–æ–º, —á—Ç–æ –Å –∏ —ë –≤ —Å–∏–ª—É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ –∏–º–µ—é—Ç —Å–≤–æ–∏ –∫–æ–¥—ã, –ø–æ—ç—Ç–æ–º—É –∏—Ö —É–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.

    –ù–æ –≤—ã –Ω–µ –¥—É–º–∞–π—Ç–µ, —á—Ç–æ —Å –ª–∞—Ç–∏–Ω–∏—Ü–µ–π –ø—Ä–æ—â–µ:
    Text.Select("<[mama\] [my\la\] [ra/-mu]/>",{"A".."z"," "})
    –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–µ —Ç–∞–∫ –ª–∏? –ù—É –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –≤—ã—à–ª–æ, —á—Ç–æ [, ], \ –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ –æ–∫–∞–∑–∞–ª–∏—Å—å –º–µ–∂–¥—É –ø—Ä–æ–ø–∏—Å–Ω—ã–º–∏ –∏ —Å—Ç—Ä–æ—á–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ –ª–∞—Ç–∏–Ω–∏—Ü—ã, –ø–æ—ç—Ç–æ–º—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–∏—Å–∞—Ç—å —Ç–∞–∫:
    Text.Select("<[mama\] [my\la\] [ra/-mu]/>",{"A".."Z","a".."z"," "})

    –≠—Ç–æ –≤—Å—ë –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, –Ω–æ —á—Ç–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–µ –≤—Å–µ —Å–∏–º–≤–æ–ª—ã, –∞ —Ç–æ–ª—å–∫–æ —á—Ç–æ-—Ç–æ –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ –Ω—É–∂–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞? –¢—É—Ç –Ω–∞–º –Ω–µ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ Trim:
    Text.TrimStart("<name = 191.168.0.0 - –ú–∏—Ö–∞–∏–ª (buchlotnik) –ú—É–∑—ã–∫–∏–Ω/>",List.Transform({1..127},Character.FromNumber))
    Text.TrimEnd("<name = 191.168.0.0 - –ú–∏—Ö–∞–∏–ª (buchlotnik) –ú—É–∑—ã–∫–∏–Ω/>",List.Transform({1..127},Character.FromNumber))
    Text.Trim("<name = 191.168.0.0 - –ú–∏—Ö–∞–∏–ª (buchlotnik) –ú—É–∑—ã–∫–∏–Ω/>",List.Transform({1..127},Character.FromNumber))
    –ò–¥–µ—è —Ç–æ—á–Ω–æ —Ç–∞–∫–∞—è –∂–µ ‚Äì –ø–µ—Ä–µ–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤, –∏ —Ñ—É–Ω–∫—Ü–∏—è –∏—Ö —É–¥–∞–ª—è–µ—Ç. –¢–æ–ª—å–∫–æ
    TrimStart - —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ —Å–ø–∏—Å–∫–∞, –∏–¥—É—â–∏–µ –ø–æ–¥—Ä—è–¥ —Å –Ω–∞—á–∞–ª–∞ —Å—Ç—Ä–æ–∫–∏
    TrimEnd - —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ —Å –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏
    Trim - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ —Å–µ–±–µ —Ä–∞–±–æ—Ç—É –æ–±–µ–∏—Ö
    –¢–æ–ª—å–∫–æ –±—É–¥—å—Ç–µ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ø–∏—Å–∫–æ–≤:
    Text.Trim("<name = 191.168.0.0 - –ú–∏—Ö–∞–∏–ª (buchlotnik) –ú—É–∑—ã–∫–∏–Ω/>",List.Transform({1..127},Character.FromNumber)&{"–ú","–∏","–Ω"})
    –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏—Ç—Å—è "—Ö–∞–∏–ª (buchlotnik) –ú—É–∑—ã–∫" - –ú–∏ –≤ –Ω–∞—á–∞–ª–µ –∏ –∏–Ω –≤ –∫–æ–Ω—Ü–µ –ø–æ–ø–∞–ª–∏ –ø–æ–¥ —Ä–∞–∑–¥–∞—á—É, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–∏ —Å–∏–º–≤–æ–ª—ã —Å–æ–¥–µ—Ä–∂–∞–ª–∏—Å—å –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–∞–µ–º—ã—Ö. –≠—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –æ—Ç–≤–µ—Ç –Ω–∞ –ø—Ä–æ—à–ª–æ–≥–æ–¥–Ω—é—é –∑–∞–≥–∞–¥–∫—É )))
    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –∏–∑—É—á–∞–π—Ç–µ –∫–æ–¥—ã —Å–∏–º–≤–æ–ª–æ–≤ –∏ —á–∏—Å—Ç–∏—Ç–µ –≤–∞—à–∏ –≤—ã–≥—Ä—É–∑–∫–∏ –æ—Ç –≤—Å—è–∫–æ–≥–æ –º—É—Å–æ—Ä–∞ —Å –ø–æ–ª–Ω—ã–º –æ—Å–æ–∑–Ω–∞–Ω–∏–µ–º –¥–µ–ª–∞.
    ]
    
[   –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì CustomFunctions

    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –ø–æ–≤–æ–¥ —Å–ø–∞—Ä—Å–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞. –¢–µ–º–∞ —É–∂–µ –ø–æ–¥–Ω–∏–º–∞–ª–∞—Å—å –õ—ë—Ö–æ–π, –Ω–æ –∫–æ–¥ –Ω–µ –±—ã–ª –≤—ã–ª–æ–∂–µ–Ω –≤ —Å–∏–ª—É –≥—Ä–æ–º–æ–∑–¥–∫–æ—Å—Ç–∏.
    –ü–æ–¥—É–º–∞–ª, —á—Ç–æ –Ω–∞–¥–æ –±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é )))

    –ü–æ—Å–µ–º—É —Ñ—É–Ω–∫—Ü–∏—è consultant:
    (optional year as nullable number) =>
        [   path = "http://www.consultant.ru/law/ref/calendar/proizvodstvennye/",
            yr   = year??Date.Year(DateTime.LocalNow()), 
            from = Text.FromBinary(Web.Contents(path&Text.From(yr)&(if yr = 2020 then "b" else ""))),
            splt = List.Skip(Text.Split(from,"#(tab,tab,tab)<td class=")),
            lst  = List.Zip({{1..12},splt}),
            f=(x)=>[a=Text.Split(x{1},"<td class="),
                    b=List.Select(a,(x)=>not Text.Contains(x,"inactively")),
                    c=List.Transform(b,(x)=>List.Range(Text.SplitAny(x,"><"),0,2))][c],
            g=(x,y)=>{#date(yr,x{0},Number.From(y{1})),Text.Remove(y{0},"""")},
            tr  = List.TransformMany(lst,f,g),
            tbl = Table.FromList(tr,(x)=>x,type table [Date=date,DateType=text])
        ]  [tbl]

    ()=> –û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    path  ‚Äì –æ—Ç–∫—É–¥–∞ —Ç–∞—â–∏–º
    yr    ‚Äì –≥–æ–¥, –∑–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—å - –µ—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω ‚Äì –±–µ—Ä—ë–º —Ç–µ–∫—É—â–∏–π –≥–æ–¥ (—É –∫–æ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ?? –º–µ–Ω—è–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ if year is null then Date.Year(DateTime.LocalNow()) else year)
    from  ‚Äì —Ç–∞—â–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Å–∞–π—Ç–∞. –ï—Å—Ç—å –Ω—é–∞–Ω—Å ‚Äì 2020 –±—ã–ª –Ω–µ–ø—Ä–æ—Å—Ç—ã–º –≥–æ–¥–æ–º, –ø–æ—ç—Ç–æ–º—É —Ç–æ–≥–¥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ø–µ—Ä–µ–∑–∞–ª–∏–≤–∞–ª–∏ –∏ –æ–Ω –ø–æ–ª—É—á–∏–ª –∞–¥—Ä–µ—Å–∞—Ü–∏—é 2020b, —á—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∑–¥–µ—Å—å –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    split ‚Äì —Ö–∏—Ç—Ä–æ –¥–µ–ª–∏–º —Ç–µ–∫—Å—Ç ‚Äì –ø–æ–º–µ—Å—è—á–Ω—ã–µ –±–ª–æ–∫–∏ –æ—Ç–±–∏–≤–∞—é—Ç—Å—è —Ç—Ä–æ–π–Ω—ã–º —Ç–∞–±–æ–º ‚Äì –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –∫–∞–∫ —ç—Ç–æ –∑–∞–ø–∏—Å–∞–Ω–æ, –Ω—É –∏ –ø–µ—Ä–≤—ã–π –∫—É—Å–æ–∫ (–¥–æ –ø–æ–º–µ—Å—è—á–Ω—ã—Ö) –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º
    lst   ‚Äì —Å–æ–µ–¥–∏–Ω—è–µ–º –±–ª–æ–∫–∏ —Ç–µ–∫—Å—Ç–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ –º–µ—Å—è—Ü–µ–≤ —á–µ—Ä–µ–∑ List.Zip
    tr    ‚Äì –Ω–µ–º–Ω–æ–∂–∫–æ –ø–µ—Ä–µ—Å–∫–æ—á–∏–º ‚Äì –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ List.TransformMany, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–º –Ω—É–∂–Ω—ã –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏:
    f     ‚Äì –¥–µ–ª–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ –ø–æ "<td class=", –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –±–µ–∑ "inactively" (—É –Ω–∏—Ö –Ω–∞ —Å–∞–π—Ç–µ –º–µ—Å—è—á–Ω—ã–µ –±–ª–æ–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ 7 –Ω–∞ 6, –∏ —Ç–∞–∫ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã –ø—É—Å—Ç—ã–µ), –∏ –∏—Ö —Å–ø–ª–∏—Ç—É–µ–º –ø–æ ">" –∏ "<", –æ—Å—Ç–∞–≤–∏–≤ –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ ‚Äì —Å—Ç–∞—Ç—É—Å –∏ –Ω–æ–º–µ—Ä –¥–Ω—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ
    g     ‚Äì —Å–æ–±–∏—Ä–∞–µ–º –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç—É –∏ —Å—Ç–∞—Ç—É—Å –¥–∞—Ç—ã –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∫–∞–≤—ã—á–µ–∫
    tbl   ‚Äì –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É, —Å—Ä–∞–∑—É –∑–∞–¥–∞–≤ —Ç–∏–ø–∏–∑–∞—Ü–∏—é
    
    –ö–∞–∫ –±—ã –≤—Å—ë)))

    –ö–∞–∫ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:
    consultant() // –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥
    consultant(2024) //–∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≥–æ–¥
    Table.Combine(List.Transform({2010..2024},consultant)) //–∫–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞ –ø–µ—Ä–∏–æ–¥ –ª–µ—Ç
    ]

[   Table.TransformColumns ‚Äì –ß–∞—Å—Ç—å 1 –§—É–Ω–∫—Ü–∏—è —á–µ—Ç—ã—Ä—ë—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.TransformColumns
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–∞—à—ë–ª—Å—è –ø–æ–≤–æ–¥, –ø–æ—ç—Ç–æ–º—É —Ä–∞–∑–±–∏—Ä–∞–µ–º Table.TransformColumns. –î–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–≥–ª—è–Ω–µ–º –≤ —Å–ø—Ä–∞–≤–∫—É:
    
    Table.TransformColumns(
        table as table, 
        transformOperations as list, 
        optional defaultTransformation as nullable function, 
        optional missingField as nullable number
    )

        table                   ‚Äì –Ω–∞—à–∞ —Ç–∞–±–ª–∏—Ü–∞
        transformOperations     ‚Äì —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
        defaultTransformation   ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –ø—Ä–∏–º–µ–Ω—è–µ–º–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∫–æ–≥–¥–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–≤–∏–º null)
        missingField            ‚Äì –∞—Ä–≥—É–º–µ–Ω—Ç, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ç–æ, —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏

    –ù—É –∏ –ø–æ–µ—Ö–∞–ª–∏ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ - –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ —Ç–µ–∫—Å—Ç, –∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ null –∏ –º—ã —Ö–æ—Ç–∏–º null –ø–æ–º–µ–Ω—è—Ç—å –Ω–∞ 0, –∞ —Ç–µ–∫—Å—Ç –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞:
        let
            from = Table.FromRecords({
                [A = null, B = 2, C = 3, D = "4"],
                [A = "5", B = 6, C = null, D = 8],
                [A = 9, B = null, C = "10", D = 11]
            }),
            f=(x)=> if x=null then 0 else Number.From(x),
            to = Table.TransformColumns(from, {"A", f} )
        in 
            to
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ null –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ —á–∏—Å–ª–æ (–∑–∞—á–µ–º –≤—ã–Ω–æ—Å–∏—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å —Ç—É—Ç). –ö–∞–∂–¥—ã–π —Å—Ç–æ–ª–±–µ—Ü –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç –æ–¥–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ (—Å–∞–º–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —Å—Ç–æ–ª–±—Ü—É) –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Ç–æ–ª–±—Ü—ã –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã
    to ‚Äì –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ —Å—Ç–æ–ª–±—Ü—É –ê ‚Äì —Ç.–µ. –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ —Ç–∏–ø —Å—Ç–æ–ª–±—Ü–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è.
    –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–∞ ‚Äì —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –≤–µ—â–∏:
    
        to = Table.TransformColumns(from,{"A", f, Int64.Type})
    
    –í–æ—Ç —Ç–µ–ø–µ—Ä—å –∏ –∑–Ω–∞—á–µ–Ω–∏—è, –∏ —Ç–∏–ø —Å—Ç–æ–ª–±—Ü–∞ –∫–∞–∫–∏–µ –Ω—É–∂–Ω–æ.

    –û–ö, –Ω–æ —á—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤:
        
        to = Table.TransformColumns(from,{
            {"A", f, Int64.Type},
            {"B", f, Int64.Type},
            {"C", f, Int64.Type},
            {"D", f, Int64.Type}
        })
    
    –¢–µ–ø–µ—Ä—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —ç—Ç–æ {–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ñ—É–Ω–∫—Ü–∏—è, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ç–∏–ø}
    –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—ã—à–ª–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ–π, –Ω–æ –º—ã —Ä–µ—à–∏–º —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É –≤–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏.

    –¢–µ–ø–µ—Ä—å –∑–∞–¥–∞–¥–∏–º—Å—è –≤–æ–ø—Ä–æ—Å–æ–º ‚Äì –∞ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å—Ä–∞–∑—É –∫–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º? –ù—É, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –¥–ª—è —ç—Ç–æ–≥–æ –∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç:
    
        to = Table.TransformColumns(from,{}, f)

        –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø–∏—Å–∫–æ–º, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫.
    
    –¢—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º, –∫—Ä–æ–º–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äì –∫–æ –≤—Å–µ–º, —á–µ–≥–æ –º—ã –∏ –¥–æ–±–∏–≤–∞–ª–∏—Å—å.

    –ù–æ –≤–µ–¥—å —á–∞—Å—Ç–æ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω—É–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –∞ –≤–æ—Ç –∫ –æ—Å—Ç–∞–ª—å–Ω—ã–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é:
        
        to = Table.TransformColumns(from, {"A",(x)=>x}, f)

    –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å—Ç–æ–ª–±–µ—Ü A –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–Ω–∞–¥–µ—é—Å—å –Ω–µ –Ω—É–∂–Ω–æ –æ–±—ä—è—Å–Ω—è—Ç—å, —á—Ç–æ (x)=>x –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏—á–µ–≥–æ, –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –µ–π –∞—Ä–≥—É–º–µ–Ω—Ç), –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏–∑–º–µ–Ω—è—é—Ç—Å—è.
    –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø–æ–¥—Ö–æ–¥–∞ ‚Äì –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –Ω–æ —Å—Ä–∞–∑—É –æ–±–æ–∑–Ω–∞—á–∏—Ç—å –µ—â—ë –∏ —Ç–∏–ø —Å—Ç–æ–ª–±—Ü–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è (–æ–ø—è—Ç—å –∂–µ ‚Äì —Å–º. —á–∞—Å—Ç—å 2)

    –ù—É –∞ –ø–æ–∫–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ—â—ë –∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì –≤–æ–∑–º–æ–∂–Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π —Ç–∏–ø–∏—á–Ω—ã–π –∏ –∏–∑–≤–µ—Å—Ç–µ–Ω –∑–∞—Ä–∞–Ω–µ–µ, –∞ —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –Ω–µ–ø–æ–ª–Ω–∞—è:

        to = Table.TransformColumns(
                from,
                {{"A", f, Int64.Type}, {"B", f, Int64.Type}, {"C", f, Int64.Type}, {"D", f, Int64.Type}, {"E", f, Int64.Type}},
                null,
                MissingField.Ignore
            )

    –í–∏–¥–∏–º, —á—Ç–æ –≤ —Å–ø–∏—Å–∫–µ –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü E. –ü—Ä–∏ —ç—Ç–æ–º –≤–∞–∂–Ω–æ ‚Äì —Ö–æ—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º—ã –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º, –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å ‚Äì –ø–æ—ç—Ç–æ–º—É –º—ã —Å—Ç–∞–≤–∏–º null. –ê –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç - MissingField.Ignore, –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Å—Ç–æ–ª–±—Ü–∞.
    –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, –µ—Å–ª–∏ —É –≤–∞—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞ –∏ —Ç–∞–∫–æ–π —Å—Ç–æ–ª–±–µ—Ü –Ω—É–∂–µ–Ω, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ:
        
        to = Table.TransformColumns(
            from,
            {{"A", f, Int64.Type},{"B", f, Int64.Type},{"C", f, Int64.Type},{"D", f, Int64.Type},{"E", f, Int64.Type}},
            null,
            MissingField.UseNull
        )
    –¢–µ–ø–µ—Ä—å –Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã, –¥–∞–∂–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–≤—à–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø—Ä–∏–¥—É–º–∞–Ω—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ ‚Äì –æ–Ω–∏ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä—è—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.
    ]

[   Table.TransformColumns ‚Äì !!! –ß–∞—Å—Ç—å 2 –ü—Ä–∏—á—ë–º —Ç—É—Ç List.Transform / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.TransformColumns , List.Transform

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–∑–±–æ—Ä Table.TransformColumns. –í –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –º—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –≥—Ä–æ–º–æ–∑–¥–∫–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
        
        let
            from = Table.FromRecords({
                [A = null, B = 2, C = 3, D = "4"],
                [A = "5", B = 6, C = null, D = 8],
                [A = 9, B = null, C = "10", D = 11]
            }),
            f=(x)=> if x=null then 0 else Number.From(x),
            to = Table.TransformColumns(from,{{"A", f, Int64.Type},{"B", f, Int64.Type},{"C", f, Int64.Type},{"D", f, Int64.Type}})
        in 
            to
    
    –†–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –±—ã–ª–æ –Ω–µ–ø–æ–ª–Ω—ã–º, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–µ –ø–æ–∑–≤–æ–ª–∏–ª–æ –ø—Ä–∏—Å–≤–æ–∏—Ç—å —Ç–∏–ø—ã —Å—Ç–æ–ª–±—Ü–∞–º. 
    –ö–∞–∫ –∂–µ –±—ã—Ç—å? –ü—Ä–æ—Å—Ç–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ Table.ColumnNames:
    
        let
            from = Table.FromRecords({
                [A = null, B = 2, C = 3, D = "4"],
                [A = "5", B = 6, C = null, D = 8],
                [A = 9, B = null, C = "10", D = 11]
            }),
            f=(x)=> if x=null then 0 else Number.From(x),
            nms = Table.ColumnNames(from),
            lst = List.Transform(nms,(x)=>{x,f,Int64.Type}),
            to  = Table.TransformColumns(from, lst)
        in 
            to

    –ó–¥–µ—Å—å
        nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤,
        lst ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äì —ç—Ç–æ {–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ñ—É–Ω–∫—Ü–∏—è, —Ç–∏–ø}
        to  ‚Äì —É—Å–ø–µ—à–Ω–æ —ç—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏

    –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü:
        
        nms = List.Skip(Table.ColumnNames(from))

    –ù—É –∏ –≤ —Ü–µ–ª–æ–º –º–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã —á–µ—Ä–µ–∑ List.Select –∏ –¥–∞–ª–µ–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—á–∫–æ–π.
    –í—Ä–æ–¥–µ –Ω–µ—Å–ª–æ–∂–Ω–æ, –∞ –Ω–µ—Ä–≤–æ–≤ —ç–∫–æ–Ω–æ–º–∏—Ç –º–Ω–æ–≥–æ, –¥–∞ –∏ –∫–æ–¥ –≤—ã—Ö–æ–¥–∏—Ç –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º –∏ —á–∏—Ç–∞–µ–º—ã–º.
    ]

[   –°–ª–æ–∂–Ω–æ –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö 1 - –¢–∏–ø–∏–∑–∞—Ü–∏—è    / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Type.ForFunction

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–µ–¥–∞–≤–Ω–æ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ Table.TransformColumns –∏ —è —Ç–∞–º –Ω–µ–º–Ω–æ–≥–æ —Å–ª—É–∫–∞–≤–∏–ª, —Å–∫–∞–∑–∞–≤, —á—Ç–æ —Ç–æ–ª—å–∫–æ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–¥–∞—Ç—å —Ç–∏–ø —Å—Ç–æ–ª–±—Ü–∞. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –º—ã –º–æ–∂–µ–º —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —Ç–∏–ø —Å–∞–º–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
    f=(x)=>
    f=(x as any)=>
    f=(x as any) as number =>




    –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∏–ø –æ—á–µ–Ω—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äì –≤—Å—ë –¥–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–º —Ç–∏–ø–æ–º, —ç—Ç–æ—Ç —Ç–∏–ø –∞–≤—Ç–æ–º–∞—Ç–æ–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏ –∫ —Å—Ç–æ–ª–±—Ü—É. –ù–æ –µ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ù–û ‚Äì —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å number, text, date –∏ —Ç.–ø.‚Äì —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ —Ç–∏–ø—ã. –ù–æ –≤ —É–ø–æ–º—è–Ω—É—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –Ω–∞–º –±—ã–ª–æ –Ω—É–∂–Ω–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ (Int64.Type), –∞ –µ—â—ë —á–∞—Å—Ç–æ –±—ã–≤–∞—é—Ç –ø—Ä–æ—Ü–µ–Ω—Ç—ã (Percentage.Type), –¥–µ–Ω—å–≥–∏ –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤ (Currency.Type). –¢–∞–∫–∏–µ —Ç–∏–ø—ã —É–∫–∞–∑–∞—Ç—å —É–∂–µ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è, —Ö–æ—Ç—è‚Ä¶
    let
        from = Table.FromRecords({
            [A = null, B = 2, C = 3, D = "4"],
            [A = "5", B = 6, C = null, D = 8],
            [A = 9, B = null, C = "10", D = 11]
        }),
        NumOrZero = [   func = (x)=> if x=null then 0 else Number.From(x),
                        ftyp = Type.ForFunction([ReturnType = Int64.Type, Parameters = [x = type any]], 1),
                        fres = Value.ReplaceType(func, ftyp)][fres],

        to = Table.TransformColumns(from, {},NumOrZero)
    in
        to



    —Ä–∞–∑–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —à–∞–≥ NumOrZero ‚Äì —ç—Ç–æ –∑–∞–ø–∏—Å—å, –ø—Ä–∏—á—ë–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ fres (–∑–∞—á–µ–º —Ç–∞–∫ ‚Äì —á–∏—Ç–∞–µ–º —Ç—É—Ç)
    func ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–æ—Å—Ç–∞
    ftyp ‚Äì –∞ –≤–æ—Ç —Ç—É—Ç –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é Type.ForFunction, –æ–Ω–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∏–ø —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–Ω–∏–º–∞—è –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
    - signature ‚Äì —ç—Ç–æ –∑–∞–ø–∏—Å—å –∏–∑ –¥–≤—É—Ö –ø–æ–ª–µ–π ReturnType (–∫—É–¥–∞ –º—ã –∑–∞–ø–∏—à–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø ‚Äì –∏ –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Int64.Type) –∏ Parameters (–∑–∞–ø–∏—Å—å —Ç–∏–ø–æ–≤ –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç x)
    - min ‚Äì –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–¥–∏–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì –ø–æ—ç—Ç–æ–º—É –∑–Ω–∞—á–µ–Ω–∏–µ 1)
    fres ‚Äì –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–∏–ø –∫ –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏, –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º Value.ReplaceType

    –ù–µ—Å–ª–æ–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–¥ –≤—ã—à–µ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∫–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º, –Ω–æ –∏ –º–µ–Ω—è–µ—Ç –∏—Ö —Ç–∏–ø –Ω–∞ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π

    –¢–µ–ø–µ—Ä—å –Ω–µ–º–Ω–æ–≥–æ —É—Å–ª–æ–∂–Ω–∏–º ‚Äì —Ö–æ—Ä–æ—à–æ –∏ —É–¥–æ–±–Ω–æ, –∫–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –º–∞–ª–µ–Ω—å–∫–∞—è, —Ç–æ–≥–¥–∞ –≤–µ—Å—å –∫–æ–¥ –≤—ã—à–µ –ø–∏—à–µ—Ç—Å—è —Ä—É–∫–∞–º–∏ –∏ –æ–¥–∏–Ω —Ä–∞–∑. –ù–æ –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å–ª–æ–∂–Ω–∞—è, –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è —Ç–∏–ø—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ. –ö–æ–Ω–µ—á–Ω–æ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∑–∞ –ø—Ä–∞–≤–∏–ª–æ —Å–Ω–∞—á–∞–ª–∞ —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–ø–∏—Å–∞—Ç—å, –∞ –ø–æ—Ç–æ–º –∑–∞–¥–∞–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é; –Ω–æ –º–æ–∂–Ω–æ —Å–ª–µ–≥–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:
    NumOrZero = [   func = (x as any)=> if x=null then 0 else Number.From(x),
                        typ = Value.Type(func),
                        params = Type.FunctionParameters(typ),
                        min = Type.FunctionRequiredParameters(typ),
                        ftyp = Type.ForFunction([ReturnType = Int64.Type, Parameters = params], min),
                        fres = Value.ReplaceType(func, ftyp)][fres]




    func ‚Äì –≤—Å—ë —Ç–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ –≤ –Ω–µ–π —É–∫–∞–∑–∞–Ω —Ç–∏–ø –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞,
    typ ‚Äì –ø–æ–ª—É—á–∞–µ–º —Ç–∏–ø –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–∏–∑ —á–µ–≥–æ –æ–Ω —Å–æ—Å—Ç–æ–∏—Ç –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏),
    params ‚Äì –≤—ã—Ç–∞—â–∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    min ‚Äì –≤—ã—Ç–∞—â–∏–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤—ã–∑–æ–≤–∞ (FunctionRequiredParameters —Å–∞–º–∞ –ø–æ—Å—á–∏—Ç–∞–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –æ—Ç–±—Ä–æ—Å–∏—Ç —Ç–µ, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —É–∫–∞–∑–∞–Ω–æ optional)
    ftyp ‚Äì –∞ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º —Ç–∏–ø –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏, —É–∫–∞–∑–∞–≤ –Ω—É–∂–Ω—ã–π ReturnType, –∞ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –±—ã–ª–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    fres ‚Äì –Ω—É –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–∏–ø.

    –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –µ—Å–ª–∏ –≤ —Ö–æ–¥–µ –æ—Ç–ª–∞–¥–∫–∏ –≤—ã —á—Ç–æ-—Ç–æ –ø–æ–º–µ–Ω—è–µ—Ç–µ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö –∏–ª–∏ –≤ —Ç–µ–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É –∏ –Ω–∏—á–µ–≥–æ –±–æ–ª—å—à–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –Ω–µ –ø—Ä–∏–¥—ë—Ç—Å—è.
    ]

[   –°–ª–æ–∂–Ω–æ –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö 2 - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Type.ForFunction
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑ —É–∂ –Ω–∞—á–∞–ª–∏ —Ä–∞–∑–±–∏—Ä–∞—Ç—å —Ç–µ–º—É —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏, —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –µ—â—ë –æ–¥–∏–Ω, –≤–µ—Å—å–º–∞ –≤–∞–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å. –í—Å–µ –¥—É–º–∞—é –∑–Ω–∞—é—Ç, —á—Ç–æ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞—Å–∏–≤–æ–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ —Å –µ—ë –æ–ø–∏—Å–∞–Ω–∏–µ–º, –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–≤–µ—Å—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.
    –ï—Å–ª–∏ –≤–∞–º —Ö–æ—Ç–µ–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å –ø–æ–¥–æ–±–Ω–æ–µ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ–¥ –Ω–∏–∂–µ –¥–ª—è –≤–∞—Å:
    let
        from = Table.FromRecords({
            [A = null, B = 2, C = 3, D = "4"],
            [A = "5", B = 6, C = null, D = 8],
            [A = 9, B = null, C = "10", D = 11]
        }),
        NumOrZero = [   func = (x as any)=> if x=null then 0 else Number.From(x),
                typ = Value.Type(func),
                params = Type.FunctionParameters(typ),
                min = Type.FunctionRequiredParameters(typ),
                ftyp = Type.ForFunction([ReturnType = Int64.Type, Parameters = params], min),
                doc = [
                        Documentation.Name = "NumOrZero", 
                        Documentation.Description = "—Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ <i><b>null</b></i> –Ω—É–ª—ë–º –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫ —á–∏—Å–ª–æ–≤–æ–º—É —Ç–∏–ø—É", 
                        Documentation.LongDescription = "—Ñ—É–Ω–∫—Ü–∏—è –∑–∞–º–µ–Ω—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ <i><b>null</b></i> –Ω—É–ª—ë–º –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∫ —á–∏—Å–ª–æ–≤–æ–º—É —Ç–∏–ø—É", 
                        Documentation.Examples = {
                                                    [Description = "—á–∏—Å–ª–∞ –æ—Å—Ç–∞—é—Ç—Å—è —á–∏—Å–ª–∞–º–∏", Code = "=NumOrZero(5)", Result = "5"], 
                                                    [Description = "—á–∏—Å–ª–æ –∫–∞–∫ —Ç–µ–∫—Å—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–∏—Å–ª–æ–º", Code = "=NumOrZero(""5"")",Result = "5"], 
                                                    [Description = "null –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –Ω–æ–ª—å", Code = "=NumOrZero(null)",Result = "0"]
                                                }
                        ],
                ftypwithmeta = Value.ReplaceMetadata(ftyp,doc), 
                fres = Value.ReplaceType(func, ftypwithmeta)][fres],

        to = Table.TransformColumns(from, {},NumOrZero)
    in
        to

    –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –≤—Å—ë —Å —Ç–æ–π –∂–µ NumOrZero –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–æ—Å—Ç–∞. –¢–æ–ª—å–∫–æ –≤ –Ω–µ—ë –¥–æ–±–∞–≤–∏–ª–æ—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:
    doc - —ç—Ç–æ –∑–∞–ø–∏—Å—å, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –æ–ø–∏—Å–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏:
    Documentation.Name ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
    Documentation.Description –∏ Documentation.LongDescription ‚Äì –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–µ–≥–∏ ‚Äì —Ç–∞–∫ –º–æ–∂–Ω–æ –Ω–∞–≤–µ—Å—Ç–∏ –∫—Ä–∞—Å–æ—Ç—É)
    Documentation.Examples ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–º–µ—Ä–æ–≤. –ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–∞–ø–∏—Å—å –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ [Description,Code,Result] ‚Äì —Ç.–µ. –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–¥ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â—ë–Ω

    –ß—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å —Å —ç—Ç–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º? –ï–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∏–ø –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≤–∏–¥–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    ftypwithmeta ‚Äì –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Value.ReplaceMetadata, –∫–æ—Ç–æ—Ä–∞—è –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ doc –∫ —Ç–∏–ø—É ftyp

    fres ‚Äì –Ω—É –∏ —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ func —Ç–∏–ø —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∫ –Ω–µ–º—É –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.
    –¢–µ–ø–µ—Ä—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ, –µ—Å–ª–∏ –≤—ã–±—Ä–∞—Ç—å —à–∞–≥ NumOrZero, –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –ø–æ–ª–Ω–æ–µ –µ—ë –æ–ø–∏—Å–∞–Ω–∏–µ, —á—Ç–æ –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥ –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª–µ–µ —á–µ–º —Å–æ–ª–∏–¥–Ω–æ.
    –ö–æ–Ω–µ—á–Ω–æ, —è –Ω–µ –ø—Ä–∏–∑—ã–≤–∞—é –¥–µ–ª–∞—Ç—å –ø–æ–¥–æ–±–Ω–æ–µ —Å –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, –Ω–æ –µ—Å–ª–∏ –≤—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —á—Ç–æ-—Ç–æ —Ç–æ–ª–∫–æ–≤–æ–µ, —á–µ–º –≥–æ—Ç–æ–≤—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –∫–æ–ª–ª–µ–≥–∞–º–∏, –ª—É—á—à–µ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å ‚Äì –∏ –∏–º –±—É–¥–µ—Ç —É–¥–æ–±–Ω–µ–µ, –∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–µ–±—è –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å ¬´–Ω–∞—Å—Ç–æ—è—â–∏–º¬ª —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.
    ]

[   UnZip 1 - –û–±—â–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ –∫–æ–¥ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì BinaryFormat.*

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —Ç–µ–º–µ –ø—Ä–æ TableToBinaryText —É–∂–µ –ø–æ–¥–Ω–∏–º–∞–ª—Å—è –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, —á—Ç–æ docx, xlsx, pptx –∏ –ø—Ä–æ—á–∏–µ —Ñ–∞–π–ª—ã –æ—Ñ–∏—Å–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π zip-–∞—Ä—Ö–∏–≤—ã. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, —Ä–µ—à–µ–Ω–∏–µ –º–Ω–æ–≥–∏—Ö –∑–∞–¥–∞—á –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∞—Ä—Ö–∏–≤–∞.

    –î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–≤–æ–¥–Ω—ã—Ö –∑–∞–º–µ—á–∞–Ω–∏–π:
    - zip-–∞—Ä—Ö–∏–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    - –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–µ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ç–∫–∏ –∏ —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
    - —Ñ—É–Ω–∫—Ü–∏–∏ BinaryFormat.* –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–ø–ª–∏—Ç—Ç–µ—Ä—É (—Å—Ä–∞–≤–Ω–∏—Ç–µ Text.Split(txt,‚Äù ‚Äú) –∏ Splitter.SplitTextByDelimiter(" ")(txt) ‚Äì —Ç.–µ. —Ñ—É–Ω–∫—Ü–∏—è —Å –µ—ë –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫–∞–∫ –±—ã –ø–∏—à–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤–æ –≤—Ç–æ—Ä—ã—Ö —Å–∫–æ–±–∫–∞—Ö –ø–æ—Å–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏
    - –ø–æ–¥ –¥–≤–æ–∏—á–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –ø–æ—Ä—è–¥–æ–∫/—Ö–∞—Ä–∞–∫—Ç–µ—Ä —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –±–∏–Ω–∞—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è

    –¢–µ–ø–µ—Ä—å –∫ –¥–µ–ª—É (—Ç–µ–ª—É))):
    (ZIP as binary) =>
    let
        ui16 = BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger16, ByteOrder.LittleEndian),
        ui32 = BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger32, ByteOrder.LittleEndian),
        f = (x) => try Binary.Decompress(x, Compression.Deflate) otherwise null,
        g = (x) => BinaryFormat.Transform(BinaryFormat.Binary(x),f),
        h = (x) => [    head = BinaryFormat.Record([a = BinaryFormat.Binary(14), size=ui32, c=ui32, name=ui16, extra=ui16])(x),
                        body = BinaryFormat.Record( [flag  = true,
                                                    Filename = BinaryFormat.Text(head[name]),
                                                    Extras   = BinaryFormat.Text(head[extra]),
                                                    Content  = g(head[size])])][body],
        iftrue = BinaryFormat.Choice(BinaryFormat.Binary(26),h),
        iffalse = BinaryFormat.Record([flag = false]),
        getfile = BinaryFormat.Choice(ui32, (x)=> if x = 67324752 then iftrue else iffalse, type binary),
        filelist = BinaryFormat.List(getfile, each [flag] = true)(ZIP),
        remove = List.RemoveLastN(filelist,1),
        to = Table.FromRecords(remove,{"Filename","Content"})
    in
        to

    –í–æ—Ç —Ç–∞–∫–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏ –≤–µ—Å—å–º–∞ —à—É—Å—Ç—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –¢–µ–º –∂–µ, –∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –∫–∞–∫ –æ–Ω–∞ —É—Å—Ç—Ä–æ–µ–Ω–∞, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π ‚Äì –≤—Å—ë –ø—Ä–æ—Å—Ç–æ –Ω–µ –≤–ª–µ–∑–ª–æ –≤ –æ–¥–∏–Ω –ø–æ—Å—Ç.
    ]

[   UnZip 2 - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì BinaryFormat.*
        –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
        –≠—Ç–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∫–æ–¥—É —Ñ—É–Ω–∫—Ü–∏–∏ UnZip –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–æ—Å—Ç–∞:
        ZIP ‚Äì –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
        ui16 –∏ ui32 ‚Äì —Ñ–æ—Ä–º–∞—Ç—ã —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –±–∞–π—Ç–æ–≤ (2 –∏ 4 –±–∞–π—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, —Å –æ–±—Ä–∞—Ç–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º –±–∞–π—Ç–æ–≤ ‚Äì —Ç–∞–∫ –æ–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤–µ)

        –ê —Ç–µ–ø–µ—Ä—å –Ω–∞—á–Ω—É —Å –∫–æ–Ω—Ü–∞, —Ç–∞–∫ –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–µ–µ:
        to ‚Äì –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π remove –≤ —Ç–∞–±–ª–∏—Ü—É
        remove ‚Äì —É–¥–∞–ª–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞

        filelist ‚Äì –ø—Ä–∏–º–µ–Ω—è–µ–º BinaryFormat.List –∫ –Ω–∞—à–µ–º—É —Ñ–∞–π–ª—É ZIP. –ò–¥–µ—è –ø—Ä–æ—Å—Ç–∞—è ‚Äì –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–µ—Ç –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫, –ø—Ä–∏—á–µ–º –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–≤—ã–π —Å–≤–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì getfile, –∞ —á–∏—Ç–∞–µ—Ç –ø–æ–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —É—Å–ª–æ–≤–∏–µ —É–∂–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫, –ø–æ—Ç–æ–º—É –∏ –ø–æ–Ω–∞–¥–æ–±–∏–ª—Å—è remove
        getfile ‚Äì –∞ –≤–æ—Ç —ç—Ç–æ —É–∂–µ –≤—ã–Ω–æ—Å –º–æ–∑–≥–∞ - BinaryFormat.Choice - –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å, –∞ –≤—Ç–æ—Ä–æ–π ‚Äì —á—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ ui32 ‚Äì –ø—Ä–æ—á–∏—Ç–∞–π —á–µ—Ç—ã—Ä–µ –±–∞–π—Ç–∞; –µ—Å–ª–∏ –∏—Ö —á–∏—Å–ª–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ 67324752 (–∏–ª–∏ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–µ 04 03 4b 50 –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∏–ª–∏ 50 4b 03 04 –≤ –ø—Ä—è–º–æ–º, –∏–ª–∏ PK\x03\x04 ‚Äì —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –Ω–∞—á–∞–ª–∞ —Ñ–∞–π–ª–∞) —Ç–æ –ø—Ä–∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏—é iftrue –∏–Ω–∞—á–µ iffalse
        iffalse ‚Äì –∫–∞–∫ –±—ã –¥–≤–æ–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –æ–Ω –Ω–∏—á–µ–≥–æ –Ω–µ —á–∏—Ç–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç [flag = false] –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å
        iftrue ‚Äì –∞ –≤–æ—Ç –∑–¥–µ—Å—å —Å–ª–æ–∂–Ω–µ–µ ‚Äì —Å–Ω–æ–≤–∞ BinaryFormat.Choice, —Ç–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å —Å—á–∏—Ç—ã–≤–∞–µ–º 26 –±–∞–π—Ç (—Å—É–º–º–∞—Ä–Ω–æ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ –≤—Å–µ–≥–¥–∞ –∏–¥–µ—Ç 30 –±–∞–π—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø—Ä–æ—Å—Ç–æ 4 –º—ã —É–∂–µ —Å—á–∏—Ç–∞–ª–∏ –≤ getfile, —Ç–µ–ø–µ—Ä—å –¥–æ—á–∏—Ç—ã–≤–∞–µ–º –æ—Å—Ç–∞—Ç–æ–∫) –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–∏–º —Ñ—É–Ω–∫—Ü–∏—é h (–µ—â—ë —Ä–∞–∑ –Ω–∞–ø–æ–º–Ω—é ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫ –º—ã –±—É–¥–µ–º —á–∏—Ç–∞—Ç—å –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
        h ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –¥–≤—É—Ö –ø–æ–ª–µ–π; head –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞—à–∏ 26 –±–∞–π—Ç–æ–≤ (a - –ø–µ—Ä–≤—ã–µ 14 –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–ª–∏, size ‚Äì —Å–ª–µ–¥—É—é—â–∏–µ 4, —ç—Ç–æ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, c ‚Äì —Å–ª–µ–¥—É—é—â–∏–µ 4 –∏ –ø–æ 2 –±–∞–π—Ç–∞ name –∏ extra ‚Äì –ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω, —ç—Ç–æ –±–∏–Ω–∞—Ä–Ω–∏–∫) ‚Äì —Ç.–µ. –º—ã –ø–æ–ª—É—á–∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–ª–∏–Ω–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞, –¥–ª–∏–Ω–µ extra –ø–æ–ª—è –∏ —Ä–∞–∑–º–µ—Ä–µ —Å–∞–º–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ; body ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è ‚Äì –∏–º—è, extra, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ‚Äì –ø–æ—Ä—è–¥–æ–∫ —Ç–∞–∫–∂–µ –≤–∞–∂–µ–Ω, –ø—Ä–∏—á—ë–º Filename —Å—Ä–∞–∑—É —á–∏—Ç–∞–µ–º –∫–∞–∫ —Ç–µ–∫—Å—Ç, –∞ –≤–æ—Ç —Å Content –µ—â—ë –Ω—É–∂–Ω–æ –ø–æ–≤–æ–∑–∏—Ç—å—Å—è ‚Äì –º—ã –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é g
        g ‚Äì –º—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ f
        f ‚Äì –Ω—É –≤–æ—Ç –∏ –¥–æ–±—Ä–∞–ª–∏—Å—å ‚Äì –Ω–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ –º—ã —á–∏—Ç–∞–µ–º –∞—Ä—Ö–∏–≤, –∞ –∑–Ω–∞—á–∏—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞–¥–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –Ω–µ—Å–∂–∞—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äì Compression.Deflate –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è zip.
        –ö–∞–∫-—Ç–æ —Ç–∞–∫, –∫–æ–¥ –ø–∏—Å–∞—Ç—å –ø—Ä–æ—â–µ, —á–µ–º –æ–±—ä—è—Å–Ω–∏—Ç—å –µ–≥–æ —Å—É—Ç—å. –Æ–∑–∞–π—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ!
    ]
[   UnZip 3 ‚Äì –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì BinaryFormat.*

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –•–æ—á—É –ª–æ–≥–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ–º—É zip-–∞—Ä—Ö–∏–≤–æ–≤. –í –æ—Ñ–∏—Å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –≤—Å–µ —Ñ–∞–π–ª—ã –∏–º–µ—é—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∞—Ç–∏–Ω–∏—Ü–µ–π –∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏—Ö —á—Ç–µ–Ω–∏–µ–º –Ω–µ—Ç; –Ω–æ –≤–æ—Ç –µ—Å–ª–∏ –≤—ã –æ—Ç–∫—Ä–æ–µ—Ç–µ –æ–±—ã—á–Ω—ã–π zip, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π, —Ç–æ —É–≤–∏–¥–∏—Ç–µ —Ç–∞–∫–æ–µ: ÔøΩÔøΩÔøΩÔøΩ_ÔøΩÔøΩÔøΩÔøΩ_ÔøΩÔøΩÔøΩÔøΩÔøΩ.
    –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –≤ zip –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ (–∞ —Ç–æ—á–Ω–µ–µ –≤—Å—ë, —á—Ç–æ –Ω–µ –ª–∞—Ç–∏–Ω–∏—Ü–∞) –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ DOS-–∫–æ–¥–∏—Ä–æ–≤–∫–∞—Ö. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É BinaryFormat.Text –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É, –≤ —Å–ª—É—á–∞–µ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã ‚Äì —ç—Ç–æ cp866.
    –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –∫–æ–¥, –≤ –∫–æ—Ç–æ—Ä–æ–º UnZip –¥–æ–ø–æ–ª–Ω–µ–Ω–∞ –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º, –æ–Ω –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π, –∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞.
    –ù—É –∏ –æ—Ñ–æ—Ä–º–∏–ª ¬´–ø–æ-–±–æ–µ–≤–æ–º—É¬ª - —Å –±–ª–µ–∫–¥–∂–µ–∫–æ–º, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π‚Ä¶
    [   func = (ZIP, optional cp)=>
            [   ui16 = BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger16, ByteOrder.LittleEndian),
                ui32 = BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger32, ByteOrder.LittleEndian),
                b = (x) => BinaryFormat.Binary(x),
                c = if cp is null then 866 else cp,
                f = (x) => try Binary.Decompress(x, Compression.Deflate) otherwise null,
                g = (x) => BinaryFormat.Transform(b(x),f),
                h = (x) => [head = BinaryFormat.Record([a = b(14), size=ui32, c=b(4), name=ui16, extra=ui16])(x),
                            body = BinaryFormat.Record( [ FileName = BinaryFormat.Text(head[name],c),
                                                    Extras   = b(head[extra]),
                                                    Content  = g(head[size]),
                                                    flag  = true])][body],
                iftrue = BinaryFormat.Choice(b(26),h),
                iffalse = BinaryFormat.Record([flag = false]),
                getfile = BinaryFormat.Choice(ui32, (x)=> if x = 67324752 then iftrue else iffalse, type binary),
                filelist = BinaryFormat.List(getfile, each [flag] = true)(ZIP),
                remove = List.RemoveLastN(filelist,1),
                to = Table.FromRecords(remove, type table [FileName = text, Content = binary])][to],
        typ = type function (
                    ZIP as (type binary meta [Documentation.FieldCaption = "–±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (zip,xlsx,docx,pptx –∏ —Ç.–ø.)"]),
                    optional cp as (type number meta [Documentation.FieldCaption = "–∫–æ–¥–∏—Ä–æ–≤–∫–∞", Documentation.SampleValues = {866}])
                            )           
                    as table meta [ 
                                    Documentation.Name = "UnZip (@buchlotnik)",
                                    Documentation.LongDescription = "–§—É–Ω–∫—Ü–∏—è —Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ zip-–∞—Ä—Ö–∏–≤–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–ª—è–º–∏ FileName - –∏–º—è —Ñ–∞–π–ª–∞ (—Å –ø—É—Ç—ë–º, –µ—Å–ª–∏ –æ–Ω –≤ –ø–æ–¥–ø–∞–ø–∫–µ) –∏ Content - –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è <b>–Ω–µ –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö</b> –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (–¥–ª—è –æ—Ñ–∏—Å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 866 - –∫–æ–¥–∏—Ä–æ–≤–∫–∞ DOS <b>—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã</b>"        
                                    ],
        result = Value.ReplaceType(func,typ)
    ][result]
    ]

[   –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Ñ–∞–π–ª–∞ Word /#–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Xml.Document

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ó–∞—Ö–æ—Ç–µ–ª–æ—Å—å —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∞—Å–ø–µ–∫—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è UnZip ‚Äì –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –∏–∑ —Ñ–∞–π–ª–∞ Word. –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Ñ—É–Ω–∫—Ü–∏—è:
    WordTablesList = (file)=>
        [
        getTable = (xml)=>[
            f=(x)=>[a = Table.SelectRows(x,(r)=>r[Name]="tr")[Value],
                    b = List.Max(List.Transform(a,Table.RowCount)),
                    c = Table.FromList(a,g,b)][c],
            g=(x)=>List.Transform(x[Value],h),
            h=(x)=>Text.Combine(List.Transform(Table.SelectRows(x,(r)=>r[Name]="p")[Value],i),"#(lf)"),
            i=(x)=>[a = Table.SelectRows(x,(r)=>r[Name]="r")[Value],
                    b = (x)=> Table.SelectRows(x,(r)=>r[Name]="t")[Value],
                    c = List.Combine(List.Transform(a,b)),
                    d = List.Select(c,(x)=>Value.Is(x,Text.Type)),
                    f = Text.Combine(d)][f],
            to = f(xml)][to],
        
        from = UnZip(file),
        xml = Xml.Document(from{[FileName="word/document.xml"]}[Content]){[Name="document"]}[Value]{[Name="body"]}[Value],
        filtr = Table.SelectRows(xml, each ([Name] = "tbl"))[Value],
        to = List.Transform(filtr,getTable)
        ][to]

    from ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ UnZip
    xml ‚Äì –∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ–ª—É—á–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ document.xml, –≤ –Ω–µ–º document, –≤ –Ω–µ–º body
    filtr - –≤—ã–±—Ä–∞–ª–∏ —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã - tbl (–µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã –Ω–µ —Ç–∞–±–ª–∏—Ü—ã, –∞ —Ç–µ–∫—Å—Ç ‚Äì –≤—ã–±–∏—Ä–∞–π—Ç–µ p)
    to ‚Äì –≤—ã—Ç–∞—â–∏–ª–∏ –∏–∑ xml —Å–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã —Ñ—É–Ω–∫—Ü–∏–µ–π getTable

    –¢–µ–ø–µ—Ä—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ getTable:
    to ‚Äì –∏—Ç–æ–≥–æ–º —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ f –∫ xml-—Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
    f ‚Äì –Ω–∞ —à–∞–≥–µ a –≤—ã–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–≥–∏ tr ‚Äì —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã, —à–∞–≥ b ‚Äì –Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É —Å—Ç—Ä–æ–∫–∏ (—à–∞–≥ –Ω—É–∂–µ–Ω, –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏), –Ω—É –∏ –Ω–∞ —à–∞–≥–µ —Å —Å–æ–±–∏—Ä–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π g
    g ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫, –Ω–æ –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç h
    h ‚Äì —Å–æ–±–∏—Ä–∞–µ—Ç —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–æ–∫–∏ (–≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Ç–æ–∂–µ –±—ã–≤–∞—é—Ç –∞–±–∑–∞—Ü—ã), –ø—Ä–∏–º–µ–Ω–∏–≤ –∫ –∫–∞–∂–¥–æ–º—É –∞–±–∑–∞—Ü—É —Ñ—É–Ω–∫—Ü–∏—é i
    i‚Äì –¥–æ–∫–∞–ø—ã–≤–∞–µ—Ç—Å—è –¥–æ —Ç–µ–∫—Å—Ç–∞: a ‚Äì –±–µ—Ä–µ—Ç —Ç–µ–≥–∏ "r", b ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–Ω–∏–º–∞–Ω–∏—è —Ç–µ–≥–∞ "t", c ‚Äì –ø–æ–ª—É—á–∞–µ—Ç –∏–∑ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ "t", d ‚Äì –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, f ‚Äì —Å–æ–±–∏—Ä–∞–µ—Ç –∫—É—Å–∫–∏ –≤ –µ–¥–∏–Ω—ã–π —Ç–µ–∫—Å—Ç.

    –ö–∞–∫ –±—ã –∏ –≤—Å—ë. –° –Ω–µ–ø—Ä–∏–≤—ã—á–∫–∏ –∫–æ–¥ –º–æ–∂–µ—Ç –∏ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞–ø—Ä—è–∂–Ω–æ, –Ω–æ —Å—É—Ç—å –ø—Ä–æ—Å—Ç–∞—è ‚Äì –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ ¬´–º–∞—Ç—Ä—ë—à–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–π¬ª —Ä–∞–∑–±–∏—Ä–∞–µ–º ¬´–º–∞—Ç—Ä–µ—à–∫—É xml¬ª. –≠—Ç–æ –Ω–∞–º–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º –º—ã—à–∫–æ–∫–ª–∞—Ü–∞—Ç—å –¥–µ—Å—è—Ç–∫–∏ —à–∞–≥–æ–≤ —Å —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ–º —Å—Ç–æ–ª–±—Ü–æ–≤, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–π, –ø–∞–π–≤–æ—Ç–æ–º –∏ –ø—Ä–æ—á–µ–π –º—É—Ç—å—é, –∫–æ—Ç–æ—Ä—ã–µ –∑–¥–µ—Å—å —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –Ω—É–∂–Ω—ã.
    –¢–∞–∫ —á—Ç–æ –ø–∏—à–∏—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –ø–∏—à–∏—Ç–µ —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º!
    ]
 
[   List.TransformMany –∏–ª–∏ –¥–≤–æ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.TransformMany

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç–µ –≤—Å–ø–ª—ã–ª–∞ –∑–∞–¥–∞—á–∫–∞, –ø–æ—ç—Ç–æ–º—É —Ä–µ—à–∏–ª —Ä–∞–∑–æ–±—Ä–∞—Ç—å List.TransformMany.
    –ß–∏—Ç–∞–µ–º —Å–ø—Ä–∞–≤–∫—É:
    List.TransformMany(list as list, collectionTransform as function, resultTransform as function) as list
    collectionTransform –∏–º–µ–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä—É (x as any) as list => ..., –≥–¥–µ x ‚Äî —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –≤ list. resultTransform –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –∏–º–µ–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä—É (x as any, y as any) as any => ..., –≥–¥–µ x ‚Äî —ç–ª–µ–º–µ–Ω—Ç –≤ list, –∞ y ‚Äî —ç–ª–µ–º–µ–Ω—Ç, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—É—Ç–µ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è collectionTransform –∫ —ç—Ç–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.
    –ú–¥—è‚Ä¶ –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è.
    –î–æ–ø—É—Å—Ç–∏–º –∏–º–µ–µ–º —Å–ø–∏—Å–æ–∫ {x1,x2,x3}.
    collectionTransform (cT) –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç, –∞ –º–æ–∂–µ—Ç –ø–æ—Ä–æ–¥–∏—Ç—å —Å–ø–∏—Å–æ–∫ ‚Äì –∏ –Ω–∞ –≤—ã—Ö–æ–¥ –º—ã –ø–æ–ª—É—á–∏–º {cT(x1) ={y1}, cT(x2)={y21,y22},cT(x3)={y31,y32,33}}.
    –î–∞–ª–µ–µ resultTransform (rT) –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏ –∫ –∏—Å—Ö–æ–¥–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º, –∏ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É cT (–∫ –∫–∞–∂–¥–æ–º—É –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äì —ç—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ), –ø–æ—ç—Ç–æ–º—É –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫: {rT(x1,y1),rT(x2,y21),rT(x2,y22),rT(x3,y31),rT(x3,y32),rT(x3,y33)}
    –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —Å–ø–∏—Å–æ–∫ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫, –Ω–æ –≤–æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–±–æ—Ç—ã collectionTransform.

    –†–∞–∑–±–µ—Ä–µ–º —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π, –Ω–æ –±–æ–µ–≤–æ–π –ø—Ä–∏–º–µ—Ä:
    let
        from = Table.FromRecords({  [a="—Ä–∞–∑",b="1-1"],
                                    [a="–¥–≤–∞",b="2-1,2-2"],
                                    [a="—Ç—Ä–∏",b="3-1,3-2,3-3"]}),
        lst = Table.ToRows(from),
        tr = List.TransformMany(lst,(x)=>Text.Split(x{1},","),(x,y)=>{x{0}}&Text.Split(y,"-")),
        to = Table.FromRows(tr)
    in
        to
    from ‚Äì –Ω–∞ –≤—Ö–æ–¥–µ –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É, —Å –ø—Ä–æ–±–ª–µ–º–Ω—ã–º —Å—Ç–æ–ª–±—Ü–æ–º b ‚Äì –≤ –Ω—ë–º –Ω–∞–¥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ –∑–∞–ø—è—Ç–æ–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, –∞ –¥–∞–ª–µ–µ –∫–∞–∂–¥—ã–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –µ—â—ë —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞, –Ω–æ —É–∂–µ –ø–æ –¥–µ—Ñ–∏—Å—É. –û–±—ã—á–Ω–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Table.TransformColumns, Table.ExpandList.Column, Table.SplitColumn; –Ω–æ —Å–µ–≥–æ–¥–Ω—è –º—ã –ø—Ä–æ –¥—Ä—É–≥–æ–µ:
    lst ‚Äì –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É –≤ —Å–ø–∏—Å–æ–∫
    tr ‚Äì –≤—ã–∫–∞—Ç—ã–≤–∞–µ–º List.TransformMany. collectionTransform - (x)=>Text.Split(x{1},",") ‚Äì –¥–µ–ª–∏–º –ø–æ –∑–∞–ø—è—Ç–æ–π –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ (—ç—Ç–æ –±—ã–ª —Å—Ç–æ–ª–±–µ—Ü b). resultTransform - (x,y)=>{x{0}}&Text.Split(y,"-") ‚Äì –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–æ–∫–∏ ‚Äì —ç—Ç–æ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ x (–±—ã–≤—à–∏–π —Å—Ç–æ–ª–±–µ—Ü a) –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è y –ø–æ –¥–µ—Ñ–∏—Å—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–∑ –Ω—É–∂–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ç—Ä–æ–∫, –ø—Ä–∏—á—ë–º –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Ö–æ–¥–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
    to ‚Äì –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Å–æ–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É
    –í—É–∞–ª—è, –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞.

    –í —Ü–µ–ª–æ–º —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–∫–æ–ª—å–Ω–∞—è, –Ω–æ –≤–µ—Å—å–º–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è. –ü–∏—Ö–∞—Ç—å –µ—ë –≤–æ –≤—Å–µ –∑–∞–¥–∞—á–∏ —è –±—ã –Ω–µ —Å—Ç–∞–ª ‚Äì –æ–Ω–∞ –ú–û–ñ–ï–¢ –¥–æ–±–∞–≤–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç–∏, –Ω–æ —ç—Ç–æ –ù–ï –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û - –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω—É–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.
    –ê –≤–æ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–µ—Å—å–º–∞ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π –∏ –Ω–∞ –º–æ–π –≤–∫—É—Å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π. –¢–∞–∫ —á—Ç–æ –∫–æ–º—É –∑–∞–π–¥–µ—Ç ‚Äì —é–∑–∞–π—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ!
    ]
    
[   Self referencing query –∏–ª–∏ incremental update –≤ Excel / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Excel.CurrentWorkbook()

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç–µ –≤—Å–ø–ª—ã–ª –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥—É–µ—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å.
    –ò—Ç–∞–∫, –∏–º–µ–µ–º –ø–∞–ø–∫—É —Å –∫—É—á–µ–π —Ñ–∞–π–ª–æ–≤ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≤—ã–≥—Ä—É–∑–∫–∏ –∏–∑ –∫–∞–∫–æ–π-—Ç–æ —Å–∏—Å—Ç–µ–º—ã), –∫ –∫–æ—Ç–æ—Ä–æ–π –º—ã –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è —Å —Ü–µ–ª—å—é –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –ü—Ä–∏ —ç—Ç–æ–º –≤ –ø–∞–ø–∫–µ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å—é –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –º—ã —Ö–æ—Ç–∏–º –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –Ω–∏—Ö –∫ –Ω–∞—à–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ, –∞ –Ω–µ –∑–∞–∫–∞—á–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∞–ø–∫—É —Ü–µ–ª–∏–∫–æ–º. –í–ø–æ–ª–Ω–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ, –Ω–æ –≤ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ —É –Ω–∞—Å —Ç–æ–ª—å–∫–æ Excel —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π PQ. –†–µ—à–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–∞–≥–æ–≤.

    –®–∞–≥ 0 ‚Äì –∏—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å (tst)
    let
        f=(x)=>Excel.Workbook(x){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Data],
        
        from = Folder.Files("D:\tst")[[Name],[Content]],
        tr = Table.TransformColumns(from,{"Content",f}),
        tbl = Table.ExpandTableColumn(tr, "Content", {"a".."c"})
    in
        tbl
    from ‚Äì –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ø–∞–ø–∫–µ, –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏ –∏—Ö –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    tr ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ f ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¢–∞–±–ª–∏—Ü—ã1, –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π
    tbl ‚Äì –Ω—É –∏ —Ä–∞—Å–∫—Ä—ã–ª–∏ —Å—Ç–æ–ª–±–µ—Ü —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º, –ø–æ–ª—É—á–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É, –ø–æ—Ä–∞–¥–æ–≤–∞–ª–∏—Å—å –∏ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –µ—ë –Ω–∞ –ª–∏—Å—Ç

    –®–∞–≥ 1 ‚Äì –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å (tmp)
    Excel.CurrentWorkbook(){[Name="tst"]}[Content]
    –í—Å—è —Å—É—Ç—å –ø—Ä–∏—ë–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–ø—Ä–æ—Å–∞ tst –Ω–∞ –ª–∏—Å—Ç —É –Ω–∞—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ —Å –∏–º–µ–Ω–µ–º tst –∏ –º—ã –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –Ω–µ–π. –¢.–µ. —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Å–≤—è–∑–µ–π tst —Ç–∞—â–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–ø–∫–∏, –∞ tmp ‚Äì –∫–∞–∫—É—é-—Ç–æ —Ç–∞–±–ª–∏—Ü—É –∏–∑ –∫–Ω–∏–≥–∏ –∏ —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∫ –±—É–¥—Ç–æ –Ω–µ —Å–≤—è–∑–∞–Ω—ã

    –®–∞–≥ 2 ‚Äì –º–µ–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å (tst)
    let
        f=(x)=>Excel.Workbook(x){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Data],
        
        from = Folder.Files("D:\tst")[[Name],[Content]],
        lst = List.Buffer(List.Distinct(tmp[Name])),
        filtr = Table.SelectRows(from, (x)=> not List.Contains(lst,x[Name])),
        tr = Table.TransformColumns(filtr,{"Content",f}),
        tbl = Table.ExpandTableColumn(tr, "Content", {"a", "b", "c"}),
        cmb = Table.Combine({tmp,tbl})
    in
        cmb
    –Ω—É –∏ —Ç–µ–ø–µ—Ä—å –∫–æ–ª–¥—É–Ω—Å—Ç–≤–æ ‚Äì –æ—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ –∂–µ, –ø—Ä–æ—Å—Ç–æ –Ω–µ–º–Ω–æ–∂–∫–æ –¥–æ–±–∞–≤–ª—è–µ–º:
    lst ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ tmp
    filtr ‚Äì –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏ –∑–∞–ø—Ä–æ—Å –∫ –ø–∞–ø–∫–µ, –æ—Å—Ç–∞–≤–∏–≤ —Ç–æ–ª—å–∫–æ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
    cmb ‚Äì –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –≤–Ω–æ–≤—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –∏–º–µ—é—â–µ–π—Å—è

    –í—Å—ë! –ü–æ–∫–∞ –≤ –ø–∞–ø–∫–µ –Ω–µ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã, –Ω–∞ –ª–∏—Å—Ç –±—É–¥–µ—Ç –≥—Ä—É–∑–∏—Ç—å—Å—è tmp, —Ç.–µ. –∏–º–µ—é—â–∞—è—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ ‚Äì –∑–∞–ø—Ä–æ—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è.
    –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–µ—Ç–æ–¥–∞ ‚Äì –æ—á–µ–≤–∏–¥–Ω–æ —ç—Ç–æ —Å–∏–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤ –∏ –±–æ–ª—å—à–æ–π —Å–∫–∞—á–∏–≤–∞–µ–º—ã–π –æ–±—ä–µ–º. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ ‚Äì –∏–Ω—Ñ—É –Ω—É–∂–Ω–æ –≥—Ä—É–∑–∏—Ç—å –Ω–∞ –ª–∏—Å—Ç, —Ñ–∞–π–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª—å—à–æ–π –∏ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ 1 048 575 —Å—Ç—Ä–æ–∫ (–ø—Ä–æ —à–∞–ø–∫—É –Ω–µ –∑–∞–±—ã–≤–∞–µ–º). –ö–æ–Ω–µ—á–Ω–æ, –Ω–∞ —Ç–∞–∫–∏—Ö –æ–±—ä–µ–º–∞—Ö —Å—Ç–æ–∏—Ç –æ–±—Å—É–∂–¥–∞—Ç—å —á—Ç–æ-—Ç–æ –±–æ–ª–µ–µ —Ü–∏–≤–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ: –ë–î –¥–ª—è –¥–∞–Ω–Ω—ã—Ö, PBI –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏‚Ä¶ –Ω–æ –∑–∞ –Ω–µ–∏–º–µ–Ω–∏–µ–º –≥—Ä–∞—Ñ–∏–Ω–∏, –∏–º–µ–µ–º –≥–æ—Ä–Ω–∏—á–Ω—É—é )))
    ]
   
[   Excel.CurrentWorkbook(){[Name=‚Ä¶]}[Content] –∏–ª–∏ –∑–∞—á–µ–º –Ω–∞–º —Å—Ç–æ–ª—å–∫–æ —Å–∫–æ–±–æ–∫? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Excel.CurrentWorkbook

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –£–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ –≤–æ–ø—Ä–æ—Å –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø–æ–ª—è–º –∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å–ø–∏—Å–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö, –Ω–æ –ø–æ—Å–∫–æ–ª—å–∫—É —Ä–µ–≥—É–ª—è—Ä–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ —ç—Ç–æ–º—É –≤ —á–∞—Ç–µ, —Å—Ç–æ–∏—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å –ø–∞—Ä—É –Ω—é–∞–Ω—Å–æ–≤.
    –ü—Ä–∏–º–µ—Ä –∑–∞—è–≤–ª–µ–Ω –ø—Ä—è–º–æ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content]

    –ß—Ç–æ –∂–µ —Ç—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?
    Excel.CurrentWorkbook()
    –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∏–¥—É—Ç –∫—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏ ‚Äì –≤ –Ω–∏—Ö –ø–æ–º–µ—â–∞—é—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã. –£ CurrentWorkbook –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –Ω–µ—Ç, –ø–æ—ç—Ç–æ–º—É —Å–∫–æ–±–∫–∏ –ø—É—Å—Ç—ã–µ.
    –î–∞–ª–µ–µ –∏–¥—É—Ç —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ ‚Äì —ç—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —ç–ª–µ–º–µ–Ω—Ç—É —Å–ø–∏—Å–∫–∞. –ù–æ –≤–µ–¥—å CurrentWorkbook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–º —Ç–∞–±–ª–∏—Ü—É. –§–∏—à–∫–∞ –≤ —Ç–æ–º, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –≤–∏–¥–∞ [Name, Content]. –¢.–µ. —Ç–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
    Excel.CurrentWorkbook(){0}
    –≠—Ç–æ –≤–µ—Ä–Ω–µ—Ç –Ω–∞–º –∑–∞–ø–∏—Å—å —Å –ø–µ—Ä–≤—ã–º (–≤—ã –∂–µ –ø–æ–º–Ω–∏—Ç–µ –ø—Ä–æ –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å –Ω—É–ª—è) –∏–º–µ–Ω–µ–º –≤ —Ç–µ–∫—É—â–µ–π –∫–Ω–∏–≥–µ.

    –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –¥–ª—è —Ç–∞–±–ª–∏—Ü –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —É—Å–ª–æ–≤–∏–µ:
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}
    –≠—Ç–æ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç: –≤–µ—Ä–Ω–∏ —ç–ª–µ–º–µ–Ω—Ç, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª–µ Name —Ä–∞–≤–Ω–æ "–¢–∞–±–ª–∏—Ü–∞1".

    –î–ª—è —ç—Ç–∏—Ö –∂–µ —Ü–µ–ª–µ–π –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ Table.SelectRows, –Ω–æ —Ç–∞–∫ –∫–æ—Ä–æ—á–µ –∏ —á—É—Ç–∫–∞ —à—É—Å—Ç—Ä–µ–µ.
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è –ø–∏—à–µ—Ç—Å—è –±–µ–∑ –∫–∞–≤—ã—á–µ–∫, –∞ –≤–æ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–∞–≤—ã—á–∫–∞—Ö. –ë—ã–≤–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –∏–º—è –ø–æ–ª—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä —Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–æ–∫–∏), —Ç–æ–≥–¥–∞ –µ–≥–æ –ø–∏—à—É—Ç –≤ –∫–∞–≤—ã—á–∫–∞—Ö, –Ω–æ –ø–æ—Å–ª–µ —Ä–µ—à–µ—Ç–∫–∏, –ø–æ—ç—Ç–æ–º—É —Ç–∞–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ç–∞–∫–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω:
    Excel.CurrentWorkbook(){[#‚ÄùName‚Äù="–¢–∞–±–ª–∏—Ü–∞1"]}

    –ò –µ—â—ë –æ–¥–Ω–æ –∑–∞–º–µ—á–∞–Ω–∏–µ ‚Äì –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∏–ª–∏ –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∏–ª–∏ –ø–æ —É—Å–ª–æ–≤–∏—é, –Ω–æ –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ –≤–µ—Ä–Ω—ë—Ç—Å—è –æ—à–∏–±–∫–∞. –í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–∏—à–µ–º —Ç–∞–∫:
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}?
    –ó–Ω–∞–∫ –≤–æ–ø—Ä–æ—Å–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–Ω—É—Ç—å —ç–ª–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å, –∏ null, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç.

    –ù—É –∞ –ø–æ—Å–ª–µ —Ñ–∏–≥—É—Ä–Ω—ã—Ö –∏–¥—É—Ç –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏:
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content]
    –≠—Ç–æ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø–æ–ª—é –∑–∞–ø–∏—Å–∏.

    –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è —Ç–∞–∫–∂–µ –ø–∏—à–µ–º –±–µ–∑ –∫–∞–≤—ã—á–µ–∫ –∏–ª–∏ –≤ –∫–∞–≤—ã—á–∫–∞—Ö, –Ω–æ –ø–æ—Å–ª–µ —Ä–µ—à—ë—Ç–∫–∏:
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[#"Content"]

    –ù—É –∏ —Ç–∞–∫–∂–µ, –∫–∞–∫ –∏ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Å–ø–∏—Å–∫–∞, –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞–∫ –≤–æ–ø—Ä–æ—Å–∞:
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}?[Content]?
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —ç—Ç–æ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç: –≤–µ—Ä–Ω–∏ –∏–∑ —Ç–µ–∫—É—â–µ–π –∫–Ω–∏–≥–∏ —Ç–∞–±–ª–∏—Ü—É –∏–º–µ–Ω, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Å—Ç—Ä–æ–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–ª–µ Name —Ä–∞–≤–Ω–æ –¢–∞–±–ª–∏—Ü–∞1 (–µ—Å–ª–∏ —Ç–∞–∫–∞—è —Å—Ç—Ä–æ–∫–∞ –µ—Å—Ç—å), –∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –ø–æ–ª–µ Content –∏–∑ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ (–µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å).
    –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–º –ª–∏–±–æ —Ç–∞–±–ª–∏—Ü—É, –ª–∏–±–æ null ‚Äì –≤—Å—è–∫–æ –ª—É—á—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ –æ—à–∏–±–∫—É )))

    –í–æ—Ç —Ç–∞–∫–æ–π –Ω–µ—Ö–∏—Ç—Ä—ã–π –ø—Ä–∏–º–µ—Ä, –Ω–æ —Ä–µ–∞–ª—å–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤ —Å–µ–±–µ –º–Ω–æ–≥–æ –∞—Å–ø–µ–∫—Ç–æ–≤.
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, —Å —ç—Ç–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞ —è –≤ —Å–≤–æ–µ –≤—Ä–µ–º—è –∏ –Ω–∞—á–∏–Ω–∞–ª –æ—Å–≤–æ–µ–Ω–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ M.
    –î—É–º–∞—é –Ω–µ—Å–ª–æ–∂–Ω–æ –¥–æ–≥–∞–¥–∞—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ –º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.
    –ï—â—ë —Ä–∞–∑ –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –µ—ë –∫ –ø—Ä–æ—á—Ç–µ–Ω–∏—é.
    ]
  
[   Excel.CurrentWorkbook() vs Excel.Workbook() –∏–ª–∏ –≤ —á—ë–º –∂–µ —Ä–∞–∑–Ω–∏—Ü–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Excel.CurrentWorkbook, Excel.Workbook

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –¢–æ–ª—å–∫–æ —á—Ç–æ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ Excel.CurrentWorkbook, –Ω–æ –µ—Å—Ç—å –µ—â—ë –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è - Excel.Workbook. –ò–∑ –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –æ–±–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É Excel-—Ñ–∞–π–ª–æ–≤, –Ω–æ –µ—Å—Ç—å —Ä—è–¥ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ç–ª–∏—á–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å.

    –û—Ç–ª–∏—á–∏–µ 0 ‚Äì –∞—Ä–≥—É–º–µ–Ω—Ç—ã
    CurrentWorkbook –Ω–µ –∏–º–µ–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ —Ç–µ–∫—É—â–µ–π –∫–Ω–∏–≥–µ. Workbook –∏–º–µ–µ—Ç —Ç—Ä–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ ‚Äì –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π workbook –∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ useHeaders –∏ delayTypes. –ü–µ—Ä–≤—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ ‚Äì –æ–±—ã—á–Ω–æ –µ–≥–æ –ø–æ–ª—É—á–∞—é—Ç —á–µ—Ä–µ–∑ Folder.Files –∏–ª–∏ File.Contents, –ø—Ä–∏—á—ë–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—É—Ç–∏ –¥–ª—è File.Contents –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏ —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–∫—É—â—É—é –∫–Ω–∏–≥—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–±–∞ –∫–æ–¥–∞ –¥–∞–¥—É—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ–∫—É—â–µ–π –∫–Ω–∏–≥–∏:
    Excel.CurrentWorkbook()
    Excel.Workbook(File.Contents(‚Äú–ø—É—Ç—å_–∫_—Ç–µ–∫—É—â–µ–º—É_—Ñ–∞–π–ª—É‚Äù))

    –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ä–∞–∑–±–µ—Ä–µ–º –Ω–∏–∂–µ

    –û—Ç–ª–∏—á–∏–µ 1 ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    CurrentWorkbook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–≤—É–º—è –ø–æ–ª—è–º–∏ [Name, Content]
    Workbook ‚Äì —Ç–∞–±–ª–∏—Ü—É —Å —á–µ—Ç—ã—Ä—å–º—è –ø–æ–ª—è–º–∏ [Name, Item, Kind, Hidden]
    –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è CurrentWorkbook –≤ —Ñ–∞–π–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã –∏ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã (–∏–º–µ–Ω–Ω–æ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –ª–∏—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏—Å–≤–æ–µ–Ω–æ –∏–º—è; –∏–º—ë–Ω —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏, —Ñ–æ—Ä–º—É–ª–∞–º–∏ –∏ —Ç.–ø. —ç—Ç–æ –Ω–µ –∫–∞—Å–∞–µ—Ç—Å—è), –∞ –≤–æ—Ç —Å –ø–æ–º–æ—â—å—é Workbook –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Ç–∞–±–ª–∏—Ü–∞–º (Kind=‚ÄùTable‚Äù), –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º (Kind=‚Äù DefinedName‚Äù) –∏ –ª–∏—Å—Ç–∞–º (Kind=‚ÄùSheet‚Äù).
    –ó–¥–µ—Å—å –≤–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ ‚Äì –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü –Ω–µ –º–æ–≥—É—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–ø–∏—Å—ã–≤–∞—è —É—Å–ª–æ–≤–∏—è –æ—Ç–±–æ—Ä–∞ –¥–ª—è CurrentWorkbook –º—ã —É–∫–∞–∑—ã–≤–∞–ª–∏ —Ç–æ–ª—å–∫–æ –∏–º—è, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü –∏ –ª–∏—Å—Ç–æ–≤ —Å–æ–≤–ø–∞–¥–∞—Ç—å –º–æ–≥—É—Ç, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ Workbook –ª—É—á—à–µ —É–∫–∞–∑–∞—Ç—å –∏–º—è –∏ —Ç–∏–ø:
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content]
    Excel.Workbook(File.Contents("–ø—É—Ç—å_–∫_—Ç–µ–∫—É—â–µ–º—É_—Ñ–∞–π–ª—É ")){[Name="–¢–∞–±–ª–∏—Ü–∞1",Kind="Table"]}[Data]
    –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ–ª—è —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è ‚Äì Content –∏ Data —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ

    –û—Ç–ª–∏—á–∏–µ 2 ‚Äì —Ä–∞–±–æ—Ç–∞ —Å –ª–∏—Å—Ç–∞–º–∏
    –≠—Ç–æ —á–∞—Å—Ç–∞—è –∑–∞–¥–∞—á–∞ ‚Äì —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–æ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤ –≤ —Ñ–∞–π–ª–µ, –ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Workbook. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–¥–æ –æ—Ç–º–µ—Ç–∏—Ç—å ‚Äì –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ Workbook –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤–æ–π—Å—Ç–≤–æ Hidden ‚Äì –æ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –í–°–ï–ú –ª–∏—Å—Ç–∞–º –≤ –∫–Ω–∏–≥–µ, –ø—Ä–æ—Å—Ç–æ –¥–ª—è —Å–∫—Ä—ã—Ç—ã—Ö –≤–µ—Ä–Ω–µ—Ç Hidden=true (–∏ –¥–ª—è –æ—á–µ–Ω—å —Å–∫—Ä—ã—Ç—ã—Ö —Ç–æ–∂–µ, –∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ —ç—Ç–æ ‚Äì —Å–æ–≤–µ—Ç—É—é –ø–æ–≥—É–≥–ª–∏—Ç—å).
    –¢–∞–∫–∂–µ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì useHeaders, –æ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false –∏ —Ç–æ–≥–¥–∞ —Ç–∞–±–ª–∏—Ü–∞ –ª–∏—Å—Ç–∞ –±—É–¥–µ—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ Column1, Column2 –∏ —Ç.–¥. –ï—Å–ª–∏ –∂–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å useHeaders=true ‚Äì –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ ‚Äì —Ç.–µ. –º–æ–∂–Ω–æ –Ω–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å PromoteHeaders –æ—Ç–¥–µ–ª—å–Ω—ã–º —à–∞–≥–æ–º ‚Äì –∫–æ–≥–¥–∞ –≤ –≤—ã–≥—Ä—É–∑–∫–µ –æ–¥–∏–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ª–∏—Å—Ç, —ç—Ç–æ –±—ã–≤–∞–µ—Ç —É–¥–æ–±–Ω–æ
    Excel.Workbook(File.Contents("D:\ECWEW.xlsx")){[Kind="Sheet"]}[Data] //–¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    Excel.Workbook(File.Contents("D:\ECWEW.xlsx"),true){[Kind="Sheet"]}[Data] //–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏

    –û—Ç–ª–∏—á–∏–µ 3 ‚Äì —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
    –ï—â—ë –æ–¥–Ω–æ –≤–∞–∂–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ ‚Äì CurrentWorkbook –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã –Ω–µ—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏, –∞ Workbook ‚Äì –Ω–∞–æ–±–æ—Ä–æ—Ç, —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏. –ü–æ—Å–ª–µ–¥–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì delayTypes ‚Äì –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false, —Ç.–µ. ¬´–Ω–µ –æ—Å—Ç–∞–≤–ª—è—Ç—å –Ω–µ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏¬ª, —ç—Ç—É —Å–∞–º—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç. –ö–æ–≥–¥–∞ –∂–∞–ª—É—é—Ç—Å—è, —á—Ç–æ —Å –ª–∏—Å—Ç–∞–º–∏ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–æ–≤–µ—Ç—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì –µ—Å–ª–∏ –æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω (—Ç.–µ. false), —É –≤–∞—Å –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ —Ç–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, –∞ –ø–æ—Ç–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äì –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ —Ç–∞–∫–æ–µ —Ç–∏–ø–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ any, –∞ –≤–æ—Ç —Ç–∞–∫ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
    Excel.Workbook(File.Contents("D:\ECWEW.xlsx"),true,false){[Name="–õ–∏—Å—Ç1",Kind="Sheet"]}[Data] 

    –ö —á–µ–º—É –≤–µ—Å—å —ç—Ç–æ—Ç –º–Ω–æ–≥–æ–±—É–∫–≤–µ–Ω–Ω—ã–π —Å–ø–∏—á? - Excel.CurrentWorkbook —É–¥–æ–±–Ω–æ –º—ã—à–∫–æ–∫–ª–∞—Ü–∞–µ—Ç—Å—è –ø—Ä—è–º–æ –∏–∑ —Ñ–∞–π–ª–∞; —Å Excel.Workbook –Ω–∞–¥–æ –ø–æ–≤–æ–∑–∏—Ç—å—Å—è ‚Äì –ø—Ä–æ–ø–∏—Å–∞—Ç—å –ø—É—Ç—å, –Ω–æ –∑–∞—Ç–æ –≤—ã —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç–µ –≤—Å—ë, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–∫—Ä—ã—Ç–æ–µ, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∏ –±–æ–Ω—É—Å–æ–º –ø–∞—Ä—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
    –î–∞ –∏ –≤ —Ü–µ–ª–æ–º —è —Å—Ç–æ—Ä–æ–Ω–Ω–∏–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ ‚Äì –ø–æ—ç—Ç–æ–º—É –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é Excel.Workbook –∏ –æ–±—Ä–∞—â–∞—é—Å—å –∫ —Ñ–∞–π–ª–∞–º —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑–≤–Ω–µ, –∑–∞–æ–¥–Ω–æ –∏–∑–±–µ–≥–∞—è –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞—â–∏—Ç–∞–º–∏/–ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–æ—á–∏–º.
    ]

[   Table.ExpandListColumn –∏ Table.SplitColumn –∏–ª–∏ –∫–∞–∫ —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ –≤ —Å—Ç–æ–ª–±—Ü—ã / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.ExpandListColumn, Table.SplitColumn

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–∞—à—ë–ª—Å—è –∏–Ω—Ñ–æ–ø–æ–≤–æ–¥ –æ–±—Å—É–¥–∏—Ç—å —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö.
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –ø—Ä–∏–º–µ—Ä:
    let
        from = Table.FromRecords({  [a=1,b=2,c={{3,4},{5,6},{7,8}}],
                                    [a=9,b=8,c={{7,6},{5,4},{3,2}}],
                                    [a=1,b=3,c={{5,7},{9,8},{6,4}}]}),
        exp = Table.ExpandListColumn(from, "c"),
        splt = Table.SplitColumn(exp,"c",(x)=>x,{"c","d"})
    in
        splt

    from ‚Äì —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å—Ç–æ–ª–±–µ—Ü c —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤. –ó–∞–¥–∞—á–∞ —Ä–∞—Å–∫–∏–¥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, –∞ –¥–∞–ª–µ–µ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
    exp ‚Äì –ø–µ—Ä–≤–∞—è —á–∞—Å—Ç—å —Ä–µ—à–∞–µ—Ç—Å—è –ª–µ–≥–∫–æ —á–µ—Ä–µ–∑ Table.ExpandListColumn
    splt ‚Äì –∞ –≤–æ—Ç —Å–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç—å—é —á–µ—Ä–µ–∑ –º—ã—à–∫–æ–∫–ª–∞—Ü –æ–±—ã—á–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –∏–∑–≤–ª–µ–∫–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏, –∞ –ø–æ—Ç–æ–º —Å–ø–ª–∏—Ç—è—Ç –ø–æ —ç—Ç–æ–º—É –∂–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é ‚Äì –¢–ê–ö –î–ï–õ–ê–¢–¨ –ù–ï –ù–ê–î–û ‚Äì –Ω–∞–¥–æ —Å–æ–æ–±—Ä–∞–∑–∏—Ç—å, —á—Ç–æ Table.SplitColumn –∂–¥–µ—Ç –æ—Ç –Ω–∞—Å —Ñ—É–Ω–∫—Ü–∏—é, –≥–µ–Ω–µ—Ä—è—â—É—é —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –Ω–æ —É –Ω–∞—Å –Ω–∞ –≤—Ö–æ–¥–µ –∏ —Ç–∞–∫ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –ø–æ—ç—Ç–æ–º—É (x)=>x ‚Äì —Ç.–µ. —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º–µ—é—â–∏–π—Å—è —Å–ø–∏—Å–æ–∫, –∏ –≤—Å—ë, –Ω–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö —Ç–µ–ª–æ–¥–≤–∏–∂–µ–Ω–∏–π. –í–æ—Ç.
    ]

[   Excel.Workbook - —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –ª–∏—Å—Ç—ã –∏–∑ —Ñ–∞–π–ª–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Excel.Workbook, Table.Combine, Table.ExpandTableColumn

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —ç—Ç–æ–π —Ç–µ–º—ã –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –≤–æ–ø—Ä–æ—Å ‚Äì –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å–æ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤ –≤ —Ñ–∞–π–ª–µ. –ú—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è Excel.Workbook, –∞ –≤–æ—Ç –¥–∞–ª—å—à–µ –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã:

    –í–∞—Ä–∏–∞–Ω—Ç 0 ‚Äì –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å –ª–∏—Å—Ç–æ–≤
    let
        from = Excel.Workbook(File.Contents("–ø—É—Ç—å\—Ñ–∞–π–ª.xlsx"), true),
        sheets = Table.SelectRows(from, each [Kind]="Sheet"),
        to = Table.Combine(sheets[Data])
    in
        to
    from ‚Äì –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ñ–∞–π–ª—É, –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç true ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    sheets ‚Äì –≤—ã–±—Ä–∞–ª–∏ —Ç–æ–ª—å–∫–æ –ª–∏—Å—Ç—ã (–µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã —Ç–∞–±–ª–∏—Ü—ã - [Kind]="Table")
    to ‚Äì –Ω—É –∏ —Å–æ–µ–¥–∏–Ω–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –≤–æ–µ–¥–∏–Ω–æ

    –í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äì –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤, –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ª–∏—Å—Ç–∞—Ö —Ç–∏–ø–æ–≤—ã–µ
    let
        from = Excel.Workbook(File.Contents("–ø—É—Ç—å\—Ñ–∞–π–ª.xlsx "), true),
        sheets = Table.SelectRows(from, each [Kind]="Sheet"),
        cols = Table.SelectColumns(sheets,{"Name", "Data"}),
        nms = Table.ColumnNames(cols{0}[Data]),
        to = Table.ExpandTableColumn(cols, "Data",nms)
    in
        to
    –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —à–∞–≥–∞ —Ç–µ –∂–µ
    cols ‚Äì –≤—ã–±—Ä–∞–ª–∏ —Å—Ç–æ–ª–±—Ü—ã —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ª–∏—Å—Ç–æ–≤ –∏ –¥–∞–Ω–Ω—ã–º–∏
    nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ –ø–µ—Ä–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
    to ‚Äì —Ä–∞—Å–∫—Ä—ã–ª–∏ —Ç–∞–±–ª–∏—á–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü

    –í–∞—Ä–∏–∞–Ω—Ç 2 - –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤, —à–∞–ø–∫–∏ —Ç–∞–±–ª–∏—Ü –º–æ–≥—É—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è
    let
        from = Excel.Workbook(File.Contents("–ø—É—Ç—å\—Ñ–∞–π–ª.xlsx "), true),
        sheets = Table.SelectRows(from, each [Kind]="Sheet"),
        cols = Table.SelectColumns(sheets,{"Name", "Data"}),
        nms = List.Distinct(List.Combine(List.Transform(cols[Data], Table.ColumnNames))),
        to = Table.ExpandTableColumn(cols, "Data",nms)
    in
        to

    –º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —à–∞–≥ nms ‚Äì –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü, —Å–æ–±–∏—Ä–∞–µ–º –≤ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –∏ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ

    –ö–∞–∫ –±—ã –∏ –≤—Å—ë. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ 0), –∞ –ø–æ–ª—å–∑—ã –ø—Ä–∏–Ω–æ—Å–∏—Ç –º–Ω–æ–≥–æ.
    ]

[   Table.FromList + GroupKind.Local ‚Äì —à—É—Å—Ç—Ä–æ–µ –ø–æ–¥–æ–±–∏–µ —Ä–µ–≥—É–ª—è—Ä–æ–∫ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.FromList, GroupKind.Local

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –û–ø—è—Ç—å –∑–∞—á–∞—Å—Ç–∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–µ–≥—É–ª—è—Ä–∫–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–≤–µ–∑–ª–∏. –ü–æ—Å–µ–º—É —Ö–æ—á—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–º–µ—Ä –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø —Ä–µ—à–µ–Ω–∏—è - —Ä–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ, –∞ –∑–∞—Ç–µ–º –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∏—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º.
    –ù—É –ø–æ–µ—Ö–∞–ª–∏:
    let
        ld = List.Buffer({"0".."9"}),
        ldp = List.Buffer(ld&{"(",")"," ","-"}),
        
        f=(x)=>[a = Table.FromList(Text.ToList(x),(x)=>{x,if List.Contains(ldp,x) then 0 else 1},{"y","z"}),
                b = Table.Group(a,"z",{"i",each Text.Combine([y])},GroupKind.Local)[i],
                c = List.Transform(b,(x)=>Text.Select(x,ld)),
                d = List.Select(c,(x)=>x<>"")][d],
        
        lst = { " +7 (495) 617-61-16–± –¥–æ–±. 1503",
                "—Ç–µ–ª: +7-913-728-64-87 –í–ª–∞–¥–∏–º–∏—Ä",
                "(4152), –¥–æ–±. 23-81-47 +7962 215 17 17",
                "8 (423) 2 60-84-84, 143(–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)",
                "8 (495) 229-49-69, –¥–æ–±. 114",
                "+7 (383) 286-87-08 ext.24120"},
        to = Table.FromList(lst,(x)=>{x}&f(x),4)
    in
        to

    lst ‚Äì –Ω–∞—à –∏—Å—Ç–æ—á–Ω–∏–∫, –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ ‚Äì –∑–∞–¥–∞—á–∞ –≤—ã–Ω—É—Ç—å –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
    to ‚Äì —Å–æ–±—Ä–∞–ª–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ —Ç–∞–±–ª–∏—Ü—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ f

    –ù—É –∞ —Ç–µ–ø–µ—Ä—å –æ —Ñ—É–Ω–∫—Ü–∏–∏.
    –î–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–≤–µ–¥—ë–º –¥–≤–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–ø–∏—Å–∫–∞ ‚Äì ld –∏ ldp
    ld ‚Äì —Å–ø–∏—Å–æ–∫ —Ü–∏—Ñ—Ä (–∏–º–µ–Ω–Ω–æ —Å–∏–º–≤–æ–ª–æ–≤, –∫–∞–≤—ã—á–∫–∏ –Ω–µ –∑–∞–±—ã–≤–∞–µ–º) - —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
    ldp ‚Äì –∫ —Å–ø–∏—Å–∫—É ld –¥–æ–±–∞–≤–∏–ª–∏ —Å–∏–º–≤–æ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –≤ –Ω–æ–º–µ—Ä–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Äì —Å–∫–æ–±–∫–∏, –ø—Ä–æ–±–µ–ª—ã, –¥–µ—Ñ–∏—Å - —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –æ–¥–Ω—É –≥—Ä—É–ø–ø—É
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Å–ø–∏—Å–∫–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ –∏ –ø–æ–º–µ—â–µ–Ω—ã –≤ List.Buffer ‚Äì —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

    –¢–µ–ø–µ—Ä—å —Å–∞–º–∏ —à–∞–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏:
    a ‚Äì —Å–æ–±–∏—Ä–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ù–∞ –≤—ã—Ö–æ–¥ –ø–æ–ª—É—á–∏–º —Ç–∞–±–ª–∏—Ü—É –∏–∑ –¥–≤—É—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ ‚Äì y —ç—Ç–æ —Å–∞–º —Å–∏–º–≤–æ–ª, –∞ z ‚Äì –±—É–¥–µ—Ç –Ω—É–ª–µ–≤—ã–º, –µ—Å–ª–∏ —Å–∏–º–≤–æ–ª –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –≤ –Ω–æ–º–µ—Ä–µ –∏ –µ–¥–∏–Ω–∏—Ü–∞ ‚Äì –µ—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç
    b ‚Äì –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ z, –ª–æ–∫–∞–ª—å–Ω–æ, –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ –ø–∏—à–µ–º (–ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç —Ä–∞–∑–±–∏—Ä–∞–ª–æ—Å—å —Ç—É—Ç), –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º –≤ —Ç–µ–∫—Å—Ç. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤—Å–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –±—É–¥—É—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    c ‚Äì —á–∏—Å—Ç–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª—ã –∏–∑ —Å–ø–∏—Å–∫–∞ ld
    d ‚Äì –≤—ã–±–∏—Ä–∞–µ–º –Ω–µ –ø—É—Å—Ç—ã–µ —Ç–µ–∫—Å—Ç—ã
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë. –¢–æ–Ω–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å –º–µ–Ω—è—è —Å–ø–∏—Å–∫–∏ ld –∏ ldp, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ )))
    ]

[   Table.Skip ‚Äì –æ—Ç–¥–µ–ª—è–µ–º –ª–∏—à–Ω–µ–µ –≤ —Ç–∞–±–ª–∏—Ü–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.Skip

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ –º–æ—Ç–∏–≤–∞–º –Ω–µ–¥–∞–≤–Ω–µ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –≤ —á–∞—Ç–µ –æ–±—Å—É–¥–∏–º –≤–æ–ø—Ä–æ—Å –ø—Ä–æ–ø—É—Å–∫–∞ –ª–∏—à–Ω–∏—Ö —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ.
    –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–º–µ—Ä:
    let
        from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("3VO7DsIwDPwV5LlDHTuEsvIZhaEVMIUyZUL8O6qDVAeUSK0YgOXk6+Nsn+32BrurD5cBYTsE76snNSmllHJKbUrXkd6rP9CGfaiZziMySmwFjSALnuTtRuJ6+p66+AR+se+yNqjuY8fHCbmPPoHKjh9OLUPgZkSLq7nVmC8xOfbiVOE0LRT1KjYq7vRCLZRAeLN0tobRli7UIFB2gboa+YPjZTlQJi5MZCFxHvMjdfl5IpWmaZSmze8IFm4BXaJI+SqbQpX2tcrDAw=="),Compression.Deflate))),
        skip=(x)=>Table.Skip(x),
        to = skip(from)
    in
    to
    –î–∞–ª–µ–µ –±—É–¥–µ–º –º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—é skip.

    –ò—Ç–∞–∫, –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ —Ñ—É–Ω–∫—Ü–∏–∏ Table.Skip –ø–µ—Ä–µ–¥–∞–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Å–∞–º–∞ —Ç–∞–±–ª–∏—Ü–∞, –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏–π, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω—É–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –ø–æ—ç—Ç–æ–º—É:
    skip=(x)=>Table.Skip(x,8)
    –¢–∞–∫ —É–∂–µ –ª—É—á—à–µ, –Ω–æ –º—ã –∑–∞–¥–∞–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ. –ù–æ —á—Ç–æ –µ—Å–ª–∏ –º—ã –Ω–µ –∑–Ω–∞–µ–º —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–ø—É—Å—Ç–∏—å? –ü–æ—á–µ–º—É-—Ç–æ –º–Ω–æ–≥–∏–µ –Ω–∞—á–∏–Ω–∞—é—Ç –∏–º–µ–Ω–Ω–æ –≤—ã—á–∏—Å–ª—è—Ç—å —á–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º—ã—Ö —Å—Ç—Ä–æ–∫, —Å–æ–æ—Ä—É–∂–∞—è –∂—É—Ç–∫–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π –∏ –ø—Ä–æ—á–∏–º.

    –§–∏—à–∫–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –≤–æ –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —É—Å–ª–æ–≤–∏–µ:
    skip=(x)=>Table.Skip(x,(r)=>r[Column1]=null)
    –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Ñ—É–Ω–∫—Ü–∏—é –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ –ø–∏—à–µ–º –æ—Ç –∑–∞–ø–∏—Å–∏. –ë—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –°–û–û–¢–í–ï–¢–°–¢–í–£–Æ–¢ —É—Å–ª–æ–≤–∏—é. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–∫–∞ –≤ Column1 –±—É–¥–µ—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è null.
    –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –æ—á–µ–Ω—å ‚Äì –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ —Å–º–µ–Ω–∏–º —Å—Ç–æ–ª–±–µ—Ü:
    skip=(x)=>Table.Skip(x,(r)=>r[Column2]=null)
    –¢–µ–ø–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ –Ω–∞–¥–æ.
    –ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –º—ã –Ω–µ –∑–Ω–∞–ª–∏ —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –Ω–æ –∑–Ω–∞–ª–∏ –≤ –∫–∞–∫–æ–º —Å—Ç–æ–ª–±—Ü–µ –∏—Å–∫–∞—Ç—å. –ü—Ä–∏—á—ë–º –∏—Å–∫–∞—Ç—å –º–æ–∂–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ null:
    skip=(x)=>Table.Skip(x,(r)=>r[Column1]<>"–∑–∞–≥–æ–ª–æ–≤–æ–∫")
    –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–∏—Å–∫ –ø–æ Column1 –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π ¬´–∑–∞–≥–æ–ª–æ–≤–æ–∫¬ª.

    –ù–æ —á—Ç–æ, –µ—Å–ª–∏ –º—ã –∑–Ω–∞–µ–º –∫–∞–∫–æ–µ —Å–ª–æ–≤–æ –∏—Å–∫–∞—Ç—å, –Ω–æ –Ω–µ –∑–Ω–∞–µ–º –Ω–∏ —Å—Ç—Ä–æ–∫–∏, –Ω–∏ —Å—Ç–æ–ª–±—Ü–∞? –î–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:
    skip=(x)=>Table.Skip(x,(r)=>not List.Contains(Record.ToList(r),"–∫–ª—é—á"))
    –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –º—ã –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤ –Ω—ë–º –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

    –ù–∞–∫–æ–Ω–µ—Ü, –≤ —Å–∞–º–æ–º –ø–ª–æ—Ö–æ–º —Å–ª—É—á–∞–µ, –º—ã –º–æ–∂–µ–º –¥–∞–∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–∏–∫–æ–º –Ω–µ –∑–Ω–∞—Ç—å, —Ç–æ–ª—å–∫–æ –µ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç. –ù–æ —Ç–æ–∂–µ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞:
    skip=(x)=>Table.Skip(x,(r)=>not Text.Contains(Text.Combine(List.Select(Record.ToList(r),(x)=>x is text)),"–∫–ª—é"))
    –¢—É—Ç —Ñ–∏–Ω—Ç —É—à–∞–º–∏ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏–≤ —Å—Ç—Ä–æ–∫—É –≤ —Å–ø–∏—Å–æ–∫, –º—ã –≤—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (is text), —Å—Ü–µ–ø–ª—è–µ–º –≤—Å–µ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É (–ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—Å–µ null) –∏ —É–∂–µ –µ—ë –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞. –í—ã—Ö–æ–¥–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —à—É—Å—Ç—Ä–æ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –Ω–µ—Å–ª–æ–∂–Ω—ã–µ –ø—Ä–∏—ë–º—ã, –Ω–æ –æ—á–µ–Ω—å –ª–∞–∫–æ–Ω–∏—á–Ω–æ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É.
    ]

[   Propis - —Å—É–º–º–∞ –ø—Ä–æ–ø–∏—Å—å—é / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - custom

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –í—Å–ø–ª—ã–ª —Å–∫–µ–ª–µ—Ç –∏–∑ —à–∫–∞—Ñ–∞ - –∫–æ–≥–¥–∞-—Ç–æ –¥–∞–≤–Ω–æ –ø–∏—Å–∞–ª —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å—É–º–º—ã –ø—Ä–æ–ø–∏—Å—å—é, —Ç–∞–º –Ω–∞—à–ª–∞—Å—å –±–∞–≥–∞. –ë–∞–≥—É –∏—Å–ø—Ä–∞–≤–∏–ª, –≤—ã–∫–ª–∞–¥—ã–≤–∞—é –∫–∞–∫ –µ—Å—Ç—å, –∫–æ–¥ —Ö–æ—Ç—å –∏ —Å—Ç–∞—Ä—ã–π –Ω–æ –≤–ø–æ–ª–Ω–µ –≥–æ–¥–Ω—ã–π:
    Propis=(num)=>
    [ ln = { {"–¥–µ—Å—è—Ç—å ","–æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—å ","–¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å ","—Ç—Ä–∏–Ω–∞–¥—Ü–∞—Ç—å ","—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å ","–ø—è—Ç–Ω–∞–¥—Ü–∞—Ç—å ","—à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç—å ","—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å ","–≤–æ—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å ","–¥–µ–≤—è—Ç–Ω–∞–¥—Ü–∞—Ç—å "},
    {"","—Å—Ç–æ ","–¥–≤–µ—Å—Ç–∏ ","—Ç—Ä–∏—Å—Ç–∞ ","—á–µ—Ç—ã—Ä–µ—Å—Ç–∞ ","–ø—è—Ç—å—Å–æ—Ç ","—à–µ—Ç—å—Å–æ—Ç ","—Å–µ–º—å—Å–æ—Ç ","–≤–æ—Å–µ–º—å—Å–æ—Ç ","–¥–µ–≤—è—Ç—å—Å–æ—Ç "},
    {"","","–¥–≤–∞–¥—Ü–∞—Ç—å ","—Ç—Ä–∏–¥—Ü–∞—Ç—å ","—Å–æ—Ä–æ–∫ ","–ø—è—Ç—å–¥–µ—Å—è—Ç ","—à–µ—Å—Ç—å–¥–µ—Å—è—Ç ","—Å–µ–º—å–¥–µ—Å—è—Ç ","–≤–æ—Å–µ–º—å–¥–µ—Å—è—Ç ","–¥–µ–≤—è–Ω–æ—Å—Ç–æ "},
    {"","–æ–¥–∏–Ω ","–¥–≤–∞ ","—Ç—Ä–∏ ","—á–µ—Ç—ã—Ä–µ ","–ø—è—Ç—å ","—à–µ—Å—Ç—å ","—Å–µ–º—å ","–≤–æ—Å–µ–º—å ","–¥–µ–≤—è—Ç—å "},
    {"","–æ–¥–Ω–∞ ","–¥–≤–µ ","—Ç—Ä–∏ ","—á–µ—Ç—ã—Ä–µ ","–ø—è—Ç—å ","—à–µ—Å—Ç—å ","—Å–µ–º—å ","–≤–æ—Å–µ–º—å ","–¥–µ–≤—è—Ç—å "}},
    lr = { {"","–º–∏–ª–ª–∏–∞—Ä–¥ ","–º–∏–ª–ª–∏–∞—Ä–¥–∞ ","–º–∏–ª–ª–∏–∞—Ä–¥–∞ ","–º–∏–ª–ª–∏–∞—Ä–¥–∞ ","–º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ "},
    {"","–º–∏–ª–ª–∏–æ–Ω ","–º–∏–ª–ª–∏–æ–Ω–∞ ","–º–∏–ª–ª–∏–æ–Ω–∞ ","–º–∏–ª–ª–∏–æ–Ω–∞ ","–º–∏–ª–ª–∏–æ–Ω–æ–≤ "},
    {"","—Ç—ã—Å—è—á–∞ ","—Ç—ã—Å—è—á–∏ ","—Ç—ã—Å—è—á–∏ ","—Ç—ã—Å—è—á–∏ ","—Ç—ã—Å—è—á "},
    {""," "," "," "," "," "}},
    fn = (n,r)=> [ t = List.Transform(Text.ToList(n), each Number.From(_)),
    x = ln{1}{t{0}} & (if t{1}<>1 then ln{2}{t{1}} & (if r = 2 then ln{4}{t{2}} else ln{3}{t{2}}) else ln{0}{t{2}}),
    y = lr{r}{if t{1}=1 or t{2}=0 then 5 else List.Min({t{2},5})},
    z = if Number.From(n)=0 then "" else x&y][z],
    t = Splitter.SplitTextByRepeatedLengths(3)(Number.ToText(num,"000000000000")),
    z = if num = 0 then "–Ω–æ–ª—å" else Text.Combine(List.Transform({0..3},each fn(t{_},_)),"")][z]

    –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –æ—Ç –Ω—É–ª—è –¥–æ 999 999 999 999. –ö–æ–º—É –Ω—É–∂–Ω—ã —Ç—Ä–∏–ª–ª–∏–æ–Ω—ã - –∑–∞–≤–∏–¥—É—é, –Ω–æ –¥–æ–ø–∏–ª–∏–≤–∞–π—Ç–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ (—É–≥–æ–≤–æ—Ä–∏–ª–∏ - –¥–æ–ø–∏–ª–∏–ª)üòâ
    ]
[   –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–∞–ø–∫–∏? / #–ù–µ–í—Å–µ–ô–æ–≥—É—Ä—Ç—ã–û–¥–∏–Ω–∞–∫–æ–≤–æ–ü–æ–ª–µ–∑–Ω—ãÔªø
    –í—Å–µ–º –¥–æ–±—Ä–∞! Ôªø–†–µ–≥—É–ª—è—Ä–Ω–æ —Ç–æ —Ç—É—Ç, —Ç–æ —Ç–∞–º –≤—Å–ø–ª—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ —Å–±–æ—Ä–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫—É—á–∏ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø—Ä–∏—á–µ—Å–∞—Ç—å.
    –°–µ–≥–æ–¥–Ω—è —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞.
    –ò—Ç–∞–∫, –∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ –ø–∞–ø–∫–µ –∏ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –∫–∞–∫ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ‚òùÔ∏è, —Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ç—Å—è –≤–æ—Ç —Ç–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤:
    –≥–¥–µ
    123 - —ç—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–ø—Ä–æ—Å –∫ –ø–∞–ø–∫–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "123"
    –ó–∞–ø—Ä–æ—Å "–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞" - —ç—Ç–æ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –≤ –Ω–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º—É –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–π–ª, –∏–∑ –ø–∞–ø–∫–∏ –ø–æ –æ–±—Ä–∞–∑—Ü—É –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å—Å—è —à–∞–±–ª–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ.
    –ó–∞–ø–∞—Ä–æ—Å "–ü–∞—Ä–∞–º–µ—Ç—Ä1" - —ç—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä, –∑–Ω–∞—á–µ–Ω–∏–µ–º –∫–æ—Ç–æ—Ä–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ "–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞"
    –ó–∞–ø—Ä–æ—Å "–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞" - —ç—Ç–æ —à–∞–±–ª–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –≤ –∫–æ—Ç–æ—Ä—ã–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞ –∏ –≤ –Ω–µ–º –∂–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ–¥–∏–Ω–∏—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑ –ø–∞–ø–∫–∏ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π –≤ –µ–¥–∏–Ω—ã–π –º–∞—Å—Å–∏–≤
    –§—É–Ω–∫—Ü–∏—è "–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª" - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å–≤—è–∑–∞–Ω–∞ —Å –∑–∞–ø—Ä–æ—Å–æ–º "–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞", –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç? –≠—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ—Ä–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, —Ç.–µ. –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å-—à–∞–±–ª–æ–Ω, —Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω–∏—Ç—Å—è –∏ —Ñ—É–Ω–∫—Ü–∏—è. –≠—Ç–∞ —Å–∞–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–∫ —Ä–∞–∑ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ "123".
    –ß—Ç–æ –∏–∑ –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ª–µ–¥—É–µ—Ç? –õ–µ–∑–µ–º –≤ —ç—Ç–æ—Ç —Å–∞–º—ã–π –∑–∞–ø—Ä–æ—Å-—à–∞–±–ª–æ–Ω (–æ–Ω –∂–µ "–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞") –∏ –≤ –Ω–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –ø—Ä–∏—á–µ—Å—ã–≤–∞–Ω–∏–µ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≤–∞–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É, –∞ –¥–∞–ª–µ–µ, –∫–æ–≥–¥–∞ –±—É–¥–µ–º —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤ –≤ –µ–¥–∏–Ω—ã–π –º–∞—Å—Å–∏–≤, —Ç–∞–º —É–∂–µ –±—É–¥—É—Ç –≤—Å–µ –Ω—É–∂–Ω—ã–µ –≤–∞–º —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã. –¢–∞–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±—ã—Å—Ç—Ä–µ–µ.
    Ôªø–ó–∞—á–µ–º –≤—Å–µ —ç—Ç–æ –Ω–∞–¥–æ? –î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —é–∑–µ—Ä–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ª–µ–≥–∫–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø–∞–ø–∫–µ: –Ω–µ—Ç –º–æ—Ä–æ–∫–∏ —Å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤—Ä—É—á–Ω—É—é, —Å –ø–µ—Ä–µ–¥–µ–ª—ã–≤–∞–Ω–∏–µ–º –µ–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é, —Å –æ—Ç–ª–∞–≤–ª–∏–≤–∞–Ω–∏–µ–º –±–∞–≥–æ–≤, –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –∏ –º–Ω–æ–≥–æ —á–µ–≥–æ –µ—â–µ.
    Ôªø–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç...
    ]

[   Table.ReplaceErrorValues, Table.RemoveRowsWithErrors ‚Äì —á–∏—Å—Ç–∏–º –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.ReplaceErrorValues, Table.RemoveRowsWithErrors

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –î–≤–∞–∂–¥—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏ –≤—Å–ø–ª—ã–≤–∞–ª –≤–æ–ø—Ä–æ—Å –∫–∞–∫ –ø–æ—Å—Ç—É–ø–∞—Ç—å —Å –æ—à–∏–±–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–µ. –ò–º–µ—é—Ç—Å—è –≤–≤–∏–¥—É –æ—à–∏–±–∫–∏ –Ω–∞ –ª–∏—Å—Ç–∞—Ö - #–î–ï–õ/0!, #–°–°–´–õ–ö–ê!, #–ù/–î –∏ —Ç.–¥. –ü–æ–Ω—è—Ç–Ω–æ–µ –¥–µ–ª–æ, —á—Ç–æ –Ω–∞–∏–ª—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äì –≤–ª–µ–∑—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫ –∏ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å. –ù–æ –µ—Å–ª–∏ —É –Ω–∞—Å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ–∞–π–ª–µ –ø—Ä–æ—Ç—è–Ω—É—Ç—ã —Ñ–æ—Ä–º—É–ª—ã, –∞ —è—á–µ–π–∫–∏ –Ω–µ –≤—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, —á—Ç–æ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ ‚Äì –≤ —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.

    –ó–¥–µ—Å—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Äì –∑–∞–º–µ–Ω–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å.
    –ù–∞—á–Ω—ë–º —Å –∑–∞–º–µ–Ω—ã ‚Äì –Ω–∞–º –≤ –ø–æ–º–æ—â—å Table.ReplaceErrorValues.
    –¢—É—Ç –≤—Å—ë –ø—Ä–æ—Å—Ç–æ:
    Table.ReplaceErrorValues(table, {"Column2", null})
    –í—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º ‚Äì {–∏–º—è —Å—Ç–æ–ª–±—Ü–∞,–Ω–∞ —á—Ç–æ –∑–∞–º–µ–Ω–∏—Ç—å –æ—à–∏–±–∫—É}
    –•–æ—Ç—è –µ—Å–ª–∏ –º—ã—à–∫–æ–∫–ª–∞—Ü–∞—Ç—å, –∫–æ–¥ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
    Table.ReplaceErrorValues(table, {{"Column2", null}})
    –¢.–µ. –∞–≤—Ç–æ–º–∞—Ç–æ–º –≤–≤–æ–¥–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ - –≤–µ–¥—å –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑ –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª–µ–µ —á–µ–º –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü:
    Table.ReplaceErrorValues(table, {{"Column2", null},{"Column4", null}})
    –ü—Ä–∏—á—ë–º –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–º–µ–Ω—ã –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º:
    Table.ReplaceErrorValues(table, {{"Column2", null},{"Column4", 0}})

    –ù–æ —á—Ç–æ, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ä–∞–∑—É –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã:
    Table.ReplaceErrorValues(table, List.Transform(Table.ColumnNames(table),(x)=>{x,null}))
    –¢.–µ. –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –≤–∏–¥–∞ {–∏–º—è, null}

    –¢–µ–ø–µ—Ä—å —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Å—Ç—Ä–æ–∫. –¢—É—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç Table.RemoveRowsWithErrors.
    –°–∏–Ω—Ç–∞–∫—Å–∏—Å –µ—â—ë –ø—Ä–æ—â–µ:
    Table.RemoveRowsWithErrors(table, {"Column2"})
    –ù–æ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –∏—â–µ—Ç –æ—à–∏–±–∫–∏ —Ç–æ–ª—å–∫–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ, —Ö–æ—Ç—è —É–¥–∞–ª—è–µ—Ç –≤—Å—é —Å—Ç—Ä–æ–∫—É —Å –æ—à–∏–±–∫–æ–π. –î–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –≤—Å—ë —Ç–∞–∫–∂–µ –Ω–µ—Å–ª–æ–∂–Ω–æ:
    Table.RemoveRowsWithErrors(table, {"Column1", "Column2", "Column3"})

    –ê –∫–∞–∫ —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å –æ—à–∏–±–∫–∞–º–∏ —Å—Ä–∞–∑—É –ø–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º? –ò –≤–æ—Ç —Ç—É—Ç –º—ã –Ω–µ –±—É–¥–µ–º —Å–æ–æ—Ä—É–∂–∞—Ç—å –Ω–∏—á–µ–≥–æ:
    Table.RemoveRowsWithErrors(table)
    –¢.–µ. –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–∑ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã (–æ–±—Ä–∞—Ç–∏—Ç–µ –Ω–∞ —ç—Ç–æ –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —á–µ—Ä–µ–∑ –º—ã—à–∫–æ–∫–ª–∞—Ü –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∏ –º–æ–∂–µ—Ç –ø–æ—Ä–æ–∂–¥–∞—Ç—å –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–µ —Å—é—Ä–ø—Ä–∏–∑—ã).

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –æ—à–∏–±–∫–∏ –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å, –Ω–æ –≤—Å–µ–≥–¥–∞ –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å ‚Äì –Ω–µ –ø–æ–≤–ª–µ—á–µ—Ç –ª–∏ —Ç–∞–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–º–µ–Ω–∞ –∏—Å–∫–∞–∂–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –º–æ–∂–µ—Ç –≤—Å–µ-—Ç–∞–∫–∏ –ª—É—á—à–µ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–∏–∫.
    ]

[   UnFill –∏–ª–∏ –∫–∞–∫ —É—á–µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏–ª–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.ToColumns, Table.FromColumns

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –í —á–∞—Ç–µ –ø–æ–¥–∫–∏–Ω—É–ª–∏ –∑–∞–¥–∞—á–∫—É ‚Äì —Å–¥–µ–ª–∞—Ç—å ¬´FillDown –Ω–∞–æ–±–æ—Ä–æ—Ç¬ª. –°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á–∏ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–∞ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö. –ù–∞–ø—Ä—è–º—É—é M —Ç–∞–∫ –Ω–µ —É–º–µ–µ—Ç, —Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å—ã ‚Äì —ç—Ç–æ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é #–ù–µ–í—Å–µ–ô–æ–≥—É—Ä—Ç—ã–û–¥–∏–Ω–∞–∫–æ–≤–æ–ü–æ–ª–µ–∑–Ω—ã; –Ω–æ –µ—Å—Ç—å –ø—Ä–∏—ë–º, –∫–æ—Ç–æ—Ä—ã–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º.
    –°—Ä–∞–∑—É –∫–æ–¥:
    let 
    UnFill =(tbl,col,optional up)=>
        [   a = Table.ColumnNames(tbl),
            b = List.PositionOf(a,col),
            c = Table.ToColumns(tbl),
            d = c{b},
            e = if up is null or up = 0 then {null}&List.RemoveLastN(d,1) else List.Skip(d),
            f = List.Transform(List.Zip({d,e}),(x)=>if x{0}=x{1} then null else x{0}),
            g = List.ReplaceRange(c,b,1,{f}),
            h = Table.FromColumns(g,a)
        ][h],
        
        from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("xdExCoAwDAXQu3R2aNJUoVdRF6tOxa2TeHcxESq4qENcPh1+8qBpV9NlS0BHOss5lqSB394EruF8KWAZIcloKq4RcEph4pQ9YAJslTaJ+uSSU9JX3VtSar6Qgp2Dw2OY/oK//POPNsTbXfGB5HWYWodpdBi987DU7w=="),1))),
        unfilldown = UnFill(from,"–î–∞–Ω–Ω—ã–µ"),
        unfillup = UnFill(from,"–î–∞–Ω–Ω—ã–µ",1),
        unfilldown2 = UnFill(from,"–î–∞–Ω–Ω—ã–µ",0) 
    in 
        unfilldown2

    –í–∏–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é UnFill ‚Äì —è –Ω–µ–º–Ω–æ–≥–æ –æ–±–æ–±—â–∏–ª –∑–∞–¥–∞—á—É, –ø–æ—ç—Ç–æ–º—É —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—É—é —Ç–∞–±–ª–∏—Ü—É, —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–±–æ—Ä FillDown –∏–ª–∏ FillUp –º—ã —Ö–æ—Ç–∏–º ¬´–æ—Ç–º–µ–Ω–∏—Ç—å¬ª.
    –ü–æ —à–∞–≥–∞–º:
    a ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤
    b ‚Äì –Ω–∞—à–ª–∏ –Ω–æ–º–µ—Ä –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –Ω–∞—Å —Å—Ç–æ–ª–±—Ü–∞
    c ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ ‚Äì —Å–ø–∏—Å–æ–∫, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
    d ‚Äì –≤–∑—è–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –Ω–∞—Å —Å—Ç–æ–ª–±–µ—Ü
    e ‚Äì –∞ –≤–æ—Ç –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –º–∞–≥–∏—è: –µ—Å–ª–∏ —É –Ω–∞—Å Down ‚Äì –º—ã –±–µ—Ä–µ–º –ø—É—Å—Ç–æ–π —ç–ª–µ–º–µ–Ω—Ç –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–º—É –Ω–∞—à —Å–ø–∏—Å–æ–∫ –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, —Ç.–µ. –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π; –µ—Å–ª–∏ Up ‚Äì –Ω–∞–æ–±–æ—Ä–æ—Ç, —É–¥–∞–ª—è–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏ –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    f ‚Äì –ø–æ–ø–∞—Ä–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–æ–≤ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏—Ö ‚Äì –µ—Å–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null, –∏–Ω–∞—á–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
    g ‚Äì —Ç–µ–ø–µ—Ä—å –¥–µ–ª–æ –∑–∞ –º–∞–ª—ã–º ‚Äì –ø–æ–¥—Å–æ–≤—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞—à–∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –Ω–∞ –º–µ—Å—Ç–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é {f} ‚Äì –Ω–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞)
    h ‚Äì –Ω—É –∏ —Å–æ–±–∏—Ä–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –æ–±—Ä–∞—Ç–Ω–æ

    –í—Å—ë, –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞. unfilldown, unfillup, unfilldown2 ‚Äì –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏.
    –í–æ—Ç —Ç–∞–∫, –∫—É—Ä–∏—Ç–µ —Å–ø–∏—Å–∫–∏, —á—Ç–æ–±—ã —à–∞–º–∞–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã üòâ
    ]

[   PropisRub - —Å—É–º–º–∞ –ø—Ä–æ–ø–∏—Å—å—é (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì custom
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–∞—á–∞–ª–∏ —Ç—É—Ç. –ù–µ –¥—É–º–∞–ª, —á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∏–ª–ª–∏–æ–Ω—ã —Ä—É–±–ª–µ–π —Ç–∞–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –Ω–æ —Ä–∞–∑ —É–∂ –Ω–∞–¥–æ:
    PropisRub=(x)=>
    [ ln = { {"–¥–µ—Å—è—Ç—å ","–æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—å ","–¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å ","—Ç—Ä–∏–Ω–∞–¥—Ü–∞—Ç—å ","—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å ","–ø—è—Ç–Ω–∞–¥—Ü–∞—Ç—å ","—à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç—å ","—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å ","–≤–æ—Å–µ–º–Ω–∞–¥—Ü–∞—Ç—å ","–¥–µ–≤—è—Ç–Ω–∞–¥—Ü–∞—Ç—å "},
    {"","—Å—Ç–æ ","–¥–≤–µ—Å—Ç–∏ ","—Ç—Ä–∏—Å—Ç–∞ ","—á–µ—Ç—ã—Ä–µ—Å—Ç–∞ ","–ø—è—Ç—å—Å–æ—Ç ","—à–µ—Å—Ç—å—Å–æ—Ç ","—Å–µ–º—å—Å–æ—Ç ","–≤–æ—Å–µ–º—å—Å–æ—Ç ","–¥–µ–≤—è—Ç—å—Å–æ—Ç "},
    {"","","–¥–≤–∞–¥—Ü–∞—Ç—å ","—Ç—Ä–∏–¥—Ü–∞—Ç—å ","—Å–æ—Ä–æ–∫ ","–ø—è—Ç—å–¥–µ—Å—è—Ç ","—à–µ—Å—Ç—å–¥–µ—Å—è—Ç ","—Å–µ–º—å–¥–µ—Å—è—Ç ","–≤–æ—Å–µ–º—å–¥–µ—Å—è—Ç ","–¥–µ–≤—è–Ω–æ—Å—Ç–æ "},
    {"","–æ–¥–∏–Ω ","–¥–≤–∞ ","—Ç—Ä–∏ ","—á–µ—Ç—ã—Ä–µ ","–ø—è—Ç—å ","—à–µ—Å—Ç—å ","—Å–µ–º—å ","–≤–æ—Å–µ–º—å ","–¥–µ–≤—è—Ç—å "},
    {"","–æ–¥–Ω–∞ ","–¥–≤–µ ","—Ç—Ä–∏ ","—á–µ—Ç—ã—Ä–µ ","–ø—è—Ç—å ","—à–µ—Å—Ç—å ","—Å–µ–º—å ","–≤–æ—Å–µ–º—å ","–¥–µ–≤—è—Ç—å "}},
    lr = { {"","—Ç—Ä–∏–ª–ª–∏–æ–Ω ","—Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ ","—Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ ","—Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ ","—Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ "},
    {"","–º–∏–ª–ª–∏–∞—Ä–¥ ","–º–∏–ª–ª–∏–∞—Ä–¥–∞ ","–º–∏–ª–ª–∏–∞—Ä–¥–∞ ","–º–∏–ª–ª–∏–∞—Ä–¥–∞ ","–º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ "},
    {"","–º–∏–ª–ª–∏–æ–Ω ","–º–∏–ª–ª–∏–æ–Ω–∞ ","–º–∏–ª–ª–∏–æ–Ω–∞ ","–º–∏–ª–ª–∏–æ–Ω–∞ ","–º–∏–ª–ª–∏–æ–Ω–æ–≤ "},
    {"","—Ç—ã—Å—è—á–∞ ","—Ç—ã—Å—è—á–∏ ","—Ç—ã—Å—è—á–∏ ","—Ç—ã—Å—è—á–∏ ","—Ç—ã—Å—è—á "},
    {"","","","","",""}},
    lc = { {"–ª–µ–π","–ª—å","–ª—è","—Ä—É–±"},
    {"–µ–∫","–π–∫–∞","–π–∫–∏","–∫–æ–ø–µ"}},
    txt=(n,r)=>[ a = List.Transform(Text.ToList(n), each Number.From(_)),
    b = ln{1}{a{0}} & (if a{1}<>1 then ln{2}{a{1}} & (if r = 3 then ln{4}{a{2}} else ln{3}{a{2}}) else ln{0}{a{2}}),
    c = lr{r}{if a{1}=1 or a{2}=0 then 5 else List.Min({a{2},5})},
    d = if Number.From(n)=0 then "" else b&c][d],
    cur=(x,y)=>[ a = Number.From(x),
    b = if Number.IntegerDivide(a,10)=1 or Number.Mod(a+9,10)>3 then lc{y}{0} else if Number.Mod(a,10)=1 then lc{y}{1} else lc{y}{2},
    c = lc{y}{3}&b][c],
    prp=(x)=>[ a = Splitter.SplitTextByRepeatedLengths(3)(x),
    b = Text.Combine(List.Transform({0..4},each txt(a{_},_)),""),
    c = if Number.From(x)=0 then "–Ω–æ–ª—å " else b][c],
    lst = Text.Split(Number.ToText(Number.Round(x,2),"000000000000000.00","en-US"),"."),
    res = prp(lst{0})&cur(Text.End(lst{0},2),0)&" "&lst{1}&" "&cur(lst{1},1)][res]

    –†–∞—Å—à–∏—Ä–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω, —Ä—É–±–ª–∏ –∏ –∫–æ–ø–µ–π–∫–∏ —Å–∫–ª–æ–Ω—è—é—Ç—Å—è. –Æ–∑–∞–π—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ. –ë–∞–≥—Ä–µ–ø–æ—Ä—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è, –∞ –≤–æ—Ç –ø–µ—Ä–ª–∞–º—É—Ç—Ä–æ–≤—ã—Ö –ø—É–≥–æ–≤–∏—Ü —Å —Ä–∞—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∫—Ä—ã–ª—å—è–º–∏ –Ω–µ –¥–µ—Ä–∂–∏–º.
    ]

[   Buffer 1 ‚Äì List.Buffer / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Buffer

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ß—Ç–æ-—Ç–æ –Ω–∞–∑—Ä–µ–ª–æ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤ –≤ M. –ù–∞—á–Ω–µ–º —Å —Å–∞–º–æ–≥–æ, –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –ø—Ä–æ—Å—Ç–æ–≥–æ ‚Äì List.Buffer. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏ ‚Ä¶ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫. –°—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ —Å–ø–∏—Å–æ–∫ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –ø–∞–º—è—Ç—å –∏ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º (stable). –ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –ø–æ—Å–ª–µ –ø–æ–º–µ—â–µ–Ω–∏—è –≤ –±—É—Ñ–µ—Ä —Å–ø–∏—Å–æ–∫ –∑–∞–Ω–æ–≤–æ –Ω–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è.
    –ó–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ?
    –í–æ–∑—å–º–µ–º —Ç–∞–∫–æ–π –ø—Ä–∏–º–µ—Ä:
    let
    from = #table({"fio"},{{"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á–ò–≤–∞–Ω–æ–≤"},{"–ü—ë—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á–ü–µ—Ç—Ä–æ–≤"},{"–ï–≤–ª–∞–º–ø–∏–π –ï–≤–ª–∞–º–ø–∏–µ–≤–∏—á–ï–≤–ª–∞–º–ø–∏–µ–≤"},{"JohnSmith"}}),
    f=(x)=>Text.Combine(Splitter.SplitTextByCharacterTransition({"a".."z"}&{"–∞".."—è"},{"A".."Z"}&{"–ê".."–Ø"})(x)," "),
    to = Table.TransformColumns(from,{"fio",f})
    in
    to
    –§–∞–º–∏–ª–∏—è –ø—Ä–∏–ª–∏–ø–ª–∞ –∫ –∏–º–µ–Ω–∏ –∏ –æ—Ç—á–µ—Å—Ç–≤—É. –†–∞–∑–¥–µ–ª—è–µ–º —á–µ—Ä–µ–∑ Splitter.SplitTextByCharacterTransition –∏ –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–±–∏—Ä–∞–µ–º, –Ω–æ —É–∂–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª. –í—Å—ë –ø—Ä–æ—Å—Ç–æ, –Ω–æ –Ω–µ —Å–æ–≤—Å–µ–º.
    –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è f –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å—Ç–æ–ª–±—Ü–∞. –ê –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —É –Ω–∞—Å —É–∫–∞–∑–∞–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ({"a".."z"} - —ç—Ç–æ –Ω–µ —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å, —ç—Ç–æ –∏–º–µ–Ω–Ω–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ–¥–æ–≤ —Å–∏–º–≤–æ–ª–æ–≤) ‚Äì —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ. –ò –≤–æ—Ç —á—Ç–æ–±—ã —ç—Ç–æ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å –ø–∏—à–µ–º —Ç–∞–∫:
    let
    from = #table({"fio"},{{"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á–ò–≤–∞–Ω–æ–≤"},{"–ü—ë—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á–ü–µ—Ç—Ä–æ–≤"},{"–ï–≤–ª–∞–º–ø–∏–π –ï–≤–ª–∞–º–ø–∏–µ–≤–∏—á–ï–≤–ª–∞–º–ø–∏–µ–≤"},{"JohnSmith"}}),
    a = List.Buffer({"a".."z"}&{"–∞".."—è"}),
    b = List.Buffer({"A".."Z"}&{"–ê".."–Ø"}),
    f=(x)=>Text.Combine(Splitter.SplitTextByCharacterTransition(a,b)(x)," "),
    to = Table.TransformColumns(from,{"fio",f})
    in
    to
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, —Ç–æ–ª—å–∫–æ —Å–ø–∏—Å–∫–∏ –≤—ã–Ω–µ—Å–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ –∏ –ø–æ–º–µ—Å—Ç–∏–ª–∏ –∏—Ö –≤ –±—É—Ñ–µ—Ä. –¢–µ–ø–µ—Ä—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –≤—ã—á–∏—Å–ª–µ–Ω—ã –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –∏ –¥–∞–ª–µ–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ.
    –ù–∞ –º–∞—Å—Å–∏–≤–µ –≤ 50k —Å—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å 4 –¥–æ 2 —Å–µ–∫—É–Ω–¥ (–Ω—É —Ç–æ –µ—Å—Ç—å –≤ –¥–≤–∞ —Ä–∞–∑–∞).
    –í–æ—Ç —Ç–∞–∫ ‚Äì —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ (—Å–ø–∏—Å–∫–∏ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤, —Å–ø–∏—Å–∫–∏ –¥–∞—Ç –∏ —Ç.–ø.) –∏ –±—É—Ñ–µ—Ä–∏—Ç–µ –∏—Ö - —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏.
    ]

[   ? ?? ‚Äì Field Access –∏ Coalesce ‚Äì –∏–ª–∏ –∑–∞—á–µ–º –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –≤ –∫–æ–¥–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –æ—Å–Ω–æ–≤—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –î–∞–≤–∞–π—Ç–µ –ø–æ—Å—Ç–∞–≤–∏–º —Ç–æ—á–∫—É –≤ –≤–æ–ø—Ä–æ—Å–µ –∑–Ω–∞–∫–æ–≤ –≤–æ–ø—Ä–æ—Å–∞ üòâ. –£–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–æ–º–Ω—é:
    {1,2,3,4}{7} //–æ—à–∏–±–∫–∞ ‚Äì —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
    [a= "–í–∞—Å—è", b= "–ü–µ—Ç—è", c="–ö–æ–ª—è"][d]//–æ—à–∏–±–∫–∞ ‚Äì –ø–æ–ª–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞124"]}[Content]//–æ—à–∏–±–∫–∞, –µ—Å–ª–∏ –Ω–µ—Ç —Ç–∞–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã

    –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ? (–∑–Ω–∞–∫ –≤–æ–ø—Ä–æ—Å–∞):
    {1,2,3,4}{7}? //null
    [a= "–í–∞—Å—è", b= "–ü–µ—Ç—è", c="–ö–æ–ª—è"][d]? //null
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞124"]}?[Content]? //null
    –¢.–µ. –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —ç–ª–µ–º–µ–Ω—Ç—É —Å–ø–∏—Å–∫–∞ –∏–ª–∏ –ø–æ–ª—é —Ç–∞–±–ª–∏—Ü—ã, –≤ —Å–ª—É—á–∞–µ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä ? –≤–µ—Ä–Ω—ë—Ç –Ω–∞–º null ‚Äì —ç—Ç–æ –ª—É—á—à–µ, —á–µ–º –æ—à–∏–±–∫–∞.

    –ù–æ —á—Ç–æ –µ—Å–ª–∏ –Ω–∞–º –Ω–µ –Ω—É–∂–µ–Ω null? –í–µ–¥—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–∞–ª–µ–µ –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö –∏ –Ω–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è 0, {}, [], "" (–Ω–æ–ª—å, –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –ø—É—Å—Ç–∞—è –∑–∞–ø–∏—Å—å, –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –∏ —Ç.–ø.) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–ª—É–∂–µ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Ä–æ–¥–µ ¬´–Ω–µ –Ω–∞–π–¥–µ–Ω–æ¬ª.
    –í–æ —Ç—É—Ç –Ω–∞–º –Ω–∞ –ø–æ–º–æ—â—å –∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä ?? ‚Äì –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (coalesce). –í –æ–±—â–µ–º –≤–∏–¥–µ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
    x??y
    –µ—Å–ª–∏ x –Ω–µ null ‚Äì –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â—ë–Ω x, –∏–Ω–∞—á–µ ‚Äì y.
    –ù—É –∞ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ:
    {1,2,3,4}{7}? ??0 //0 ‚Äì –Ω–æ–ª—å
    [a= "–í–∞—Å—è", b= "–ü–µ—Ç—è", c="–ö–æ–ª—è"][d]? ?? ""//–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
    Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞124"]}?[Content]? ??"–¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"// –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
    –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - –≥–ª–∞–≤–Ω–æ–µ –Ω–µ –∑–∞–±—ã—Ç—å –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ–±–µ–ª –º–µ–∂–¥—É ? –∏ ?? .

    –í–æ—Ç —Ç–∞–∫ ‚Äì –Ω–∏–∫–∞–∫–∏—Ö try, –Ω–∏–∫–∞–∫–∏—Ö if then else, –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞–∫–∏ –≤–æ–ø—Ä–æ—Å–∞, –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ.
    –í —á–∞—Ç–µ –º–æ–∂–Ω–æ –≥–ª—è–Ω—É—Ç—å –Ω–∞ –±–æ–µ–≤–æ–π –ø—Ä–∏–º–µ—Ä ‚Äì –±–µ—Ä–∏—Ç–µ –Ω–∞ –≤–æ–æ—Ä—É–∂–µ–Ω–∏–µ.
    ]

[   Text.Combine ‚Äì —Å–æ–±–∏—Ä–∞–µ–º —Ç–µ–∫—Å—Ç –≤–æ–µ–¥–∏–Ω–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Text.Combine

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —á–∞—Ç–∞ ‚Äì –≤ –ª–∏–¥–µ—Ä–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π List.Transform (–ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö –±—ã—Å—Ç—Ä–µ–µ), –¥–∞–ª–µ–µ Excel.CurrentWorkbook (–±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤), –¥–∞–ª–µ–µ Table.ColumnNames (–µ—ë —è –Ω–µ —Ä–∞–∑–±–∏—Ä–∞–ª, –Ω–æ —Ç—É—Ç –∏ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –Ω–µ—á–µ–≥–æ ‚Äì –¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã), –∞ –≤–æ—Ç —á–µ—Ç–≤–µ—Ä—Ç–æ–π –æ–∫–∞–∑–∞–ª–∞—Å—å Text.Combine ‚Äì –µ—Å–ª–∏ —á–µ—Å—Ç–Ω–æ, —É–¥–∏–≤–ª—ë–Ω ‚Äì –Ω–æ –¥—É–º–∞–µ—Ç—Å—è —Ç—É—Ç –µ—Å—Ç—å –æ —á—ë–º –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å.
    –ò—Ç–∞–∫, —Å–ø—Ä–∞–≤–∫–∞:
    Text.Combine(texts as list, optional separator as nullable text) as text

    texts ‚Äì —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –ø—Ä–æ–≤–µ—Ä—è–µ–º:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"}) //–º–∞–º–∞–º—ã–ª–∞—Ä–∞–º—É
    Text.Combine({"a".."f"}) //abcdef
    Text.Combine({"1".."5"}) //12345
    Text.Combine({1..5}) //Expression.Error: –ù–µ —É–¥–∞–µ—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 1 –≤ —Ç–∏–ø Text
    –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç - —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫, –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç.

    separator ‚Äì –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –±–µ–∑ –Ω–µ–≥–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–¥–µ—Ç —á–µ—Ä–µ–∑ ¬´–Ω–∏—á–µ–≥–æ¬ª, –∞ —Ç–æ—á–Ω–µ–µ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},"") //–º–∞–º–∞–º—ã–ª–∞—Ä–∞–º—É
    –ü–æ–ª—É—á–∏–ª–∏ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –≤—ã—à–µ.
    –ù—É –∞ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –Ω—É–ª–µ–≤—É—é —Å—Ç—Ä–æ–∫—É:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"}," ") // –º–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},"-") // –º–∞–º–∞-–º—ã–ª–∞-—Ä–∞–º—É
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},"-&-") // –º–∞–º–∞-&-–º—ã–ª–∞-&-—Ä–∞–º—É
    –¢.–µ. —Å—Ç—Ä–æ–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.

    –ï—â—ë –æ–¥–Ω–∞ —Ç–∏–ø–∏—á–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äì —Å–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ —á—Ç–æ–±—ã –∫–∞–∂–¥–æ–µ –±—ã–ª–æ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},"#(lf)")
    –ó–¥–µ—Å—å "#(lf)"- escape-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ–ø–µ—á–∞—Ç–∞–µ–º–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ - –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ (–∫–æ–º—É –Ω—É–∂–Ω–∞ —Ç–∞–±—É–ª—è—Ü–∏—è - "#(tab) " ‚Äì –ø—Ä–∞–≤–¥–∞ Excel –µ—ë –Ω–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç, –Ω–æ –µ—Å–ª–∏ –≤—ã –ø–æ—Ç–æ–º –∫–æ–ø–∏—Ä—É–µ—Ç–µ —Ç–µ–∫—Å—Ç –≤ –¥—Ä—É–≥–æ–µ –º–µ—Å—Ç–æ ‚Äì —Ç–∞–±—É–ª—è—Ü–∏—è —Ç–∞–º –±—É–¥–µ—Ç).

    Escape-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –æ–±—ã—á–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},";#(lf)")

    –ù–∞–∫–æ–Ω–µ—Ü, —Å–∏–º–≤–æ–ª –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–ø–µ—á–∞—Ç–∞–µ–º—ã–º:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},"#(00A0)")
    –ö—Ç–æ –Ω–µ —É–∑–Ω–∞–ª ‚Äì —ç—Ç–æ –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω—ã–π –ø—Ä–æ–±–µ–ª (A0 - —ç—Ç–æ 160 –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ). –¢.–µ. –ø–∏—à–µ–º "#(—à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–π –∫–æ–¥ –Æ–Ω–∏–∫–æ–¥–∞) " ‚Äì –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –ª—é–±–æ–π –∫–æ–¥ –ø–æ –≤–∫—É—Å—É. –ù—É –∞ –µ—Å–ª–∏ —É –≤–∞—Å –ø–ª–æ—Ö–æ —Å —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π, —Å–∏–º–≤–æ–ª—ã –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –∏ –ø–æ —Å—Ç–∞—Ä–∏–Ω–∫–µ:
    Text.Combine({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},Character.FromNumber(160))
    Character.FromNumber –ø–æ–Ω–∏–º–∞–µ—Ç –æ–±—ã—á–Ω–æ–µ (–¥–µ—Å—è—Ç–∏—á–Ω–æ–µ) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ù–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ ‚Äì –≥–ª–∞–≤–Ω–æ–µ –≤—Å—ë –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—Å—Ç –∏ –≤—ã—è—Å–Ω–∏—Ç—å –∫–æ–¥ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è.
    ]

[   Date + Time = ? –ø–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É–≤—Ä–µ–º—è –∏–∑ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - DateTime.From, DateTime.FromText

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ß—Ç–æ-—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø—Ä–æ—Å–∫–æ—á–∏–ª–∞ –∑–∞–¥–∞—á–∫–∞ –ø–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—é –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ –¥–∞—Ç—É–≤—Ä–µ–º—è. –ó–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ? –î–∞ –ø—Ä–æ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ —á–∞—Å—Ç–µ–Ω—å–∫–æ –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö, –∞ –Ω–∞–¥–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥—ã ‚Äì —Ç.–µ. —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –º–æ–∂–Ω–æ –∑–∞–º–æ—Ä–æ—á–∏—Ç—å—Å—è –Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã –¥–∞—Ç –∏ –æ—Ç–¥–µ–ª—å–Ω–æ –≤—Ä–µ–º–µ–Ω–∏, –∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞—Ç—É–≤—Ä–µ–º—è –∏ –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É ‚Äì —Ä–µ–∞–ª—å–Ω–æ —É–¥–æ–±–Ω–µ–µ.
    –ù—É –ø–æ–µ—Ö–∞–ª–∏. –ü—Ä–∏–º–µ—Ä –±—É–¥–µ—Ç –ø—Ä–µ–¥–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π:
    let
        date = #date(2022,8,6),
        time = #time(1,41,26),
        datetime0 = date + time, // –ù–µ —É–¥–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä + –∫ —Ç–∏–ø–∞–º Date –∏ Time
        datetime1 = DateTime.From(Number.From(date) + Number.From(time)),//06.08.2022 1:41:26
        datetime2 = DateTime.From(Text.From(date)&" "&Text.From(time)), //06.08.2022 1:41:00
        datetime3 = DateTime.From(Text.From(date)&" "&Time.ToText(time,"hh:mm:ss")),//06.08.2022 1:41:26
        datetime4 = DateTime.From(Text.From(date)&Time.ToText(time,[Format=" hh:mm:ss"])),//06.08.2022 1:41:26
        datetime5 = DateTime.From(date) + Duration.From("0."&Time.ToText(time,[Format="T"])),//06.08.2022 1:41:26
        datetime6 = DateTime.FromText("06.08.2022"&"01:41:26",[Format="dd.MM.yyyyhh:mm:ss"]),//06.08.2022 1:41:26
        datetime7 = DateTime.FromText("2022-08-06T01:41:26",[Format="yyyy-MM-ddThh:mm:ss"]),//06.08.2022 1:41:26
        datetime8 = date & time //06.08.2022 1:41:26
        
    in
        datetime8

    –î–ª—è –Ω–∞—á–∞–ª–∞ ‚Äì date –∏ time ‚Äì –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è. –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ date ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–º—è, –∞ #date() ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, —Å–æ–∑–¥–∞—é—â–∞—è –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞—Ç—ã, —Å time –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ ‚Äì –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –∏ –Ω–µ –ø—É—Ç–∞–µ–º ‚Äì –¥–∏–µ–∑ —Ä–µ—à–∞–µ—Ç )))
    –¢–µ–ø–µ—Ä—å –ø–æ —à–∞–≥–∞–º:
    datetime0 ‚Äì —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–¥—É–º–∞—Ç—å —ç–∫—Å–µ–ª—å—â–∏–∫ ‚Äì –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–ª–æ–∂–∏—Ç—å –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è. –ù–æ —Ç–∞–∫ –Ω–µ –≤—ã–π–¥–µ—Ç ‚Äì –∑–¥–µ—Å—å –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤, –∞ –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è ‚Äì —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ü–æ—ç—Ç–æ–º—É –ø—Ä–∏–¥–µ—Ç—Å—è –∫–æ–ª–¥–æ–≤–∞—Ç—å.
    datetime1 ‚Äì —Ä–∞–∑ –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–∂–∏—Ç—å ‚Äì –ø—Ä–æ–±—É–µ–º –ø—Ä–∏–≤–µ—Å—Ç–∏ —Ç–∏–ø—ã ‚Äì –∏ –¥–∞—Ç—É, –∏ –≤—Ä–µ–º—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ —á–∏—Å–ª–∞, —Å—É–º–º–∏—Ä—É–µ–º, –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É–≤—Ä–µ–º—è ‚Äì —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä—è–º –∫–∞–∫ –≤ Excel ‚Äì –∏ –Ω–∞–¥–æ —Å–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π (—Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏) —Å–ø–æ—Å–æ–±
    datetime2 ‚Äì –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± ‚Äì –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –æ–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç, —Å–∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–∞—Ç—É–≤—Ä–µ–º—è –∏–∑ —Ç–µ–∫—Å—Ç–∞ ‚Äì –∑–¥–µ—Å—å –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ ‚Äì Text.From "—Å—ä–µ–¥–∞–µ—Ç" —Å–µ–∫—É–Ω–¥—ã.
    datetime3 ‚Äì —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–µ–∫—É–Ω–¥ ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Time.ToText ‚Äì –≤ —ç—Ç–æ–º —à–∞–≥–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Å—Ç–∞—Ä—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–π –≤–µ—Ä—Å–∏–∏ ‚Äì –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —É–∫–∞–∑–∞–Ω —Ñ–æ—Ä–º–∞—Ç
    datetime4 ‚Äì —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –≤ –Ω–æ–≤–æ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ ‚Äì –∑–¥–µ—Å—å –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –∏–¥—ë—Ç –∑–∞–ø–∏—Å—å, –æ–¥–Ω–æ –∏–∑ –ø–æ–ª–µ–π –∫–æ—Ç–æ—Ä–æ–π ‚Äì —Ñ–æ—Ä–º–∞—Ç. –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä–æ–±–µ–ª –º–æ–∂–Ω–æ "–∑–∞–≥–Ω–∞—Ç—å" –≤ —Ñ–æ—Ä–º–∞—Ç
    datetime5 ‚Äì –µ—â—ë –æ–¥–∏–Ω —Å–ø–æ—Å–æ–±, –∫–æ—Ç–æ—Ä—ã–π –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à, –µ—Å–ª–∏ —É –≤–∞—Å –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —É–∂–µ –Ω–∞ –≤—Ö–æ–¥–µ –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ ‚Äì –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –¥–∞—Ç—É –≤ –¥–∞—Ç—É–≤—Ä–µ–º—è, –∞ –≤—Ä–µ–º—è ‚Äì –≤ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å–ª–æ–∂–∏—Ç—å (—ç—Ç–æ—Ç —Å–ø–æ—Å–æ–± –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —á–µ—Ä–µ–∑ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º —á–µ—Ä–µ–∑ Number.From)

    –ù—É –∏ –æ–±—Å—É–∂–¥–∞—è DateTime.From, –Ω–µ–ª—å–∑—è –Ω–µ –≤—Å–ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ DateTime.FromText ‚Äì —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–Ω–∏–º–∞–Ω–∏—è –¥–∞—Ç—ã–≤—Ä–µ–º–µ–Ω–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞.
    datetime6 ‚Äì –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–æ–∂–Ω–æ –Ω–µ –∑–∞–º–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è —Å –ø—Ä–æ–±–µ–ª–∞–º–∏, –∞ –ø—Ä–æ—Å—Ç–æ "–æ–±—ä—è—Å–Ω–∏—Ç—å" –≤ –∫–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥–µ. –ü—Ä–∏—á—ë–º —Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∞–º—ã–π —Ä–∞–∑–Ω—ã–π.

    datetime7 ‚Äì –∫—Ç–æ –ø–æ–ª—É—á–∞–ª —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –∏ –ø–æ—Ç–æ–º –ø–∞—Ä–∏–ª—Å—è —Å–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏ –∏ –ª–æ–∫–∞–ª—è–º–∏ —Å–µ–π—á–∞—Å –Ω–∞–≤–µ—Ä–Ω–æ–µ –ø—Ä–æ—Å–ª–µ–∑–∏–ª–∏—Å—å –æ—Ç —É–º–∏–ª–µ–Ω–∏—è ‚Äì —Ç–∞–∫ —Ç–æ–∂–µ –º–æ–∂–Ω–æ.

    UPD datetime8 - —Ç–∞–∫ —É–≤–ª–µ–∫—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏, —á—Ç–æ –Ω–µ –Ω–∞–ø–∏—Å–∞–ª –≥–ª–∞–≤–Ω–æ–µ (—Å–ø–∞—Å–∏–±–æ @sboy_ko - –Ω–∞–ø–æ–º–Ω–∏–ª) - –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –Ω–µ–ª—å–∑—è —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å, –Ω–æ –º–æ–∂–Ω–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞—Ç—å (–≤—Å—ë-—Ç–∞–∫–∏ –∏ —Ç–æ –∏ –¥—Ä—É–≥–æ–µ - –æ—Å–æ–±–∞—è —Ñ–æ—Ä–º–∞ record )

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë. –í—Ä–æ–¥–µ –Ω–∏—á–µ–≥–æ –∑–∞–ø—Ä–µ–¥–µ–ª—å–Ω–æ–≥–æ ‚Äì –≥–ª–∞–≤–Ω–æ–µ –ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç—ã. –ß–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç –Ω–∞–≥–ª—è–¥–Ω–µ–µ, —á–µ—Ä–µ–∑ —á–∏—Å–ª–∞ –±—ã—Å—Ç—Ä–µ–µ ‚Äì –Ω–æ –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏ –∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—Ö–æ–¥–µ.
    ]

[   Table.AddIndexColumn ‚Äì —Å–Ω–æ–≤–∞ –ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏–ª–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.AddIndexColumn, List.Buffer

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –°–µ–≥–æ–¥–Ω—è –≤ —á–∞—Ç–µ –Ω–µ–º–Ω–æ–∂–∫–æ –±–µ–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ —Å –ø–æ–ª –æ–±–æ—Ä–æ—Ç–∞ —Å–ª—É—á–∏–ª—Å—è —á–µ–ª–ª–µ–Ω–∂ –Ω–∞ —Ç–µ–º—É –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏. –ú—ã —É–∂–µ —Ä–µ—à–∞–ª–∏ —Ç–∞–∫—É—é –∑–∞–¥–∞—á—É –≤ —Ö–æ–¥–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ UnFill. –°–µ–≥–æ–¥–Ω—è –∂–µ –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ –≤–æ-–ø–µ—Ä–≤—ã—Ö, –º–æ–∂–Ω–æ –∏ —á–µ—Ä–µ–∑ Table.Join (–æ—á–µ–Ω—å —à—É—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç @MaximZelensky), –Ω—É –∞ –≤–æ-–≤—Ç–æ—Ä—ã—Ö‚Ä¶ –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —á–µ—Ä–µ–∑ Table.AddIndexColumn –∏ —Å–ø–∏—Å–æ–∫.

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–¥:
    let
        tbl = Table.FromColumns({{"a".."i"},{1..9}},{"a","b"}),
        lst = List.Buffer({null}&tbl[b]),
        add = Table.AddIndexColumn(tbl,"c",0,1),
        to = Table.TransformColumns(add,{"c",(x)=>lst{x}})
    in
        to
    tbl ‚Äì —Å–∞–º–∞ —Ç–∞–±–ª–∏—Ü–∞,
    lst ‚Äì —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –Ω—É–∂–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞, —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –≤ –Ω–∞—á–∞–ª–æ –Ω—É–ª–µ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º (–∏ –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –ø—Ä–æ –±—É—Ñ–µ—Ä)
    add ‚Äì –¥–æ–±–∞–≤–∏–ª–∏ —Å—Ç–æ–ª–±–µ—Ü –∏–Ω–¥–µ–∫—Å–∞
    to ‚Äì —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω–¥–µ–∫—Å –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –¥–æ–±–∞–≤–∏–ª–∏ –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞ –Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ –∏–Ω–¥–µ–∫—Å—É –º—ã –ø–æ–ª—É—á–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å )))

    –°–¥–µ–ª–∞–µ–º –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç (–æ–Ω –º–µ–¥–ª–µ–Ω–Ω–µ–µ –±—É–∫–≤–∞–ª—å–Ω–æ –Ω–∞ –ø–∞—Ä—É –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤, –Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ):
    let
        tbl = Table.FromColumns({{"a".."i"},{1..9}},{"a","b"}),
        lst = List.Buffer(tbl[b]),
        add = Table.AddIndexColumn(tbl,"c",-1,1),
        to = Table.TransformColumns(add,{"c",(x)=>if x<0 then null else lst{x}})
    in
        to
    –ó–¥–µ—Å—å –º—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫, –∞ –≤–æ—Ç –Ω—É–º–µ—Ä–∞—Ü–∏—é –Ω–∞—á–∞–ª–∏ —Å -1. –¢. –µ. —Ç–æ—á–Ω–æ —Ç–∞–∫–∂–µ —Å–¥–≤–∏–Ω—É–ª–∏ –ø–æ–∑–∏—Ü–∏—é –Ω–∞ 1 –Ω–∞–∑–∞–¥, –ø—Ä–∞–≤–¥–∞ –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –æ—à–∏–±–∫—É –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞: (x)=>if x<0 then null else lst{x}
    –ó–∞—á–µ–º –±—ã–ª–æ —É—Å–ª–æ–∂–Ω—è—Ç—å? - –¥–∞ –≤—Å—ë –¥–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–≥—Ä–∞—è —Å —Ç—Ä–µ—Ç—å–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º AddIndexColumn –º–æ–∂–Ω–æ —Å–¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ –ª—é–±–æ–µ —á–∏—Å–ª–æ –ø–æ–∑–∏—Ü–∏–π –≤–≤–µ—Ä—Ö –∏–ª–∏ –≤–Ω–∏–∑:
    let
        tbl = Table.FromColumns({{"a".."i"},{1..9}},{"a","b"}),
        lst = List.Buffer(tbl[b]),
        add = Table.AddIndexColumn(tbl,"c",1,1),
        to = Table.TransformColumns(add,{"c",(x)=>lst{x}?})
    in
        to
    –í—Å—ë —Ç–æ–∂–µ —Å–∞–º–æ–µ, –Ω–æ —Å–¥–≤–∏–≥ —Ç–µ–ø–µ—Ä—å –≤–ø–µ—Ä–µ–¥ –Ω–∞ 1 ‚Äì —Ç–∞–∫ –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É (–Ω—É –∏ –Ω–µ –∑–∞–±—ã–ª–∏ –≤–æ–ø—Ä–æ—Å–∏–∫)

    –ê —Ç–µ–ø–µ—Ä—å –æ–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å—ë –≤ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é:
    let
        tbl = Table.FromColumns({{"a".."i"},{1..9}},{"a","b"}),
        AddOtherRowColumn = (tbl,col,newcol,index) =>
        [   lst = List.Buffer(Table.Column(tbl,col)),
            add = Table.AddIndexColumn(tbl,newcol,index,1),
            f = if index <0 then (x)=> if x <0  then null else lst{x}
                            else (x)=>lst{x}?,
            to = Table.TransformColumns(add,{newcol,f})][to],
        to = AddOtherRowColumn(tbl,"b","c",-1),
        to1 = AddOtherRowColumn(tbl,"b","c",-3),
        to2 = AddOtherRowColumn(tbl,"b","c",2)
    in
        to2
    –ü–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º –≤—Å—ë –¥—É–º–∞—é –ø–æ–Ω—è—Ç–Ω–æ ‚Äì —Ç–∞–±–ª–∏—Ü–∞, —Å—Ç–æ–ª–±–µ—Ü, –∏–º—è –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∏ –Ω–∞ —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å–¥–≤–∏–Ω—É—Ç—å.
    –ü—Ä–æ—Å—Ç–æ, –ª–∞–∫–æ–Ω–∏—á–Ω–æ –∏ –≥–ª–∞–≤–Ω–æ–µ —à—É—Å—Ç—Ä–æ! –Æ–∑–∞–π—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ.
    ]

[   List.Accumulate + Record.Field –ø—Ä–æ—Ç–∏–≤ Join-–æ–≤ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Record.Field, List.Accumulate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤ —á–∞—Ç–µ –≤—Å–ø–ª—ã–≤–∞–µ—Ç –ø—Ä–∏—ë–º, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –∑–∞–¥–∞—é—Ç –≤–æ–ø—Ä–æ—Å ¬´—á—Ç–æ –∑–∞ –º–∞–≥–∏—è¬ª?
    –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–∏—ë–º —à–∏—Ä–æ–∫–æ –∏–∑–≤–µ—Å—Ç–µ–Ω –≤ —É–∑–∫–∏—Ö –∫—Ä—É–≥–∞—Ö, –±—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, –ø–æ—ç—Ç–æ–º—É —Ä–∞–∑–±–µ—Ä–µ–º.
    –ò—Ç–∞–∫ –∑–∞–¥–∞—á–∞: –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ –§–ò–û/–¥–æ–ª–∂–Ω–æ—Å—Ç—å, –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ –î–æ–ª–∂–Ω–æ—Å—Ç—å/–æ–∫–ª–∞–¥/–ø—Ä–µ–º–∏—è, –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ö–æ—Ç–∏–º —Ç–∞–±–ª–∏—Ü—É –§–ò–û/–¥–æ–ª–∂–Ω–æ—Å—Ç—å/–æ–∫–ª–∞–¥/–ø—Ä–µ–º–∏—è. –ü–æ–Ω—è—Ç–Ω–æ–µ –¥–µ–ª–æ, —á—Ç–æ —ç—Ç–æ —Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Join:
    let
        a = #table({"–§–ò–û","–ü—Ä–æ—Ñ–µ—Å—Å–∏—è"},{{"–í–∞—Å—è","–ò–≥—Ä–æ–∫"},{"–ü–µ—Ç—è","–ò–≥—Ä–æ–∫"},{"–ö–æ–ª—è","–¢—Ä–µ–Ω–µ—Ä"},{"–ï–≤–ª–∞–º–ø–∏–π","–í—Ä–∞—á"}}),
        b = #table({"–î–æ–ª–∂–Ω–æ—Å—Ç—å","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"},{{"–ò–≥—Ä–æ–∫",1000,100},{"–¢—Ä–µ–Ω–µ—Ä",2000,5000},{"–í—Ä–∞—á",100,1}}),
        c = Table.Join(a,"–ü—Ä–æ—Ñ–µ—Å—Å–∏—è",b,"–î–æ–ª–∂–Ω–æ—Å—Ç—å"),
        d = Table.RemoveColumns(c,"–î–æ–ª–∂–Ω–æ—Å—Ç—å")
    in
        d
    –ù–æ —Å—Ä–∞–∑—É –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å ‚Äì –∂—É–ª—å–Ω–∏—á–µ—Å—Ç–≤–æ ‚Äì —Ç–∞–º –î–æ–ª–∂–Ω–æ—Å—Ç—å, —Ç–∞–º ‚Äì –ü—Ä–æ—Ñ–µ—Å—Å–∏—è, –≥–¥–µ –∑–∞–º–æ—Ä–æ—á–∫–∏ —Å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º? –ì–¥–µ —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å? –ò —Ç.–¥. –ù—É –û–ö, —Ç–æ–≥–¥–∞ NestedJoin:
    let
        a = #table({"–§–ò–û","–ü—Ä–æ—Ñ–µ—Å—Å–∏—è"},{{"–í–∞—Å—è","–ò–≥—Ä–æ–∫"},{"–ü–µ—Ç—è","–ò–≥—Ä–æ–∫"},{"–ö–æ–ª—è","–¢—Ä–µ–Ω–µ—Ä"},{"–ï–≤–ª–∞–º–ø–∏–π","–í—Ä–∞—á"}}),
        b = #table({"–î–æ–ª–∂–Ω–æ—Å—Ç—å","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"},{{"–ò–≥—Ä–æ–∫",1000,100},{"–¢—Ä–µ–Ω–µ—Ä",2000,5000},{"–í—Ä–∞—á",100,1}}),
        c = Table.NestedJoin(a,"–ü—Ä–æ—Ñ–µ—Å—Å–∏—è",b,"–î–æ–ª–∂–Ω–æ—Å—Ç—å","tmp"),
        d = Table.ExpandTableColumn(c, "tmp", {"–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"})
    in
        d
    –ó–¥–µ—Å—å, –¥—É–º–∞—é —Å–∏—Ç—É–∞—Ü–∏—è –∏ —Ä–µ—à–µ–Ω–∏–µ –º–Ω–æ–≥–∏–º –∑–Ω–∞–∫–æ–º—ã.

    –¢–æ–≥–¥–∞ –æ —á—ë–º –ø–æ—Å—Ç? –î–∞ –ø—Ä–æ—Å—Ç–æ —Ö–æ—á—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É:
    let
        a = #table({"–§–ò–û","–ü—Ä–æ—Ñ–µ—Å—Å–∏—è"},{{"–í–∞—Å—è","–ò–≥—Ä–æ–∫"},{"–ü–µ—Ç—è","–ò–≥—Ä–æ–∫"},{"–ö–æ–ª—è","–¢—Ä–µ–Ω–µ—Ä"},{"–ï–≤–ª–∞–º–ø–∏–π","–í—Ä–∞—á"}}),
        b = #table({"–î–æ–ª–∂–Ω–æ—Å—Ç—å","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"},{{"–ò–≥—Ä–æ–∫",1000,100},{"–¢—Ä–µ–Ω–µ—Ä",2000,5000},{"–í—Ä–∞—á",100,1}}),
        —Å = List.Accumulate(Table.ToRows(b),[],(s,c)=>Record.AddField(s,c{0},List.Skip(c))),
        d = (x)=>x&Record.Field(—Å,x{1}),
        e = Table.FromList(Table.ToRows(a),d,{"–§–ò–û","–ü—Ä–æ—Ñ–µ—Å—Å–∏—è","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"})
    in
        e
    –ß—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å?
    –í–æ–∑–Ω–∏–∫ —Å—Ç—Ä–∞–Ω–Ω—ã–π —à–∞–≥ c ‚Äì —Å –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–æ–º –∏ –ø—É—Å—Ç–æ–π –∑–∞–ø–∏—Å—å—é. –ó–¥–µ—Å—å –º—ã —Ç–∞–±–ª–∏—Ü—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π —Ä–∞–∑–±–∏–ª–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ (Table.ToRows) –∏ –∞–∫–∫—É–º—É–ª–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äì –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è –∑–∞–ø–∏—Å–∏, –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–ø–∏—Å–æ–∫ ‚Äì –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—è. –¢.–µ. –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–ª–∏ –∑–∞–ø–∏—Å—å, –≥–¥–µ –ø–æ–ª—è —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω—É–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–ª–æ–≤–∞—Ä—å). –ó–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ? –î–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∑–∞–ø–∏—Å–∏ –±—É–¥–µ—Ç —Å—Ä–∞–∑—É –≤—ã–Ω–∏–º–∞—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –Ω—É–∂–Ω–æ–≥–æ –Ω–∞–º –ø–æ–ª—è, –±–µ–∑ –ø–æ–∏—Å–∫–∞.
    –î–∞–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏—è d ‚Äì –µ—ë –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ - –º—ã —É–≤–∏–¥–∏–º —ç—Ç–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ ‚Äì –æ–Ω–∞ –±–µ—Ä–µ—Ç —Å–∞–º —Å–ø–∏—Å–æ–∫ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –Ω–µ–º—É –∑–Ω–∞—á–µ–Ω–∏–µ –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—è –∏–∑ —Å–ª–æ–≤–∞—Ä—è. –¢.–µ. –∫ —Å–ø–∏—Å–∫—É –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —Å—Ç—Ä–æ–∫–µ –¥–æ–±–∞–≤–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ–∫
    –ù—É –∏ –Ω–∞ —à–∞–≥–µ e ‚Äì –º—ã —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–¥—Å–æ–≤—ã–≤–∞–µ–º –≤ –º–æ–π –ª—é–±–∏–º—ã–π FromList.
    –ö–∞–∫ –±—ã –≤—Å—ë. –ù–∞–≤–µ—Ä–Ω—è–∫–∞ –Ω–µ–º–Ω–æ–∂–∫–æ –Ω–µ–ø—Ä–∏–≤—ã—á–Ω–æ, –Ω–æ —Ç–∞–∫ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö. –ü—Ä–æ–±—É–π—Ç–µ )))
    ]

[   Record.FieldOrDefault, Record.FromTable ‚Äì –Ω–µ–º–Ω–æ–∂–∫–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤ —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Record.FieldOrDefault, Record.FromTable

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –º—ã –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏, –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Å–∏.
    –í–æ–∑–Ω–∏–∫–∞–µ—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äì –∞ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤ —Å–ª–æ–≤–∞—Ä–µ –µ—Å—Ç—å –Ω–µ –≤—Å–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è?
    –ú—ã –∑–Ω–∞–µ–º –ø—Ä–æ –≤–æ—Ç —Ç–∞–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
    [a=1,b=2,c=3][d]? // null
    –ò –¥–∞–∂–µ —Ç–∞–∫–æ–π:
    [a=1,b=2,c=3][d]? ?? "–Ω–µ –Ω–∞–π–¥–µ–Ω–æ"// –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    –ù–æ –æ–Ω–∏ –ø—Ä–∏–º–µ–Ω–∏–º—ã –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —Å–ø–∏—Å–∫–∞, –∞ –≤–æ—Ç —Ñ—É–Ω–∫—Ü–∏—è Record.Field –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É –∏ –≤–æ–ø—Ä–æ—Å–∏–∫ –Ω–µ —Å–ø–∞—Å–µ—Ç.

    –ó–∞—Ç–æ —Å–ø–∞—Å—ë—Ç –¥—Ä—É–≥–∞—è, –Ω–µ –º–µ–Ω–µ–µ –ø–æ–ª–µ–∑–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - Record.FieldOrDefault.
    Record.FieldOrDefault([a=1,b=2,c=3], "d") //null
    Record.FieldOrDefault([a=1,b=2,c=3], "d","–Ω–µ –Ω–∞–π–¥–µ–Ω–æ") // –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    –¢.–µ. –±–µ–∑ —Ç—Ä–µ—Ç—å–µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏–º–µ–µ–º —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç [ ]?, —Å —Ç—Ä–µ—Ç—å–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º ‚Äì —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç [ ]? ??
    –ù—É –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —ç—Ç–æ –∫ –∫–æ–¥—É –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –ø–æ—Å—Ç–∞:
    let
    a = #table({"–§–ò–û","–ü—Ä–æ—Ñ–µ—Å—Å–∏—è"},{{"–í–∞—Å—è","–ò–≥—Ä–æ–∫"},{"–ü–µ—Ç—è","–ò–≥—Ä–æ–∫"},{"–ö–æ–ª—è","–¢—Ä–µ–Ω–µ—Ä"},{"–ï–≤–ª–∞–º–ø–∏–π","–í—Ä–∞—á"}}),
    b = #table({"–î–æ–ª–∂–Ω–æ—Å—Ç—å","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"},{{"–ò–≥—Ä–æ–∫",1000,100},{"–¢—Ä–µ–Ω–µ—Ä",2000,5000}}),
    —Å = Record.FromTable(Table.FromList(Table.ToRows(b),(x)=>{x{0},List.Skip(x)},{"Name","Value"})),
    d = (x)=>x&Record.FieldOrDefault(—Å,x{1},{}),
    e = Table.FromList(Table.ToRows(a),d,{"–§–ò–û","–ü—Ä–æ—Ñ–µ—Å—Å–∏—è","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"})
    in
    e
    –°–º–æ—Ç—Ä–∏–º –Ω–∞ —à–∞–≥ d ‚Äì –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω –Ω–µ null, –∞ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ {} ‚Äì —ç—Ç–æ –≤–∞–∂–Ω–æ, –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –ø—Ä–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ (–Ω—É –∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ null, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äì —Ç–∞–∫–∂–µ –ø–∏—à–µ–º —Å–ø–∏—Å–æ–∫, –Ω–æ —É–∂–µ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏: {"–Ω–µ –Ω–∞–π–¥–µ–Ω–æ","–Ω–µ –ø–æ–ª–æ–∂–µ–Ω–æ"})

    –¢–∞–∂–µ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —à–∞–≥ —Å. –í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Accumulate, –Ω–æ –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –±–æ–ª—å—à–∞—è, –æ–Ω –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª—è—Ç—å —Ä–∞–±–æ—Ç—É (–Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–ª–æ–≤–∞—Ä–µ –≤ 50k —Å—Ç—Ä–æ–∫ —Å–µ–≥–æ–¥–Ω—è –ø—Ä–æ—Å—Ç–æ —É–º–µ—Ä). –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –µ—Å—Ç—å –±–æ–ª–µ–µ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–±—Ä–∞—Ç—å –±–æ–ª—å—à—É—é –∑–∞–ø–∏—Å—å - Record.FromTable. –ù–æ –µ—Å—Ç—å –Ω—é–∞–Ω—Å - –Ω–∞ –≤—Ö–æ–¥ –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, —Ç–∞–±–ª–∏—Ü–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–∞ —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –¥–≤—É—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ - "Name" –∏ "Value". –ù—É –∏ –≤ –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–æ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ Table.ToRows+Table.FromList.

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë - —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å, –±–æ–ª—å—à–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –∑–∞–ø–∏—Å–∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏, –¥–µ–ª–æ –∑–∞ –º–∞–ª—ã–º ‚Äì –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –£—Å–ø–µ—Ö–æ–≤!
    ]

[   TableRenameColumnsByPositions –∏–ª–∏ –∫–∞–∫ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã –ø–æ –Ω–æ–º–µ—Ä—É / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì custom functions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –°–µ–≥–æ–¥–Ω—è –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –±—ã–ª –ø–æ–¥–Ω—è—Ç –≤–æ–ø—Ä–æ—Å –æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ –Ω–æ–º–µ—Ä—É (–ø–æ–∑–∏—Ü–∏–∏). –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Ñ—É–Ω–∫—Ü–∏—è:

    [func =(table,list) =>
        [   a = List.Buffer(Table.ColumnNames(table)),
            b = List.Count(a),
            c = (x) =>{a{if x{0}>0 then x{0}-1 else b+x{0}},x{1}},
            d = if list{0} is list then List.Transform(list,c) else c(list),
            e = Table.RenameColumns(table,d)
        ][e],
    typ = type function (
                    table as (type table meta [Documentation.FieldCaption = "–∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞"]),
                    list as (type list meta [Documentation.FieldCaption = "–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è"])
                            )           
                    as table meta [ 
                                    Documentation.Name = "TableRenameColumnsByPositions> (@buchlotnik)",
                                    Documentation.LongDescription = "–§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã  –ø–æ –∏—Ö –Ω–æ–º–µ—Ä—É. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ {–Ω–æ–º–µ—Ä, –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ} –ª–∏–±–æ —Å–ø–∏—Å–∫–∞ —Å–ø–∏—Å–∫–æ–≤ {{–Ω–æ–º–µ—Ä1, –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ1},{–Ω–æ–º–µ—Ä2, –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ2}}. –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–¥–∞–µ—Ç –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å –Ω–∞—á–∞–ª–∞ —Ç–∞–±–ª–∏—Ü—ã, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ - —Å –∫–æ–Ω—Ü–∞.",
                                    Documentation.Examples = {
                                        [Description = "–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü", Code = "=TableRenameColumnsByPositions(#table({""a"",""b"",""c""},{}),{1,""–ø–µ—Ä–≤—ã–π""})",Result="#table({""–ø–µ—Ä–≤—ã–π"",""b"",""c""},{})"], 
                                        [Description = "–ø–µ—Ä–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π —Å –∫–æ–Ω—Ü–∞ —Å—Ç–æ–ª–±–µ—Ü", Code =  "=TableRenameColumnsByPositions(#table({""a"",""b"",""c""},{}),{-1,""–ø–µ—Ä–≤—ã–π —Å –∫–æ–Ω—Ü–∞""})",Result="#table({""a"",""b"",""–ø–µ—Ä–≤—ã–π —Å –∫–æ–Ω—Ü–∞""},{})"], 
                                        [Description = "–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±—Ü—ã", Code = "=TableRenameColumnsByPositions(#table({""a"",""b"",""c""},{}),{{1,""–ø–µ—Ä–≤—ã–π""},{-1,""–ø–æ—Å–ª–µ–¥–Ω–∏–π""}})",Result="#table({""–ø–µ—Ä–≤—ã–π"",""b"",""–ø–æ—Å–ª–µ–¥–Ω–∏–π""},{})"]
                                        }        
                                    ],
        result = Value.ReplaceType(func,typ)
    ][result]

    –ì–ª–æ–±–∞–ª—å–Ω–æ –ø–æ —à–∞–≥–∞–º:
    func ‚Äì —Å–∞–º–∞ —Ñ—É–Ω–∫—Ü–∏—è
    typ ‚Äì –æ–ø–∏—Å–∞–Ω–∏–µ –µ—ë —Ç–∏–ø–∞ ‚Äì —á—Ç–æ-—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ –º—ã —É–∂–µ —Å–º–æ—Ç—Ä–µ–ª–∏ –≤ –ø–æ—Å—Ç–∞—Ö –ø—Ä–æ —Ç–∏–ø–∏–∑–∞—Ü–∏—é –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
    result ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å–æ –≤—Å–µ–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏, —á—Ç–æ–± –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –≥–ª–∞–∑ —Ä–∞–¥–æ–≤–∞–ª—Å—è)))

    –ù—É –∞ —Ç–µ–ø–µ—Ä—å –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏.
    –û–±—â–∞—è –∏–¥–µ—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å—Ç–æ–ª–±—Ü–∞–º (–ø–æ–ª—è–º) –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ –∏–º–µ–Ω–∏, –Ω–æ —É –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤, –∞ –≤–æ—Ç —Å–æ —Å–ø–∏—Å–∫–æ–º –º–æ–∂–Ω–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ –Ω–æ–º–µ—Ä–∞–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ü–æ–µ—Ö–∞–ª–∏:
    a ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤
    b ‚Äì –Ω–∞—à–ª–∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –Ω–∞–º —ç—Ç–æ –Ω—É–∂–Ω–æ, –µ—Å–ª–∏ –Ω—É–º–µ—Ä–∞—Ü–∏—è –∏–¥—ë—Ç —Å –∫–æ–Ω—Ü–∞
    c ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–º–µ—Ä –≤ –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–∞—Ä—É {–∏–∑–º–µ–Ω—è–µ–º–æ–µ_–∏–º—è,–Ω–æ–≤–æ–µ_–∏–º—è}. –õ–æ–≥–∏–∫–∞ —Ç–∞–∫–∞—è: –µ—Å–ª–∏ –Ω–æ–º–µ—Ä –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π ‚Äì –±–µ—Ä–µ–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ (—Ç–∞–º -1 –ø–æ—Å–∫–æ–ª—å–∫—É –Ω—É–º–µ—Ä–∞—Ü–∏—è —Å –Ω—É–ª—è), –∞ –µ—Å–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π ‚Äì –±–µ—Ä–µ–º —Å –∫–æ–Ω—Ü–∞, —Ç.–µ. —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –æ–±—â–µ–µ —á–∏—Å–ª–æ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Ç–µ–º, –Ω–∞ —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –æ—Ç –∫–æ–Ω—Ü–∞ –Ω—É–∂–Ω–æ –æ—Ç—Å—Ç—É–ø–∏—Ç—å
    d ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫, –∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö ‚Äì —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤, —Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á–µ–º —É –Ω–∞—Å —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ ‚Äì –µ—Å–ª–∏ –æ–Ω —Å–ø–∏—Å–æ–∫, —Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –Ω—É–∂–Ω–æ –ø–æ–¥–≤–µ—Ä–≥–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º List.Transform, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è c –∫ –∞—Ä–≥—É–º–µ–Ω—Ç—É list
    e ‚Äì –ø–æ–¥—Å–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —à—Ç–∞—Ç–Ω–æ–π Table.RenameColumns

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë. –ù–µ–º–Ω–æ–∂–∫–æ –ø—Ä–∏—à–ª–æ—Å—å –ø–æ—à–∞–º–∞–Ω–∏—Ç—å –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –≤ —Ü–µ–ª–æ–º, –Ω–∞–¥–µ—é—Å—å, —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ. –Æ–∑–∞–π—Ç–µ –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ!
    ]

[   (x)=>x –∏–ª–∏ –∑–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –æ–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —Å–≤–æ–µ –≤—Ä–µ–º—è –º—ã —Ä–∞–∑–±–∏—Ä–∞–ª–∏ –∫–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å ¬´–ø—É—Å—Ç–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç¬ª - –Ω–∞–º —ç—Ç–æ –±—ã–ª–æ –Ω—É–∂–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∞–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π. –ù–æ —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –±—ã–≤–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –º—ã –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∞ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
    –í–æ—Ç –≤ —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö –Ω–∞—Å –∏ –≤—ã—Ä—É—á–∞–µ—Ç
    (x)=>x
    –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –∞—Ä–≥—É–º–µ–Ω—Ç x –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —ç—Ç–æ—Ç —Å–∞–º—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç (–Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π!).
    –ó–∞—á–µ–º –æ–Ω–æ –Ω–∞–¥–æ? –°–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä –∏ –Ω–∏–∂–µ —Ä–∞–∑–±–µ—Ä—ë–º –ø–æ —à–∞–≥–∞–º:
    let
        tbl = #table({"n","a".."f"},{{"i",1..5,{1,2,3}},{"j",2..6,{1,2}},{"k",3..7,{1}},{"i",4..8,{1,2}},{"j",5..9,{1}}}),
        group = Table.Group(tbl,"n",{"tmp",(x)=>x}),
        add = Table.AddColumn(tbl,"tmp",(x)=>x),
        pivot = Table.Pivot(tbl[[n],[a]], {"i".."k"}, "n", "a",(x)=>x),
        comb = Table.CombineColumns(tbl,List.Skip(Table.ColumnNames(tbl)),(x)=>x,"tmp"),
        splt = Table.SplitColumn(tbl,"f",(x)=>x),
        from = Table.FromList(tbl[f],(x)=>x)
    in
        from

    tbl ‚Äì –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    group ‚Äì –º—ã –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Å—Ç–æ–ª–±—Ü—É n –∏ —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ—ç—Ç–æ–º—É —Ñ—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –Ω–∞–º –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ö –≤—Å–µ. –ó–∞–æ–¥–Ω–æ –º—ã —É–∑–Ω–∞–ª–∏, —á—Ç–æ –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ (table), —Ç.–µ. –µ—Å–ª–∏ –≤—ã –∑–∞—Ä–∞–Ω–µ–µ –Ω–µ –∑–Ω–∞–µ—Ç–µ –æ—Ç –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –ø–∏—Å–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä ‚Äì –Ω–∞–ø–∏—à–∏—Ç–µ (x)=>x –∏ —É–≤–∏–¥–µ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥—ã
    add ‚Äì –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å—ë, —á—Ç–æ –ø–æ—Å—Ç—É–ø–∏–ª–æ –Ω–∞ –≤—Ö–æ–¥ ‚Äì –∏ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –∑–∞–ø–∏—Å—å (record). –¢.–µ. –º—ã –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –Ω–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ —Ü–µ–ª–∏–∫–æ–º –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏
    pivot ‚Äì –Ω–µ –ª—é–±–ª—é —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, –Ω–æ —Å–∫–∞–∑–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ ‚Äì –ø—Ä–∏ —Å–≤–µ–¥–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –Ω–∞—Å —Ç–∞–∫–∂–µ —Ö–æ—Ç—è—Ç —Ñ—É–Ω–∫—Ü–∏—é –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–π –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏—Ö–æ–¥–∏—Ç‚Ä¶ —Å–ø–∏—Å–æ–∫ (list). –ú—ã—à–∫–æ–∫–ª–∞—Ü–µ–º —Ç–∞–∫ –Ω–µ —Å–¥–µ–ª–∞—Ç—å ‚Äì –µ—Å–ª–∏ –≤—ã–±—Ä–∞—Ç—å ¬´–Ω–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å¬ª - —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–∞ –±–µ–∑ –ø—è—Ç–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏ –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É, –∞ —Ç–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.

    –í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –≤—ã—à–µ –±–æ–ª—å—à–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, —Å –∫–∞–∫–∏–º —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö –º—ã —Ä–∞–±–æ—Ç–∞–µ–º, –Ω–æ –µ—Å—Ç—å –≤–ø–æ–ª–Ω–µ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã–µ —Ç–∞–±–ª–∏—á–Ω–æ-—Å–ø–∏—Å–æ—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

    comb ‚Äì —Ö–æ—Ç–∏–º —Å–æ–±—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ä—è–¥–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Å–ø–∏—Å–æ–∫, –æ—Ç –Ω–∞—Å —Ç—Ä–µ–±—É—é—Ç Combiner –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é ‚Äì —Ç–æ–ª—å–∫–æ —É –Ω–∞—Å –Ω–∞ –≤—Ö–æ–¥–µ –∏ —Ç–∞–∫ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –∏ —Ç–µ–ø–µ—Ä—å –º—ã –∑–Ω–∞–µ–º —á—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å
    split ‚Äì —ç—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ - –Ω–∞–º –≤—Ä–æ–¥–µ –∫–∞–∫ –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü, —Ç–æ–ª—å–∫–æ –æ–Ω —É–∂–µ —Ä–∞–∑–¥–µ–ª–µ–Ω, –ø–æ—ç—Ç–æ–º—É –Ω–µ –¥–µ–ª–∞–µ–º –Ω–∏—á–µ–≥–æ
    from ‚Äì –Ω—É –∏ –¥–ª—è –º–µ–Ω—è –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–π —Å–ª—É—á–∞–π ‚Äì —Å–±–æ—Ä —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Å–ø–∏—Å–∫–æ–≤ ‚Äì ¬´–ø–æ—á–µ–º—É –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–µ—Ä–µ–∑ Table.FromRows?¬ª —Å–ø—Ä–æ—Å–∏—Ç–µ –≤—ã ‚Äì ¬´–ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä—è–º –Ω–∞ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ¬ª –æ—Ç–≤–µ—á—É —è ‚Äì FromRows —Ç—Ä–µ–±—É–µ—Ç —Å–ø–∏—Å–∫–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã, –∞ FromList ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—è—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ —Å –Ω–µ–π –º–æ–∂–Ω–æ –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è, –ø—Ä–æ—Å—Ç–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –µ—ë –∞—Ä–≥—É–º–µ–Ω—Ç Splitter –Ω–µ –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å –Ω–∏—á–µ–≥–æ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –í –ú –∫—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å/–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å/–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –§—É–Ω–∫—Ü–∏—è ‚Äì —ç—Ç–æ —Ç–æ–∂–µ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ–≥–æ–¥–Ω—è –º—ã –≤—ã—è—Å–Ω–∏–ª–∏, –∫–∞–∫ –µ—ë –Ω–∞–ø–∏—Å–∞—Ç—å, —á—Ç–æ–±—ã –æ–Ω–∞ –±—ã–ª–∞, –Ω–æ ¬´–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–ª–∞¬ª.
    ]

[   Table.SelectColumns, Table.RemoveColumns, Table.ReorderColumns ‚Äì –∏–ª–∏ –∂–æ–Ω–≥–ª–∏—Ä—É–µ–º —Å—Ç–æ–ª–±—Ü–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.SelectColumns, Table.RemoveColumns, Table.ReorderColumns

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í –ú —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä—è–¥ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç–æ–ª–±—Ü–∞–º–∏, –Ω–æ –ø–∏—Å–∞—Ç—å –ø–æ –∫–∞–∂–¥–æ–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç –∫–∞–∫-—Ç–æ —Å–∫—É—á–Ω–æ, –∞ –≤–æ—Ç –µ—Å–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å ‚Äì –º–æ–∂–µ—Ç –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ.
    –ò—Ç–∞–∫ SelectColumns, RemoveColumns, ReorderColumns ‚Äì –∏–º–µ—é—Ç –¥–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ–¥–∏–Ω –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç:
    table ‚Äì —Ç–∞–±–ª–∏—Ü–∞, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º
    columns/columnsOrder ‚Äì –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ (–≤—ã–±–∏—Ä–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª—è—Ç—å –º–æ–∂–Ω–æ –∏ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü, –∞ –≤–æ—Ç –º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ ‚Äì —Ç–æ–ª—å–∫–æ —É —Å–ø–∏—Å–∫–∞)
    missingfield ‚Äì –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –≥–æ–≤–æ—Ä—è—â–∏–π —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏ ‚Äì –∫–∞–∫ –≤–æ–¥–∏—Ç—Å—è –∏–º–µ–µ—Ç –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ - MissingField.UseNull –∏–ª–∏ MissingField.Ignore

    –°–º–æ—Ç—Ä–∏–º –∫–æ–¥ –∏ –Ω–∏–∂–µ —Ä–∞–∑–±–∏—Ä–∞–µ–º —à–∞–≥–∏:
    let 
        from = #table({"a".."h"},{{1..8}}),
        
        lst1 = Table.ColumnNames(from),
        select1 = Table.SelectColumns(from,lst1),
        remove11 = Table.RemoveColumns(from,lst1), 
        reorder1 = Table.ReorderColumns(from,lst1),

        lst2 = {List.Last(lst1),List.First(lst1)},
        select2 = Table.SelectColumns(from,lst2),
        remove2 = Table.RemoveColumns(from,lst2), 
        reorder2 = Table.ReorderColumns(from,lst2),

        lst3 = List.Reverse(List.Alternate(lst1,1,1,1)),
        select3 = Table.SelectColumns(from,lst3),
        remove3 = Table.RemoveColumns(from,lst3), 
        reorder3 = Table.ReorderColumns(from,lst3),

        lst4 = {"k","j","i"}&List.Skip(lst1),
        select41 = Table.SelectColumns(from,lst4,MissingField.Ignore),
        remove41 = Table.RemoveColumns(from,lst4,MissingField.Ignore), 
        reorder41 = Table.ReorderColumns(from,lst4,MissingField.Ignore),

        select42 = Table.SelectColumns(from,lst4,MissingField.UseNull),
        remove42 = Table.RemoveColumns(from,lst4,MissingField.UseNull), 
        reorder42 = Table.ReorderColumns(from,lst4,MissingField.UseNull)
    in 
        reorder42

    lst1 ‚Äì —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã
    select1 –∏ reorder1 ‚Äì –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–µ–Ω—è–ª–æ—Å—å ‚Äì –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±—Ä–∞–ª–∞ —Å—Ç–æ–ª–±—Ü—ã, –¥—Ä—É–≥–∞—è —Ä–∞—Å–ø–æ–ª–æ–∂–∏–ª–∞ —Å—Ç–æ–ª–±—Ü—ã –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –∏ —à–ª–∏, –∞ remove1 ‚Äì –≤–µ—Ä–Ω—É–ª–∞ –ø—É—Å—Ç—É—é —Ç–∞–±–ª–∏—Ü—É ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –ø—Ä–∏—à–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å. –í—Å—ë –ª–æ–≥–∏—á–Ω–æ, –Ω–æ –∫–∞–∫-—Ç–æ –Ω–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç–æ–ª–±—Ü–æ–≤ –º–æ–∂–Ω–æ –ø–æ–∏–≥—Ä–∞—Ç—å, –∏ –≤–æ—Ç —Ç—É—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ

    lst2 ‚Äì –≤–∑—è–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏ –ø–µ—Ä–≤–æ–µ –∏–º–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
    select2 ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±—Ü—ã
    remove2 ‚Äì —Ç–∞–±–ª–∏—Ü–∞ –±–µ–∑ –ø–µ—Ä–≤–æ–≥–æ –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å—Ç–æ–ª–±—Ü–æ–≤
    reorder2 ‚Äì —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø–µ—Ä–≤—ã–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±—Ü—ã –ø–æ–º–µ–Ω—è–Ω—ã –º–µ—Å—Ç–∞–º–∏. –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì Select –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ—Ç —Ç–µ —Å—Ç–æ–ª–±—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∫–∞–∑–∞–ª–∏, –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º —É–∫–∞–∑–∞–ª–∏, –∞ –≤–æ—Ç Reorder ‚Äì —Å—Ç–æ–ª–±—Ü—ã –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –±–µ—Ä–µ—Ç –≤ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –Ω–æ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞ –º–µ—Å—Ç–∞—Ö

    lst3 ‚Äì –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä ‚Äì List.Alternate –¥–∞—Å—Ç –Ω–∞–º –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–∞ –Ω–µ—á—ë—Ç–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö, –∞ Reverse ‚Äì —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç –∏—Ö –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (–∏–Ω–∞—á–µ –Ω–µ –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ –∑–∞—á–µ–º –Ω–∞–º reorder)
    select3 ‚Äì –≤—Å–µ –Ω–µ—á—ë—Ç–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
    remove3 ‚Äì –≤—Å–µ —á–µ—Ç–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã (–Ω–µ—á–µ—Ç–Ω—ã–µ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã)
    reorder3 ‚Äì —á—ë—Ç–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–∞ –º–µ—Å—Ç–∞—Ö, –Ω–µ—á—ë—Ç–Ω—ã–µ ‚Äì –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ

    lst4 ‚Äì –Ω—É –∏ —Ç–∏–ø–∏—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∏ —Å–±–æ—Ä–µ –∏–∑ –∫—É—á–∏ —Ñ–∞–π–ª–æ–≤ ‚Äì –Ω–∞–¥–æ —Å–æ–±—Ä–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±—Ü—ã, –∞ –Ω–µ –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö –æ–Ω–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚Äì —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –æ—à–∏–±–∫–∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º MissingField
    remove41, remove42 ‚Äì –≤–µ—Ä–Ω—É–ª–∞—Å—å —Ç–∞–±–ª–∏—Ü–∞ —Å–æ —Å—Ç–æ–ª–±—Ü–æ–º –∞ ‚Äì –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã, –ª–∏—à–Ω–∏–µ –±—ã–ª–∏ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã
    select41 ‚Äì —Ç–∞–±–ª–∏—Ü–∞ –±–µ–∑ –ø–µ—Ä–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞, –ª–∏—à–Ω–∏–µ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã
    reorder41 ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–ª–∏—à–Ω–∏–µ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã, –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –±—ã–ª –ø—Ä–æ–ø—É—â–µ–Ω –≤ —Å–ø–∏—Å–∫–µ –∏ –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ)
    select42 ‚Äì —Ç–∞–±–ª–∏—Ü–∞ —Å–æ –≤—Å–µ–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏ –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã null
    reorder42 ‚Äì –∞ –≤–æ—Ç —ç—Ç–æ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ ‚Äì —Å—Ç–æ–ª–±–µ—Ü a –æ—Å—Ç–∞–ª—Å—è –Ω–∞ –º–µ—Å—Ç–µ, –∞ –¥–∞–ª–µ–µ –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞

    –î—É–º–∞—é –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ–±–æ–ª—å—à–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è. –ö–ª—é—á–µ–≤—ã–º —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –∏ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –µ–≥–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è. –õ–æ–≥–∏–∫–∞ —É –Ω–∏—Ö –ø–æ—Ö–æ–∂–∞—è –Ω–æ –Ω–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞—è, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ!
    ]

[   List.PositionOf ‚Äì –∏–ª–∏ –ü–û–ò–°–ö–ü–û–ó –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.PositionOf

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –Ω–∞–π—Ç–∏ –ø–æ–∑–∏—Ü–∏—é –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ, –¥–ª—è —ç—Ç–æ–≥–æ —Ä–∞–∑—É–º–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å List.PositionOf. –ò –Ω–∞ —ç—Ç–æ–º –º–æ–∂–Ω–æ –±—ã –±—ã–ª–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ—Å—Ç, –µ—Å–ª–∏ –±—ã –Ω–µ –æ–¥–Ω–æ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–æ ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —á–µ—Ç—ã—Ä—ë—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –∞ –∑–Ω–∞—á–∏—Ç –Ω–∞—Å –∂–¥—ë—Ç –º–Ω–æ–≥–æ –≤–∫—É—Å–Ω–æ–≥–æ ))) –ü–æ–µ—Ö–∞–ª–∏:
    List.PositionOf(list as list, value as any, optional occurrence as nullable number, optional equationCriteria as any) as any

    –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã:
    list ‚Äì —Å–∞–º —Å–ø–∏—Å–æ–∫
    value ‚Äì –∏—Å–∫–æ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

    –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã:
    occurrence ‚Äì ¬´–≤—Ö–æ–∂–¥–µ–Ω–∏–µ¬ª - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã Occurrence.First, Occurrence.Last, Occurrence.All ‚Äì —Ç.–µ. –ø–µ—Ä–≤–æ–µ, –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–ª–∏ –≤—Å–µ
    equationCriteria ‚Äì –∫—Ä–∏—Ç–µ—Ä–∏–π —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ‚Äì —Å—é–¥–∞ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å Comparer –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (current,value)=> - –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ ‚Äì —Å–Ω–∞—á–∞–ª–∞ current ‚Äì –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞, –∑–∞—Ç–µ–º value ‚Äì –Ω–∞—à–µ –∏—Å–∫–æ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

    –ù—É –∏ –ø—Ä–∏–º–µ—Ä, –Ω–∏–∂–µ —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ —à–∞–≥–∞–º:
    let
        a = List.PositionOf({1..10},5), //4
        b = List.PositionOf({"a".."z"},"d"), //3 
        c = List.PositionOf({1..10},11), //-1 - –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
        d = List.PositionOf({1,2,null,3,4,null,5},null), //2
        e = List.PositionOf({1,2,null,3,4,null,5},null,Occurrence.First),//2
        f = List.PositionOf({1,2,null,3,4,null,5},null,Occurrence.Last), //5
        g = List.PositionOf({1,2,null,3,4,null,5},null,Occurrence.All), //{2,5}
        h = List.PositionOf({1,2,null,3,4,null,5},null,Occurrence.First,(c,v)=>c<>v),//0
        i = List.PositionOf({1,2,null,3,4,null,5},null,Occurrence.Last,(c,v)=>c<>v),//6
        j = List.PositionOf({1,2,null,3,4,null,5},null,Occurrence.All,(c,v)=>c<>v),//{0,1,3,4,6}
        k = List.PositionOf({1..5},3,Occurrence.All,(c,v)=>c<v), //{0,1}
        l = List.PositionOf({1..5},3,Occurrence.All,(c,v)=>c>v), //{3,4}
        m = List.PositionOf({1,2,null,3,4,null,5},3,Occurrence.All,(c,v)=>if c is null then false else c>v),//{4,6}
        n = List.PositionOf({"a".."z"},"D",Occurrence.All,Comparer.OrdinalIgnoreCase) //3
    in
        n

    –®–∞–≥–∏ a -d ‚Äì –ø—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –¥–≤—É–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
    a ‚Äì –∏—â–µ–º –∏ –Ω–∞—Ö–æ–¥–∏–º —á–∏—Å–ª–æ –≤ —Å–ø–∏—Å–∫–µ, –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω—É–º–µ—Ä–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–¥—ë—Ç —Å –Ω—É–ª—è
    b ‚Äì —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –¥–ª—è —Ç–µ–∫—Å—Ç–∞
    c ‚Äì –∑–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤–µ—Ä–Ω—ë—Ç—Å—è –Ω–µ –æ—à–∏–±–∫–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ -1
    d ‚Äì –∏—Å–∫–∞—Ç—å –º–æ–∂–Ω–æ –∏ null

    –®–∞–≥–∏ e ‚Äì g ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º Occurrence
    e ‚Äì —Å—Ä–∞–≤–Ω–∏—Ç–µ —Å —à–∞–≥–æ–º d ‚Äì –ø–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Occurrence.First ‚Äì —Ç.–µ. –∏—â–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ
    f ‚Äì Occurrence.Last –¥–∞—Å—Ç –Ω–∞–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ
    g ‚Äì Occurrence.All –≤–µ—Ä–Ω—ë—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤—Ö–æ–∂–¥–µ–Ω–∏–π –∑–Ω–∞—á–µ–Ω–∏—è

    –®–∞–≥–∏ h ‚Äì n ‚Äì –ø–æ–¥–∫–ª—é—á–∞–µ–º —Ç—è–∂—ë–ª—É—é –∞—Ä—Ç–∏–ª–ª–µ—Ä–∏—é ‚Äì —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç)))
    –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –º—ã –Ω–µ –∑–Ω–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –ø—Ä–æ—Å—Ç–æ –∏—â–µ–º –ø–µ—Ä–≤—ã–π/–ø–æ—Å–ª–µ–¥–Ω–∏–π –Ω–µ–ø—É—Å—Ç–æ–π —ç–ª–µ–º–µ–Ω—Ç? –°–º–æ—Ç—Ä–∏–º —à–∞–≥–∏ h ‚Äì j ‚Äì –≤ —Å–ø–∏—Å–∫–µ –∏—â–µ–º null, –Ω–æ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π (c,v)=>c<>v ‚Äì —Ç.–µ. –Ω–µ —Ä–∞–≤–Ω–æ null
    k,l - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –º–µ–Ω—å—à–∏–µ –∏–ª–∏ –±–æ–ª—å—à–∏–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ
    m ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ–π ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤ —Å–ø–∏—Å–∫–µ –µ—Å—Ç—å null –∏ –∏—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å —á–∏—Å–ª–æ–º, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –ª—é–±–æ–≥–æ null –≤–æ–∑–≤—Ä–∞—â–∞–µ–º false, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –∏—Å–∫–æ–º—ã–º
    n ‚Äì –Ω—É –∏ –≤–∞—Ä–∏–∞–Ω—Ç —Å —Ç–µ–∫—Å—Ç–∞–º–∏ ‚Äì –≤ —á–µ—Ç–≤–µ—Ä—Ç–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å —É—Å–ª–æ–≤–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –æ—á–µ—Ä–µ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤—Å—è –º–æ—â—å –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ!
    ]

[   List.PositionOfAny –∏–ª–∏ –∫–æ–≥–¥–∞ –∏—Å–∫–æ–º–æ–µ - —Å–ø–∏—Å–æ–∫ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.PositionOfAny

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –¢–æ–ª—å–∫–æ —á—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏ List.PositionOf –∏ –∏–∑–ª–æ–∂–µ–Ω–∏–µ –±—ã–ª–æ –±—ã –Ω–µ–ø–æ–ª–Ω—ã–º, –µ—Å–ª–∏ –Ω–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –µ—â—ë –∏ List.PositionOfAny.
    –°–º–æ—Ç—Ä–∏–º —Å–ø—Ä–∞–≤–∫—É:
    List.PositionOfAny(list as list, values as list, optional occurrence as nullable number, optional equationCriteria as any) as any

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, —Ç–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Å–ø–∏—Å–æ–∫. –¢.–µ. –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏—Å–∫–æ–º–æ–µ value, –∞ —Å–ø–∏—Å–æ–∫ values ‚Äì –∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ö–æ—Ç—è –±—ã —Å –æ–¥–Ω–∏–º –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥–∞—Å—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

    –°–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä –∏ —Ä–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —à–∞–≥–∞–º:
    let
        a = List.PositionOfAny({1..10},{1,3,5}),//0
        b = List.PositionOfAny({1..10},{1,3,5},Occurrence.All),//{0,2,4}
        c = List.PositionOfAny({1..10},{11,13,15}),//-1
        d = List.PositionOfAny({1..10},{11,13,15},Occurrence.All),//{}
        e = List.PositionOfAny({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},{"–º–∞","—Ä–∞"},Occurrence.All,Text.Contains),//{0,2}
        f = List.PositionOfAny({"–º–∞–º–∞","–º—ã–ª–∞","—Ä–∞–º—É"},{"–ú–ê","–†–ê"},Occurrence.All,(c,v)=>Text.Contains(c,v,Comparer.OrdinalIgnoreCase)),//{0,2}
        g = List.PositionOfAny({"—ã–ª","–∏–ª"},{"–º–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É","–ø–∞–ø–∞ –ø–∏–ª –ø–∏–≤–æ"},Occurrence.All,Text.Contains),//{}
        h = List.PositionOfAny({"—ã–ª","–∏–ª"},{"–º–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É","–ø–∞–ø–∞ –ø–∏–ª –ø–∏–≤–æ"},Occurrence.All,(c,v)=>Text.Contains(v,c))//{0,1}
    in
        h

    a ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—É–ª–∞ 0 ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–æ–º–æ–≥–æ, –∞ –º—ã –ø–æ–º–Ω–∏–º –ø—Ä–æ –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å –Ω—É–ª—è –∏ —á—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è Occurrence.First
    b ‚Äì –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ —Å Occurrence.All –≤–µ—Ä–Ω—ë—Ç –Ω–∞–º —Å–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü–∏–π
    c,d ‚Äì –∞ –≤–æ—Ç –æ–± —ç—Ç–æ–º –Ω–µ —Å–∫–∞–∑–∞–ª –≤ –ø—Ä–æ—à–ª–æ–º –ø–æ—Å—Ç–µ ‚Äì –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è -1, –ù–û –≤ —Å–ª—É—á–∞–µ —Å Occurrence.All ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è {} ‚Äì –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ ‚Äì —É—á–∏—Ç—ã–≤–∞–π—Ç–µ —ç—Ç–æ –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞

    –ù—É –∏ —á–∞—Å—Ç–æ –ø–æ–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫ —Å–≤—è–∑–∞–Ω —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫
    e ‚Äì –∫–∞–∫ –≤–∏–¥–∏—Ç–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ equationCriteria –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Text.Contains ‚Äì —ç—Ç–∞ –∑–∞–ø–∏—Å—å —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞ (c,v)=>Text.Contains(c,v) ‚Äì —Ç.–µ. –ø—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ —Å–ø–∏—Å–∫–∞
    f ‚Äì –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –º—ã –Ω–µ –ø–∏—Å–∞–ª–∏ –ø–æ–ª–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –Ω–æ –∑–¥–µ—Å—å –æ–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞
    g ‚Äì –∞ –≤–æ—Ç —Ç–∞–∫–∞—è –æ—à–∏–±–∫–∞ –≤—Å—Ç—Ä–µ—á–∞–ª–∞—Å—å –≤ —á–∞—Ç–µ ‚Äì –∫–∞–∫ –º—ã –≤–∏–¥–∏–º –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–∏ –æ–¥–∏–Ω –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ç–æ—Ä–æ–≥–æ ‚Äì –Ω—É –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –æ–Ω–∏ –¥–ª–∏–Ω–Ω–µ–µ; –∏ –ø–æ–∏—Å–∫ –Ω—É–∂–µ–Ω –Ω–∞–æ–±–æ—Ä–æ—Ç ‚Äì –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ —Ç–µ–∫—Å—Ç–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ç–æ—Ä–æ–≥–æ, —á—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å?
    h ‚Äì –¥–∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ Text.Contains –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –í—É–∞–ª—è, –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞!

    –í–æ—Ç —Ç–µ–ø–µ—Ä—å —Ç–æ—á–Ω–æ –≤—Å—ë ‚Äì –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –ª–æ–≥–∏–∫—É –ø–æ—Å—Ç–∞—Ä–∞–ª—Å—è –¥–æ–Ω–µ—Å—Ç–∏.
    ]

[   Folder.Files ‚Äì —Å–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–ø–∫–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Folder.Files

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑–±–µ—Ä–µ–º —Ç–∏–ø–æ–≤—É—é –∑–∞–¥–∞—á—É –ø–æ —Å–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –Ω–∞ –≤—ã–±–æ—Ä Folder.Files –∏ Folder.Contents ‚Äì —Å –ø–µ—Ä–≤–æ–π –≤—Å—ë –Ω–µ–º–Ω–æ–∂–∫–æ –ø—Ä–æ—â–µ, –ø–æ—ç—Ç–æ–º—É –Ω–∞—á–Ω—ë–º —Å –Ω–µ—ë, –≤—Ç–æ—Ä—É—é –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É—é –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–æ—Å—Ç–æ–º.
    –Ø –Ω–µ –±—É–¥—É —Å–µ–π—á–∞—Å —É—Å–ª–æ–∂–Ω—è—Ç—å –∂–∏–∑–Ω—å –∑–∞–ø—Ä–æ—Å–æ–º –∫ —Ñ–∞–π–ª—É, —Ñ—É–Ω–∫—Ü–∏–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Ç.–¥. –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–µ–º —Ç–∏–ø–∏—á–Ω—ã–π –æ–±—Ä–∞–∑—á–∏–∫ –∫–æ–¥–∞ –∏ —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ —à–∞–≥–∞–º:
    let
        from = Folder.Files("C:\Users\buchlotnik\Desktop\tst"),
        filtr = Table.SelectRows(from, each [Extension] = ".xlsx" and [Attributes][Hidden] = false),
        tbl = Table.SelectColumns(filtr,{"Name","Folder Path","Content"}),
        func=(x)=>Excel.Workbook(x){0}[Data],
        tr = Table.TransformColumns(tbl,{"Content",func}),
        to = Table.ExpandTableColumn(tr, "Content", {"Column1", "Column3"})
    in
        to

    from ‚Äì –∑–¥–µ—Å—å –≤—Å—ë –ø—Ä–æ—Å—Ç–æ –∏ –±–µ–∑ –∏–∑—ã—Å–∫–æ–≤ ‚Äì –≤—ã–∑—ã–≤–∞–µ–º Folder.Files —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º ‚Äì –ø—É—Ç—ë–º –∫ –ø–∞–ø–∫–µ, –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (–≤ –æ–±—â–µ–º –≤–∏–¥–µ –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤—ã–Ω–æ—Å–∏—Ç—å –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –Ω–µ –±—ã–ª–æ –±–æ–ª—å–Ω–æ –ø—Ä–∏ —Ä–µ–ª–æ–∫–∞—Ü–∏–∏ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤). –ù–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏:
    Contents ‚Äì –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞,
    Name ‚Äì –∏–º—è —Ñ–∞–π–ª–∞,
    Extension ‚Äì —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞,
    Date Accessed, Date Modified, Date Created ‚Äì –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–æ–∑–¥–∞–Ω–∏—è,
    Attributes ‚Äì –∞—Ç—Ä–∏–±—É—Ç—ã —Ñ–∞–π–ª–∞ –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Ç–∞–∫–∏–µ –∫–∞–∫ Hidden, System, Content Type ,
    Folder Path ‚Äì –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é —Ñ–∞–π–ª–∞

    filtr ‚Äì —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–º –Ω–∞—Å –∞—Ç—Ä–∏–±—É—Ç–∞–º. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã Excel (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ xlsx), –ø—Ä–∏—á—ë–º –Ω–µ —Å–∫—Ä—ã—Ç—ã–µ ‚Äì —ç—Ç–æ –Ω—É–∂–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–æ—Å—Ç—å, —á—Ç–æ –∫—Ç–æ-—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–∞–ø–∫–æ–π –≤ –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ ‚Äì –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∫–Ω–∏–≥ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –æ–Ω–∏ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ –≤—ã–±–æ—Ä–∫—É, —Ä–æ–Ω—è—è –∑–∞–ø—Ä–æ—Å ))). –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤—ã –º–æ–∂–µ—Ç–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –ª—é–±–æ–º—É –≤–∞–∂–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, –¥–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ç.–¥.

    tbl ‚Äì –æ—Ç–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–∞–±–æ—Ç—ã ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –∏–º—è, –ø—É—Ç—å (—á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –∏–∑ –ø—É—Ç–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∞–ø–∫–∏) –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ ¬´–Ω–∞—á–∏–Ω–∫–∞¬ª —Ñ–∞–π–ª–æ–≤ ‚Äì –∑–Ω–∞—á–∏—Ç –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ Contents

    func ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ Excel.Workbook ‚Äì –µ–µ –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç –∏ —Ç—É—Ç, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Å—Ç–∞ (—Ç–∏–ø–∏—á–Ω–æ –¥–ª—è –≤—ã–≥—Ä—É–∑–æ–∫ –∏–∑ 1–° ‚Äì –≤—ã–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω –ª–∏—Å—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–º—ë–Ω –∏ —Ç.–ø.). –ù–æ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –¥–ª—è –≤–∞—à–µ–≥–æ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ - Csv.Document, Xml.Document, Json.Document –∏ —Ç.–¥.

    tr ‚Äì –Ω—É –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π func —Å—Ç–æ–ª–±–µ—Ü Contents ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤–µ—Ä–Ω—ë—Ç –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã, –¥–∞ –∏ –≤–æ–æ–±—â–µ –æ–±—ã—á–Ω–æ –∑–¥–µ—Å—å –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É, —Ö–æ—Ç—è –æ—Ç –∑–∞–¥–∞—á–∏ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø–∏—Å—å, —Å–ø–∏—Å–æ–∫, —Ç–µ–∫—Å—Ç –∏ —Ç.–¥. –ö–ª—é—á–µ–≤–æ–µ - –º—ã –Ω–µ —Ç—è–Ω—É–ª–∏ —Ñ–∞–π–ª—ã –∑–∞–Ω–æ–≤–æ –ø–æ [Folder Path]&[Name] - –Ω–µ –∑–Ω–∞—é –∫—Ç–æ –ø—Ä–∏–¥—É–º–∞–ª —ç—Ç—É –¥–∏—á—å - –º—ã —Å—Ä–∞–∑—É –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü Contents

    to ‚Äì –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –≤—Å—ë –≤ –±–æ–∂–µ—Å–∫–∏–π –≤–∏–¥. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å–¥–µ–ª–∞–Ω–æ —á–µ—Ä–µ–∑ Table.ExpandTableColumn, —á—Ç–æ–±—ã –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –ª–∏—Å—Ç–æ–≤, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–∑–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞; –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ Table.Combine(tr[Contents]) ‚Äì –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã, –Ω—É –∏–ª–∏ –µ—Å–ª–∏ –≤–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è func –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–∞–ø–∏—Å—å –∏–ª–∏ —Å–ø–∏—Å–æ–∫ ‚Äì ExpandRecordColumn, ExpandListColumn –∏ —Ç.–¥. ‚Äì –≤–∞—Ä–∏–∞–Ω—Ç—ã –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ.

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë ‚Äì –∏–∑–ª–æ–∂–∏–ª –æ–±—â–∏–π –ø–æ–¥—Ö–æ–¥, –µ–≥–æ –º–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å, —É–≥–ª—É–±–ª—è—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø–æ –≤–∫—É—Å—É (–Ω–æ –ª—É—á—à–µ –ø–æ–¥ –∑–∞–¥–∞—á—É).
    ]

[   Table.ToList - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–º–µ–Ω—ã, —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö –∏–ª–∏ –∫–∞–∫ –≤—Å—ë-—Ç–∞–∫–∏ –±—ã—Å—Ç—Ä–µ–µ? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.ToList

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç–µ –≤—Å–ø–ª—ã–ª–∞ –∑–∞–¥–∞—á–∫–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é –∑–∞–º–µ–Ω—É –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Ç–µ–∫—Å—Ç–∞.
    –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ ‚Äì –µ—Å—Ç—å —Ç–µ–∫—Å—Ç —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –µ—â—ë –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü, —Å —Ç–∞–∫–∏–º –∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º, –Ω–æ —Å –∑–∞–º–µ–Ω–æ–π –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –¥—Ä—É–≥–∏–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π. –û–ö.
    
    –õ–æ–≥–∏–∫–∞ —Ä–µ—à–µ–Ω–∏—è (–≤ –º–æ–µ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏) ‚Äì —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é, –≤ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–∞–º–µ–Ω—ã, —Å–æ–±—Ä–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–µ–∫—Å—Ç —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ —Ä–µ—à–∏–ª —á–µ—Ä–µ–∑ List.ReplaceMatchingItems (—Ö–æ—Ä–æ—à–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –º—ã –µ–µ –µ—â—ë —Ä–∞–∑–±–µ—Ä—ë–º), –Ω–æ —Å–ª–æ–≤–∞—Ä—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö –æ–∫–∞–∑–∞–ª—Å—è –±—ã—Å—Ç—Ä–µ–µ. –ù–∞ —ç—Ç–æ–º –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å, –ù–û‚Ä¶
    
    –í –Ω–∞–∑–≤–∞–Ω–∏–∏ –∑–∞—è–≤–ª–µ–Ω–∞ Table.ToList ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–∏–º–µ–Ω–∏–≤ –∫ —Å–ø–∏—Å–∫—É –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –ê –º—ã —É–∂–µ –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ Table.FromList —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º Table.FromRows. 
    –í–æ—Ç –∏ –≤–æ–∑–Ω–∏–∫–ª–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –∏ Table.ToList –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ Table.ToRows.
   
    –ü–æ—ç—Ç–æ–º—É —Ä–∞–∑–±–∏—Ä–∞–µ–º –ø—Ä–∏–º–µ—Ä:
    
        let
            tbl1 =  #table({"ID","txt"},{{"1","A,B"},{"2","B,C,D"},{"3","C,D,E,F"}}),
            tbl2 =  #table({"cat","txt"},{{"A","aa"},{"B","bb"},{"C","cc"},{"D","dd"},{"E","ee"},{"F","ff"}}),
            dict =  Record.FromTable(
                        Table.RenameColumns(tbl2,{{"cat","Name"},{"txt","Value"}})
                    ),
            
            f=(x as list)=>x&{g(x{1})},
            g=(x)=> Text.Combine(
                        List.Transform(
                            Text.Split(x,","),
                            (y)=>Record.Field(dict,y)
                        ),
                        ","
                    ),
            
            to  = Table.FromList(Table.ToRows(tbl1),f,{"ID","txt","new"}),
            to1 = Table.FromRows(Table.ToList(tbl1,f),{"ID","txt","new"}),
            to2 = Table.FromList(Table.ToList(tbl1,(x)=>x),f,{"ID","txt","new"}),
            to3 = Table.FromList(Table.ToList(tbl1,f),(x)=>x,{"ID","txt","new"})
        in
            to3

    tbl1, tbl2 ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏ —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
    dict ‚Äì –¥–µ–ª–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ (–æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤, –∏–Ω–∞—á–µ Record.FromTable –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
    f    ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –Ω–∞ –≤—Ö–æ–¥ —Å–ø–∏—Å–æ–∫ (–∑–Ω–∞—á–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —Å—Ç—Ä–æ–∫–∏) –∏ –¥–æ–±–∞–≤–ª—è—é—â–∞—è –∫ –Ω–µ–º—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–µ–π g
    g    ‚Äì –ª–æ–≥–∏–∫–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —É–∂–µ –æ–ø–∏—Å–∞–Ω–∞ –≤—ã—à–µ ‚Äì —Ä–∞–∑–¥–µ–ª–∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ –∑–∞–ø—è—Ç–æ–π, —Å–¥–µ–ª–∞–ª–∏ –∑–∞–º–µ–Ω—É –ø–æ —Å–ø–∏—Å–∫—É, —Å–æ–±—Ä–∞–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é

    –ê —Ç–µ–ø–µ—Ä—å –Ω–∞—á–∏–Ω–∞–µ–º —Å–æ–±–∏—Ä–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É (—Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –≤ 100k —Å—Ç—Ä–æ–∫):
    to  ‚Äì –¥–µ–ª–∏–º —Ç–∞–±–ª–∏—Ü—É —á–µ—Ä–µ–∑ ToRows, —Å–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ FromList —Å —Ñ—É–Ω–∫—Ü–∏–µ–π f ‚Äì —ç—Ç–æ –º–æ–π –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ 1,185 —Å–µ–∫—É–Ω–¥—ã
    to1 ‚Äì –¥–µ–ª–∏–º —á–µ—Ä–µ–∑ ToList —Å —Ñ—É–Ω–∫—Ü–∏–µ–π f, –∞ —Å–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ FromRows ‚Äì –æ—Ç—Ä–∞–±–æ—Ç–∞–ª–æ –∑–∞ 1,563 —Å–µ–∫—É–Ω–¥—ã ‚Äì —á—É–¥–∞ –Ω–µ —Å–ª—É—á–∏–ª–æ—Å—å, FromRows ‚Äì –º–µ–¥–ª–µ–Ω–Ω–∞—è
    to2 ‚Äì –¥–µ–ª–∏–º —á–µ—Ä–µ–∑ ToList —Å —Ñ—É–Ω–∫—Ü–∏–µ–π (x)=>x (–æ–±—Å—É–∂–¥–∞–ª–∞—Å—å —Ç—É—Ç), –∞ —Å–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ FromList —Å —Ñ—É–Ω–∫—Ü–∏–µ–π f ‚Äì 1,184 —Å–µ–∫—É–Ω–¥—ã ‚Äì —á—É—É—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞
    to3 ‚Äì "—Ñ–∏–Ω—Ç —É—à–∞–º–∏" ‚Äì —Ä–∞–∑–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ ToList —Å —Ñ—É–Ω–∫—Ü–∏–µ–π f, –∞ —Å–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ FromList —Å (x)=>x ‚Äì –∏ –ø–æ–ª—É—á–∞–µ–º‚Ä¶ 1,169 —Å–µ–∫—É–Ω–¥—ã - –ø—Ä–∏—Ä–æ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–µ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π, –Ω–æ –ø—Ä–∏—è—Ç–Ω—ã–π.
    
    –ü—Ä–æ–≤–µ—Ä–∏–ª –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö –Ω–∞ –≤—ã–±–æ—Ä–∫–∞—Ö —Ä–∞–∑–Ω–æ–≥–æ –æ–±—ä—ë–º–∞ —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º. 
    –í—ã–≤–æ–¥ ‚Äì —Ä–∞–∑–±–∏—Ä–∞—Ç—å –∏ —Å–æ–±–∏—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ —á–µ—Ä–µ–∑ Table.ToList –∏ Table.FromList, —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —ç—Ç–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –ø–æ–¥—Å–æ–≤—ã–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–∫–µ. –ö–∞–∫-—Ç–æ —Ç–∞–∫.
    ]

[   List.ReplaceMatchingItems vs Record.Field –∏–ª–∏ –∫–∞–∫–æ–π —Ç—Ä–∞–Ω—Å–ª–∏—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.ReplaceMatchingItems, Record.Field

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–∫–∞ –æ–±—Å—É–∂–¥–∞–ª–∏ —Å–±–æ—Ä–∫—É-—Ä–∞–∑–±–æ—Ä–∫—É —Ç–∞–±–ª–∏—Ü –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –ø—Ä–∏ –º–∞–ª–æ–º —á–∏—Å–ª–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∑–∞–º–µ–Ω—ã (–¥–æ 7 -8) List.ReplaceMatchingItems –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º Record.Field. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —É—Ö–∏—â—Ä–µ–Ω–∏—è ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Text.Upper/Text.Lower –∏–ª–∏ Comparer.OrdinalIgnoreCase ‚Äì —á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∞ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–ø–∏—Å–Ω—ã–µ –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã.

    –í –ø—Ä–∏–º–µ—Ä–µ —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏–∑ —Ä—É—Å—Å–∫–æ–≥–æ –≤ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, –ø—Ä–∏—á—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–≤–µ–¥–µ–Ω –ø—Ä–æ–ø–∏—Å–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ (–≤—Å–µ 33 –±—É–∫–≤—ã –≤ –ø—Ä–∏–º–µ—Ä –Ω–µ –ø–∏—Å–∞–ª ‚Äì –æ—Å—Ç–∞–≤–∏–ª –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏, –Ω–æ –ø—Ä–∏–Ω—Ü–∏–ø, –Ω–∞–¥–µ—é—Å—å –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–µ–Ω):
    let
        from = #table({"txt"},{{"–∞–±–≤"},{"–∞–ë–≤"},{"–ê–ë–í"}}),
        fulllist={{"–ê","A"},{"–∞","A"},{"–ë","B"},{"–±","B"},{"–í","V"},{"–≤","V"}},
        partlist={{"–ê","A"},{"–ë","B"},{"–í","V"}},
        fullrec=[–ê="A",–∞="A",–ë="B",–±="B",–í="V",–≤="V"],
        partrec=[–ê="A",–ë="B",–í="V"],
        to1=Table.TransformColumns(from,{"txt",(x)=>Text.Combine(List.ReplaceMatchingItems(Text.ToList(x),fulllist))}),
        to2=Table.TransformColumns(from,{"txt",(x)=>Text.Combine(List.ReplaceMatchingItems(Text.ToList(x),partlist,Comparer.OrdinalIgnoreCase))}),
        to3=Table.TransformColumns(from,{"txt",(x)=>Text.Combine(List.ReplaceMatchingItems(Text.ToList(Text.Upper(x)),partlist))}),
        to4=Table.TransformColumns(from,{"txt",(x)=>Text.Combine(List.Transform(Text.ToList(x),(y)=>Record.Field(fullrec,y)))}),
        to5=Table.TransformColumns(from,{"txt",(x)=>Text.Combine(List.Transform(Text.ToList(x),(y)=>Record.Field(partrec,Text.Upper(y))))}),
        to6=Table.TransformColumns(from,{"txt",(x)=>Text.Combine(List.Transform(Text.ToList(Text.Upper(x)),(y)=>Record.Field(partrec,y)))})
    in
        to6
    –ò—Ç–∞–∫, –ø–æ —à–∞–≥–∞–º
    from ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∏—Ä—É–µ–º —Å—Ç–æ–ª–±–µ—Ü txt
    fulllist ‚Äì —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è, —Ç.–µ. –æ–ø–∏—Å–∞–Ω—ã –∑–∞–º–µ–Ω—ã –¥–ª—è –±—É–∫–≤ –∫–∞–∫ –≤ –Ω–∏–∂–Ω–µ–º, —Ç–∞–∫ –∏ –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
    partlist ‚Äì —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
    fullrec ‚Äì —Å–ª–æ–≤–∞—Ä—å-–∑–∞–ø–∏—Å—å, —Å –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ—á–Ω–µ–º –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    partrec ‚Äì —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å-–∑–∞–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–µ—Ä—Ö–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
    to1 ‚Äì —Ä–µ—à–µ–Ω–∏–µ ¬´–≤ –ª–æ–±¬ª - —Ä–∞–∑–æ–±—Ä–∞–ª–∏ —Ç–µ–∫—Å—Ç –Ω–∞ —Å–∏–º–≤–æ–ª—ã, —Å–¥–µ–ª–∞–ª–∏ –∑–∞–º–µ–Ω—É –ø–æ —Å–ø–∏—Å–∫—É, —Å–æ–±—Ä–∞–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–µ–∫—Å—Ç
    to2 ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫, –ø–æ—ç—Ç–æ–º—É –¥–æ–±–∞–≤–∏–ª–∏ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç - Comparer.OrdinalIgnoreCase
    to3 ‚Äì –∞ –∑–¥–µ—Å—å —Ç–µ–∫—Å—Ç –Ω–∞ –≤—Ö–æ–¥–µ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–≤–µ–ª–∏ –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
    to4 ‚Äì —Ä–µ—à–µ–Ω–∏–µ ¬´–≤ –ª–æ–±¬ª —Å –ø–æ–ª–Ω—ã–º —Å–ª–æ–≤–∞—Ä—ë–º, –Ω–æ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö
    to5 ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å, –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø–æ–ª—è –∑–∞–ø–∏—Å–∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º —Å–∏–º–≤–æ–ª –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
    to6 ‚Äì —Ç–∞–∫–∂–µ —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å, –Ω–æ —Ç–µ–∫—Å—Ç —É–∂–µ –Ω–∞ –≤—Ö–æ–¥–µ –ø–µ—Ä–µ–≤–µ–ª–∏ –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä

    –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ –≤ 160k —Å—Ç—Ä–æ–∫, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ (fulllist –∏ fullrec ‚Äì –ø–æ 66 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, partlist –∏ partrec ‚Äì –ø–æ 33).

    –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É –≤—ã—Ä–∞–∂–∞—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ª–∏–¥–µ—Ä–∞:
    to1 –∏ to2 ‚Äì 155%,—Ç.–µ. —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è –≤–¥–≤–æ–µ, –Ω–æ —Å Comparer.OrdinalIgnoreCase, –≤—ã–∏–≥—Ä—ã—à–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ –¥–∞–ª–æ, –∏ –≤ —Ü–µ–ª–æ–º —Å –¥–ª–∏–Ω–Ω—ã–º —Å–ø–∏—Å–∫–æ–º List.ReplaceMatchingItems –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    to5 ‚Äì 131% - —Å–ª–æ–≤–∞—Ä—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö, –Ω–æ –≤–≤–µ–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω–æ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É
    to3 ‚Äì 123% - —Å–ø–∏—Å–æ–∫ –º—ã —Å–æ–∫—Ä–∞—Ç–∏–ª–∏ –≤–¥–≤–æ–µ, —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ —Å—Ä–∞–∑—É –∫–æ –≤—Å–µ–º—É —Ç–µ–∫—Å—Ç—É - –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ü—É—Ö, —ç—Ç–æ –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–≤–æ–π –≤–æ–ø—Ä–æ—Å)
    to6 ‚Äì 105% - —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≤–µ–ª–∏ –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –∑–∞ –æ–¥–∏–Ω –∑–∞—Ö–æ–¥, –∑–∞–ø–∏—Å—å —Å–æ–∫—Ä–∞—Ç–∏–ª–∏ –≤–¥–≤–æ–µ ‚Äì –Ω–æ —ç—Ç–æ–≥–æ –æ–∫–∞–∑–∞–ª–æ—Å—å –Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–±–µ–¥—ã, –Ω–µ–º–Ω–æ–∂–∫–æ, –Ω–æ –Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
    to4 - 100% - –∫–∞–∫ –≤—ã —É–∂–µ –¥–æ–≥–∞–¥–∞–ª–∏—Å—å ‚Äì —Ä–µ—à–µ–Ω–∏–µ ¬´–≤ –ª–æ–±¬ª –Ω–∞ –∑–∞–ø–∏—Å—è—Ö –æ–∫–∞–∑–∞–ª–æ—Å—å —Å–∞–º—ã–º —à—É—Å—Ç—Ä—ã–º.

    –ö–æ–Ω–µ—á–Ω–æ, –µ—â—ë –º–æ–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ —Ä—è–¥ –≤—ã–≤–æ–¥–æ–≤ –Ω–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è —Å–∞–º —Å–æ–±–æ–π:
    - —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—é –¥–µ–ª–∞—Ç—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö. (—Ç–æ—á–∫–∞)
    - –µ—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä –≤–∞–∂–µ–Ω ‚Äì —Å—Ç–∞—Ä–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Text.Upper/Text.Lower –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫–æ –≤—Å–µ–º—É —Ç–µ–∫—Å—Ç—É —Å—Ä–∞–∑—É
    - —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö, –ø—Ä–µ–≤—ã—à–∞—é—â–∏–µ 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ç–∞–∫–∂–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º ‚Äì —Ç—É—Ç –∑–∞–ø–∏—Å–∏ –≤–Ω–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
    ]

[   & = Combine –∏–ª–∏ –ø–æ—á–µ–º—É –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∏–Ω–æ–≥–¥–∞ —Å–ª–∏—è–Ω–∏–µ‚Ä¶ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - .Combine

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑–±–µ—Ä–µ–º, –∫–∞–∫ –º–Ω–µ –∫–∞–∑–∞–ª–æ—Å—å, –ø—Ä–æ—Å—Ç—É—é —Ç–µ–º—É, –∞ –∏–º–µ–Ω–Ω–æ ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ & (combination operator) ‚Äì –¥–∞-–¥–∞, —è –Ω–µ –æ—à–∏–±—Å—è - –∑–Ω–∞–∫ –∞–º–ø–µ—Ä—Å–∞–Ω–¥ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –∏–º–µ–Ω–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏ –æ–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ-—Ä–∞–∑–Ω–æ–º—É.
    –ù–∞—á–Ω—ë–º —Å —Ç–µ–∫—Å—Ç–∞:
    –ê–ø–µ—Ä—Å–∞–Ω–¥ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–≤–∞ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–¥–Ω–æ –∏ –≤—Å–µ –∑–Ω–∞—é—Ç, —á—Ç–æ —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è (—Å—Ü–µ–ø–∫–∞, —Å–∫–ª–µ–∏–≤–∞–Ω–∏–µ)
    "a"&"b"//"ab"
    –û–ø–µ—Ä–∞–Ω–¥–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å —Ç–µ–º –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
    "a"&"b"&"c"//"abc"
    –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ª—É—á—à–µ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏
    Text.Combine({"a".."f"})//"abcdef"
    –û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è Combine –∏ –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —Ö–æ—á–µ—Ç –æ—Ç –Ω–∞—Å —Å–ø–∏—Å–æ–∫ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π ‚Äì –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –ø—Ä–æ —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏.
    –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å—Ç—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç
    Text.Combine({"a".."c"},",")//"a,b,c"
    –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Å—å–º–∞ –∫—Å—Ç–∞—Ç–∏, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ

    –°–æ —Å–ø–∏—Å–∫–∞–º–∏ –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ ‚Äì –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ, —Ç.–µ. –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è
    {1,2}&{3,4}//{1,2,3,4}
    –°–ø–∏—Å–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±–æ–π –¥–ª–∏–Ω—ã –∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫ —Å–ø–∏—Å–∫—É
    {"a","b","c"}&{"d"}//{"a","b","c","d"}
    —Ç.–µ. –¥–æ–±–∞–≤–ª—è—è —á—Ç–æ-—Ç–æ –∫ —Å–ø–∏—Å–∫—É –º—ã –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ–º –¥–≤–∞ —Å–ø–∏—Å–∫–∞, –ø—Ä–æ—Å—Ç–æ –≤—Ç–æ—Ä–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–∏–Ω –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.
    –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ —Å–ø–∏—Å–∫–æ–≤:
    {{1,2},{3,4}}&{{5,6}}//{{1,2},{3,4},{5,6}}
    —ç—Ç–∞ —Å–∏—Ç—É–∞—Ü–∏—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ —Å—Ç–æ–ª–±–µ—Ü –∫ —Ç–∞–±–ª–∏—Ü–µ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã ‚Äì –∫ —Å–ø–∏—Å–∫—É —Å–ø–∏—Å–∫–æ–≤ –Ω–∞–¥–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–ø–∏—Å–æ–∫ ‚Äì —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –¥–≤—É—Ö —Å–ø–∏—Å–∫–æ–≤ —Å–ø–∏—Å–∫–æ–≤ )))

    –ö–∞–∫ –∏ —Å —Ç–µ–∫—Å—Ç–æ–º –µ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ–º—ã–µ —Å–ø–∏—Å–∫–∏ –ø–æ–º–µ—â–µ–Ω—ã –≤ —Å–ø–∏—Å–æ–∫):
    List.Combine({{1,2},{3,4}})//{1,2,3,4}

    –í—Å—ë, —á—Ç–æ –±—ã–ª–æ –≤—ã—à–µ ‚Äì —ç—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è, —Ç–æ–≥–¥–∞ –ø–æ—á–µ–º—É –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É? –î–∞ –ø—Ä–æ—Å—Ç–æ –µ—â—ë –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã ‚Äì –∏ –≤–æ—Ç —Å –Ω–∏–º–∏ –æ–Ω –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –¥—Ä—É–≥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é ‚Äì —Å–ª–∏—è–Ω–∏–µ (merge).
    –†–∞–∑–±–µ—Ä–µ–º –∑–∞–ø–∏—Å–∏. –ù–∞ —Ç–∞–∫–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ä–∞–∑–Ω–∏—Ü–∞ –Ω–µ —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è:
    [a=1,b=2]&[c=3]//[a=1,b=2,c=3]
    –ò–∑ –¥–≤—É—Ö –∑–∞–ø–∏—Å–µ–π —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∞—Å—å –æ–¥–Ω–∞, –≤ —á—ë–º —Ç–æ–≥–¥–∞ –ø–æ–¥–≤–æ—Ö?
    –î–∞ –≤–æ—Ç –æ–Ω:
    [a=1,b=2]&[b=3,c=4]//[a=1,b=3,c=4]
    –ø–æ–ª—è –≤ –∑–∞–ø–∏—Å–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –∏ –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ –¥–≤—É—Ö –∑–∞–ø–∏—Å–µ–π —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ –ø–æ–ª–µ–π –æ—Å—Ç–∞—ë—Ç—Å—è –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø—Ä–∏—á—ë–º –∏–∑ –∑–∞–ø–∏—Å–∏ —Å–ø—Ä–∞–≤–∞.

    –ù–∞–¥–µ—é—Å—å —Ç–µ–ø–µ—Ä—å –ø–æ–Ω—è—Ç–Ω–æ, –ø–æ—á–µ–º—É Record.Combine –≤—ã–¥–∞—ë—Ç —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
    Record.Combine({[a=1,b=2],[b=3,c=4],[c=5,d=6]})//[a=1,b=3,c=5,d=6]

    –ù—É –∏, –Ω–∞–∫–æ–Ω–µ—Ü, —Ç–∞–±–ª–∏—Ü—ã. –¢—É—Ç –≤–æ–æ–±—â–µ –≤–µ—Å–µ–ª–æ ‚Äì –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü —Å—Ç—Ä–æ–∫–∏ –≤—Ç–æ—Ä–æ–π –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–¥ —Å—Ç—Ä–æ–∫–∞–º–∏ –ø–µ—Ä–≤–æ–π, –ø—Ä–∏—á—ë–º —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥—Ä—É–≥ –ø–æ–¥ –¥—Ä—É–≥–æ–º, –∞ –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–µ–µ. –ï—â—ë —Ç–æ—á–Ω–µ–µ ‚Äì —Å–Ω–∞—á–∞–ª–∞ –∏–¥—É—Ç –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã, –∞ –ø–æ—Ç–æ–º –Ω–µ —Å–æ–≤–ø–∞–≤—à–∏–µ –∏–∑ –ø—Ä–∞–≤–æ–π.
    –¢–∞–±–ª–∏—Ü—ã –¥—Ä—É–≥ –ø–æ–¥ –¥—Ä—É–≥–æ–º (–∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç):
    #table({"a","b"},{{1,2},{3,4}})&#table({"a","b"},{{5,6},{7,8}})

    –¢–∞–±–ª–∏—Ü—ã –¥—Ä—É–≥ –ø–æ–¥ –¥—Ä—É–≥–æ–º, –Ω–æ —Å–æ —Å–¥–≤–∏–≥–æ–º (–∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
    #table({"a","b"},{{1,2},{3,4}})&#table({"c","d"},{{5,6},{7,8}})

    –¢–∞–±–ª–∏—Ü—ã —Å —á–∞—Å—Ç–∏—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ —Å—Ç–æ–ª–±—Ü–æ–≤
        #table({"a","b"},{{1,2},{3,4}})&#table({"c","b"},{{5,6},{7,8}})
    –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —É –ø—Ä–∞–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Ä—è–¥–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ–º–µ–Ω—è–ª—Å—è.

    –ù—É –∏ –∫–∞–∫ –≤–æ–¥–∏—Ç—Å—è, –∞–º–ø–µ—Ä—Å–∞–Ω–¥ –±–ª–∞–≥–æ–ø–æ–ª—É—á–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π
    Table.Combine({#table({"a","b"},{{1,2},{3,4}}),#table({"c","b"},{{5,6},{7,8}})})
    –ö–∞–∫ –≤—ã –¥–æ–≥–∞–¥–∞–ª–∏—Å—å ‚Äì —Å —Ç–µ–º –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –û–ø–µ—Ä–∞—Ç–æ—Ä & –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äì –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω—è—Ç—å, –ø—Ä–∏–Ω—è—Ç—å –∏ –ø—Ä–æ—Å—Ç–∏—Ç—å )))
    ]

[   Text.Split vs Splitter.SplitTextByDelimiter –∏–ª–∏ –∫–æ–≥–¥–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Text.Split, Splitter.SplitTextByDelimiter

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —Ä–∞–∑—Ä–µ–∑–µ –Ω–µ–¥–∞–≤–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤ –ø—Ä–æ —Å–±–æ—Ä–∫—É —Ç–∞–±–ª–∏—Ü –Ω—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å –≤–æ–ø—Ä–æ—Å –æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –º—ã –∏–º–µ–µ–º —Ñ—É–Ω–∫—Ü–∏—é Text.Split –∏ —Å–µ–º–µ–π—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π Splitter. –í—ã–≥–ª—è–¥–∏—Ç —ç—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
    Text.Split("a,b,c",",")//{"a","b","c"}
    Splitter.SplitTextByDelimiter(",")("a,b,c")//{"a","b","c"}
    –¢.–µ —Ñ—É–Ω–∫—Ü–∏–∏ Text.Split –º—ã –ø–µ—Ä–µ–¥–∞–µ–º —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–π —Ç–µ–∫—Å—Ç, –ø–æ—Ç–æ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å; –∞ —É Splitter –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —ç—Ç–æ —Å–∞–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –∞ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–π —Ç–µ–∫—Å—Ç –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –æ—Ç–¥–µ–ª—å–Ω–æ –≤–æ –≤—Ç–æ—Ä—ã—Ö —Å–∫–æ–±–∫–∞—Ö ‚Äì –ø–æ–¥–æ–±–Ω–æ–µ –º—ã –≤—Å—Ç—Ä–µ—á–∞–ª–∏, –∫–æ–≥–¥–∞ –æ–±—Å—É–∂–¥–∞–ª–∏ –∑–∞–º—ã–∫–∞–Ω–∏—è.

    –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —É Text.Split —á—É—Ç–∫–∞ –ª–∞–∫–æ–Ω–∏—á–Ω–µ–µ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–µ–µ. –¢–æ–ª—å–∫–æ –º—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –¥–ª–∏–Ω–∞ –∫–æ–¥–∞ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–µ –≤–ª–∏—è–µ—Ç, —Ç–æ–≥–¥–∞ –æ —á—ë–º –ø–æ—Å—Ç? –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –∑–∞–¥–∞—á–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö –∏ –∫–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–±—Ä–∞—Ç—å ‚Äì –≤–æ–ø—Ä–æ—Å —Å–∫–æ—Ä–µ–µ –≤–∫—É—Å–∞, –Ω–µ–∂–µ–ª–∏ –∫–∞–∫–∏—Ö-—Ç–æ –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤. –ù–æ –ø—Ä–∏ —ç—Ç–æ–º —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç —á—ë—Ç–∫–æ –∑–∞—è–≤–ª–µ–Ω –∫–∞–∫ splitter as function ‚Äì —ç—Ç–æ Table.FromList –∏ Table.SplitColumn. –ò –≤–æ—Ç –≤ –∏—Ö —Å–ª—É—á–∞–µ –≤—ã–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

    –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–±–µ —Å–∏—Ç—É–∞—Ü–∏–∏:
    Table.SplitColumn
    let
        from = #table({"txt"},{{"1,2,3"},{"4,5,6"},{"7,8,9"}}),
        to1 = Table.SplitColumn(from,"txt",(x)=>Text.Split(x,",")),
        to2 = Table.SplitColumn(from,"txt",(x)=>Splitter.SplitTextByDelimiter(",")(x)),
        to3 = Table.SplitColumn(from,"txt",Splitter.SplitTextByDelimiter(","))
    in
        to3
    Table.FromList
    let
        from = {"1,2,3","4,5,6","7,8,9"},
        to1 = Table.FromList(from,(x)=>Text.Split(x,",")),
        to2 = Table.FromList(from,(x)=>Splitter.SplitTextByDelimiter(",")(x)),
        to3 = Table.FromList(from,Splitter.SplitTextByDelimiter(","))
    in
        to3

    from ‚Äì –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äì —Ç–∞–±–ª–∏—Ü–∞ –∏–ª–∏ —Å–ø–∏—Å–æ–∫
    to1 ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Text.Split
    to2 ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Splitter.SplitTextByDelimiter
    to3 ‚Äì –Ω–∞–ø—Ä—è–º—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Splitter.SplitTextByDelimiter (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ - –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º—ã—à–∫–æ–∫–ª–∞—Ü–µ–º, —Ç–∞–∫ —á—Ç–æ –æ–Ω –∏–Ω–æ–≥–¥–∞ –≤—ã–¥–∞–µ—Ç –æ—á–µ–Ω—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)

    –†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–∞–∑–∞–ª–æ—Å—å –±—ã, –∏–¥–µ–Ω—Ç–∏—á–Ω—ã. –ù–û! –í–∞—Ä–∏–∞–Ω—Ç to1 –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º to2, –∞ –≤–æ—Ç to3 ‚Äì –≤ 1,5-2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ –¥–≤—É—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö! –ù–µ –∑–Ω–∞—é –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —É —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π, –Ω–æ –≤–µ—Ä–¥–∏–∫—Ç –ø—Ä–æ—Å—Ç–æ–π ‚Äì –µ—Å–ª–∏ –æ—Ç –Ω–∞—Å —Ö–æ—Ç—è—Ç ‚Äúsplitter as function‚Äù –∏ –Ω–∞–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–µ–Ω —Å–ø–ª–∏—Ç—Ç–µ—Ä ‚Äì –¥–∞–∂–µ –Ω–µ –¥—É–º–∞–µ–º –∏ –ø–µ—Ä–µ–¥–∞–µ–º –∏–º–µ–Ω–Ω–æ –µ–≥–æ, –ø—Ä–∏—á–µ–º –Ω–∞–ø—Ä—è–º—É—é, –∞ –Ω–µ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é ‚Äì —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ.
    ]

[   List.Alternate, Table.AlternateRows ‚Äì –∑–∞–±–∞–≤–Ω—ã–µ ¬´—á–µ—Ä–µ–¥–æ–≤–∞—Ç–µ–ª–∏¬ª —ç–ª–µ–º–µ–Ω—Ç–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Alternate, Table.AlternateRows

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—Å–ø–ª—ã–≤–∞—é—Ç –∑–∞–¥–∞—á–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä–∫—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–ª–∏ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã ‚Äì –∫–∞–∂–¥—ã–π –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç, –∫–∞–∂–¥–∞—è —Ç—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è List.Alternate –∏ Table.AlternateRows.

    –ù–∞—á–Ω–µ–º —Å List.Alternate. –£ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ç—ã—Ä–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ ‚Äì –¥–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –¥–≤–∞ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö:
    list ‚Äì —Å–∞–º —Å–ø–∏—Å–æ–∫
    count ‚Äì —á–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º—ã—Ö (—É–¥–∞–ª—è–µ–º—ã—Ö) —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    repeatInterval (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) ‚Äì —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –º–µ–∂–¥—É –ø—Ä–æ–ø—É—Å–∫–∞–µ–º—ã–º–∏
    offset (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) ‚Äì —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å.

    –í—ã–≥–ª—è–¥–∏—Ç –Ω–µ–º–Ω–æ–∂–∫–æ –∑–∞–ø—É—Ç–∞–Ω–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ø–æ–µ—Ö–∞–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä:
    let
        lst = {1..10},
        a=List.Alternate(lst,1),//{2,3,4,5,6,7,8,9,10}
        b=List.Alternate(lst,1,2),//{2,3,5,6,8,9}
        c=List.Alternate(lst,1,2,3),//{1,2,3,5,6,8,9}
        d = List.Alternate(lst,3,2,1),//{1,5,6,10}
        ListDelEachN=(l,n)=>List.Alternate(l,1,n-1,n-1),
        ListSelectEachN=(l,n)=>List.Alternate(l,n-1,1,0),
        e = ListDelEachN(lst,3),//{1,2,4,5,7,8,10}
        f = ListSelectEachN(lst,3)//{3,6,9}
    in
        f

    –∏ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –ø–æ —à–∞–≥–∞–º
    a ‚Äì –ø–µ—Ä–µ–¥–∞–ª–∏ —Ç–æ–ª—å–∫–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, Alternate —á–µ—Å—Ç–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏–ª –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –∏ –≤–µ—Ä–Ω—É–ª –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äì —Ç.–µ. –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ List.Skip(lst,2) –∏–ª–∏ List.Range(lst,2)
    b ‚Äì –∑–¥–µ—Å—å –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ repeatInterval ‚Äì —Ç.–µ —É–∫–∞–∑–∞–ª–∏ —á–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ —ç–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞–¥–æ —Å–Ω–æ–≤–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã ‚Äì ¬´–æ–¥–∏–Ω –ø—Ä–æ–ø—É—Å—Ç–∏–ª, –¥–≤–∞ –æ—Å—Ç–∞–≤–∏–ª, –æ–¥–∏–Ω –ø—Ä–æ–ø—É—Å—Ç–∏–ª‚Ä¶ –∏ —Ç.–¥.¬ª
    —Å ‚Äì –∞ —ç—Ç–æ –ø–æ–ª–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å ‚Äì —É–∫–∞–∑–∞–ª–∏ —Å–∫–æ–ª—å–∫–æ —ç–µ–º–µ–Ω—Ç–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞ –æ—Å—Ç–∞–≤–∏—Ç—å, —Å–∫–æ–ª—å–∫–æ —É–¥–∞–ª–∏—Ç—å –∏ —á–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è. –¢.–µ. –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã: ¬´—Ç—Ä–∏ –≤ –Ω–∞—á–∞–ª–µ –æ—Å—Ç–∞–≤–∏–ª, –æ–¥–∏–Ω –ø—Ä–æ–ø—É—Å—Ç–∏–ª, –¥–≤–∞ –æ—Å—Ç–∞–≤–∏–ª, –æ–¥–∏–Ω –ø—Ä–æ–ø—É—Å—Ç–∏–ª‚Ä¶ –∏ —Ç.–¥.¬ª.
    –¢—É—Ç –ø—Ä–æ—Å—Ç–æ –≤–∞–∂–Ω–æ –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, —à–∞–≥ d ‚Äì ¬´–æ–¥–∏–Ω –≤ –Ω–∞—á–∞–ª–µ –æ—Å—Ç–∞–≤–∏–ª, —Ç—Ä–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª, –¥–≤–∞ –æ—Å—Ç–∞–≤–∏–ª, —Ç—Ä–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª –∏ —Ç.–¥.¬ª.

    –í –∫–∞—á–µ—Å—Ç–≤–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞–ø–∏—à–µ–º –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ n-–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–∞–∂–¥–æ–≥–æ n-–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.

    ListDelEachN ‚Äì —É–¥–∞–ª—è–µ–º –∫–∞–∂–¥—ã–π n-—ã–π, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–≤—ã–µ n-1 –æ—Å—Ç–∞–≤–ª—è–µ–º (—á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç), –¥–∞–ª–µ–µ —É–¥–∞–ª—è–µ–º 1 (–≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç), —Ç–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º n-1 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (—Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç) –∏ —Å–Ω–æ–≤–∞ —É–¥–∞–ª—è–µ–º –¥–æ –∫–æ–Ω—Ü–∞ —Å–ø–∏—Å–∫–∞ l (–ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç)

    ListSelectEachN ‚Äì –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∂–¥—ã–π n-—ã–π ‚Äì —ç—Ç–æ –∑–µ—Ä–∫–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –∑–¥–µ—Å—å –º—ã –Ω–∞—á–Ω—ë–º –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—Ä—è–º–æ —Å –Ω–∞—á–∞–ª–∞ —Å–ø–∏—Å–∫–∞, –ø–æ—ç—Ç–æ–º—É —á–µ—Ç–≤–µ—Ä—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–∞–º –Ω–µ –Ω—É–∂–µ–Ω (—Ç.–µ. –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –Ω–µ –ø–∏—Å–∞—Ç—å, –Ω–æ –æ–Ω –º–Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤ –Ω–∏–∂–µ, –ø–æ—ç—Ç–æ–º—É –ø–æ—Å—Ç–∞–≤–∏–ª –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - 0), –∑–¥–µ—Å—å –º—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ —É–¥–∞–ª—è–µ–º n-1 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç), –¥–∞–ª–µ–µ –æ—Å—Ç–∞–≤–ª—è–µ–º 1 (—ç—Ç–æ –∏ –µ—Å—Ç—å –Ω—É–∂–Ω—ã–π –Ω–∞–º n-—ã–π) –∏ —Ç–∞–∫ –¥–æ –∫–æ–Ω—Ü–∞ —Å–ø–∏—Å–∫–∞.
    e,f ‚Äì –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ‚Äì –º–æ–∂–µ—Ç–µ —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

    –í —Ü–µ–ª–æ–º –≤—Ä–æ–¥–µ –Ω–µ—Å–ª–æ–∂–Ω–æ, –Ω–∞–¥–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–≤—ã–∫–Ω—É—Ç—å –∫ –ø–æ—Ä—è–¥–∫—É –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. –ù–æ –≤–æ—Ç —Ç—É—Ç —Å–∞–º–æ–µ –≤—Ä–µ–º—è —Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ Table.AlternateRows. –£ –Ω–µ—ë —Ç–æ–∂–µ —á–µ—Ç—ã—Ä–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –ø—Ä–∞–≤–¥–∞ –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ, –æ–Ω–∏ –∏–º–µ—é—Ç —Ç–æ –∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–æ –∏–¥—É—Ç‚Ä¶ –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ä—è–¥–∫–µ! (–æ–Ω–∏ –µ—â—ë –∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É, –Ω–æ —ç—Ç–æ –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥ —É–∂–µ –º–µ–ª–æ—á–∏).
    –°–∫–∞–∂–µ–º ¬´—Å–ø–∞—Å–∏–±–æ¬ª —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –∏ –∑–∞–ø–æ–º–Ω–∏–º ‚Äì –≤ Table.AlternateRows —Å–Ω–∞—á–∞–ª–∞ —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –æ—Ç—Å—Ç—É–ø–∏—Ç—å (offset), –ø–æ—Ç–æ–º —á–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º—ã—Ö (skip), –ø–æ—Ç–æ–º —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏–µ –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å (take). –ù—É –∏ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞:
    let
        tbl = Table.FromColumns({{1..10}},{"a"}),
        TableDelEachN=(t,n)=>Table.AlternateRows(t,n-1,1,n-1),
        TableSelectEachN=(t,n)=>Table.AlternateRows(t,0,n-1,1),
        e=TableDelEachN(tbl,3),
        f=TableSelectEachN(tbl,3)
    in
        f
    –ó–¥–µ—Å—å –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ TableDelEachN –∏ TableSelectEachN, —É–¥–∞–ª—è—é—â–∞—è –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç –≤—ã–±–∏—Ä–∞—é—â–∞—è n-—ã–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã. –°—Ä–∞–≤–Ω–∏—Ç–µ –∏—Ö —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ ‚Äì –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, ¬´–ø—Ä–æ—Å—Ç–æ¬ª –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ä—è–¥–∫–µ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫, —Ñ—É–Ω–∫—Ü–∏–∏ —Ö–æ—Ä–æ—à–∏–µ, —Ä–µ–∞–ª—å–Ω–æ —à—É—Å—Ç—Ä—ã–µ, –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä—è–º–æ –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–µ, –ø—Ä–æ—Å—Ç–æ –∫ —Ç–æ–º—É, —á—Ç–æ –æ–Ω–∏ ¬´–Ω–µ–º–Ω–æ–∂–∫–æ¬ª —Ä–∞–∑–Ω—ã–µ –Ω—É–∂–Ω–æ –ø—Ä–∏–≤—ã–∫–Ω—É—Ç—å‚Ä¶ )))
    ]

[   Skip, Range –∏–ª–∏ Remove –∏–ª–∏ —á–∏—Ç–∞–µ–º –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Skip, Table. Range, Table.RemoveFirstN, List.Skip, List. Range, List.RemoveFirstN

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑–±–∏—Ä–∞–ª —Ñ—É–Ω–∫—Ü–∏–∏ –ú –≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Ñ—É–Ω–∫—Ü–∏—é Table.Range:
    –°–∏–Ω—Ç–∞–∫—Å–∏—Å :
    Table.Range(table as table, offset as number, optional count as nullable number) as table
    –í –æ–ø–∏—Å–∞–Ω–∏–∏ –∫ —Ñ—É–Ω–∫—Ü–∏–∏: Table.Range –Ω–∞—à–µ–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ —Å –æ—Ç–ª–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π Table.Skip
    (table as table, optional countOrCondition as any) as table

    –ù—É –∏ –≤–¥–æ–≥–æ–Ω–∫—É —Å —Ñ—É–Ω–∫—Ü–∏–µ–π:
    Table.RemoveFirstN(table as table, optional countOrCondition as any) as table

    –í—Å–µ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç ¬´–∏–∑–±–∞–≤–∏—Ç—å¬ª —Ç–∞–±–ª–∏—Ü—É –æ—Ç —à–∞–ø–∫–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∫ (–Ω—É –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ ¬´–º—É—Å–æ—Ä–Ω—ã—Ö¬ª —Å—Ç—Ä–æ–∫ ‚Äì –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Å–∞–π—Ç–∞, –∏–ª–∏ pdf, –Ω–∞–ø—Ä–∏–º–µ—Ä)

    –í —Å–ª—É—á–∞–µ —Å Text.Skip –∏ Text.RemoveFirstN –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –∏–Ω–¥–µ–∫—Å (—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å), —Ç–∞–∫ –∏ —Ñ—É–Ω–∫—Ü–∏—é (–∫–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å), —Ç–æ–≥–¥–∞ –∫–∞–∫ Table.Range –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å. –ö–∞–∑–∞–ª–æ—Å—å –±—ã —Ä–∞–∑–Ω–∏—Ü—ã –æ—Å–æ–±–æ–π –Ω–µ—Ç, –Ω–æ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏:
    –ë–µ—Ä–µ–º —Ç–∞–±–ª–∏—Ü—É –∏–∑ 100–ö —Å—Ç—Ä–æ–∫ –∏ —É–±–∏—Ä–∞–µ–º –∏–∑ –Ω–µ–µ —à–∞–ø–∫—É –≤ 50k —Å—Ç—Ä–æ–∫
    let
    from = Excel.CurrentWorkbook(){0}[Content],
    rng = Table.Range(from,50000),
    skp=Table.Skip(from,50000),
    rfN=Table.RemoveFirstN(from,50000)
    in
    rfN
    –°–∞–º—ã–º –±—ã—Å—Ç—Ä—ã–º –æ–∫–∞–∑–∞–ª—Å—è RemoveFirstN, Range –Ω–∞ 2% –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –∞ Skip ‚Äì –Ω–∞ –ø–æ—á—Ç–∏ 10% –º–µ–¥–ª–µ–Ω–Ω–µ–µ!.
    –í–æ–∑–Ω–∏–∫ –≤–æ–ø—Ä–æ—Å: –ê –≤ —á–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –¥–µ–ª–æ ?
    –í —á–∞—Ç–µ, –º–∞—ç—Å—Ç—Ä–æ @buchlotnik —Ç—É—Ç –∂–µ –¥–∞–ª –æ—Ç–≤–µ—Ç:
    Skip-—Ç–æ –¥—É–º–∞–µ—Ç, –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∞ Range —Å—Ä–∞–∑—É –æ—Ç–∫—É—Å—ã–≤–∞–µ—Ç –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.
    –¢–µ—Å—Ç —Å List.Skip/Range/RemoveFirstN –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –æ—Ç–≤–µ—Ç @buchlotnik –≤ —á–∞—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã Range –∏ Skip ‚Äì Skip –æ–∫–∞–∑–∞–ª–∞—Å—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –ø–æ—á—Ç–∏ –Ω–∞ 20%.
    –í—ã–≤–æ–¥: —Ö–æ—Ç–∏–º –±—ã—Å—Ç—Ä–µ–µ ‚Äì —é–∑–∞–µ–º Range.
    –ù—É –∏ –Ω–∞ –∑–∞–∫—É—Å–∫—É, –≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –º—ã—Å–ª–∏ –ú–∏—Ö–∞–∏–ª–∞ @buchlotnik, –≤–∏—à–µ–Ω–∫–∞ –Ω–∞ —Ç–æ—Ä—Ç–µ ‚Äì —Ä–∞–±–æ—Ç–∞ –ú–µ—Ä–∫–∏ 2.1 –≤ excel –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ö —Å —è–≤–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –±–µ–∑ –Ω–∏—Ö.
    –§–æ—Ä–º—É–ª—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ —Å —Ç–∏–ø–æ–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—É –Ω–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–ª—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞):
    =–í–ü–†(–∏—Å–∫–æ–º–æ–µ; –≥–¥–µ –∏—â–µ–º; —Å—Ç–æ–ª–±–µ—Ü; 0)
    =–í–ü–†(–∏—Å–∫–æ–º–æ–µ; –≥–¥–µ –∏—â–µ–º; —Å—Ç–æ–ª–±–µ—Ü;)
    =–ü–û–ò–°–ö–ü–û–ó(–∏—Å–∫–æ–º–æ–µ;–≥–¥–µ –∏—â–µ–º;0)
    =–ü–û–ò–°–ö–ü–û–ó(–∏—Å–∫–æ–º–æ–µ;–≥–¥–µ –∏—â–µ–º;)
    –ò–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —Ç–µ—Ä—è–µ—Ç—Å—è 0,003 —Å–µ–∫—É–Ω–¥—ã ‚Äì –≤—Ä–æ–¥–µ –Ω–µ –º–Ω–æ–≥–æ, –Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑. –¢–∞–∫ —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å ‚Äì –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è/—Å–∏–ª—ã/–Ω–µ—Ä–≤—ã, –Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–æ–ª–∏–∫ –∏–ª–∏ –æ—Ç–¥–∞—Ç—å —ç—Ç–æ –Ω–∞ –æ—Ç–∫—É–ø —Ñ—É–Ω–∫—Ü–∏–∏ —Å –æ–∂–∏–¥–∞–µ–º–æ–π –≤ –∏—Ç–æ–≥–µ –ø–æ—Ç–µ—Ä–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏.

    –†–µ–∑—é–º–µ: –µ—Å–ª–∏ –µ—Å—Ç—å –≤—ã–±–æ—Ä –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏–µ–π —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º any –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º number ‚Äì –≤—ã–±–∏—Ä–∞–µ–º –≤—Ç–æ—Ä—É—é, –æ–Ω–∞ –±—ã—Å—Ç—Ä–µ–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è –∏ —Å—Ä–∞–∑—É –¥–µ–π—Å—Ç–≤—É–µ—Ç.
    ]

[   HEX2DEC ‚Äì –∏–ª–∏ —á–µ–º –µ—â—ë –ø–æ–ª–µ–∑–Ω—ã Binary –∏ BinaryFormat / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Custom Functions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç–µ –≤—Å–ø–ª—ã–ª–∞ —Ç–µ–º–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–µ–ª –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ. –ù–µ —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ, –∫–æ–≥–¥–∞ –≤–º–µ—Å—Ç–æ —Å–∏–º–≤–æ–ª–æ–≤ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –ø–æ–ª—É—á–∞–µ–º ¬´C4¬ª –∏–ª–∏ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å ¬´FF¬ª.
    –¢–∏–ø–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –µ—Å—Ç—å, —Å—Ä–∞–∑—É –µ–≥–æ –∏ —Ä–∞–∑–±–µ—Ä–µ–º:
    let
        from = {"C4", "EB", "FF", "20", "F2", "E5", "F5", "2C", "20", "EA", "F2", "EE", "20", "E2", "20", "F2", "E0", "ED", "EA", "E5", "29", "29", "29"},
        f=(x)=>Expression.Evaluate("0x"&x),
        to = Text.FromBinary(Binary.FromList(List.Transform(from,f)),1251)
    in
        to
    from - –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–ª–µ—Ç–µ–ª —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–µ (—Ç–æ—á–Ω–µ–µ —Ç–µ–∫—Å—Ç –∫–æ–¥–æ–≤ —ç—Ç–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤)
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ Expression.Evaluate. –ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç —Ñ–∞–∫—Ç, —á—Ç–æ –ø—Ä–µ—Ñ–∏–∫—Å "0x" –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É ‚Äì –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –∫ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∏ –ø—Ä–æ—Å–∏–º –≤—ã—á–∏—Å–ª–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ ‚Äì –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º –æ–±—ã—á–Ω–æ–µ –¥–µ—Å—è—Ç–∏—á–Ω–æ–µ —á–∏—Å–ª–æ.
    to ‚Äì –¥–∞–ª–µ–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –≤ —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª, –ø–æ–ª—É—á–∏–ª–∏ –∏–∑ –Ω–µ–≥–æ –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –∫–∞–∫ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç (–∫–æ–¥–∏—Ä–æ–≤–∫–∞ 1251)

    –í—Å—ë –æ—á–µ–Ω—å –ª–∞–∫–æ–Ω–∏—á–Ω–æ, –Ω–æ —Ö–æ–¥—è—Ç —Å–ª—É—Ö–∏, —á—Ç–æ –∏–∑-–∑–∞ Expression.Evaluate –∫–æ–º–ø—å—é—Ç–µ—Ä—ã –ø—Ä–æ—Å—Ç–æ –≤–µ—à–∞—é—Ç—Å—è. –ê–≤—Ç–æ—Ä –Ω–µ —Ä–∞–∑–¥–µ–ª—è–µ—Ç —Ç–∞–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–∞—Ö –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∏—Ç 200% –æ—Ç —Å–∞–º–æ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∏–∑ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–≤ –¥–≤–∞ —Ä–∞–∑–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–µ –Ω–∞ –ø–æ—Ä—è–¥–∫–∏, –∫–∞–∫ –æ–±—ã—á–Ω–æ —É—Ç–≤–µ—Ä–∂–¥–∞—é—Ç). –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —É—Å–∫–æ—Ä–∏—Ç—å—Å—è –º–æ–∂–Ω–æ.
    –ü–µ—Ä–µ–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é f –≤–æ—Ç —Ç–∞–∫:
    f=(x)=>[a=[0=0,1=1,2=2,3=3,4=4,5=5,6=6,7=7,8=8,9=9,A=10,B=11,C=12,D=13,E=14,F=15],
                b=List.Reverse(Text.ToList(x)),            c=List.Accumulate(b,[i=0,n=0],(s,c)=>[i=s[i]+1,n=s[n]+Number.Power(16,s[i])*Record.Field(a,c)])[n]][c]
    —Ä–∞–∑–±–µ—Ä—ë–º –µ—ë —à–∞–≥–∏ ‚Äì
    a ‚Äì —Å–ª–æ–≤–∞—Ä—å –∏–∑ –∑–∞–ø–∏—Å–∏ (–≤ —Å–µ—Ç–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –º–∞—Å—Å—É –≤–∞—Ä–∏–∞—Ü–∏–π ‚Äì –Ω–∞ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–∏, —Å–ø–∏—Å–∫–∞—Ö —Å–ø–∏—Å–∫–æ–≤ –∏ —Ç.–¥.)
    b ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
    c ‚Äì –Ω—É –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ —á–∏—Å–ª–æ ‚Äì –∏–∑ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—É—á–∞–µ–º —á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —É–º–Ω–æ–∂–∞–µ–º –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç–µ–ø–µ–Ω—å 16 (–∑–¥–µ—Å—å —á–µ—Ä–µ–∑ Record.Field, –≤ —Å–µ—Ç–∏ –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã —á–µ—Ä–µ–∑ List.Positions, List.PositionOf, List.Generate –∏ —Ç.–¥.), –Ω—É –∏ —Å—É–º–º–∏—Ä—É–µ–º. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≥–ª–æ–±–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω List.Accumulate, –Ω–æ –æ–ø—è—Ç—å –∂–µ –≤ —Å–µ—Ç–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ —á–µ—Ä–µ–∑ List.Sum(List.Transform‚Ä¶ –∏ –¥–∞–∂–µ —á–µ—Ä–µ–∑ —Ä–µ–∫—É—Ä—Å–∏—é.
    –ü–æ–ª—É—á–∏–ª–æ—Å—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ, –Ω–æ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ ‚Äì —ç—Ç–æ —É–∂–µ 130% –æ—Ç —Å–∞–º–æ–≥–æ —à—É—Å—Ç—Ä–æ–≥–æ. –¢.–µ. –º—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–∏—á–µ–º –≤ –ø–æ–ª—Ç–æ—Ä–∞ —Ä–∞–∑–∞. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ, –∫–∞–∫ –≤—ã –ø–æ–Ω—è–ª–∏, —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —É–∂–µ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –æ–ø–∏—Å–∞–Ω –∏ –º–æ–π –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–µ —Å–∏–ª—å–Ω–æ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø.

    –°–µ–≥–æ–¥–Ω—è –∂–µ —è —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–≤—Å–µ–º –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç, —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ 100%:
    f=(x)=>BinaryFormat.Byte(Binary.FromText(x,BinaryEncoding.Hex))
    –≤–æ—Ç —Ç–∞–∫, –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ—á–∫—É )))
    –°—É—Ç—å –ø—Ä–æ—Å—Ç–∞—è ‚Äì –º—ã –ø–æ–ª—É—á–∞–µ–º –±–∏–Ω–∞—Ä–Ω–∏–∫ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –µ–≥–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Binary.FromText) –Ω—É –∏ —á–∏—Ç–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –±–∞–π—Ç (–∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ 4 –±–∏—Ç–∞, –¥–≤–∞ —Å–∏–º–≤–æ–ª–∞ –¥–∞—é—Ç 8 –±–∏—Ç –∏–ª–∏ 1 –±–∞–π—Ç).
    –ö—Ç–æ-—Ç–æ, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, –≤–æ–∑–º—É—Ç–∏—Ç—Å—è ‚Äì –≤–µ–¥—å —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –±–û–ª—å—à–µ–µ —á–∏—Å–ª–æ (—Ç.–µ. –±–æ–ª–µ–µ –¥–≤—É—Ö —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤), —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—à–µ —Å –Ω–∏–º –±—ã —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å, –∞ —ç—Ç–∞ –Ω–µ—Ç. –°–æ–≥–ª–∞—Å–µ–Ω, –Ω–æ –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –ø–æ—Å—Ç—É–ø–∞–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–∫:
    f=(x)=>BinaryFormat.UnsignedInteger32(Binary.FromText(Text.PadStart(x,8,"0"),BinaryEncoding.Hex))
    —Ç.–µ. —Å –ø–æ–º–æ—â—å—é Text.PadStart –¥–æ–ø–æ–ª–Ω—è–µ–º —Ç–µ–∫—Å—Ç –Ω—É–ª—è–º–∏ –¥–æ 8 —Å–∏–º–≤–æ–ª–æ–≤ –∏ —á–∏—Ç–∞–µ–º –Ω–µ –±–∞–π—Ç, –∞ —á–µ—Ç—ã—Ä—ë—Ö–±–∞–π—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ (–∏–ª–∏ –¥–æ 16 —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Ç–æ–≥–¥–∞ —á–∏—Ç–∞–µ–º –≤–æ—Å—å–º–∏–±–∞–π—Ç–Ω–æ–µ) ‚Äì –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ —Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –∑–∞—Ç–æ –ø–æ–ª—É—á–∞–µ–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ—á–∫—É.

    –ù–∏–∫–∞–∫–∏—Ö ¬´—Ñ–∏–Ω—Ç–æ–≤ —É—à–∞–º–∏¬ª, –Ω–∏–∫–∞–∫–∏—Ö —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏—ë–º–æ–≤ ‚Äì –ø—Ä–æ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ‚Äì –ª—é–±–∏—Ç–µ –µ—ë, –≤ –Ω–µ–π –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ.

[   Table.TransformColumnTypes ‚Äì –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–∏–ø—ã –≤—Ä—É—á–Ω—É—é, –Ω–æ –ø–∞—á–∫–∞–º–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.TransformColumnTypes

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ù–µ–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –ø–æ–¥–Ω–∏–º–∞–ª—Å—è –≤–æ–ø—Ä–æ—Å –∏ –≤–æ—Ç –≤—á–µ—Ä–∞ —Å–Ω–æ–≤–∞ –Ω–∞–ø–æ–º–Ω–∏–ª–∏ ‚Äì –æ–±—Å—É–¥–∏–º –Ω–µ–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é —Å—Ç–æ–ª–±—Ü–æ–≤. –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º ‚Äì –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —à–∞–≥ ¬´–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π —Ç–∏–ø¬ª –∏ —ç—Ç–æ –≤ —Ü–µ–ª–æ–º —É–¥–æ–±–Ω–æ. –ù–æ –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–∑–æ–≤–æ–µ —Ä–∞–Ω–æ –∏–ª–∏ –ø–æ–∑–¥–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ-–∏—Å—Ç–æ—á–Ω–∏–∫–µ –ø—Ä–æ–ø–∞–¥–∞–µ—Ç —Å—Ç–æ–ª–±–µ—Ü, –∏–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ, –∏–ª–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏ —à–∞–≥ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å. –ò –≤–æ—Ç —Ç—É—Ç, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–µ –æ–¥–∏–Ω –¥–µ—Å—è—Ç–æ–∫ (–≤ –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞—è—Ö –∏ –∑–∞ —Å–æ—Ç–Ω—é –ø–µ—Ä–µ–≤–∞–ª–∏–≤–∞–µ—Ç), –≤—ã—è—Å–Ω—è–µ—Ç—Å—è, —á—Ç–æ –Ω–µ —Ç–æ —á—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äì –ø—Ä–æ—Å—Ç–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–µ–ø—Ä–æ—Å—Ç–æ, –∞ –µ—Å–ª–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü –∏ —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –º–µ–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ ‚Äì –∑–∞–¥–∞—á–∞ —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ —Å–∫–æ–ª—å–∫–æ –Ω–µ–≤—ã–ø–æ–ª–Ω–∏–º–æ–π, —Å–∫–æ–ª—å–∫–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π.

    –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –Ω–∞–ø–∏—à–µ–º –Ω–µ–º–Ω–æ–∂–∫–æ –∫–æ–¥–∞ –∏ —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ—á–µ–º—É —Ç–∞–∫:
    let
        from = Table.FromRecords({[–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ="—Ç–∞–ø–∫–∏",–ö–∞—Ç–µ–≥–æ—Ä–∏—è="–æ–±—É–≤—å",–¶–µ–Ω–∞–û–ø—Ç=1000,–¶–µ–Ω–∞–†–æ–∑–Ω=2000,–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ=100,–°—É–º–º–∞–û–ø—Ç=100000,–°—É–º–º–∞–†–æ–∑–Ω=200000,–ü—Ä–æ–¥–∞–≤–µ—Ü="–í–∞—Å—è",–î–∞—Ç–∞–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è=44562,–î–∞—Ç–∞–ü—Ä–æ–¥–∞–∂–∏=44835,–î–∞—Ç–∞–û—Ç–≥—Ä—É–∑–∫–∏=44866,–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ="–æ–±—ã—á–Ω—ã–µ —Ç–∞–ø–∫–∏"]}),
        nms = Table.ColumnNames(from),
        dlst = List.Select(nms,(i)=>Text.Contains(i,"–î–∞—Ç–∞")),
        nlst = List.Select(nms,(i)=>List.Contains({"–¶–µ–Ω–∞","–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ","–°—É–º–º–∞"},i,(x,y)=>Text.Contains(y,x))),
        tlst = List.Difference(nms,dlst&nlst),
        f=(x,y)=>List.Transform(x,(i)=>{i,y}),
        transflst = f(dlst,Date.Type)&f(nlst,Number.Type)&f(tlst,Text.Type),
        to = Table.TransformColumnTypes(from,transflst)
    in
        to

    from ‚Äì –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–ª–µ—Ç–µ–ª–∞ —Ç–∞–±–ª–∏—Ü–∞, –∑–¥–µ—Å—å –Ω–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–∞—è, –ø—Ä–æ—Å—Ç–æ —á—Ç–æ–± –ø–æ—Å—Ç –Ω–µ –∑–∞–≥—Ä–æ–º–æ–∂–¥–∞—Ç—å, –Ω–æ –∏ –¥–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ –∏ –≤—Å—è–∫–∏–µ —Ü–µ–Ω—ã —Å –ù–î–° ‚Äì –∫–æ—Ä–æ—á–µ –≤–∫–ª—é—á–∏—Ç–µ —Ñ–∞–Ω—Ç–∞–∑–∏—é
    nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
    dlst ‚Äì –∏–∑ –æ–±—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –¥–∞—Ç–∞–º–∏
    nlst ‚Äì —Ç–∞–∫–∂–µ –∏–∑ –æ–±—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—É—á–∞–µ–º –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (—Å–∞–º –ø—Ä–∏—ë–º –æ–±—Å—É–∂–¥–∞–ª—Å—è —Ç—É—Ç –∏ –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —ç—Ç–æ–º –ø—Ä–∏–Ω—Ü–∏–ø–µ –≤—ã –º–æ–∂–µ—Ç–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ø–æ–¥ –≤–∞—à–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞)
    tlst ‚Äì –Ω—É –∏ –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–µ —Å –¥–∞—Ç–∞–º–∏ –∏ –Ω–µ —Å —á–∏—Å–ª–∞–º–∏ –º—ã —Ö–æ—Ç–∏–º —Å–¥–µ–ª–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ ‚Äì —Ç—É—Ç –Ω–∞–º –≤ –ø–æ–º–æ—â—å List.Difference - –∏–∑ –≤—Å–µ—Ö –∏–º—ë–Ω –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–æ—à–ª–∏ –≤ dlst –∏ nlst.
    –û–∫, —Ç–µ–ø–µ—Ä—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è f ‚Äì –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: x ‚Äì —Å–ø–∏—Å–æ–∫, y ‚Äì —Ç–∏–ø, –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –Ω–∞—à —Å–ø–∏—Å–æ–∫ –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –≤–∏–¥–∞ {–Ω–∞–∑–≤–∞–Ω–∏–µ,—Ç–∏–ø} (—ç—Ç–æ –º—ã —Ç–æ–∂–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏ )
    transflst ‚Äì –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–∫–∏ —Å–ø–∏—Å–∫–æ–≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö (–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–º–ø–µ—Ä—Å–∞–Ω–¥ —Å–æ —Å–ø–∏—Å–∫–æ–º —Å–ø–∏—Å–∫–æ–≤ –æ–±—Å—É–∂–¥–∞–ª–∏ —Ç—É—Ç)
    to ‚Äì –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –Ω–∞—à —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π —Ç–∏–ø–æ–≤ –∫ —Ç–∞–±–ª–∏—Ü–µ ‚Äì –∏ –≤—Å—ë!

    –î–∞, –∫–æ–º—É-—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –µ—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–¥ –≤—ã—à–µ —Å —Ç–µ–º, —á—Ç–æ –æ–±—ã—á–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —à–∞–≥–µ ¬´–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π —Ç–∏–ø¬ª, —Ç–æ –æ–∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –≤—Å—ë –±–æ–ª–µ–µ —á–µ–º –∫–æ–º–ø–∞–∫—Ç–Ω–æ )))

    –ü—Ä–∏ —ç—Ç–æ–º –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –º—ã –Ω–∏ —Ä–∞–∑—É –≤ –∫–æ–¥–µ –Ω–µ –æ–±—Ä–∞—Ç–∏–ª–∏—Å—å –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∏–º–µ–Ω–∏ —Å—Ç–æ–ª–±—Ü–∞, –Ω–µ –ø–∏—Å–∞–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π, –≤—Å—ë —á–µ–º –æ–ø–µ—Ä–∏—Ä–æ–≤–∞–ª–∏ ‚Äì —ç—Ç–æ –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—è—Å—å –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø. –ü–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ–¥ –Ω–∏–∫–∞–∫ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –∞ –ø–æ—ç—Ç–æ–º—É –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã —Å—Ç–∞–ª–∫–∏–≤–∞–µ—Ç–µ—Å—å —Å –±–æ–ª—å—à–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ ‚Äì –Ω–µ –ø–æ–ª–µ–Ω–∏—Ç–µ—Å—å, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ ‚Äì —ç—Ç–æ —Å–∏–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç –∂–∏–∑–Ω—å –≤ –±—É–¥—É—â–µ–º.
    ]
[   List.Combine+Table.FromList vs AddIndexColumn+AddColumn+Unpivot+Pivot + —á—Ç–æ —Ç–∞–º –µ—â—ë –º–æ–∂–Ω–æ –Ω–∞–∫–ª–∞—Ü–∞—Ç—å –º—ã—à–∫–æ–π / #–ù–µ–≤—Å–µ–π–æ–≥—É—Ä—Ç—ã–æ–¥–∏–Ω–∞–∫–æ–≤–æ–ø–æ–ª–µ–∑–Ω—ã

    –ö–æ–ª–ª–µ–≥–∏, –≤—Å–µ–º –¥–æ–±—Ä–æ–≥–æ.
    –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –ú —Ä–∞—Å—Ç–µ—Ç –∏ –≤–º–µ—Å—Ç–µ —Å —Ç–µ–º –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ä–æ–ª–∏–∫–æ–≤ –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. Youtube –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∑–∞–Ω–∏–º–∞–µ—Ç –ª–∏–¥–∏—Ä—É—é—â–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ —ç—Ç–æ–π —á–∞—Å—Ç–∏.
    –í –ø–æ–∏—Å–∫–∞—Ö —Å–≤—è—â–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞–∞–ª—è –≤ —á–∞—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞ –Ω–∞ –ú, –¥–∞ –∏ –ø—Ä–æ—Å—Ç–æ –≤ –ø–æ–∏—Å–∫–∞—Ö –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –Ω–∞—Ç–æ–ª–∫–Ω—É–ª—Å—è –Ω–∞ –æ–¥–∏–Ω —Ä–æ–ª–∏–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–∑–±–∏—Ä–∞–ª–∞—Å—å –∑–∞–¥–∞—á–∞ –ø–æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü—ã.
    –ö –∞–≤—Ç–æ—Ä—É —Ä–æ–ª–∏–∫–∞ –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–µ—Ç–µ–Ω–∑–∏–π, –Ω–æ –∑–∞–¥–∞—á–∫—É —Ä–µ—à–∏–ª —Ä–∞–∑–æ–±—Ä–∞—Ç—å.

    –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - —Ç–∞–±–ª–∏—Ü–∞ –≤–∏–¥–∞:
    #table({"1","2","3"},{{"01.02.22","02.02.22","03.02.22"},{100,200,300},{"04.02.22","05.02.22","06.02.22"},{500,700,900}})
    –ï–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ñ–æ—Ä–º–∞—Ç—É:
    #table({"1","2"},{{"01.02.22",100},{"02.02.22",200},{"03.02.22",300},{"04.02.22",500},{"05.02.22",700},{"06.02.22",900}})

    –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞ —Ä–æ–ª–∏–∫–∞ –≤ –∫–æ–¥–µ (–∏—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã excel. –ï–µ –º–æ–∂–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø–æ –ø—Ä–∏–º–µ—Ä—É –≤—ã—à–µ —Å–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ª–∏—Å—Ç–µ):
        get_data = Excel.CurrentWorkbook(){[Name="–î–∞—Ç–∞"]}[Content],
        tab_idx =Table.AddIndexColumn(get_data,"–ò–Ω–¥–µ–∫—Å",0,1, Int64.Type),
        tab_mod =Table.AddColumn(tab_idx,"–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è",each Number.Mod([–ò–Ω–¥–µ–∫—Å], 2),type number),
        tab_row_num =Table.AddColumn(tab_mod,"row_num",each if [–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è] = 0 then [–ò–Ω–¥–µ–∫—Å] else [–ò–Ω–¥–µ–∫—Å] - 1),
        tab_remove_cols = Table.RemoveColumns(tab_row_num, {"–ò–Ω–¥–µ–∫—Å"}),
        tab_unpivot = Table.UnpivotOtherColumns(tab_remove_cols,{"–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è", "row_num"},"–ê—Ç—Ä–∏–±—É—Ç","–ó–Ω–∞—á–µ–Ω–∏–µ"),
        tab_pivot = Table.Pivot(Table.TransformColumnTypes(tab_unpivot,{{"–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è", type text}},"ru-RU"),
        List.Distinct(Table.TransformColumnTypes(tab_unpivot,{{"–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è", type text}},"ru-RU")[#"–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è"]),"–û—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è","–ó–Ω–∞—á–µ–Ω–∏–µ"),
        cols_select = Table.SelectColumns(tab_pivot,{"0", "1"})

    –ü–æ–¥—Ö–æ–¥ –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –∏–Ω–¥–µ–∫—Å–∞, –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –º–æ–¥—É–ª—é –∏ –¥–∞–ª–µ–µ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ Pivot –∏ Unpivot.
    –î–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –Ω–∞ –∂–∏–∑–Ω—å –∏ –Ω–∏ –≤ –∫–æ–µ–º —Å–ª—É—á–∞–µ –Ω–µ –æ—Å–ø–∞—Ä–∏–≤–∞–µ—Ç—Å—è.
    –ï—Å—Ç—å –ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–∞–Ω–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É?
    –°—Ö–æ–¥—É —Ä–µ—à–µ–Ω–∏–µ:
    from = Excel.CurrentWorkbook(){[Name="–î–∞—Ç–∞"]}[Content],
    lst1=List.Combine(Table.ToRows(Table.AlternateRows(from,1,1,1))),
    lst2=List.Combine(Table.ToRows(Table.AlternateRows(from,0,1,1))),
    zp=List.Zip({lst1,lst2}),
    to=Table.FromList(zp,(x)=>x)
    –õ–æ–≥–∏–∫–∞ –∫–æ–¥–∞: –ë–µ—Ä–µ–º —á–µ—Ç–Ω—ã–µ –∏ –Ω–µ—á–µ—Ç–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –ø–æ —Å—Ç—Ä–æ–∫–∞–º —Ç–∞–±–ª–∏—Ü—ã, –∫–æ–º–±–∞–π–Ω –∏ —á–µ—Ä–µ–∑ ZIP –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤ Table.FromList.
    –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ –ú–µ—Ä–∫–µ –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –≤ 3 —Ä–∞–∑–∞ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã—à–µ, —á–µ–º –∫–æ–¥ –∞–≤—Ç–æ—Ä–∞ —Ä–æ–ª–∏–∫–∞ –Ω–∞ Youtube.

    –†–µ—à–µ–Ω–∏–µ –±—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ –ú–∏—Ö–∞–∏–ª—É (@buchlotnik) –∏ –æ—Ç –º–∞—ç—Å—Ç—Ä–æ PQ –ø–æ—Å–ª–µ–¥–æ–≤–∞–ª –æ—Ç–≤–µ—Ç –≤ –≤–∏–¥–µ –µ—â–µ –æ–¥–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:
    from = Excel.CurrentWorkbook(){[Name="–î–∞—Ç–∞"]}[Content],
    to = Table.FromList(List.Combine(List.Transform(List.Split(Table.ToList(from,(x)=>x),2),List.Zip)),(x)=>x)
    –°–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å, –ª–∞–∫–æ–Ω–∏—á–Ω–æ, –ª–æ–≥–∏—á–Ω–æ –∏ –∫—Ä–∞—Å–∏–≤–æ.

    –û–∂–∏–¥–∞–µ–º–æ, —á—Ç–æ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ –æ—Å—Ç–∞–≤–∏–ª–æ —à–∞–Ω—Å–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –¥–≤—É–º. –ú–æ–∂–µ—Ç–µ —Å–∞–º–∏ —É–±–µ–¥–∏—Ç—å—Å—è –Ω–∞ 56k —Å—Ç—Ä–æ–∫:
    –ó–∞–ø—Ä–æ—Å       –°—Ä–µ–¥–Ω–µ–µ      –û—Ç         –î–æ     –û–±—â–µ–µ
    Buch           0,59       0,53       0,7    14,84
    CubRoot        0,93       0,86       1,09   23,27
    Youtube        2,84       2,67       3,14   71,02

    –û —á–µ–º —ç—Ç–æ—Ç –ø–æ—Å—Ç: –†–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ "–º—ã—à–∫—É" –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –Ω–∞ –∂–∏–∑–Ω—å, –Ω–æ –µ—Å–ª–∏ –í—ã —Ö–æ—Ç–∏—Ç–µ –æ—â—É—Ç–∏—Ç—å –≤ –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ, –∫–∞–∫ –¥—Ä–æ–∂–∏—Ç –¥–≤–∏–≥–∞—Ç–µ–ª—å –ú, –±–µ—Ä–∏—Ç–µ –≤ —Ä—É–∫–∏ –º–µ—Ö–∞–Ω–∏–∫—É ‚Äì –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, —á–∏—Ç–∞–π—Ç–µ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–π—Ç–µ —Å–≤–æ–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.
    –í–º–µ—Å—Ç–µ –º—ã —Å–¥–µ–ª–∞–µ–º –º–∏—Ä –ú —á–∏—â–µ )
    ]
[   List.TransformMany vs. Table.CombineColumns –∏–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Å–ø–ª–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.TransformMany, Table.CombineColumns

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ü–æ–¥–∫–∏–Ω—É–ª–∏ –Ω–∞–º–µ–¥–Ω–∏ –∑–∞–¥–∞—á–∫—É –ø–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –≥—Ä–∞—Ñ–∏–∫–∞ –æ—Ç–ø—É—Å–∫–æ–≤ –≤ –±–æ–∂–µ—Å–∫–∏–π –≤–∏–¥. –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Ä–∞–∑–±–µ—Ä–µ–º –≤–æ–ø—Ä–æ—Å —Å–ø–ª–∏—Ç–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é.
    –°—Ä–∞–∑—É –ø—Ä–∏–º–µ—Ä:
    let
        from = Table.FromRecords(Json.Document(Binary.Decompress(Binary.FromText("rZLBDsIwCIZfpel5aYDSWX0V9eCmvoEn47u7QeeoiXOJXn4G+6HlS/d3f7gBRxa9iHaireh5rjOKkmjvd/69aNv5Kgq+UZvOz2orvUiuCsVrz4y9aCrDdrGx11VjHsYlN84AOCFr5JIPP5yvmsBs0Q2ttAkQAwFF9xpCAdpS0gptA2SpaA4YENXhH82PDOPVtFwMz7OBdlokGV0VVpDkDyQngMjL2GBglAwRzAG2kv8NiB6ZzDcU2xIKdlVYgSL9iGJ8HBYF5emx/AFFNrZ2vnepTDssAUmuCiuAtB+AUP7yJjDAZlyc/OP4BA=="),Compression.Deflate))),
        f=(x)=>List.Zip(List.Transform(x,(i)=>if Text.Contains(i,"#(lf)") then Text.Split(i,"#(lf)") else {i})),
        cmb = Table.CombineColumns(from,{"–¥–Ω–∏","–¥–∞—Ç—ã"},f,"tmp"),
        exp = Table.ExpandListColumn(cmb, "tmp"),
        to = Table.SplitColumn(exp,"tmp",(x)=>x,{"–¥–Ω–∏","–¥–∞—Ç—ã"})
    in
        to

    from ‚Äì –≤–æ—Ç —Ç–∞–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ –≤—Ö–æ–¥–µ ‚Äì —Å—Ç–æ–ª–±—Ü—ã ¬´–¥–æ–ª–∂–Ω–æ—Å—Ç—å¬ª, ¬´—Ñ–∏–æ¬ª, ¬´–Ω–æ–º–µ—Ä¬ª; –∞ –≤–æ—Ç —Å—Ç–æ–ª–±—Ü—ã ¬´–¥–Ω–∏¬ª –∏ ¬´–¥–∞—Ç—ã¬ª –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ —Ä–∞–∑—Ä—ã–≤—É —Å—Ç—Ä–æ–∫–∏, –ø—Ä–∏—á—ë–º –æ–±–∞ —Å—Ä–∞–∑—É –≤ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏.

    f - –ø–æ—Å–∫–æ–ª—å–∫—É —Å–ø–ª–∏—Ç–∏—Ç—å –±—É–¥–µ–º —Å—Ä–∞–∑—É –æ–±–∞ —Å—Ç–æ–ª–±—Ü–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±—É–¥–µ–º –∏—Ö –∫–∞–∫ —Å–ø–∏—Å–æ–∫. –°–Ω–∞—á–∞–ª–∞ —Å–º–æ—Ç—Ä–∏–º —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ List.Transform: (i)=>if Text.Contains(i,"#(lf)") then Text.Split(i,"#(lf)") else {i}) ‚Äì –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–æ–∫–∏ –¥–µ–ª–∞–µ–º —Å–ø–ª–∏—Ç –ø–æ —ç—Ç–∏–º —Ä–∞–∑—Ä—ã–≤–∞–º, –∏–Ω–∞—á–µ ‚Äì –æ—Å—Ç–∞–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–æ–ª–±—Ü—É –ø–æ–ª—É—á–∏–º —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (—Å –æ–¥–Ω–∏–º –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏) –∏ –¥–∞–ª–µ–µ —ç—Ç–∏ —Å–ø–∏—Å–∫–∏ —Å–∫–∞—Ä–º–ª–∏–≤–∞–µ–º List.Zip ‚Äì –∫–∞–∫ –º—ã –ø–æ–º–Ω–∏–º, –æ–Ω–∞ —Å–æ—à—å–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å—Ç—Ä–æ—á–Ω–æ.

    cmb ‚Äì —Å–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–ª–∏ —Å—Ç–æ–ª–±—Ü—ã —Å –ø–æ–º–æ—â—å—é –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì –≤ —Å—Ç–æ–ª–±—Ü–µ ‚Äútmp‚Äù —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–ø–∞—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Å—Ç—Ä–æ—á–Ω–æ)

    –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç:
    exp ‚Äì —Ä–∞–∑–≤–µ—Ä–Ω—É–ª–∏ —Å–ø–∏—Å–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
    to ‚Äì —Ä–∞–∑–≤–µ—Ä–Ω—É–ª–∏ —Å—Ç—Ä–æ–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã

    –í—Ä–æ–¥–µ –ø—Ä–æ—Å—Ç–æ –∏ –ª–æ–≥–∏—á–Ω–æ, —Ç–æ–≥–¥–∞ –æ —á—ë–º –ø–æ—Å—Ç? –î–∞ –æ —Ç–æ–º, —á—Ç–æ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö –±—ã—Å—Ç—Ä–µ–µ )))

    –®–∞–≥–∏ from –∏ f –æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞ –º–µ—Å—Ç–µ, –∞ –≤–æ—Ç –¥–∞–ª—å—à–µ –º–µ–Ω—è–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:
        nms = Table.ColumnNames(from),
        lst = Table.ToList(from,(x)=>x),
        tr = List.TransformMany(lst,(x)=>f(List.LastN(x,2)),(x,y)=>List.FirstN(x,3)&y),
        to = Table.FromList(tr,(x)=>x,nms)

    nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

    lst ‚Äì —Ä–∞–∑–æ–±—Ä–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É –≤ —Å—Ç—Ä–æ–∫–∏ (—Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç)

    tr ‚Äì –∏ —Ç–µ–ø–µ—Ä—å –¥–≤–∞–∂–¥—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫:
    (x)=>f(List.LastN(x,2)) ‚Äì –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é f –∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–≤—É–º —ç–ª–µ–º–µ–Ω—Ç–∞–º (–ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤);
    (x,y)=>List.FirstN(x,3)&y ‚Äì —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫–∏ –∏–∑ –ø–µ—Ä–≤—ã—Ö —Ç—Ä—ë—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ —Å—Ç—Ä–æ–∫–µ –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö —Å –∫–∞–∂–¥–æ–π –ø–∞—Ä–æ–π –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–ø–∏—Å–∫–æ–≤. –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Å—Ä–∞–∑—É –≤—Å–µ —Å—Ç—Ä–æ–∫–∏

    to ‚Äì –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–±—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É

    –ü–æ —Å—É—Ç–∏, –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –≤–æ –≤—Ç–æ—Ä–æ–º —Å–ª—É—á–∞–µ –º—ã –≤–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –ø—Ä–∏–º–µ–Ω–∏–ª–∏ —Å–ø–∏—Å–æ—á–Ω—ã–µ, –Ω–∞ —ç—Ç–æ–º –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤—ã–∏–≥—Ä—ã—à –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ 15-20 %.

    –ú–Ω–æ–≥–∏–µ –≥–æ–≤–æ—Ä—è—Ç –æ —Ç–æ–º, —á—Ç–æ ¬´–Ω–µ –≤–∏–¥—è—Ç¬ª –≤ —Å–≤–æ–∏—Ö –∑–∞–¥–∞—á–∞—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–ª—è List.TransformMany ‚Äì –¥–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–æ–ª–∂–µ–Ω –¥–∞—Ç—å –ø–∏—â—É –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
    ]
[   List.TransformMany / #–í–µ—Å—ë–ª—ã–µ–ö–∞—Ä—Ç–∏–Ω–∫–∏

    –í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ—Å—Ç–∞ –ø—Ä–æ TransformMany

    –ù–∞–¥–µ—é—Å—å, –±—ã–ª–æ –ø–æ–ª–µ–∑–Ω–æ.
    –í—Å–µ—Ö –±–ª–∞–≥!
    @buchlotnik
    Mikhail Muzykin
    6 November 2022
    21:49
    –î–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤ —Ç–∞–Ω–∫–µ
    Record.FieldOrDefault –¥–ª—è GroupKind.Local –∏–ª–∏ –∫–∞–∫ –∑–∞–º–µ–Ω–∏—Ç—å FillDown
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Record.FieldOrDefault, GroupKind.Local

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç. –ü–æ–¥–æ–≥–Ω–∞–ª–∏ –≤ —á–∞—Ç–µ –∑–∞–¥–∞—á–∫—É (—Ç—É—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–µ–Ω–¥ - —Ç–∞–º –∏ –º—ã—à–∫–æ–∫–ª–∞—Ü, –∏ –º–æ—ë —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º FillDown). –Ø –±—ã —Ä–µ—à–∏–ª –∏ –∑–∞–±—ã–ª, –Ω–æ –ò–≥–æ—Ä—å (@CubRoot) –ø–æ–ø—ã—Ç–∞–ª—Å—è –ø—Ä–∏–º–æ—Ç–∞—Ç—å Table.Group –∏ –¥–∞–∂–µ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –º–µ–Ω—è –æ–±–æ–≥–Ω–∞–ª (–ø–æ—Ç–æ–º –ø—Ä–∞–≤–¥–∞ –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±—ã–ª–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º, –Ω–æ –±—ã–ª–æ –ø–æ–∑–¥–Ω–æ - —è —É–∂–µ –≤—Å—ë –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–ª) - –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏—à–ª–æ—Å—å –∑–∞—Å—É—á–∏—Ç—å —Ä—É–∫–∞–≤–∞ –∏ –Ω–µ–º–Ω–æ–∂–∫–æ –ø–æ–∏–≥—Ä–∞—Ç—å –≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é. –†–∞–∑–±–µ—Ä–µ–º —Å–∞–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:
    let
        from = Table.FromColumns({{"–Ω–∞—Å–æ—Å—ã","–Ω-1","–Ω-2","–Ω-3","–ø–æ–¥–Ω–æ—Å—ã","–ø-1","–ø-2","–ø-3","–ø—ã–ª–µ—Å–æ—Å—ã","–ø-1","–ø-2","–ø-3"}},{"–∫–∞—Ç–µ–≥–æ—Ä–∏—è"}),
        lst = {"–Ω–∞—Å–æ—Å—ã","–ø–æ–¥–Ω–æ—Å—ã","–ø—ã–ª–µ—Å–æ—Å—ã"},
        rec = Record.FromList(List.Repeat({1},List.Count(lst)),lst),
        f=(s,c)=>Record.FieldOrDefault(rec,c,0),
        gr = Table.Group(from,"–∫–∞—Ç–µ–≥–æ—Ä–∏—è",{"—Ç–æ–≤–∞—Ä",each List.Range([–∫–∞—Ç–µ–≥–æ—Ä–∏—è],1)},GroupKind.Local,f),
        to = Table.ExpandListColumn(gr, "—Ç–æ–≤–∞—Ä")
    in
        to

    from ‚Äì –≤–æ—Ç —Ç–∞–∫–∞—è —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å–º–µ—à–∞–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–æ–≤–∞—Ä—ã

    lst ‚Äì —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

    rec ‚Äì –∏–∑—é–º–∏–Ω–∫–∞ —Ä–µ—à–µ–Ω–∏—è ‚Äì –¥–µ–ª–∞–µ–º –∑–∞–ø–∏—Å—å, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π ‚Äì –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∞ –≤–æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è ‚Äì –µ–¥–∏–Ω–∏—Ü—ã

    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è Table.Group ‚Äì –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—è –≤ –∑–∞–ø–∏—Å–∏ ‚Äì –µ—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç ‚Äì –≤–µ—Ä–Ω—ë—Ç 1, –∏–Ω–∞—á–µ ‚Äì 0 (—Ç.–µ –º—ã —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∞–µ–º 0 –∏–ª–∏ 1 –¥–ª—è –ø—è—Ç–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ )

    gr ‚Äì –Ω—É –∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º—É —Å—Ç–æ–ª–±—Ü—É, –∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–µ–ª–∞–µ–º –ø–æ –Ω–µ–º—É –∂–µ, –ø—Ä–æ–ø—É—Å–∫–∞—è –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É (—ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Å–∞–º–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏). –û–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ Range (–ø–æ—á–µ–º—É ‚Äì –æ–±—Å—É–∂–¥–∞–ª–∏ —Ç—É—Ç ). –ü—Ä–∏ —ç—Ç–æ–º —Ñ—É–Ω–∫—Ü–∏—è f –Ω–∞–º —Å—Ä–∞–∑—É –æ—Ç–¥–∞—ë—Ç —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–æ—ç—Ç–æ–º—É –æ–±–æ—à–ª–∏—Å—å –±–µ–∑ if –∏–ª–∏ Number.From

    to ‚Äì –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–ø–∏—Å–∫–∏ –≤ —Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ç–æ–ª–±—Ü—É ¬´—Ç–æ–≤–∞—Ä¬ª

    –í–æ—Ç —Ç–∞–∫ ‚Äì –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–∑–≤–æ–ª–∏–ª–∞ –Ω–∞–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ –±–µ–∑–æ –≤—Å—è–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–π, –ø—Ä–∏ —ç—Ç–æ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–±—Ä–∞–ª–∏ —Ä–∞–∑–æ–º, –∏–∑–±–µ–≥–∞—è FillDown. –ù–∞ –º–æ–π –≤–∫—É—Å –ø—Ä–∏—ë–º –≤—ã—à–µ–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∏ –≤–µ—Å—å–º–∞ —à—É—Å—Ç—Ä—ã–π. –ò–≥–æ—Ä—å, —Å–ø–∞—Å–∏–±–æ –∑–∞ "–ø–∏–Ω–æ–∫" - –ø—Ä–æ–¥–æ–ª–∂–∞–π —Å–≤–æ–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã - —ç—Ç–æ –∫—Ä—É—Ç–æ!
    ]
[   Text.AfterDelimiter, Text.BeforeDelimiter, Text.BetweenDelimiters ‚Äì –ø–æ–ª—É—á–∞–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∏–∑ —Ç–µ–∫—Å—Ç–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Text.AfterDelimiter, Text.BeforeDelimiter, Text.BetweenDelimiters

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–¥–∫–∏–Ω—É–ª–∏ —Ç—É—Ç –∑–∞–¥–∞—á–∫—É ‚Äì ¬´–≤—ã—Ç–∞—â–∏—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–∫–æ–±–∫–∞—Ö‚Ä¶ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–∫–æ–±–æ–∫ –º–æ–≥—É—Ç –±—ã—Ç—å –µ—â—ë —Å–∫–æ–±–∫–∏, –∞ –≤–æ—Ç –∏—Ö –Ω–∞–¥–æ –æ—Å—Ç–∞–≤–∏—Ç—å¬ª. –í—Ä–æ–¥–µ –Ω–µ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ, –Ω–æ –ø–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç Text.*Delimiter*.

    –°—Ä–∞–∑—É –ø—Ä–∏–º–µ—Ä, –∞ –ø–æ—Ç–æ–º —Ä–∞–∑–±–µ—Ä–µ–º –ø–æ —à–∞–≥–∞–º:
    let
        txt="–∫–∞–∫–æ–π-—Ç–æ —Ç–µ–∫—Å—Ç (—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç) –∏ —Ç–µ–∫—Å—Ç –≤–Ω–µ —Å–∫–æ–±–æ–∫",
        a = Text.AfterDelimiter(txt,"("), //—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç) –∏ —Ç–µ–∫—Å—Ç –≤–Ω–µ —Å–∫–æ–±–æ–∫
        b = Text.AfterDelimiter(txt,"(",1), //–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç) –∏ —Ç–µ–∫—Å—Ç –≤–Ω–µ —Å–∫–æ–±–æ–∫
        c = Text.AfterDelimiter(txt,"(",{0,RelativePosition.FromEnd}), //–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç) –∏ —Ç–µ–∫—Å—Ç –≤–Ω–µ —Å–∫–æ–±–æ–∫
        d = Text.BeforeDelimiter(txt,")"), //–∫–∞–∫–æ–π-—Ç–æ —Ç–µ–∫—Å—Ç (—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë
        e = Text.BeforeDelimiter(txt,")",{0,RelativePosition.FromEnd}), //–∫–∞–∫–æ–π-—Ç–æ —Ç–µ–∫—Å—Ç (—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç
        f = Text.BetweenDelimiters(txt,"(",")"), //—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë
        g = Text.BetweenDelimiters(txt,"(",")",0,{0,RelativePosition.FromEnd}),//–∫–∞–∫–æ–π-—Ç–æ —Ç–µ–∫—Å—Ç
        h = Text.BetweenDelimiters(txt,"(",")",0,{0,RelativePosition.FromStart}),//—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë
        i = Text.BetweenDelimiters(txt,"(", ")",0,Text.Length(Text.Select(txt,")"))-1), //—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç
        j = Text.BetweenDelimiters(txt,"(", ")",Text.Length(Text.Select(txt,"("))-1,0),//–∏ –µ—â—ë
        k = Text.AfterDelimiter(Text.BeforeDelimiter(txt,")", {0, RelativePosition.FromEnd}),"(")//—Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö (–∏ —Ç–µ–∫—Å—Ç–æ–º –≤ –µ—â—ë (–∏ –µ—â—ë) –æ–¥–∏—Ö —Å–∫–æ–±–∫–∞—Ö) —Å–Ω–æ–≤–∞ —Ç–µ–∫—Å—Ç
    in
        k

    a ‚Äì –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
    b ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è (–Ω–µ –∑–∞–±—ã–≤–∞–µ–º –ø—Ä–æ –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å –Ω—É–ª—è)
    —Å ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è (0 –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–≤—ã–π, –∞ FromEnd ‚Äì —Å –∫–æ–Ω—Ü–∞, —Ç–∞–∫–∂–µ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏)
    d ‚Äì —Ç–µ–∫—Å—Ç –¥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è (–¥–æ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è)
    e ‚Äì —Ç–µ–∫—Å—Ç –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è

    –ù—É, –æ–∫, –≤—Ä–æ–¥–µ –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ ‚Äì —É–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, —É–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–æ–º–µ—Ä –≤—Ö–æ–∂–¥–µ–Ω–∏—è, –Ω–æ –Ω–∞–º-—Ç–æ –Ω–∞–¥–æ –≤—ã–Ω—É—Ç—å —Ç–µ–∫—Å—Ç –º–µ–∂–¥—É —Å–∫–æ–±–æ–∫ (–æ—Ç –ø–µ—Ä–≤–æ–π –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π)‚Äì –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º:
    f ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Ç–µ–∫—Å—Ç –æ—Ç –ø–µ—Ä–≤–æ–π –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏ –¥–æ –ø–µ—Ä–≤–æ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π
    g ‚Äì –∞ –≤–æ—Ç —Ç—É—Ç –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ, –≤–µ—Ä–Ω–æ? –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –ø–æ–∑–∏—Ü–∏—é –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è –º—ã –º–æ–∂–µ–º —É–∫–∞–∑–∞—Ç—å —Å –Ω–∞—á–∞–ª–∞ –∏–ª–∏ —Å –∫–æ–Ω—Ü–∞ —Ç–µ–∫—Å—Ç–∞, –∞ –≤–æ—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è –æ—Ç—Å—á—ë—Ç –∏–¥–µ—Ç –Ω–µ –ø–æ —Ç–µ–∫—Å—Ç—É —Ü–µ–ª–∏–∫–æ–º, –∞ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è. –¢.–µ. –æ—Ç –ø–µ—Ä–≤–æ–π –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏ –ø–æ–∏—Å–∫ –ø–æ—à—ë–ª –≤ –Ω–∞—á–∞–ª–æ —Ç–µ–∫—Å—Ç–∞ –∏ –ø–æ–ª—É—á–∏–ª–∏ —Ç–æ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏
    h ‚Äì –∏ –µ—Å–ª–∏ –ø–æ–∏—Å–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å ‚Äì –ø–æ–ª—É—á–∏–º —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –≤ —à–∞–≥–µ f

    –ü–µ—á–∞–ª—å–Ω–æ, –Ω–æ –¥–µ–ª–∞–µ–º –≤—ã–≤–æ–¥ ‚Äì —Ä–∞–∑ –Ω–µ–ª—å–∑—è –ø—Ä–∏–≤—è–∑–∞—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏—è –æ–±–æ–∏—Ö —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Ç–µ–∫—Å—Ç—É, –ø—Ä–∏–¥—ë—Ç—Å—è —Å—á–∏—Ç–∞—Ç—å.
    i ‚Äì —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–∏ ‚Äì –±–µ—Ä—ë–º –ø–µ—Ä–≤—É—é –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É, –∞ –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫ Text.Length(Text.Select(txt,")"))-1 ‚Äì —Ç.–µ. –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–∏–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ —Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ —Å–∫–æ–±–∫–∏ –∏ –ø–æ–ª—É—á–∏–ª–∏ –µ–≥–æ –¥–ª–∏–Ω—É (–Ω–µ –∑–∞–±—ã–ª–∏ -1 —Ç–∞–∫ –∫–∞–∫ –Ω—É–º–µ—Ä–∞—Ü–∏—è —Å –Ω—É–ª—è)
    –ù—É –∞ –µ—Å–ª–∏ –±—ã –∑–∞–¥–∞—á–∞ —Å—Ç–æ—è–ª–∞ –Ω–∞–æ–±–æ—Ä–æ—Ç ‚Äì –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ —Å–∞–º—ã—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–∫–æ–±–æ–∫:
    j ‚Äì –≤—ã—á–∏—Å–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É –∏ –±–µ—Ä—ë–º —Ç–µ–∫—Å—Ç –¥–æ –ø–µ—Ä–≤–æ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π

    –í –ø—Ä–∏–º–µ—Ä–µ –µ—â—ë –º–∞—è—á–∏—Ç —à–∞–≥ k ‚Äì –∏ –æ–Ω –∑–¥–µ—Å—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫. –≠—Ç–æ –∫ —Ç–æ–º—É, —á—Ç–æ –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Ç–µ–∫—Å—Ç –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BetweenDelimiters ‚Äì –º–æ–∂–Ω–æ –∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é AfterDelimiter +BeforeDelimiter ‚Äì –∏ –æ–Ω–∞ –Ω–∞ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —à—É—Å—Ç—Ä–µ–µ (–ø—Ä–∏—á—ë–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —Ç–∞–∫ –Ω–∞ 10 –Ω–∞ –º–∞—Å—Å–∏–≤–µ –≤ 10k). –ü–æ—á–µ–º—É? –î–∞ –ø–æ—Ç–æ–º—É —á—Ç–æ –¥–ª—è —à—Ç–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–º –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∏—Å—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. –ü–∏—à–∏—Ç–µ –∫–∞–∫ –≤–∞–º —É–¥–æ–±–Ω–µ–µ, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å )))
    ]

[   Folder.Contents ‚Äì —Å–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–ø–∫–∏, –Ω–æ –≤—ã–±–æ—Ä–æ—á–Ω–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Folder.Contents

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ö–∞–∫-—Ç–æ –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–∞–ø–∫–∏ —Å –ø–æ–º–æ—â—å—é Folder.Files. –ï—Å–ª–∏ –Ω–µ —á–∏—Ç–∞–ª–∏ ‚Äì –≥–ª—è–Ω—å—Ç–µ —Ö–æ—Ç—å –æ–¥–Ω–∏–º –≥–ª–∞–∑–æ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ–π—á–∞—Å –±—É–¥–µ–º –Ω–µ–º–Ω–æ–∂–∫–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –º—ã—Å–ª—å. Folder.Files —Ö–æ—Ä–æ—à–∞ —Ç–µ–º, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ —Å–æ –≤—Å–µ–º–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–∞–ø–∫–∞–º–∏. –ù–æ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–µ —Å–æ–≤—Å–µ–º —ç—Ç–æ ‚Äì —Å–µ–π—á–∞—Å —Ä–∞–∑–±–µ—Ä–µ–º –ø–∞—Ä—É –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ –Ω–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è Folder.Contents

    –í–∞—Ä–∏–∞–Ω—Ç 0 ‚Äì –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏
    
    –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –≤ –ø–∞–ø–∫–µ ¬´–û—Ç—á—ë—Ç—ã¬ª —É –≤–∞—Å –ª–µ–∂–∞—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –µ—Å—Ç—å –ø–æ–¥–ø–∞–ø–∫–∏ ¬´–ò—Å—Ö–æ–¥–Ω–∏–∫–∏¬ª, ¬´–ê—Ä—Ö–∏–≤¬ª —Å –∫—É—á–µ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –≤–µ—Ä—Å–∏–π, –∫—É—Å–∫–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Ç.–¥. –ú–æ–∂–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—è—Å—å –Ω–∞ [Folder path], –∞ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–∞–∫:

        from = Folder.Contents("C:\Users\buchlotnik\Desktop\tst"),
        filtr = Table.SelectRows(from, each ([Extension] <> ""))

    –§–∏—à–∫–∞ –≤ —Ç–æ–º, —á—Ç–æ Folder.Contens –≤–µ—Ä–Ω—ë—Ç —Ç–æ—á–Ω–æ —Ç–∞–∫—É—é –∂–µ —Ç–∞–±–ª–∏—Ü—É, –∫–∞–∫ –∏ Folder.Files, –ù–û! –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ –≤—Å–µ–º –ø–æ–¥–ø–∞–ø–∫–∞–º –∏ –≤—ã–Ω–∏–º–∞—Ç—å –æ—Ç—Ç—É–¥–∞ —Ñ–∞–π–ª—ã, –æ–Ω–∞ –≤–µ—Ä–Ω—ë—Ç –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥–ø–∞–ø–∫–∏ —Å—Ç—Ä–æ–∫—É, –≥–¥–µ Extension="" –∏ Content —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ binary, –∞ table ‚Äì —Ç.–µ. —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è Folder.Files –∫ –ø–æ–¥–ø–∞–ø–∫–µ –Ω–æ –≤ —Å–≤—ë—Ä–Ω—É—Ç–æ–º –≤–∏–¥–µ.
    –ü–æ—ç—Ç–æ–º—É –≤ –∫–æ–¥–µ –≤—ã—à–µ –º—ã –ø—Ä–æ—Å—Ç–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏ –≤—Å–µ –ø–æ–¥–ø–∞–ø–∫–∏ –∏ –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã.
    –ú–æ–∂–Ω–æ –∏ –ø–æ-–¥—Ä—É–≥–æ–º—É:

        from = Folder.Contents("C:\Users\buchlotnik\Desktop\tst"),
        filtr = Table.SelectRows(from, each [Extension] = ".xlsx")

    –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –º—ã —Å—Ä–∞–∑—É –≤—ã–±—Ä–∞–ª–∏ —Ñ–∞–π–ª—ã xlsx –∏ –º–æ–∂–µ–º –±—ã—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω–æ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —ç—Ç–æ —Ñ–∞–π–ª—ã —Å—Ç—Ä–æ–≥–æ –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –∏ –Ω–∏–∫–∞–∫–æ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º—É—Å–æ—Ä –∫ –Ω–∞–º –≤ —Ç–∞–±–ª–∏—Ü—É –Ω–µ –ø–æ–ø–∞–¥—ë—Ç. –ù–µ–ø–ª–æ—Ö–æ, –ø—Ä–∞–≤–¥–∞?

    –í–∞—Ä–∏–∞–Ω—Ç1 ‚Äì –Ω—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–¥–ø–∞–ø–∫–∏
    
    –û–±—Ä–∞—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è ‚Äì –µ—Å—Ç—å –ø–∞–ø–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –ª–µ–∂–∞—Ç –∫–∞–∫–∏–µ-—Ç–æ —Ñ–∞–π–ª—ã (—á—å–∏-—Ç–æ —Å–≤–æ–¥–∫–∏, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ç.–ø.) –∏ –µ—Å—Ç—å –ø–æ–¥–ø–∞–ø–∫–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (–ø—Ä–æ–¥—É–∫—Ç–∞–º/–º–µ–Ω–µ–¥–∂–µ—Ä–∞–º/—Ñ–∏–ª–∏–∞–ª–∞–º ‚Äì –Ω—É–∂–Ω–æ–µ –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å), –≥–¥–µ —Ç–∞–∫–∂–µ –ª–µ–∂–∏—Ç –∫—É—á–∞ —Ñ–∞–π–ª–æ–≤, –∞ –≤–∞–º –Ω—É–∂–Ω–æ –≤ –∫–∞–∂–¥–æ–º —Ä–µ–≥–∏–æ–Ω–µ –Ω–∞–π—Ç–∏ –ø–æ–¥–ø–∞–ø–∫—É ¬´–ü—Ä–æ–¥–∞–∂–∏¬ª –∏ –∑–∞–±—Ä–∞—Ç—å –æ—Ç—Ç—É–¥–∞ —Å–∞–º—ã–π —Å–≤–µ–∂–∏–π —Ñ–∞–π–ª...
    –ù—É —á—Ç–æ? –§–∏–ª—å—Ç—Ä –ø–æ [Folder path], –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–µ–º—É –∂–µ –∏ –ø–æ—Ç–æ–º Table.Max? –î–∞, —Ç–∞–∫ –º–æ–∂–Ω–æ, –∞ –º–æ–∂–Ω–æ –∏ –ø–æ-–¥—Ä—É–≥–æ–º—É:

    let
        f=(x)=>[a = x{[Name="–ü—Ä–æ–¥–∞–∂–∏"]}[Content],
                b = Table.SelectRows(a, each [Extension]=".xlsx"),
                c = Table.Max(b,"Date created")[Content],
                d = Excel.Workbook(c,true){0}[Data]][d],
        
        from  = Folder.Contents("C:\Users\ buchlotnik \Desktop\tst"),
        filtr = Table.SelectRows(from, each ([Extension] = ""))[[Name],[Content]],
        tr    = Table.TransformColumns(filtr,{"Content",f}),
        to    = Table.ExpandTableColumn(tr, "Content", {"–ø—Ä–æ–¥—É–∫—Ç", "—Å—É–º–º–∞"})
    in
        to

    from  ‚Äì –æ–±—Ä–∞—Ç–∏–ª–∏—Å—å –∫ –ø–∞–ø–∫–µ
    filtr ‚Äì –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∞–ø–∫–∏ (Extension=‚Äù‚Äù), –ø–æ–ø—É—Ç–Ω–æ –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –Ω–∞—Å —Å—Ç–æ–ª–±—Ü—ã ‚Äì Name –∏ Content
    tr    ‚Äì —Å–æ–≤–µ—Ä—à–∏–ª–∏ –º–∞–≥–∏—é –Ω–∞–¥ —Å—Ç–æ–ª–±—Ü–æ–º Content —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ f
    to    ‚Äì –∏ —Ä–∞—Å–∫—Ä—ã–ª–∏ –Ω—É–∂–Ω–æ–µ –Ω–∞–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ‚Ä¶ –í—Å—ë –ø—Ä–æ—Å—Ç–æ )))

    –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å ¬´–º–∞–≥–∏–µ–π¬ª ‚Äì —Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é f:
    a ‚Äì –≤—ã–±—Ä–∞–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ–¥–ø–∞–ø–∫–∏ ¬´–ü—Ä–æ–¥–∞–∂–∏¬ª (–ø–æ–ª–µ Content —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–∞—Ö, –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë)
    b ‚Äì –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã xlsx
    —Å ‚Äì –≤—ã–±—Ä–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å –ø–æ–º–æ—â—å—é Table.Max
    d ‚Äì –Ω—É –∏ –æ–±—Ä–∞—Ç–∏–ª–∏—Å—å –∫ –Ω–µ–º—É ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤–∑—è–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Å—Ç–∞ (–≤—ã –∂–µ –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ü–æ–∫–∞–∑–∞–ª –ø—Ä–∏–º–µ—Ä—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–∞–ª—å–Ω–æ Folder.Contents —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∂–∏–∑–Ω—å. –°–∫–∞–∑–∞—Ç—å, —á—Ç–æ–± –ø—Ä—è–º —É—Å–∫–æ—Ä—è–ª–∞ ‚Äì –Ω–µ –º–æ–≥—É, –≥—Ä–∞–º–æ—Ç–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–µ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—é—Ç ‚Äì –∏—Ö –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–æ –≥—Ä–∞–º–æ—Ç–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å ))) –ù–æ –≤ —Ü–µ–ª–æ–º —Ö–æ—Ä–æ—à–∞, –ª–∞–∫–æ–Ω–∏—á–Ω–∞ –∏ –Ω–∞ –º–æ–π –≤–∫—É—Å –Ω–µ–∑–∞—Å–ª—É–∂–µ–Ω–Ω–æ –æ–±–¥–µ–ª–µ–Ω–∞ –≤–Ω–∏–º–∞–Ω–∏–µ–º. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   –ü–æ–∏—Å–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Text.Contains, Text.Upper

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –º–Ω–µ –Ω–µ–¥–∞–≤–Ω–æ —Å—Å—ã–ª–∫—É, —è –ø–æ–∫–∏–ø–µ–ª –∏ —É—Å–ø–æ–∫–æ–∏–ª—Å—è, –Ω–æ —Å–µ–≥–æ–¥–Ω—è –≤—Å–ø–ª—ã–ª–æ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ Text.Upper, –ø–æ—ç—Ç–æ–º—É —Å–Ω–æ–≤–∞ –Ω–∞–∫–∞—Ç–∏–ª–æ‚Ä¶

    –ò—Ç–∞–∫, —Ä–µ—à–∞–µ–º –∞—Ä—Ö–∏—Å–ª–æ–∂–Ω—É—é –∑–∞–¥–∞—á—É ‚Äì –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞, –≤ –Ω–µ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü, –∏ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ ‚Äì –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ –∏ —Å–æ–≤–ø–∞–≤—à–∏–µ –≤—ã–≤–µ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ä–∞–∑—Ä–µ—à–∏–º–æ–π –∑–∞–¥–∞—á—É –¥–µ–ª–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞‚Ä¶

    –ß—Ç–æ –±—ã —Ç–∞–º –Ω–∏ –≥–æ–≤–æ—Ä–∏–ª–∏, —è –Ω–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫ –º—ã—à–∫–æ–∫–ª–∞—Ü–∞ - —è –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞. –ü–æ—ç—Ç–æ–º—É —Ç—É—Ç –Ω–µ –±—É–¥–µ—Ç –¥–≤–∞–¥—Ü–∞—Ç–∏–º–∏–Ω—É—Ç–Ω–æ–≥–æ –≤–∏–¥–µ–æ –∏–ª–∏ —Å—Ç–∞—Ç—å–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü, –ø—Ä–æ—Å—Ç–æ —Ä–µ—à–∏–º –∑–∞–¥–∞—á—É:
        
        let
            tbl  = #table({"–ê—Ä—Ç–∏–∫—É–ª","–û–ø–∏—Å–∞–Ω–∏–µ"},{{1,"–¥–µ—Ç–∞–ª—å –¥–ª—è Audi"},{2,"—á—Ç–æ-—Ç–æ –¥–ª—è KIA –∏–ª–∏ ford"},{3,"–¥–ª—è BMW (–∏ –¥–ª—è audi –ø–æ–¥–æ–π–¥–µ—Ç)"}}),
            tbl1 = #table({"–ú–∞—Ä–∫–∞"},{{"AUDI"},{"BMW"},{"KIA"},{"FORD"}}),
            dict = List.Buffer(tbl1[–ú–∞—Ä–∫–∞]),
            f=(x)=> Text.Combine(
                        List.Select(
                            dict,
                            (i)=>Text.Contains(Text.Upper(x),i)
                        ),", "
                    )
            to   = Table.AddColumn(tbl,"New", each f([–û–ø–∏—Å–∞–Ω–∏–µ]))
        in
            to

    –ø–æ —à–∞–≥–∞–º:
    tbl     ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –∏—Å–∫–∞—Ç—å –±—É–¥–µ–º –ø–æ —Å—Ç–æ–ª–±—Ü—É ¬´–û–ø–∏—Å–∞–Ω–∏–µ¬ª
    tbl1    ‚Äì —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ ‚Äì –Ω—É –∫–∞–∫ —Å–ø–∏—Å–æ–∫ ‚Äì —Ç–∞–±–ª–∏—Ü–∞, –≤–∑—è—Ç–∞—è —Å –ª–∏—Å—Ç–∞
    dict    ‚Äì –ø–µ—Ä–≤–æ–µ, —á—Ç–æ –¥–µ–ª–∞–µ–º ‚Äì –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –≤ —Å–ø–∏—Å–æ–∫, –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –µ–≥–æ –∑–∞–±—É—Ñ–µ—Ä–∏—Ç—å ‚Äì –Ω–∞–º –∫ –Ω–µ–º—É –ø—Ä–∏–¥—ë—Ç—Å—è –æ–±—Ä–∞—â–∞—Ç—å—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
    f       ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ ‚Äì –ø—Ä–∏–Ω—Ü–∏–ø –ø—Ä–æ—Å—Ç–æ–π ‚Äì –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤, –≤—ã–±–∏—Ä–∞–µ–º –∏–∑ –Ω–µ–≥–æ –≤—Å—Ç—Ä–µ—Ç–∏–≤—à–∏–µ—Å—è –∏ —Å–æ–±–∏—Ä–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å. –¢–µ–ø–µ—Ä—å –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–±–æ—Ä–∞ ‚Äì –∑–¥–µ—Å—å —É –Ω–∞—Å Text.Contains, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤–Ω—É—Ç—Ä–∏ Text.Upper. –ó–∞—á–µ–º? –î–∞ –ø—Ä–æ—Å—Ç–æ Comparer.OrdinalIgnoreCase, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç, —à—Ç—É–∫–∞ –º–µ–¥–ª–µ–Ω–Ω–∞—è, –∞ –ø–µ—Ä–µ–≤–µ–¥—è —Ç–µ–∫—Å—Ç –≤ –≤–µ—Ä—Ö–Ω–∏–π (–∏–ª–∏ –≤ –Ω–∏–∂–Ω–∏–π) —Ä–µ–≥–∏—Å—Ç—Ä –º—ã —Å–∏–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ–º –∏ —É—Å–∫–æ—Ä—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
    to      ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞

    –í—Å—ë‚Ä¶ –ü—è—Ç—å —Å—Ç—Ä–æ—á–µ–∫ –∫–æ–¥–∞.

    –ù–∞ –ø—Ä–∏–º–µ—Ä–µ —Å –æ–¥–Ω–æ–≥–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Å–∞–π—Ç–∞ —ç—Ç–æ—Ç –∫–æ–¥ –æ–±–æ—à—ë–ª –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –º—ã—à–∫–æ–∫–ª–∞—Ü–Ω—ã–π –≤—Å–µ–≥–æ-—Ç–æ –≤ 6 —Ä–∞–∑ (–Ω–∞ 100k —Å—Ç—Ä–æ–∫).
    –ü—Ä–∏ —ç—Ç–æ–º –µ—â—ë 4% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –µ—Å–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ —Ç–∞–∫:

        to = Table.FromList(
                Table.ToList(from,(x)=>x & {f(x{1})} ),
                (x)=>x,
                Table.ColumnNames(from) & {"New"}
             )
        (–º—ã —ç—Ç–æ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏ —Ç—É—Ç)

    –í —Ä–µ—à–µ–Ω–∏–∏ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π ¬´—Ö–∏—Ç—Ä–æ–π¬ª —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏—ë–º–∞. –¢–æ—Ç –∂–µ Upper (–∏–ª–∏ Lower) –∞–±—Å–æ–ª—é—Ç–Ω–æ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ SQL –∏–ª–∏ php, –Ω–∞–ø—Ä–∏–º–µ—Ä. –ü–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –Ω–∞—á–∏–Ω–∞—Ç—å –º—É—á–∞—Ç—å –º—ã—à—å, –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤—Å—ë –∂–µ –∑–∞–¥—É–º–∞—Ç—å—Å—è ‚Äì –º–æ–∂–µ—Ç –∏ –ø—Ä–∞–≤–¥–∞ —Å—Ç–æ–∏—Ç —É–∂–µ –æ—Ç–∫—Ä—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ —á—Ç–æ-—Ç–æ —Ç–∞–º –Ω–∞–ø–∏—Å–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –ù—É —Ö–æ—Ç—è –±—ã, –ø–æ–≤—Ç–æ—Ä–∏—Ç—å, –Ω–µ –ø–æ–¥—Å–º–∞—Ç—Ä–∏–≤–∞—è, —Ä–µ—à–µ–Ω–∏–µ –≤—ã—à–µ. –ù–µ–º–Ω–æ–∂–∫–æ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ —Ä—É–∫–∏ —Å–∞–º–∏ –Ω–∞—á–Ω—É—Ç –∞–≤—Ç–æ–º–∞—Ç–æ–º —Ç—è–Ω—É—Ç—å—Å—è –∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ ‚Äì –∞ —Ç–∞–º –∏ –¥–æ –ø–æ—Å—Ç–∞ –≤ —Ç–∞–Ω–∫–µ –Ω–µ–¥–∞–ª–µ–∫–æ‚Ä¶
    ]

[   –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –ø—Ä–∏—ë–º—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ—Ä–∞ –∑–∞–∫—Ä—ã—Ç—å —Ç–µ–º—É –∑–∞–º–µ–Ω –≤ —Ç–µ–∫—Å—Ç–µ. –ú—ã —É–∂–µ –ø—Ä–∏–º–∞—Ç—ã–≤–∞–ª–∏ "—Å–ª–æ–≤–∞—Ä—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö" –¥–ª—è –∑–∞–º–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª–∏–∫–æ–º –∏ –¥–ª—è –ø–æ—Å–∏–º–≤–æ–ª—å–Ω—ã—Ö –∑–∞–º–µ–Ω, –Ω–æ –±—ã–≤–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å –∑–∞–º–µ–Ω—É –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—Å—Ç–∞, –ø—Ä–∏—á—ë–º –∏–º–µ–µ—Ç—Å—è —Ä—è–¥ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –¢—É—Ç —É–∂–µ –Ω–µ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ Text.Replace –∏ —è –Ω–µ –∑–Ω–∞—é –±–æ–ª–µ–µ —à—É—Å—Ç—Ä–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞, —á–µ–º –∑–∞–ø–∏—Ö–Ω—É—Ç—å —ç—Ç–æ –≤ List.Accumulate. –ü–æ—ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–±–µ—Ä–µ–º –ø—Ä–∏–º–µ—Ä:

    let
        tbl = #table({"—Ç–µ–∫—Å—Ç","—á–∏—Å–ª–æ"},{{"–º–∞–º–∞ –º—ã–ª–∞ —Ä–∞–º—É",1},{"–æ—Ç–º—ã–ª–∞ –º–∞–º–æ—á–∫–∞ —Ä–∞–º–æ—á–∫—É",2}}),
        tb2 = #table({"—á—Ç–æ","–Ω–∞ —á—Ç–æ"},{{"–º–∞–º","–ø–∞–ø"},{"–º—ã–ª–∞","–ø–∏–ª"},{"—Ä–∞–º","–ø–∏–≤"}}),
        dict = List.Buffer(Table.ToList(tb2,(x)=>x)),
        f = (x)=>List.Accumulate(dict,x,(s,c)=>Text.Replace(s,c{0},c{1})),
        to = Table.TransformColumns(tbl,{"—Ç–µ–∫—Å—Ç",f})
    in
        to

    tbl ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü —Ç–µ–∫—Å—Ç
    tb2 ‚Äì —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∑–∞–º–µ–Ω
    dict ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–∞–±–ª–∏—Ü—É –∑–∞–º–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ –∏ –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –µ–≥–æ –∑–∞–±—É—Ñ–µ—Ä–∏—Ç—å
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º List.Accumulate, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–º–µ–Ω (—Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤, –µ—Å–ª–∏ —Ç–æ—á–Ω–µ–µ), –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —Å–∞–º —Ç–µ–∫—Å—Ç, –Ω—É –∏ —Ñ—É–Ω–∫—Ü–∏—è ‚Äì –ø—Ä–æ—Å—Ç–æ Text.Replace
    to ‚Äì –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –∫ —Å—Ç–æ–ª–±—Ü—É (–∞ –º–æ–∂–Ω–æ –∏ –∫ —Å—Ç–æ–ª–±—Ü–ê–ú)

    –í—Å—ë‚Ä¶ –ü–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ —Ç–∞–±–ª–∏—Ü–∞–º, —Å–¥–µ–ª–∞–ª–∏ –∏–∑ –æ–¥–Ω–æ–π —Å–ª–æ–≤–∞—Ä—å, —Å–≤–µ—Ä—Å—Ç–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –µ—ë. –ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö —Ç–µ–ª–æ–¥–≤–∏–∂–µ–Ω–∏–π, –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –ø—Ä–æ—á–µ–≥–æ ))) –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   Record.From‚Ä¶ - –∏–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è –Ω–∞ –∑–∞–ø–∏—Å—è—Ö / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –ø—Ä–∏—ë–º—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –°–µ–≥–æ–¥–Ω—è –≤ –ª–∏—á–∫–µ —É–∑–Ω–∞–ª, —á—Ç–æ –¥–∂–æ–π–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–∞–∑—ã –±—ã—Å—Ç—Ä–µ–µ —Å–ª–æ–≤–∞—Ä—è –Ω–∞ –∑–∞–ø–∏—Å—è—Ö. –ù–µ–º–Ω–æ–∂–∫–æ —Ä–∞—Å—Å—Ç—Ä–æ–∏–ª—Å—è, —É–¥–∏–≤–∏–ª—Å—è, –ø–æ—Ç–æ–º —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –∏ –ø–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –ø–æ—Å—Ç )))

    –ò—Ç–∞–∫, –Ω–∞–ø–æ–º–∏–Ω–∞—é –∑–∞–¥–∞—á—É ‚Äì –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
    #table({"–î–æ–ª–∂–Ω–æ—Å—Ç—å","–û–∫–ª–∞–¥","–ü—Ä–µ–º–∏—è"},{{"–ò–≥—Ä–æ–∫",1000,100},{"–¢—Ä–µ–Ω–µ—Ä",2000,5000},{"–í—Ä–∞—á",100,1}})
    –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å—å
    [–ò–≥—Ä–æ–∫={1000,100},–¢—Ä–µ–Ω–µ—Ä={2000,5000},–í—Ä–∞—á={100,1}]
    –ö–æ—Ç–æ—Ä—É—é –º—ã –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ Record.Field –∏–ª–∏ Record.FieldOrDefault

    –í—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é –≤ –≤–∏–¥–µ —Ñ—É–Ω–∫—Ü–∏–π. –í –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º –ø–æ—Å—Ç–µ –±—ã–ª–∞ —Ç–∞–∫–∞—è:
    f=(table)=>List.Accumulate(Table.ToRows(table),[],(s,c)=>Record.AddField(s,c{0},List.Skip(c)))
    –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ —É—Å–∫–æ—Ä–∏—Ç—å:
    f=(table)=>List.Accumulate(Table.ToList(from,(x)=>{x{0},List.Skip(x)}),[],(s,c)=>Record.AddField(s,c{0},c{1}))
    –û–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –≤–ø–æ–ª–Ω–µ —Ä–∞–±–æ—á–∏–µ, –¥–∞–∂–µ —à—É—Å—Ç—Ä—ã–µ, –Ω–æ –Ω–∞ –æ–±—ä—ë–º–∞—Ö —Å–ª–æ–≤–∞—Ä—è –¥–æ 100 –ø–æ–∑–∏—Ü–∏–π. –ü—Ä–∏—á–∏–Ω–∞ ‚Äì —Å–∞–º –ø–æ —Å–µ–±–µ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–ø–∏—Å–∫–æ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø–æ—ç—Ç–æ–º—É –Ω–∏–∫–∞–∫–∏—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –∏ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö –ø—Ä–æ—Å—Ç–æ –ø–∞–¥–∞–µ—Ç (–ø–æ—ç—Ç–æ–º—É –¥–µ–ª–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å –Ω–∞ 5k –ø–æ–∑–∏—Ü–∏–π —á–µ—Ä–µ–∑ –Ω–µ–≥–æ –Ω–µ –Ω–∞–¥–æ ‚Äì —ç—Ç–æ –∏ –ø—Ä–∞–≤–¥–∞ –≤ —Ä–∞–∑—ã –º–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–∂–æ–π–Ω–æ–≤)

    –û–∫, —á—Ç–æ –µ—Å—Ç—å –≤ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ ‚Äì –ø–æ–π–¥—ë–º —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—ã (Record.FromTable):
    f=(table)=>[nms = Table.ColumnNames(table),
                comb = Table.CombineColumns(table,List.Skip(nms),(x)=>x,"Value"),
                res = Record.FromTable(Table.RenameColumns(comb,{nms{0},"Name"}))][res]
    –Ω–∞ –æ–±—ä–µ–º–∞—Ö –¥–æ 100 ‚Äì —ç—Ç–æ –≤–æ–æ–±—â–µ —Å–∞–º—ã–π —à—É—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –∫ 1000 –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –Ω–∏–∂–µ, –Ω—É –∏ –ø–æ—Ç–æ–º –ø–æ—Ç–∏—Ö–æ–Ω—å–∫—É –æ—Ç—Å—Ç–∞—ë—Ç
    –î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —è —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª —Ä–∞–Ω–µ–µ:
    f=(table)=>Record.FromTable(Table.FromList(Table.ToList(table,(x)=>{x{0},List.Skip(x)}),(x)=>x,{"Name","Value"}))
    –¢–∞–∫–∂–µ –∫—Ä–∞–π–Ω–µ —à—É—Å—Ç—Ä—ã–π –∏ –æ—â—É—Ç–∏–º–æ –æ—Ç—Å—Ç–∞—ë—Ç –æ—Ç –ª–∏–¥–µ—Ä–æ–≤ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±—ä—ë–º–∞—Ö –≤ 100k –∏ –±–æ–ª–µ–µ.

    –ù—É –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø–∞—Ä–æ—á–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ ‚Äì —Ä–∞–∑—É–º–µ–µ—Ç—Å—è –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö (Record.FromList). –û–Ω–∏ —Å–∞–º—ã–µ —à—É—Å—Ç—Ä—ã–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö (–æ—Ç 10k):
    f=(table)=>Record.FromList(Table.ToList(table,(x)=>List.Skip(x)),Table.Column(table,Table.ColumnNames(table){0}))
    –∑–¥–µ—Å—å –Ω–µ–º–Ω–æ–∂–∫–æ –∫—Ä–∏–≤–æ –ø–æ–ª—É—á–µ–Ω—ã –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π ‚Äì —á–µ—Ä–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø–µ—Ä–≤–æ–º—É —Å—Ç–æ–ª–±—Ü—É, –Ω–æ –ø–æ—Å–∫–æ–ª—å–∫—É –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ‚Äì —ç—Ç–æ –≤—Å—ë —Ä–∞–≤–Ω–æ —à—É—Å—Ç—Ä–æ
    –ù–æ –Ω–∞ —É–¥–∏–≤–ª–µ–Ω–∏–µ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–º (–∏ —á–µ–º–ø–∏–æ–Ω–æ–º –Ω–∞ –æ–±—ä—ë–º–∞—Ö –æ—Ç 1000) —Å—Ç–∞–ª –≤–∞—Ä–∏–∞–Ω—Ç:
    f=(table)=>Record.FromList(Table.ToList(table,(x)=>List.Skip(x)),Table.ToColumns(table){0})
    –≤–∑—è—Ç—å –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∏–∑ —Å–ø–∏—Å–∫–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ–ª—É—á–∏–ª–æ—Å—å –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –≤–∑—è—Ç—å –æ–¥–∏–Ω, –Ω–æ –ø–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–º—É –∏–º–µ–Ω–∏.

    –í –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º —Å–ª–æ–∂—É —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–æ–º–µ—Ä–∞–º–∏ —Å–∫–æ—Ä–æ—Å—Ç–µ–π. –ï—â—ë —Ä–∞–∑ –ø–æ–≤—Ç–æ—Ä—é—Å—å ‚Äì –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–±–æ—á–∏–µ, –Ω–æ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–∏. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤–¥—Ä—É–≥ –¥–∂–æ–π–Ω—ã –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —à—É—Å—Ç—Ä–µ–µ ‚Äì –∑–∞–¥—É–º–∞–π—Ç–µ—Å—å, –∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Å–æ–±—Ä–∞–Ω —Å–ª–æ–≤–∞—Ä—å )))
    ]

[   –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö —Ç–∞–±–ª–∏—Ü—ã ‚Äì Replacer, Splitter –∏–ª–∏ –ø—Ä–∏—á—ë–º —Ç—É—Ç FromList / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Text.Replace, Text.BeforeDelimiter, Table_ReplaceValue

    –î–æ–±—Ä—ã–π –¥–µ–Ω—å, –¥–∞–º—ã –∏ –≥–æ—Å–ø–æ–¥–∞.
    –î–æ–≤–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ–µ —è–≤–ª–µ–Ω–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö ‚Äì –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ä—è–¥—É —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è. –û—Å—Ç–∞–≤–∏–º –∑–∞ —Ä–∞–º–∫–∞–º–∏ –¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è –≤ –∞–¥—Ä–µ—Å —Å–æ—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π —Ç–∞–±–ª–∏—Ü –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –º—ã –º–æ–∂–µ–º —Å —ç—Ç–∏–º —Å–¥–µ–ª–∞—Ç—å.

    –ü—Ä–∏–º–µ—Ä: 
        tbl = #table({"–¢–æ–≤–∞—Ä—ã","–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç"},{{"–¢–æ–≤–∞—Ä1","1 —à—Ç.","2 —à—Ç.","3 —à—Ç."},{"–¢–æ–≤–∞—Ä2","10 —à—Ç.","20 —à—Ç.","30 —à—Ç."}})

    1-—ã–π –°–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è: –ù–µ –ø—Ä–∏–±–µ–≥–∞—è –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—É ‚Äì —á–µ—Ä–µ–∑ ¬´–º—ã—à–∫–æ–∫–ª–∞—Ü¬ª.

        to  = Table.ReplaceValue(tbl," —à—Ç.","",Replacer.ReplaceText,{"–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç"})

    –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ —Å—Ä–∞–∑—É –ø—Ä–∏–Ω–æ—Å–∏—Ç –±–æ–ª—å, –µ—Å–ª–∏ –ø–æ–º–µ–Ω—è—é—Ç—Å—è/–¥–æ–±–∞–≤—è—Ç—Å—è –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π. –û—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —É—á–µ—Å—Ç—å, —á—Ç–æ –Ω–∞–º –ø–æ—Ç–æ–º –µ—â—ë –ø–æ —ç—Ç–æ–º—É –∂–µ —Å–ø–∏—Å–∫—É –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Ç–∏–ø–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —á–∏—Å–ª–æ–≤—ã–µ.
    –ü–µ—Ä–µ–ø–∏—à–µ–º –≤ –±–æ–ª–µ–µ —Ä–∞–±–æ—á–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:

        let
            tbl = #table({"–¢–æ–≤–∞—Ä—ã","–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç"},{{"–¢–æ–≤–∞—Ä1","1 —à—Ç.","2 —à—Ç.","3 —à—Ç."},{"–¢–æ–≤–∞—Ä2","10 —à—Ç.","20 —à—Ç.","30 —à—Ç."}}),
            nms = List.Skip(Table.ColumnNames(tbl)),
            rep = Table.ReplaceValue(tbl," —à—Ç.","",Replacer.ReplaceText,nms),
            to  = Table.TransformColumnTypes(rep,List.Transform(nms,(i)=>{i,Number.Type}))
        in
            to 

    –î–æ–ø–∏–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–µ—Å—å–º–∞ —à—É—Å—Ç—Ä. –ù–æ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç Table.ReplaceValue, —á—Ç–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞—Å–Ω–æ–π —Ç—Ä—è–ø–∫–æ–π. –ß—Ç–æ –º–æ–∂–µ–º –ø—Ä–æ—Ç–∏–≤–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ–º—É –ø–æ–¥—Ö–æ–¥—É?

    2-–æ–π –°–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è:

    let
        tbl = #table({"–¢–æ–≤–∞—Ä—ã","–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç"},{{"–¢–æ–≤–∞—Ä1","1 —à—Ç.","2 —à—Ç.","3 —à—Ç."},{"–¢–æ–≤–∞—Ä2","10 —à—Ç.","20 —à—Ç.","30 —à—Ç."}}),
        f=(x) as number =>Number.From(Text.BeforeDelimiter(x," ")),
        to = Table.TransformColumns(tbl,{"–¢–æ–≤–∞—Ä—ã",(x)=>x},f)
    in
        to


    f-—Ñ—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∫–∏ —Ç–µ–∫—Å—Ç–∞ –¥–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –ø—Ä–æ–±–µ–ª. –û–Ω–∞ —Å—Ä–∞–∑—É –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —á–∏—Å–ª–æ –∏ –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞—è–≤–ª–µ–Ω —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äì —Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É —Å ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏¬ª —á–∏—Å–ª–æ–≤—ã–º–∏ —Å—Ç–æ–ª–±—Ü–∞–º–∏.
    to ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–µ–π —á–µ—Ä–µ–∑ –æ–ø–∏—Å–∞–Ω–Ω—É—é –≤—ã—à–µ —Ñ—É–Ω–∫—Ü–∏—é

    –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ, –ª–∞–∫–æ–Ω–∏—á–Ω–æ–µ, –ù–û –º–µ–¥–ª–µ–Ω–Ω–æ–µ. –í –¥–≤–∞ —Ä–∞–∑–∞ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç Table.ReplaceValue. –ü–∞–∫–µ—Ç–æ–º –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –∞ –ø–æ—Ç–æ–º —Ç–∞–∫–∂–µ –ø–∞–∫–µ—Ç–æ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ.
    –ò –≤–æ—Ç –≤–æ–æ—Ä—É–∂–∏–≤—à–∏—Å—å —ç—Ç–∏–º –∑–Ω–∞–Ω–∏–µ–º –ø—Ä–µ–¥–ª–æ–∂–∏–º —Ç—Ä–µ—Ç–∏–π —Å–ø–æ—Å–æ–±:

    3-–∏–π –°–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è:

        let
            tbl =   #table({"–¢–æ–≤–∞—Ä—ã","–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç"},{{"–¢–æ–≤–∞—Ä1","1 —à—Ç.","2 —à—Ç.","3 —à—Ç."},{"–¢–æ–≤–∞—Ä2","10 —à—Ç.","20 —à—Ç.","30 —à—Ç."}}),
            nms =   Table.ColumnNames(tbl),
            f=(x)=>Text.Replace(x," —à—Ç.",""),
            lst =   List.Transform(Table.ToList(tbl),f),
            t   =   Table.FromList(lst,Splitter.SplitTextByDelimiter(","),nms),
            to  =   Table.TransformColumnTypes(t,
                        List.Transform(
                            List.Skip(nms),
                            (i)=>{i,Number.Type}
                        )
                    )
        in
            to

    –¢–∞–±–ª–∏—Ü—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º –≤ —Å–ø–∏—Å–æ–∫ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–º–µ–Ω—ã —Ç–µ–∫—Å—Ç–∞ –∏ –¥–∞–ª–µ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü—É.
    –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ —Å—Ç–µ–Ω–¥–µ –ø–æ–∫–∞–∑–∞–ª –Ω–µ–ø–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Ç—Ä–µ—Ç—å–µ–º—É —Ä–µ—à–µ–Ω–∏—é –Ω–∞ 5K —Å—Ç—Ä–æ–∫.

    –û —á–µ–º —ç—Ç–æ—Ç –ø–æ—Å—Ç:
    –í—ã–±–æ—Ä —Ä–µ—à–µ–Ω–∏—è —Ç–æ–π –∏–ª–∏ –∏–Ω–æ–π –∑–∞–¥–∞—á–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –ö—Ç–æ-—Ç–æ —Ç–µ—Ä–µ–±–∏—Ç –º—ã—à–∫—É –∏ –∫–ª–∞—Ü–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è, –∞ –∫—Ç–æ-—Ç–æ —á–µ—Ä–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤–Ω–æ—Å–∏—Ç –∫–æ–¥ —Ä—É–∫–∞–º–∏. –ï—Å–ª–∏ –¥–ª—è –í–∞—Å –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –º—ã—à–∫–æ–π ‚Äì —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è –∫ —Ç—Ä–µ—Ç—å–µ–º —Ä–µ—à–µ–Ω–∏—é –ø–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é —Ç–µ–∫—Å—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã. –ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —É –í–∞—Å —Ä–æ–¥–∏—Ç—Å—è –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ—à–µ–Ω–∏—è ‚Äì –±—É–¥–µ—Ç –Ω–µ–ø–ª–æ—Ö–æ –∏—Ö –ø–æ–∫–∞–∑–∞—Ç—å –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –∏—Ö —Å—Ä–∞–≤–Ω–∏—Ç—å –∏ –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ.
    ]

[   #duration + Function.Invoke –∏–ª–∏ –∫–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–æ–º / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Function.Invoke, #duration

    –ü–∞—Ä—É –¥–Ω–µ–π –Ω–∞–∑–∞–¥ –≤ —á–∞—Ç–µ –≤—Å–ø–ª—ã–ª–∞ –∑–∞–¥–∞—á–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º—è (—Ç–æ—á–Ω–µ–µ —Ç–µ–∫—Å—Ç) –≤–∏–¥–∞ "35:40:06" –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≤—Ä–µ–º—è.
    –ù—É–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ M –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–æ–±–Ω—ã—Ö –≤–æ–ª—å–Ω–æ—Å—Ç–µ–π ‚Äì #time, #date, #datetime, #datetimezone ‚Äì —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ –∑–∞–¥–∞–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞—Ö ‚Äì —á–∞—Å–æ–≤ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ 23, —Å–µ–∫—É–Ω–¥ –∏ –º–∏–Ω—É—Ç –±–æ–ª—å—à–µ 59 –∏ —Ç.–¥. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ #duration (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å) ‚Äì —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–≤–∞—Ä–∏–≤–∞–µ—Ç —á—Ç–æ —É–≥–æ–¥–Ω–æ –∏ –≤—ã–¥–∞—ë—Ç –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:
    #duration(0,0,0,1000000) //11.13:46:40
    –¢.–µ. –º–∏–ª–ª–∏–æ–Ω —Å–µ–∫—É–Ω–¥ –¥–∞—ë—Ç –Ω–∞–º 11 –¥–Ω–µ–π 13 —á–∞—Å–æ–≤ 46 –º–∏–Ω—É—Ç –∏ 40 —Å–µ–∫—É–Ω–¥ ‚Äì —à—Ç—É–∫–∞ —É–¥–æ–±–Ω–∞—è –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ Unix-–≤—Ä–µ–º–µ–Ω–∏ –≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ:
    #datetime(1970,1,1,0,0,0)+#duration(0,0,0,1671278969) //17.12.2022 12:09:29

    –û–∫, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω –∏ —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –µ–≥–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å.
    –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –ø—Ä–µ–≤—Ä–∞—â–∞—é—â—É—é —Ç–µ–∫—Å—Ç –≤—ã—à–µ –≤ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
    f=(x)=>let
    h = Number.From(Text.BeforeDelimiter(x,":")),
    m = Number.From(Text.BetweenDelimiters(x,":",":")),
    s = Number.From(Text.AfterDelimiter(x,":",1))
    in
    #duration(0,h,m,s)
    –¢.–µ. –≤–∑—è–ª–∏ —Ç–µ–∫—Å—Ç –¥–æ –¥–≤–æ–µ—Ç–æ—á–∏—è, –º–µ–∂–¥—É –¥–≤–æ–µ—Ç–æ—á–∏—è–º–∏ –∏ –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ –¥–≤–æ–µ—Ç–æ—á–∏—è, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –≤ —á–∏—Å–ª–∞ –∏ –∑–∞–ø–∏—Ö–Ω—É–ª–∏ –≤ #duration ‚Äì —Ç–∞–∫ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç–µ–ª–æ–¥–≤–∏–∂–µ–Ω–∏–π (–Ω–∞–π–¥—É—Ç—Å—è, –∫–æ–Ω–µ—á–Ω–æ, —Ç–µ, –∫—Ç–æ —Å–∫–∞–∂–µ—Ç - "–∑–∞—Ç–æ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ" - –Ω–æ –ø–æ–ª—É—á–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø—Ä–æ—Å—Ç–æ –∏–∑-–∑–∞ —É–¥–æ–±—Å—Ç–≤–∞ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥ —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω–æ).
    –û–ö, –∫–∞–∫ –±—ã —É—Å–∫–æ—Ä–∏—Ç—å—Å—è? –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª–∏–º —Ç–µ–∫—Å—Ç –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é:
    f=(x)=>[a=List.Transform(Text.Split(x,":"),Number.From),b=#duration(0,a{0},a{1},a{2})][b]
    –¢–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ (–≤ —Ä–∞–∑—ã) –±—ã—Å—Ç—Ä–µ–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª, –∞ –ø–æ—Ç–æ–º –µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥–∞–ª–∏ –≤ #duration (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º—ã—à–∫–æ–∫–ª–∞—Ü ‚Äì —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é, –¥–æ–±–∞–≤–∏—Ç—å –≤—ã—á–∏—Å–ª—è–µ–º—ã–π, —É–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–µ–µ ‚Äì –≤—Å—ë —Ç–æ –∂–µ —Å–∞–º–æ–µ, –ø—Ä–æ—Å—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ä–∞–∑–∞ –≤ –ø–æ–ª—Ç–æ—Ä–∞).

    –ù–æ —Ö–æ—á–µ—Ç—Å—è –∫—Ä–∞—Å–æ—Ç—ã ‚Äì –∫–∞–∫ –±—ã –Ω–µ –¥–µ–ª–∞—Ç—å –¥–≤–∞ —à–∞–≥–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏, –∞ –≤–æ—Ç —Å—Ä–∞–∑—É –ø–µ—Ä–µ–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç Text.Split –≤ #duration? –î–µ–ª–æ –±—ã–ª–æ —É—Ç—Ä–æ–º –∏ —è –∫–∞–∫-—Ç–æ —Å—Ä–∞–∑—É –∏ –Ω–µ —Å–æ–æ–±—Ä–∞–∑–∏–ª, –Ω–æ –≤ —á–∞—Ç —Å—Ç—Ä–µ–º–∏—Ç–µ–ª—å–Ω–æ –≤–æ—Ä–≤–∞–ª—Å—è @IlyaNazarov –∏ —è–≤–∏–ª –º–∏—Ä—É –≤–æ—Ç —ç—Ç–æ:
    f=(x)=>Function.Invoke(#duration,{0}&List.Transform(Text.Split(x,":"),Number.From))
    –ù—É —Å–∫–∞–∑–∫–∞, –∞ –Ω–µ –∫–æ–¥! - Function.Invoke –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–≤—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —Ñ—É–Ω–∫—Ü–∏—é (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ #duration), –∞ –≤—Ç–æ—Ä—ã–º ‚Äì —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ ‚Äì —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞—à–µ–≥–æ Text.Split, –Ω–æ —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –≤ –Ω–∞—á–∞–ª–µ {0}- -–ø–æ—Ç–æ–º—É —á—Ç–æ –≤ —Ç–µ–∫—Å—Ç–µ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–Ω–µ–π, –∞ –∞—Ä–≥—É–º–µ–Ω—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π.
    –ù—É –∏ –∫–∞–∫ –±—ã –≤—Å—ë ‚Äì –Ω–∞ –ª–µ—Ç—É –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥–∞–Ω –≤ —Ñ—É–Ω–∫—Ü–∏—é. –ü—Ä–∏—Ä–æ—Å—Ç –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–µ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π, –Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –í—Å–µ –ø—Ä–æ–º–µ—Ä—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ –≤ –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º.

    –ò–ª—å—è, —Å–ø–∞—Å–∏–±–æ –∑–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ!
    –ê –≤ —Ü–µ–ª–æ–º –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –µ—Å—Ç—å —Ç–∞–∫–æ–π –∫–ª–∞—Å—Å —Ñ—É–Ω–∫—Ü–∏–π ‚Äì Function. ‚Äì –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–Ω–∏ –±—ã–≤–∞—é—Ç –ø–æ–ª–µ–∑–Ω—ã. –ö—É—Ä–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É ‚Äì –≤ –Ω–µ–π –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ )))
    ]

[   Expression.Evaluate –∏–ª–∏ –∫–∞–∫ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–ª–∏ —Å —Å–∞–π—Ç–∞? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Expression.Evaluate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –û—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –æ–¥–Ω–∏–º –ø—Ä–∏—ë–º–æ–º, –Ω—É –∏ —Ä–µ—à–∏–ª –æ –Ω—ë–º –Ω–∞–ø–∏—Å–∞—Ç—å.
    –ù–∞—á–Ω—ë–º –∏–∑–¥–∞–ª–µ–∫–∞ ‚Äì —Å –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∫–∏. –í–æ—Ç –∑–∞–≥—Ä—É–∑–∏–ª–∏ –≤—ã —Ñ–∞–π–ª, –∞ —Ç–∞–º –≤ —è—á–µ–π–∫–∞—Ö –ª—é–±–µ–∑–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω—ã —Å—É–º–º—ã "123+234+345", "1234+234" –∏ —Ç.–¥. –ò –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —ç—Ç–æ –≤ —á–∏—Å–ª–∞. –û–¥–Ω–æ –∏–∑ —Ä–µ—à–µ–Ω–∏–π —Ç–∞–∫–æ–µ:
    Expression.Evaluate("123+234+345") //702
    –¢.–µ. —Ñ—É–Ω–∫—Ü–∏—è Expression.Evaluate –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –µ–≥–æ.
    –í—ã—Ä–∞–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º:
    Expression.Evaluate("123+234+345=702")//true
    –¢.–µ. –º—ã –ø–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã.

    –ò —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –Ω–∞–¥–æ —Ç–µ–∫—Å—Ç –≤–∏–¥–∞ "1-5,8,10-12" –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
    Expression.Evaluate("{"&Text.Replace("1-5,8,10-12","-","..")&"}")//{1,2,3,4,5,8,19,11,12}
    –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ "{1..5,8,10..12}" –∏ –ø–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–∞—Å—Ç –Ω–∞–º –∏—Å–∫–æ–º—ã–π —Å–ø–∏—Å–æ–∫.

    –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–¥–æ–±–Ω–æ. –ò –º–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –¥–∞–∂–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ —á–∏—Å–µ–ª –æ—Ç 1 –¥–æ x:
    f = (x)=>Expression.Evaluate("{1..x}")
    –ù–æ –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ –æ–Ω–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äì "–∏–º—è x –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–µ–∫—É—â–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ". –ü—Ä–∏—á–∏–Ω–∞ ‚Äì x –≤ —Ç–µ–∫—Å—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è ‚Äì —ç—Ç–æ –ª–∏—à—å –±—É–∫–≤–∞, –∞ –Ω–∞–º –Ω–∞–¥–æ –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ –∑–∞—è–≤–∏—Ç—å, —á—Ç–æ —ç—Ç–∞ –±—É–∫–≤–∞ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –∏–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç:
    f = (x)=>Expression.Evaluate("{1..x}",[x=x])
    –ó–¥–µ—Å—å x –¥–æ –∑–Ω–∞–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ ‚Äì —ç—Ç–æ –∏–º—è –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏, –∞ –ø–æ—Å–ª–µ –∑–Ω–∞–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ ‚Äì —Ç–æ—Ç —Å–∞–º—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤—ã –æ—Å–æ–∑–Ω–∞–µ—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–∫—Ç, –ø—Ä–∏–¥—ë—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏ —Ñ—É–Ω–∫—Ü–∏–∏:
    f = (x)=>Expression.Evaluate("List.Sum({1..x})",[x=x,List.Sum=List.Sum])
    –¢–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ –ª–æ–≥–∏–∫–æ–π - List.Sum –¥–æ –∑–Ω–∞–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–º—è –∏–∑ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –∞ –ø–æ—Å–ª–µ –∑–Ω–∞–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ ‚Äì —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –¥–∞–Ω–Ω–æ–º—É –∏–º–µ–Ω–∏.

    –ò –≤–æ—Ç —Ç—É—Ç –º—ã –∏ –ø–æ–¥—Ö–æ–¥–∏–º –∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–¥–∞—á–µ –ø–æ—Å—Ç–∞ ‚Äì –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ ‚Äì –º–æ–∂–µ–º –ª–∏ –º—ã –µ–≥–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ –∫–∞–∫ —Ç–µ–∫—Å—Ç, –∞ –∏–º–µ–Ω–Ω–æ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å? –ò –æ—Ç–≤–µ—Ç ‚Äì –¥–∞, –º–æ–∂–µ–º. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –≤–æ—Ç —Ç–∞–∫, –∫–∞–∫ –≤—ã—à–µ, –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ –∏ –∫—Ä–∞–π–Ω–µ –Ω–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ. –ß—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å? –î–∞ –≤–æ—Ç —á—Ç–æ:
    f = (x)=>Expression.Evaluate("List.Sum({1..x})",#shared&[x=x])
    –ó–¥–µ—Å—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è #shared –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã ‚Äì —Ç.–µ. –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∏–ø—ã, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —Ç.–¥., –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞–µ—Ç M, –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ (record). –ú—ã —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏–ª–∏ –∫ –Ω–µ–π –µ—â—ë –∏ x - –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.
    –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ #shared –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å.

    –ò —Ç–µ–ø–µ—Ä—å –ø—Ä–∏—ë–º, –æ –∫–æ—Ç–æ—Ä–æ–º —è —Å–∫–∞–∑–∞–ª –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ ‚Äì –Ω–∞ GitHub —É –º–µ–Ω—è –ª–µ–∂–∏—Ç –ø–∞—Ä–æ—á–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π, –∏ —Ç—É –∂–µ UnZip —è –∏—Å–ø–æ–ª—å–∑—É—é –¥–æ–≤–æ–ª—å–Ω–æ —á–∞—Å—Ç–æ. –ö–æ–Ω–µ—á–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –ù–æ —á—Ç–æ –µ—Å–ª–∏ –∑–∞–≤—Ç—Ä–∞ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –º—ã—Å–ª—å –∏ —è –µ—ë –ø–µ—Ä–µ–ø–∏—à—É –Ω–∞ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é ‚Äì –æ—á–µ–Ω—å –Ω–µ —Ö–æ—á–µ—Ç—Å—è –ø–µ—Ä–µ–¥–µ–ª—ã–≤–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã, –∫—É–¥–∞ —è –µ—ë —É–∂–µ –∑–∞–ø–∏—Ö–Ω—É–ª. –ü–æ—ç—Ç–æ–º—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
    Expression.Evaluate(Text.FromBinary(Web.Contents("https://raw.githubusercontent.com/buchlotnik/buchlotnik_functions/main/UnZip.pq")),#shared)
    Web.Contents ‚Äì –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Å–∞–π—Ç–∞ (raw.githubusercontent.com ‚Äì –æ—á–µ–Ω—å —É–¥–æ–±–Ω–∞—è —à—Ç—É–∫–∞ ‚Äì —Å—Ä–∞–∑—É –æ—Ç–¥–∞–µ—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Ç–µ–∫—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì —Ç–∞–º –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã—Ü–∞—Ä–∞–ø—ã–≤–∞—Ç—å –µ—ë –∏–∑ —Ä–∞–∑–º–µ—Ç–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã). –î–∞–ª–µ–µ Text.FromBinary –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Ç–µ–∫—Å—Ç, –∞ Expression.Evaluate + #shared –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç —Ç–µ–∫—Å—Ç –≤ –∫–æ–¥. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ñ–∞–π–ª, –∫—É–¥–∞ —è –ø–æ–º–µ—Å—Ç–∏–ª –ø–æ–¥–æ–±–Ω—ã–π –∑–∞–ø—Ä–æ—Å, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.

    –ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ –Ω–∞ GitHub ‚Äì —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –¥–µ—Ä–∂–∏—Ç–µ –Ω–∞ –¥–∏—Å–∫–µ –∏–ª–∏ –≤ –æ–±–ª–∞–∫–µ. –≠—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π ‚Äì –≤–æ–∑–º–æ–∂–Ω–æ –≤—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç –∏–ª–∏ –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∫–∞–ª–µ–Ω–¥–∞—Ä—é. –¢–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã —Ç–æ–∂–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äì –∏ –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å —ç—Ç–æ –æ–¥–∏–Ω —Ä–∞–∑, –Ω–µ–∂–µ–ª–∏ –≤–æ –≤—Å–µ—Ö —Å–≤–æ–∏—Ö —Ñ–∞–π–ª–∞—Ö, –Ω—É –∞ –∫–∞–∫ ‚Äì –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏.
    ]

[   Table.FindText ‚Äì –∏–ª–∏ –∏—â–µ–º —Ç–µ–∫—Å—Ç –≥–¥–µ-—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.FindText

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑–±–µ—Ä–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–æ–≥–¥–∞ –≤—Å–ø–ª—ã–≤–∞–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤ —Å –Ω–µ –æ—á–µ–Ω—å –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º. –ê –∏–º–µ–Ω–Ω–æ ‚Äì —Ç–∞—â–∏–º –ª–∏—Å—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —Ç–æ—á–Ω–æ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞, –º—ã –¥–∞–∂–µ –∑–Ω–∞–µ–º, —á—Ç–æ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –≤ —à–∞–ø–∫–µ, –Ω–æ –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ –∑–Ω–∞–µ–º –Ω–∏ —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫, –Ω–∏ —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å. –ü–æ —Ç–∞–∫–æ–º—É —Å–ª—É—á–∞—é –ø—Ä–∏–º–µ—Ä:
    let
        a = #table( {"a","b","c","d","e","f"},
                    {{"text",null,null,null,"—Ç–µ–∫—Å—Ç",null},
                    {null,"text",null,null,null,null},
                    {null,null,"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ","–¶–µ–Ω–∞","–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ","–°—É–º–º–∞"},
                    {null,null,"–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞",100,2,200},
                    {null,null,"–º—ã—à—å",50,10,500}}),
        b = Table.AddIndexColumn(a, "i"),
        c = Table.FindText(b,"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ"){0}[i],
        d = Table.Range(a,c),
        e = Table.PromoteHeaders(d),
        f = Table.ColumnNames(e),
        g = List.PositionOf(f,"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ"),
        h = List.Range(f,g),
        k = Table.SelectColumns(e,h)
    in
        k

    –ò–∑–≤–∏–Ω—è—é—Å—å –∑–∞ –º–Ω–æ–≥–∞–±—É–∫–∞—Ñ –≤ —à–∞–≥–∞—Ö ‚Äì —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–ª –ø–æ–¥—Ä–æ–±–Ω–æ.
    a ‚Äì —Å–∞–º–∞ —Ç–∞–±–ª–∏—Ü–∞ ‚Äì –≤–∏–¥–∏–º –Ω–∞–ª–∏—á–∏–µ –º—É—Å–æ—Ä–∞ –≤ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö —Å—Ç—Ä–æ–∫–∞—Ö, –≥–¥–µ —Ç–∞–º –∏–º–µ–Ω–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —à–∞–ø–∫–∞ –º—ã –Ω–µ –∑–Ω–∞–µ–º, –∑–Ω–∞–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–æ —Å–ª–æ–≤–æ ¬´–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ¬ª
    b ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –∏–Ω–¥–µ–∫—Å–∞, –æ–Ω –Ω–∞–º –Ω—É–∂–µ–Ω –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
    c ‚Äì —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ç–µ–º–∞ –ø–æ—Å—Ç–∞ - Table.FindText –∏—â–µ—Ç —Ç–µ–∫—Å—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ, –ø—Ä–∏—á—ë–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É Text.Contains -‚Äì—Ç.–µ. –µ—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∏ ¬´–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏¬ª - –Ω–∞–π–¥—ë—Ç ))) –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–º —Ç–∞–±–ª–∏—Ü—É, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ —Å—Ç—Ä–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –¥–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç. –ù–æ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞ ‚Äì –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞—á–∞–ª–æ —à–∞–ø–∫–∏. –ü–æ—ç—Ç–æ–º—É –º—ã –∏ –¥–æ–±–∞–≤–∏–ª–∏ —Å—Ç–æ–ª–±–µ—Ü –∏–Ω–¥–µ–∫—Å–∞, –∞ —Ç–µ–ø–µ—Ä—å –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –±–µ—Ä—ë–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É {0}, –∞ –∏–∑ –Ω–µ—ë –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ [i]
    d - –∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É –Ω–∞—á–∏–Ω–∞—è —Å–æ —Å—Ç—Ä–æ–∫–∏ —à–∞–ø–∫–∏ (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –º—ã –æ–±—Ä–∞—Ç–∏–ª–∏—Å—å –∫ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ, –î–û –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –∏–Ω–¥–µ–∫—Å–∞ ‚Äì –æ–Ω –Ω–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω)

    –û–ö, –ª–∏—à–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏, —Ç–µ–ø–µ—Ä—å —Å—Ç–æ–ª–±—Ü—ã:
    e ‚Äì –ø–æ–¥–Ω—è–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    f ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    g ‚Äì –Ω–∞—à–ª–∏ ¬´–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ¬ª —É–∂–µ –≤ –∏–º–µ–Ω–∞—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
    h ‚Äì –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –ª–∏—à–Ω–∏–µ –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
    k ‚Äì –≤—ã–±—Ä–∞–ª–∏ –Ω—É–∂–Ω–æ–µ

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë )))
    –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —á–∞—Å—Ç–æ ‚Äì –º–æ–∂–Ω–æ —É–ø–∞–∫–æ–≤–∞—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—é:
    f=(table,name)=>
        [a = Table.PromoteHeaders(Table.Range(table,Table.FindText(Table.AddIndexColumn(table, "i"),name){0}[i])),
        b = Table.ColumnNames(a),
        c = Table.SelectColumns(a,List.Range(b,List.PositionOf(b,name,Occurrence.First,Text.Contains)))][c]
    –í—Ä–æ–¥–µ –≤–ø–æ–ª–Ω–µ —Å–∏–º–ø–∞—Ç–∏—á–Ω–æ –∏ –Ω–µ —Ç–æ, —á—Ç–æ–±—ã —Å–∏–ª—å–Ω–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]


[   Table.PositionOf ‚Äì –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —É—Å–ª–æ–≤–∏—è–º —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ –∏–ª–∏ –∫–æ–≥–¥–∞ FillDown –±–µ—Å—Å–∏–ª–µ–Ω / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.PositionOf

    –í —á–∞—Ç–µ –ø–æ–¥–∫–∏–Ω—É–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –∑–∞–¥–∞—á–∫—É ‚Äì –ø–æ—ç—Ç–æ–º—É –µ—Å—Ç—å —á—Ç–æ –æ–±—Å—É–¥–∏—Ç—å.
    –°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ª–∞–π—Ç–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äì –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ–∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É, –ø—Ä–∏—á—ë–º –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –æ—Ç/–¥–æ. –ù—É –∏ –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –ø—Ä–∏–∑–Ω–∞–∫–∞ –Ω–∞–¥–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é:
    let
        dct = #table({"—à–∏—Ä–∏–Ω–∞","–∫–∞—Ç–µ–≥–æ—Ä–∏—è"},{{0,"—É–∑–∫–æ"},{100,"—Å—Ä–µ–¥–Ω–µ"},{250,"—à–∏—Ä–æ–∫–æ"}}),
        tbl = #table({"—á—Ç–æ","—à–∏—Ä–∏–Ω–∞"},{{"—Å—Ç—É–ª",60},{"–∫—Ä–µ—Å–ª–æ",80},{"—Å—Ç–æ–ª",150},{"–¥–∏–≤–∞–Ω",220},{"—Å–µ—Ä–≤–∞–Ω—Ç",280}}),
        cmb = tbl&dct,
        srt = Table.Sort(cmb,{"—à–∏—Ä–∏–Ω–∞"}),
        fll = Table.FillDown(srt,{"–∫–∞—Ç–µ–≥–æ—Ä–∏—è"}),
        to = Table.SelectRows(fll,each [—á—Ç–æ]<>null)
    in
        to
    dct ‚Äì —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, –∑–¥–µ—Å—å –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ (—Ç.–µ. —à–∏—Ä–∏–Ω–∞ –æ—Ç‚Ä¶)
    tbl ‚Äì —Ç–∞–±–ª–∏—Ü–∞, –∫—É–¥–∞ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º
    cmb ‚Äì –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã
    srt ‚Äì –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø–æ –Ω–∞—à–µ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É
    fll ‚Äì —Å–¥–µ–ª–∞–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–Ω–∏–∑
    to ‚Äì –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –Ω–∞—Å —Å—Ç—Ä–æ–∫–∏.
    –í–º–µ—Å—Ç–æ —à–∏—Ä–∏–Ω—ã –±—ã–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–µ–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –¥–∞—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏ —Ç.–¥.
    –í –æ–±—â–µ–º –ø–æ–∫–æ–≤—ã—Ä—è–π—Ç–µ –ø—Ä–∏—ë–º ‚Äì –æ–Ω –∫—Ä–∞–π–Ω–µ –ø–æ–ª–µ–∑–µ–Ω.

    –ù–û –≤—á–µ—Ä–∞ –±—ã–ª–æ –ø—Ä–æ –¥—Ä—É–≥–æ–µ ‚Äì –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω—É–∂–Ω–∞ –ø–æ –î–í–£–ú –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º. –ò –≤–æ—Ç —Ç—É—Ç –≤—ã—è—Å–Ω—è–µ—Ç—Å—è, —á—Ç–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞–º –Ω–µ –ø–æ–º–æ–∂–µ—Ç (–≤ –∫–∞—á–µ—Å—Ç–≤–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø—ã—Ç–ª–∏–≤—ã–µ —É–º—ã –º–æ–≥—É—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å).
    –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Å–∫–∞—Ç—å –ø–æ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –ø–æ –¥–≤—É–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º. –ò –≤–æ—Ç —Ç—É—Ç —Ö–æ—á—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è Table.PositionOf ‚Äì –æ–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ List.PositionOf , –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ —Ç–∞–±–ª–∏—Ü—É )))
    –ü–æ–µ—Ö–∞–ª–∏:
    let
        dct=#table({"–¥–ª–∏–Ω–∞","—Ç–æ–ª—â–∏–Ω–∞","–∫–∞—Ç–µ–≥–æ—Ä–∏—è"},{{0,0,"—Ñ–∏—Ç–∏–Ω–≥ –¥–µ—Ç—Å–∫–∏–π"},{0,2,"—Ñ–∏—Ç–∏–Ω–≥"},{0,5,"—Ñ–∏—Ç–∏–Ω–≥ —É—Å–∏–ª–µ–Ω–Ω—ã–π"},{10,0,"–ø–∞—Ç—Ä—É–±–æ–∫ —É—á–µ–±–Ω—ã–π"},{10,2,"–ø–∞—Ç—Ä—É–±–æ–∫"},{10,8,"–ø–∞—Ç—Ä—É–±–æ–∫ –Ω–∞–ø–æ—Ä–Ω—ã–π"},{100,0,"—Ç—Ä—É–±–∞ –∫–∏—Ç–∞–π—Å–∫–∞—è"},{100,5,"—Ç—Ä—É–±–∞"},{100,12,"—Ç—Ä—É–±–∞ –Ω–∞–ø–æ—Ä–Ω–∞—è"}}),
        tbl=#table({"—á—Ç–æ","–¥–ª–∏–Ω–∞","—Ç–æ–ª—â–∏–Ω–∞"},{{"–¥–µ—Ç–∞–ª—å1",7,1.5},{"–¥–µ—Ç–∞–ª—å2",24,2.2},{"–¥–µ—Ç–∞–ª—å3",80,9.9},{"–¥–µ—Ç–∞–ª—å4",120,15},{"–¥–µ—Ç–∞–ª—å5",140,0.8}}),
        lst=List.Buffer(dct[–∫–∞—Ç–µ–≥–æ—Ä–∏—è]),
        f=(x)=>lst{Table.PositionOf(dct,x,Occurrence.Last,g)},
        g=(x,y)=>x[–¥–ª–∏–Ω–∞]<=y[–¥–ª–∏–Ω–∞] and x[—Ç–æ–ª—â–∏–Ω–∞]<=y[—Ç–æ–ª—â–∏–Ω–∞],
        to = Table.AddColumn(tbl,"–∫–∞—Ç–µ–≥–æ—Ä–∏—è",f)
    in
        to

    dct, tbl ‚Äì —Å–ª–æ–≤–∞—Ä—å –∏ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ
    lst ‚Äì —Å–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–±—Ä–∞–ª–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –∏–Ω–¥–µ–∫—Å—É –≤ —Å–ø–∏—Å–∫–µ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∫ —Ç–∞–±–ª–∏—Ü–µ)
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –æ–±—Ä–∞—â–∞—é—â–∞—è—Å—è –∫ —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ –∏–Ω–¥–µ–∫—Å—É. –ò–Ω–¥–µ–∫—Å –Ω–∞—Ö–æ–¥–∏–º —Å –ø–æ–º–æ—â—å—é Table.PositionOf ‚Äì–±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–æ–∫—É, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —É—Å–ª–æ–≤–∏—é (Occurrence.Last), –∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —É—Å–ª–æ–≤–∏—é –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ñ—É–Ω–∫—Ü–∏–µ–π g
    g ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –∑–∞–ø–∏—Å–∏: x ‚Äì –∏—Å–∫–æ–º–∞—è, y ‚Äì –∑–∞–ø–∏—Å—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã (—Ç.–µ. –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –ø–æ–∏—Å–∫–∞). –°–∞–º–æ —É—Å–ª–æ–≤–∏–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –∫–∞–∫ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –∑–∞–ø–∏—Å–µ–π (–≥–ª–∞–≤–Ω–æ–µ –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è, —á—Ç–æ –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ - —á—Ç–æ –∏—â–µ–º, –∞ –Ω–∞ –≤—Ç–æ—Ä–æ–º –≥–¥–µ; –Ω—É –∏ –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –º–µ–∂–¥—É —É—Å–ª–æ–≤–∏—è–º–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä and)
    to ‚Äì–∞ –¥–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –≤ –º–æ–º–µ–Ω—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –í—Ä–æ–¥–µ –≤–ø–æ–ª–Ω–µ –ª–∞–∫–æ–Ω–∏—á–Ω–æ, –∞ –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö —Å–ª–æ–≤–∞—Ä—è—Ö ‚Äì –æ—á–µ–Ω—å –¥–∞–∂–µ —à—É—Å—Ç—Ä–æ. –¢–∞–∫ —á—Ç–æ –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å,
    ]

[   1C - –ù–æ–≤–∞—è —Ä—É–±—Ä–∏–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª–µ / #1C - –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
    –î–∞–º—ã –∏ –≥–æ—Å–ø–æ–¥–∞, –í–∞—à–µ–º—É –≤–Ω–∏–º–∞–Ω–∏—é –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –µ—â–µ –æ–¥–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ ¬´–¢–∞–Ω–∫–µ¬ª - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –æ—Ç—á–µ—Ç–∞–º–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã 1–° —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã (—Ç–∞–±–ª–∏—Ü).
    –ù–∞ —Å–∫—Ä–∏–Ω–µ (—Å–º. –ø–µ—Ä–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π) ‚Äì –æ–¥–∏–Ω –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤—ã–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ xlsx-—Ñ–æ—Ä–º–∞—Ç–µ.
    –û—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é —Ç–∞–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ —è–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–∂–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä: —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –≤—ã–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.
    –ö–æ–Ω–µ—á–Ω–æ, —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ ‚Äì —ç—Ç–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ 1–° –≤ –∫–æ–º–ø–∞–Ω–∏–∏ ‚Äì –≤—ã–≥—Ä—É–∑–∏—Ç—å –ø–ª–æ—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —ç—Ç–æ —É–¥–∞–µ—Ç—Å—è (—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ –Ω–µ—Ç –≤ –∫–æ–º–ø–∞–Ω–∏–∏, —Ç–æ —É–º–∞ —É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞) –∏ –ø—Ä–æ—Å—Ç–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (–∑–∞—á–∞—Å—Ç—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ—Å—è—Ç–∫–æ–≤ —Ç—ã—Å—è—á —Å—Ç—Ä–æ–∫) –≤ Excel, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç PQ –∏ –∫–ª–∞—Ü–∞—è –º—ã—à–∫–æ–π —Å–æ–∑–¥–∞–µ—Ç –∫–∏–ª–æ–º–µ—Ç—Ä—ã —à–∞–≥–æ–≤ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª–µ–µ-–º–µ–Ω–µ–µ –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
    –¶–∏–∫–ª–æ–º –º–∏–Ω–∏-—Å—Ç–∞—Ç–µ–π –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é #1C –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º —Å–æ–∑–¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –æ—Ç—á–µ—Ç–æ–≤, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ–≤–æ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –≤—ã–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –∏–∑ 1–° –¥–∞–Ω–Ω—ã–º–∏.
    –ü—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è –∏–∑ –¢–∞–Ω–∫–∞, —Ç–∞–∫ –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ.

    –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –º–∏–Ω–∏-—Å—Ç–∞—Ç—å–∏:
    1. –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–∞. –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏ —Å—Ç—Ä–æ–∫–∏. –û—á–∏—â–∞–µ–º —Ç–µ–∫—Å—Ç
    2. –†–∞–∑–±–∏—Ä–∞–µ–º –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —à–∞–ø–∫—É
    3. –†–∞–∑–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ä–∞–±–æ—Ç–∞–µ–º —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
    4. –°–æ–∑–¥–∞–µ–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∏ —Å–≤—è–∑–∏
    5. –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ 1–° –∏–∑ –ø–∞–ø–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

    –í —Ñ–∏–Ω–∞–ª–µ –∂–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, —Å–∫–æ—Ä–º–∏–≤ –∫–æ—Ç–æ—Ä–æ–π –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª –º—ã –ø–æ–ª—É—á–∏–º –Ω–∞ –≤—ã—Ö–æ–¥–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É.

    –ü—Ä–æ—à—É –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –ò–º–µ–µ—Ç –ª–∏ –æ–Ω–æ –ø—Ä–∞–≤–æ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤ –¢–∞–Ω–∫–µ –∏–ª–∏ –∂–µ —ç—Ç–æ –ª–∏—à–Ω–µ–µ –∏ —Ä–∞–∑–±–æ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç—á–µ—Ç–∞ –∏–∑ 1–° –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å —Ä–µ—à–µ–Ω–∏–µ–º?
    ]

[   1C. –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–∞. –ü–æ–¥–Ω–∏–º–∞–µ–º —à–∞–ø–∫—É, —É–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏ —Å—Ç—Ä–æ–∫–∏. –û—á–∏—â–∞–µ–º —Ç–µ–∫—Å—Ç. / #1C - –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–∞.

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç. –≠—Ç–∏–º –ø–æ—Å—Ç–æ–º –º—ã –Ω–∞—á–∏–Ω–∞–µ–º —Å–µ—Ä–∏—é –ø–æ—Å—Ç–æ–≤ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é PQ –∫ –≤—ã–≥—Ä—É–∑–∫–∞–º –∏–∑ 1C.
    –î–ª—è –Ω–∞—á–∞–ª–∞ –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ—Ç—á–µ—Ç "1—Å". –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã –ú, –º–æ–≥—É—Ç —É–ª—ã–±–Ω—É—Ç—å—Å—è ‚Äì —ç—Ç–æ –≤—Å–µ –∏–º –∑–Ω–∞–∫–æ–º–æ, –∞ —Ç–µ, –∫—Ç–æ –ø–æ—Å—Ç–∏–≥–∞–µ—Ç –æ—Å–Ω–æ–≤—ã ‚Äì —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è –∫ –¥–∞–Ω–Ω–æ–º—É –ø–æ—Å—Ç—É )

    –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ç–∞—Ä–∞—é—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç—á–µ—Ç—ã –∏–∑ 1–° –≤ xls(xlsx)-—Ñ–æ—Ä–º–∞—Ç –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü—Ä–∏—á–∏–Ω–∞ —ç—Ç–æ–≥–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ª–µ–∂–∏—Ç –≤ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –ø—Ä–∏–≤—ã—á–∫–∏ ‚Äì –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–∞–∑—É –∂–µ –Ω–∞ –≤—ã—Ö–æ–¥–µ –∫–∞–∫—É—é-—Ç–æ —Ç–∞–±–ª–∏—Ü—É –≤ Excel.
    –ß—Ç–æ –∂–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –≤ —Ç–∞–±–ª–∏—Ü–µ –æ—Ç—á–µ—Ç–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –∏–∑ 1–°:
    1. –®–∞–ø–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –æ—Ç—á–µ—Ç–∞ (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —á–∞—â–µ –≤—Å–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–∞ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º)
    2. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —à–∞–ø–∫–∞ (—Ä–∞–∑–±–æ—Ä –¥–∞–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞ –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–π —Ç–µ–º–µ)
    3. –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É—Å—Ç—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
    4. –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
    5. –ö–∞–∫ –±–æ–Ω—É—Å –æ—Ç 1–° ‚Äì —á–∞—Å—Ç–æ–µ –Ω–∞–ª–∏—á–∏–µ –≤ –ø–æ–ª—è—Ö –Ω–µ–ø–µ—á–∞—Ç–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

    –ü–æ–µ—Ö–∞–ª–∏, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å –æ—Ç—á–µ—Ç–æ–º:
    1-—ã–π —à–∞–≥: —É–¥–∞–ª—è–µ–º —à–∞–ø–∫—É –æ—Ç—á–µ—Ç–∞. –î–ª—è —á–µ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —É–∂–µ –≥–æ—Ç–æ–≤—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –∏–∑ —Ç–∞–Ω–∫–∞:
    Table.Skip(tbl,(r)=>not Text.Contains(Text.Combine(List.Select(Record.ToList(r),(x)=>x is text)),TXT))

    tbl - —Ç–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
    TXT ‚Äì —á–∞—Å—Ç—å –∏–º–µ–Ω–∏ –∏–∑ —à–∞–ø–∫–∏ —Ç–∞–±–ª–∏—Ü—ã, –¥–æ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤–µ—Ä—Ö–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏

    2-–æ–π —à–∞–≥: —É–¥–∞–ª—è–µ–º –Ω–µ–ø–µ—á–∞—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞. –ö–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç, –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –≤–æ—Ç —Ç–∞–∫–∏–º —Ä–µ—à–µ–Ω–∏–µ–º:
    T= [txt= "#(lf)#(00A0)",k=(x)=> Text.Combine(List.RemoveMatchingItems(Text.SplitAny(Text.Clean(x), txt),{""})," "),to=Table.TransformColumns(t,{},k)][to]

    3-–∏–π —à–∞–≥: —É–¥–∞–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã. –¢—É—Ç —Ç–∞–∫ –∂–µ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≥–æ—Ç–æ–≤—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –∏–∑ —Ç–∞–Ω–∫–∞:
    fnRemEmptyColumns = (tbl)=>
    [a = List.Sort(Table.ColumnNames(tbl)),
    b = Table.Profile(tbl,{{"tmp", (x)=>true,List.NonNullCount}})[tmp],
    c = List.PositionOf(b,0,Occurrence.All),
    d = List.Transform(c,(x)=>a{x}),
    e = Table.RemoveColumns(tbl,d)][e]
    –ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ —Ä–∞–±–æ—Ç–µ –∫–æ–¥–∞ - —á–∏—Ç–∞–µ–º –≤ —Ç–∞–Ω–∫–µ
    4-—ã–π —à–∞–≥: —É–¥–∞–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏. –í–∞—Ä–∏–∞–Ω—Ç —Ä–µ—à–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫–∏–º:
    T= Table.SelectRows(cl, each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null})))
    –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –≤ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é:.
    fnClear=(tbl,optional shp,optional clearData, optional clearColumn, optional clearRows)=> [tr=Table.TransformColumns(tbl,{},Text.From),
    t= if  shp is null  then tbl else Table.Skip(tr,(r)=>not Text.Contains(Text.Combine(List.Select(Record.ToList(r),(x)=>x is text)),shp)),
    p= if clearData is null then t else   [k=(x)=>if x=null then x else  Text.Combine(List.RemoveMatchingItems(Text.SplitAny(Text.Clean(x),clearData),{""})," "),
    to=Table.TransformColumns(t,{},k)][to],
    cl=if clearColumn is null then p else 
    [a = List.Sort(Table.ColumnNames(p)),
    b = Table.Profile(p,{{"tmp", (x)=>true,List.NonNullCount}})[tmp],
    c = List.PositionOf(b,0,Occurrence.All),
    d = List.Transform(c,(x)=>a{x}),
    e = Table.RemoveColumns(p,d)][e],
    to=if clearRows is null then cl else  Table.SelectRows(cl, each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null})))][to]

    –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏: to=fnClear(from,"–ê—Ä—Ç–∏–∫","#(lf)#(00A0)",1,1) // —Ç–∞–±–ª–∏—Ü–∞, —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –¥–æ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ø–æ–ª–µ, —É–¥–∞–ª–∏—Ç—å –Ω–µ–ø–µ—á–∞—Ç–Ω—ã–µ, —É–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã, —É–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
    –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äì –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ.
    –ö —á–µ–º—É —ç—Ç–æ—Ç –ø–æ—Å—Ç.
    –í—Å–µ —Ä–µ—à–µ–Ω–∏—è —É–∂–µ —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∏–ª–∏ –≤ —Ç–∞–Ω–∫–µ –∏–ª–∏ –≤ —á–∞—Ç–µ PQ. –î–∞–Ω–Ω—ã–π –ø–æ—Å—Ç ‚Äì–ø–æ–ø—ã—Ç–∫–∞ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é. –ö–æ–Ω–µ—á–Ω–æ, –Ω—é–∞–Ω—Å–æ–≤ –≤ –≤—ã–≥—Ä—É–∑–∫–∞—Ö 1–° –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –Ω–æ —É–ª–æ–≤–∏–≤ —Å–º—ã—Å–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π ‚Äì –º–æ–∂–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ–ø—Ü–∏–µ–π —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤ –∏–º–µ–Ω–∏ ¬´Column¬ª –∏–ª–∏ –∂–µ –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é –ø–æ–¥–Ω—è—Ç–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤. –î–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ —ç—Ç–æ –≤—Å–µ –¥–∞–≤–Ω–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π —ç—Ç–∞–ø, –∞ –¥–ª—è –Ω–∞—Å, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö –ø–æ–∑–Ω–∞–≤–∞—Ç—å –∫—Ä–∞—Å–æ—Ç—É —è–∑—ã–∫–∞ –ú, –±—É–¥–µ—Ç –æ—á–µ—Ä–µ–¥–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è.
    ]

[   List.Union, List.Intersect, List.Difference –∏–ª–∏ –∫–æ–ª—å—Ü–∞ –í–µ–Ω–Ω–∞ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö
    ]

[   List.Union vs List.Combine / #–í–µ—Å—ë–ª—ã–µ–ö–∞—Ä—Ç–∏–Ω–∫–∏
    –ü–æ –∏—Ç–æ–≥–∞–º –æ–±—Å—É–∂–¥–µ–Ω–∏—è –≤—á–µ—Ä–∞—à–Ω–µ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ - –∑–∞–∫—Ä–µ–ø–ª—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É List.Union –∏ List.Combine, –∞ –∑–∞–æ–¥–Ω–æ - –∑–∞—á–µ–º –∂–µ –Ω–∞–º List.Distinct )))
    ]

[   Text.Split vs Text.BeforeDelimiter –∏–ª–∏ –ø—Ä–∏—á—ë–º —Ç—É—Ç —Å–ø–∏—Å–∫–∏ –∏ –ø–æ—á–µ–º—É –Ω–∞ –Ω–∏—Ö –æ–ø—è—Ç—å –±—ã—Å—Ç—Ä–µ–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Text.Split, Text.BeforeDelimiter

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–µ–±–æ–ª—å—à–∞—è –∑–∞—Ä–∏—Å–æ–≤–∫–∞ –≤–¥–æ–≥–æ–Ω–∫—É –∫ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º—É —á–∞—Ç—É.
    –ò—Ç–∞–∫, –µ—Å—Ç—å –∑–∞–¥–∞—á–∞ ‚Äì –≤—ã—Ç—è–Ω—É—Ç—å –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–∞–∫–æ–≥–æ-—Ç–æ –Ω–∞–±–æ—Ä–∞ —Å–∏–º–≤–æ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –º—ã –Ω–∞–∑–æ–≤—ë–º ¬´—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å¬ª. –í—Ä–æ–¥–µ –Ω–µ—Å–ª–æ–∂–Ω–æ:
    let
        from = #table({"txt"},{{"—Ä–∞–∑"},{"—Ä–∞–∑; –¥–≤–∞"},{"—Ä–∞–∑; –¥–≤–∞; —Ç—Ä–∏"}}),
        f=(x)=>Text.BeforeDelimiter(x,"; "),
        to = Table.TransformColumns(from,{"txt",f})
    in
        to
    –¢.–µ. —É –Ω–∞—Å –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äì Text.BeforeDelimiter (–µ—ë –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç ).
    –ö–æ–¥ –≤—ã—à–µ–ª –ø—Ä–æ—Å—Ç–æ–π –∏ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π, –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–µ –≤–æ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, –∏ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—É–ª–∞ –Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–∏–∫–æ–º.

    –í –æ–±—â–µ–º –≤—Å—ë –∫—Ä—É—Ç–æ, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç–æ–≥–¥–∞ –æ —á—ë–º –ø–æ—Å—Ç? –î–∞ –≤–æ—Ç, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –æ —á—ë–º:
    let
        from = #table({"txt"},{{"—Ä–∞–∑"},{"—Ä–∞–∑; –¥–≤–∞"},{"—Ä–∞–∑; –¥–≤–∞; —Ç—Ä–∏"}}),
        f=(x)=>Text.Split(x,"; "){0},
        to = Table.TransformColumns(from,{"txt",f})
    in
        to
    –ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Text.Split ‚Äì –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –º—ã –≤—ã–Ω–∏–º–∞–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç. –ò–¥–µ—è –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è, –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ –∏ –±—É–¥–µ—Ç –∏—Å–∫–æ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º; –∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—ë—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è), –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏ –ø–æ–ª—É—á–∏–º –Ω–∞ –≤—ã—Ö–æ–¥–µ.
    –ó–∞—á–µ–º —Ç–∞–∫–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏? –î–∞ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –±—ã—Å—Ç—Ä–µ–µ ))) –ü—Ä–æ–º–µ—Ä—ã –±—É–¥—É—Ç –≤ –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º ‚Äì —Å —Ä–æ—Å—Ç–æ–º –æ–±—ä–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã–∏–≥—Ä—ã—à –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—Ç–æ—Ä–∞/–¥–≤–∞ —Ä–∞–∑–∞ ‚Äì –Ω–µ–ø–ª–æ—Ö–æ, –∞?

    –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é, —á—Ç–æ –≤—ã–∏–≥—Ä—ã—à –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ Text.BeforeDelimiter —Å–ª–∏—à–∫–æ–º —É–º–Ω–∞—è ‚Äì —É –Ω–µ—ë –∂–µ –µ—â—ë –∏ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –µ—Å—Ç—å ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—Ä–µ–º—è –Ω–∞ –æ—Ü–µ–Ω–∫—É, –ø–µ—Ä–µ–¥–∞–Ω –æ–Ω –∏–ª–∏ –Ω–µ—Ç, –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –µ—â—ë –∏ —Å—á—ë—Ç—á–∏–∫ –≤—Ö–æ–∂–¥–µ–Ω–∏–π –≤—à–∏—Ç, –∞ –≤ –¥–∞–Ω–Ω–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–∞–º —ç—Ç–æ –≤—Å—ë –Ω–µ –Ω–∞–¥–æ ‚Äì –∏ –¥—É–±–æ–≤–∞—è Text.Split —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—â—É—Ç–∏–º–æ –±—ã—Å—Ç—Ä–µ–µ.
    –¢–∞–∫ —á—Ç–æ –µ—â—ë —Ä–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —Ç–µ–∑–∏—Å, —á—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ—à–∞—é—Ç –∑–∞–¥–∞—á—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ )))
    ]

[   Table.RenameColumns ‚Äì –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã + –ø–∞—á–∫–æ–π –∏–ª–∏ –∑–∞—á–µ–º —Ç–∞–º –µ—â—ë –∏ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.RenameColumns

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –†–∞–∑–±–µ—Ä—ë–º –≤–æ–ø—Ä–æ—Å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ ‚Äì –¥–ª—è —ç—Ç–æ–≥–æ —É –Ω–∞—Å –µ—Å—Ç—å Table.RenameColumns:
    let
        from = #table({"a","b","c"},{{1,2,3}}),
        to = Table.RenameColumns(from,{"a","A"})
    in
        to
    –¢—É—Ç –≤—Å—ë –ø—Ä–æ—Å—Ç–æ ‚Äì –ø–µ—Ä–µ–¥–∞–ª–∏ —Å–ø–∏—Å–æ–∫ {—á—Ç–æ, –Ω–∞ —á—Ç–æ} –ø–æ–º–µ–Ω—è—Ç—å.

    –ï—Å–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π –Ω—É–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤:
    let
        from = #table({"a","b","c"},{{1,2,3}}),
        to = Table.RenameColumns(from,{{"a","A"},{"b","B"}})
    in
        to
    –¢–æ–∂–µ –≤—Ä–æ–¥–µ –Ω–µ—Å–ª–æ–∂–Ω–æ. –û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ —Ç–∞–∫–∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –º–Ω–æ–≥–æ –∏ –æ–Ω–∏ —É –Ω–∞—Å —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ:
    let
        from = #table({"a","b","c"},{{1,2,3}}),
        tbl = #table({"—á—Ç–æ","–Ω–∞ —á—Ç–æ"},{{"a","A"},{"b","B"},{"c","C"}}),
        to = Table.RenameColumns(from,Table.ToList(tbl,(x)=>x))
    in
        to
    –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –º—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ —á–µ—Ä–µ–∑ Table.ToList (–¥–∞, —è –ø–æ–º–Ω—é –ø—Ä–æ Table.ToRows, –∞ –≤—ã –ø–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –æ–Ω–∞ –ø–æ—á–µ–º—É-—Ç–æ –Ω–µ —Å—Ç–æ–ª—å —à—É—Å—Ç—Ä–∞—è).

    –ù—É –∏ –Ω–∞–∫–æ–Ω–µ—Ü, –∑–∞—á–µ–º –Ω–∞–º —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç? –í–∞—Ä–∏–∞–Ω—Ç –ø–µ—Ä–≤—ã–π ‚Äì —É –≤–∞—Å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è, –∞ –Ω–∞–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:
    let
        from = #table({"a","b","c"},{{1,2,3}}),
        tbl = #table({"—á—Ç–æ","–Ω–∞ —á—Ç–æ"},{{"a","A"},{"aa","A"},{"aaa","A"},{"b","B"},{"c","C"}}),
        to = Table.RenameColumns(from,Table.ToRows(tbl),MissingField.Ignore)
    in
        to
    –ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ MissingField.Ignore, —á—Ç–æ–±—ã –Ω–µ –≤—ã–ª–µ—Ç–∞–ª–∞ –æ—à–∏–±–∫–∞ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö.
    –í –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MissingField.UseNull:
    let
        from = #table({"a","b","c"},{{1,2,3}}),
        tbl = #table({"—á—Ç–æ","–Ω–∞ —á—Ç–æ"},{{"a","A"},{"b","B"},{"c","C"},{"d","D"}}),
        to = Table.RenameColumns(from,Table.ToRows(tbl),MissingField.UseNull)
    in
        to
    –ó–¥–µ—Å—å –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –Ω–æ –∏ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –ø—Ä–æ—Å—Ç–æ –∏–Ω–æ–≥–¥–∞ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –∂–∏–∑–Ω—å )))
    ]

[   –°–ß–Å–¢–ï–°–õ–ò, –°–£–ú–ú–ï–°–õ–ò –∏ –ø—Ä–æ—á–∏–µ —Ä–∞–¥–æ—Å—Ç–∏ –Ω–∞ M / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –ø—Ä–∏—ë–º—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–∞—Ä—É –Ω–µ–¥–µ–ª—å —É–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–∏—Å–∞–ª –≤ —á–∞—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø–æ —Å—É—Ç–∏ –∫–æ–¥. –ó–∞–ø—Ä–æ—Å –æ–±—ã—á–Ω–æ –∑–≤—É—á–∏—Ç ¬´–∫–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å –°–ß–Å–¢–ï–°–õ–ò?¬ª –∏–ª–∏ ¬´–∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ –°–£–ú–ú–ï–°–õ–ò?¬ª. –û—Ç–≤–µ—Ç ‚Äì ¬´—Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å¬ª –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –Ω–∞—Ä–æ–¥ –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–¥–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏. –•–æ—Ä–æ—à–æ, –¥–∞–¥–∏–º ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π¬ª –æ—Ç–≤–µ—Ç ‚Äì ¬´—Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å, –∞ –ø–æ—Ç–æ–º —Å–ª–æ–≤–∞—Ä—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö¬ª ))) –í–æ—Ç —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç –∏ —Ä–∞–∑–±–µ—Ä—ë–º:
    let
        from = #table({"A","B","C"},{{"x",1,2},{"x",3,4},{"y",5,6},{"y",7,8},{"y",9,10}}),
        f=(x)=>Table.RowCount(x),
        dict = Record.FromTable(Table.RenameColumns(Table.Group(from, "A", {"Value",f}),{"A","Name"})),
        to = Table.AddColumn(from,"New",(r)=>Record.Field(dict,r[A]))
    in
        to

    –ø–æ —à–∞–≥–∞–º:
    from - –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –ø–æ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ –ê –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–Ω–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ
    –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ —Ç–∞–±–ª–∏—Ü—É —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É
    f ‚Äì –ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω–∏—Ç –°–ß–Å–¢–ï–°–õ–ò ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ Table.RowCount
    –∏ –¥–∞–ª–µ–µ
    dict ‚Äì –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É, –ø—Ä–∏—á—ë–º –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑—ã–≤–∞–µ–º Value, –∞ —Ç–æ—Ç, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∏ ‚Äì Name ‚Äì –Ω–∞–º —ç—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–æ–≤–∞—Ä—å (—Ä–∞–∑–±–∏—Ä–∞–ª–æ—Å—å —Ç—É—Ç)
    to ‚Äì –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —à–∞–≥–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞

    –î—É–º–∞—é, –≤–æ–∑–Ω–∏–∫ –≤–æ–ø—Ä–æ—Å ‚Äì –∞ –∑–∞—á–µ–º —è –≤–æ–æ–±—â–µ –≤—ã–Ω–µ—Å —à–∞–≥ f? –î–∞ –º–Ω–µ –ø—Ä–æ—Å—Ç–æ –ª–µ–Ω—å –≤—Å—ë –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å —Ü–µ–ª–∏–∫–æ–º, —É –Ω–∞—Å –∂–µ —Ç—É—Ç –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã:
    f=(x)=>List.Sum(x[B]) // –°–£–ú–ú–ï–°–õ–ò –ø–æ —Å—Ç–æ–ª–±—Ü—É –í
    f=(x)=>List.Sum(x[C]) // –°–£–ú–ú–ï–°–õ–ò –ø–æ —Å—Ç–æ–ª–±—Ü—É –°
    f=(x)=>List.Max(x[C]) // –ú–ê–ö–°–ï–°–õ–ò –ø–æ —Å—Ç–æ–ª–±—Ü—É –°
    f=(x)=>List.Min(x[B]) // –ú–ò–ù–ï–°–õ–ò –ø–æ —Å—Ç–æ–ª–±—Ü—É –í
    f=(x)=>List.Average(x[C]) // –°–†–ó–ù–ê–ß–ï–°–õ–ò –ø–æ —Å—Ç–æ–ª–±—Ü—É –°
    –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ‚Ä¶

    –ö–æ–¥ –≤—ã—Ö–æ–¥–∏—Ç –≤—Ä–æ–¥–µ –Ω–µ—Å–ª–æ–∂–Ω—ã–π, –¥–æ–ø—É—Å–∫–∞–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫—É –Ω–∞–ø–∏–ª—å–Ω–∏–∫–æ–º –∏ –Ω–µ —Ç–æ–ª—å–∫–æ - —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ! )))
    ]

[   –°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –∏–ª–∏ –ø—Ä–∏—á—ë–º —Ç—É—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –ø—Ä–∏—ë–º—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ù–µ–¥–∞–≤–Ω–æ –≤ —á–∞—Ç–µ –ø–æ–¥–Ω—è–ª–∏ –≤–æ–ø—Ä–æ—Å –æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ. –ò—Å—Ö–æ–¥–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å—ã –±–µ–∑–±–æ–∂–Ω–æ —Ç—É–ø–∏–ª–æ, –ø–æ—ç—Ç–æ–º—É –±—ã–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –≤–æ—Ç —Ç–∞–∫–æ–µ:
    let
        from = #table({"a"},List.Zip({{1..100000}})),
        lst = List.Buffer(from[a]),
        m = 10,
        n = List.Count(lst),
        gen = List.Generate(()=>[i=0,l={},a=List.Average(l)],
                            (x)=>x[i]<n,
                            (x)=>[i=x[i]+1,l=if i<m-1 then {} else List.Range(lst,i-m+1,m),a=List.Average(l)],
                            (x)=>x[a]),
        to = Table.FromColumns(Table.ToColumns(from)&{gen},Table.ColumnNames(from)&{"new"})
    in
        to

    –ø–æ —à–∞–≥–∞–º:
    from ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
    lst ‚Äì —Å—Ç–æ–ª–±–µ—Ü, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ (–Ω–µ –∑–∞–±—ã–ª–∏ –ø—Ä–æ –±—É—Ñ–µ—Ä)
    m ‚Äì —à–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è
    n ‚Äì —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ (–∑–∞—Å—É–Ω—É—Ç—å –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–Ω–æ, –Ω–æ —Ç–∞–∫ –±—ã—Å—Ç—Ä–µ–µ)
    gen ‚Äì –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ ‚Äì –≤ –∑–∞–ø–∏—Å–∏ [i ‚Äì —Å—á—ë—Ç—á–∏–∫, l ‚Äì —Å–ø–∏—Å–æ–∫ –¥–ª—è —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è, –≤—ã—á–∏—Å–ª—è–µ–º—ã–π —á–µ—Ä–µ–∑ List.Range, a ‚Äì —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Å—Ä–µ–¥–Ω–µ–µ]
    to ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∫ –∏–º–µ—é—â–µ–π—Å—è —Ç–∞–±–ª–∏—Ü–µ.

    –ö–æ–¥ –ª–æ–≥–∏—á–Ω—ã–π, –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –∑–∞ –ø—Ä–∏–µ–º–ª–µ–º–æ–µ –≤—Ä–µ–º—è –∏ –º–æ–∂–Ω–æ –±—ã–ª–æ —É—Å–ø–æ–∫–æ–∏—Ç—å—Å—è. –û–¥–Ω–∞–∫–æ, —Å–ø–∏–Ω–Ω–æ–π –º–æ–∑–≥ –≤ —Ä–∞–π–æ–Ω–µ –∫–æ–ø—á–∏–∫–∞ –Ω–∞–ø–æ–º–Ω–∏–ª, —á—Ç–æ —Ä–µ—à–∞–ª —è –ø–∞—Ä—É –ª–µ—Ç –Ω–∞–∑–∞–¥ –ø–æ–¥–æ–±–Ω—É—é –∑–∞–¥–∞—á—É, –ø—Ä–∏—á—ë–º —Å–æ–≤—Å–µ–º –ø–æ-–¥—Ä—É–≥–æ–º—É –∏–º–µ–Ω–Ω–æ –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º—ã –±—ã—Å—Ç—Ä–æ–¥–µ–π—Å—Ç–≤–∏—è. –ü—Ä–∏—à–ª–æ—Å—å –Ω–µ–º–Ω–æ–∂–∫–æ –ø–æ–¥—É–º–∞—Ç—å, –ø–æ–Ω—è—Ç—å, —á—Ç–æ –≤ –∫–æ–¥–µ –≤—ã—à–µ –º–µ–Ω—è —Å–º—É—â–∞–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å—ë –∏ –ø–æ—ç—Ç–æ–º—É:
    let
        from = #table({"a"},List.Zip({{1..100000}})),
        lst = List.Buffer(from[a]),
        m = 10,
        n = List.Count(lst),
        gen = List.Generate(()=>[i=0,s=lst{i}],
                            (x)=>x[i]<n,
                            (x)=>[i=x[i]+1,s=x[s]+lst{i}],
                            (x)=>x[s]),
        gen2 = List.Repeat({null},m-1)&{0}&List.RemoveLastN(gen,m),
        zip = List.Transform(List.Zip({gen,gen2}),(x)=>(x{0}-x{1})/m),
        to = Table.FromColumns(Table.ToColumns(from)&{zip},Table.ColumnNames(from)&{"new"})
    in
        to
    –ü–µ—Ä–≤—ã–µ —á–µ—Ç—ã—Ä–µ —à–∞–≥–∞ —Ç–∞–∫–∏–µ –∂–µ
    gen ‚Äì –∞ –≤–æ—Ç –∑–¥–µ—Å—å –Ω–µ –≤—ã–ø–µ–Ω–¥—Ä–∏–≤–∞–µ–º—Å—è –∏ –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É ‚Äì —Ç–∞–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –±—ã—Å—Ç—Ä–µ–µ
    gen2 ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ null-—ã –∏ –æ—Ç—Ä–µ–∑–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ m —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    zip ‚Äì –∞ —Ç–µ–ø–µ—Ä—å —Å—É—Ç—å ‚Äì –≤ –ø–µ—Ä–≤–æ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ –º—ã —Ö–≤–∞—Ç–∞–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω –∏–∑ —Å–ø–∏—Å–∫–∞ –∏ –Ω–∞—Ö–æ–¥–∏–ª–∏ –ø–æ –Ω–µ–º—É —Å—Ä–µ–¥–Ω–µ–µ, —Ç.–µ. –Ω–∞—Ö–æ–¥–∏–ª–∏ —Å—É–º–º—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∞ –ø–æ—Ç–æ–º –¥–µ–ª–∏–ª–∏ –Ω–∞ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Ç.–µ. –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —É –Ω–∞—Å —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –≤ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –ø—Ä–æ—Å—Ç–æ —Å–¥–≤–∏–Ω—É–ª–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É –Ω–∞ m —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–ø—Ä–∞–≤–æ (–∏–ª–∏ –≤–Ω–∏–∑ ‚Äì –∫—Ç–æ –∫–∞–∫ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã), –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–∫–∏ —á–µ—Ä–µ–∑ List.Zip –∏ –Ω–∞—à–ª–∏ —Ä–∞–∑–Ω–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚Äì —ç—Ç–æ –∏ –µ—Å—Ç—å —Å—É–º–º–∞ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è (–ú ‚Äì –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞))), –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø–æ–¥–µ–ª–∏—Ç—å –Ω–∞ —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–∏–º–æ—Ç–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü –∫ —Ç–∞–±–ª–∏—Ü–µ –∫–∞–∫ –∏ –≤ –ø–µ—Ä–≤–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ.

    –ü—Ä–æ–º–µ—Ä—ã –≤ –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º ‚Äì —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç –¥–µ—Å—è—Ç–∫–æ–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –Ω–∞ –º–∞–ª—ã—Ö –æ–±—ä–µ–º–∞—Ö –¥–æ –ø–æ—Ä—è–¥–∫–∞(!) –Ω–∞ 100k —Å—Ç—Ä–æ–∫. –ö–∞–∫-—Ç–æ —Ç–∞–∫, –∏–Ω–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –∑–∞–¥—É–º—ã–≤–∞—Ç—å—Å—è –æ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.
    ]

[   List.Generate + Date.Add* - –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–∫–∏ –¥–∞—Ç –∏ –≤—Ä–µ–º—ë–Ω / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Generate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –°–µ–≥–æ–¥–Ω—è –≤ –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –Ω–∞–ø–∏—Å–∞–ª –≤ —á–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ø–∏—Å–∫–∞ –≤—Ä–µ–º—ë–Ω. –í–∏–¥–∏–º–æ –≤–æ–ø—Ä–æ—Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π, –ø–æ—ç—Ç–æ–º—É —Ä–∞–∑–±–∏—Ä–∞–µ–º:

    let
        // List.Generate(()=>–¥–∞—Ç–∞_–Ω–∞—á–∞–ª–∞,(x)=>x<=–¥–∞—Ç–∞_–æ–∫–æ–Ω—á–∞–Ω–∏—è,(x)=>—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è_—Ñ—É–Ω–∫—Ü–∏—è_–¥–æ–±–∞–≤–ª–µ–Ω–∏—è)
        // #date(year,month,day)
        // #datetime(year,month,day,hour,minute,second)
        // #duration(days,hours,minutes,seconds)
        
        y = List.Generate(()=>#date(2021,1,1),(x)=>x<=#date(2025,12,31),(x)=>Date.AddYears(x,1)),
        q = List.Generate(()=>#date(2021,1,11),(x)=>x<=#date(2025,12,31),(x)=>Date.AddQuarters(x,1)),
        qm = List.Generate(()=>#date(2021,1,11),(x)=>x<=#date(2025,12,31),(x)=>Date.AddMonths(x,3)),
        m = List.Generate(()=>#date(2021,1,1),(x)=>x<=#date(2025,12,31),(x)=>Date.AddMonths(x,1)),
        w = List.Generate(()=>#date(2021,1,1),(x)=>x<=#date(2025,12,31),(x)=>Date.AddWeeks(x,1)),
        wd = List.Generate(()=>#date(2021,1,1),(x)=>x<=#date(2025,12,31),(x)=>Date.AddDays(x,7)),
        d = List.Generate(()=>#date(2021,1,1),(x)=>x<=#date(2025,12,31),(x)=>Date.AddDays(x,1)),
        d1 = List.Generate(()=>#date(2021,1,1),(x)=>x<=#date(2025,12,31),(x)=>x+#duration(1,0,0,0)),
        h = List.Generate(()=>#datetime(2023,4,16,0,0,0),(x)=>x<=#datetime(2023,4,18,0,0,0),(x)=>x+#duration(0,1,0,0)),
        m15 = List.Generate(()=>#datetime(2023,4,16,0,0,0),(x)=>x<=#datetime(2023,4,18,0,0,0),(x)=>x+#duration(0,0,15,0))
    in
        m15

    –°–Ω–∞—á–∞–ª–∞ –∫–æ–º–º–µ–Ω—Ç—ã –≤ –∫–æ–¥–µ ‚Äì —Å–∞–º List.Generate –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç. –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ ‚Äì –∏–º–µ–µ–º –¥–∞—Ç—É/–¥–∞—Ç—É–≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞, –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –¥–∞—Ç—ã/–¥–∞—Ç—ã–≤—Ä–µ–º–µ–Ω–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è, —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç –∫ –¥–∞—Ç–µ/–¥–∞—Ç–µ–≤—Ä–µ–º–µ–Ω–∏ –Ω—É–∂–Ω—ã–π –ø–µ—Ä–∏–æ–¥.

    –°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–µ–º–µ–π—Å—Ç–≤–æ Date.Add*.
    y - Date.AddYears –¥–æ–±–∞–≤–ª—è–µ—Ç –≥–æ–¥—ã, –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —Ä–µ–≥—É–ª–∏—Ä—É–µ–º —à–∞–≥ –≤ –≥–æ–¥–∞—Ö (–º–∞–ª–æ –ª–∏, –≤–∞–º –ø—è—Ç–∏–ª–µ—Ç–∫–∏ –Ω—É–∂–Ω—ã)
    q - Date.AddQuarters –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–≤–∞—Ä—Ç–∞–ª—ã
    qm ‚Äì Date.AddQuarters –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å Date.AddMonths —Å —à–∞–≥–æ–º 3 –º–µ—Å—è—Ü–∞
    m ‚Äì —Ç–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —à–∞–≥–æ–º –≤ –º–µ—Å—è—Ü
    w ‚Äì —Å —à–∞–≥–æ–º –≤ –Ω–µ–¥–µ–ª—é
    wd - Date.AddWeeks –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å Date.AddDays —Å —à–∞–≥–æ–º –≤ 7 –¥–Ω–µ–π
    d ‚Äì –Ω—É –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —à–∞–≥–æ–º –≤ 1 –¥–µ–Ω—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ

    –¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É:
    d1 ‚Äì –≤–º–µ—Å—Ç–æ Date.AddDays –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å +#duration(1,0,0,0) ‚Äì —Ç.–µ. –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ 1 –¥–µ–Ω—å
    –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ #duration –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ç—å –¥–∞—Ç—É–≤—Ä–µ–º—è —Å —à–∞–≥–æ–º, –º–µ–Ω—å—à–µ —Å—É—Ç–æ–∫:
    h ‚Äì –≥–µ–Ω–µ—Ä–∏–º —Å —à–∞–≥–æ–º –≤ 1 —á–∞—Å
    m15 ‚Äì —à–∞–≥ 15 –º–∏–Ω—É—Ç

    –ö–∞–∫ –≤–∏–¥–∏—Ç–µ —Å—Ö–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, –≥–ª–∞–≤–Ω–æ–µ –ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ List.Generate ‚Äì –æ–Ω –µ—Å—Ç—å, –∏ –æ–Ω —Ö–æ—Ä–æ—à–∏–π )))
    ]

[   –ß–ò–°–¢–†–ê–ë–î–ù–ò –Ω–∞ –ú –∏–ª–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ List.Generate / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Generate
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

    –í –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ–≥–æ –ø–æ—Å—Ç–∞ –ø—Ä–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞—Ç –¥–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –≤–æ–ø—Ä–æ—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–∞ —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π, –Ω—É –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç–∫—Å–µ–ª–µ–≤—Å–∫–æ–π –ß–ò–°–¢–†–ê–ë–î–ù–ò (NETWORKDAYS)

    –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
    let
        f=(ot as date,do as date, optional holidays as list) as number=>
                [ a=List.Generate(()=>ot,(x)=>x<=do,(x)=>Date.AddDays(x,1)),
                b=List.Select(a,(x)=>Date.DayOfWeek(x,Day.Monday)<5),
                c=List.RemoveMatchingItems(b,holidays),
                d=List.Count(if holidays=null then b else c)][d],

        hol = {#date(2023,2,24),#date(2023,1,2),#date(2023,1,3),#date(2023,1,4),#date(2023,1,5),#date(2023,1,6),#date(2023,1,7),#date(2023,5,8),#date(2023,2,23),#date(2023,3,8),#date(2023,5,1),#date(2023,5,9),#date(2023,6,12),#date(2023,11,6)},
        from=#table(type table [ot=date,do=date],{{#date(2023,1,1),#date(2023,12,31)},{#date(2023,1,1),#date(2023,3,31)},{#date(2023,4,1),#date(2023,6,30)},{#date(2023,7,1),#date(2023,9,30)},{#date(2023,10,1),#date(2023,12,31)}}),
        to = Table.AddColumn(from,"networkdays",(r)=>f(r[ot],r[do],hol),Int64.Type)
    in
        to

    –†–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —à–∞–≥–∞–º:
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞—è –ß–ò–°–¢–†–ê–ë–î–ù–ò ‚Äì –æ –Ω–µ–π —á—É—Ç—å –Ω–∏–∂–µ
    hol ‚Äì —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤,
    from ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
    to ‚Äì —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è ‚Äì –≤—Ä–æ–¥–µ –≤—Å—ë –ø—Ä–æ–∑—Ä–∞—á–Ω–æ.

    –¢–µ–ø–µ—Ä—å —Å–∞–º–∞ —Ñ—É–Ω–∫—Ü–∏—è f.
    –í–≤–æ–¥–∏–º —Ç—Ä–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: ot ‚Äì –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞, do ‚Äì –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è, holidays ‚Äì –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤

    –®–∞–≥–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏:
    a ‚Äì –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –¥–Ω–µ–π –æ—Ç –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –¥–æ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è ‚Äì —Å–¥–µ–ª–∞–Ω–æ —á–µ—Ä–µ–∑ AddDays ‚Äì —ç—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º +#duration(1,0,0,0)
    b ‚Äì –≤—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ (–Ω–æ–º–µ—Ä –¥–Ω—è –≤ –Ω–µ–¥–µ–ª–µ –º–µ–Ω—å—à–µ 5, —Å—á–∏—Ç–∞—è —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞, –Ω–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ –Ω—É–º–µ—Ä–∞—Ü–∏—è –∏–¥—ë—Ç —Å –Ω—É–ª—è)
    c ‚Äì —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã—Ö –¥–Ω–µ–π ‚Äì —Å–¥–µ–ª–∞–Ω–æ —á–µ—Ä–µ–∑ List.RemoveMatchingItems ‚Äì —ç—Ç–æ —à—É—Å—Ç—Ä–µ–µ, —á–µ–º List.Difference
    d ‚Äì –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —á–∏—Å–ª–æ –¥–Ω–µ–π ‚Äì –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –∏–¥—ë—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –≤—ã—Ö–æ–¥–Ω—ã—Ö ‚Äì –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑ —à–∞–≥–∞ c, –∏–Ω–∞—á–µ ‚Äì –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑ —à–∞–≥–∞ b
    –í –ø—Ä–∏–Ω—Ü–∏–ø–µ, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –∏–º–µ–Ω–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–∞—Ç —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π ‚Äì –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ—Å—å –Ω–∞ —à–∞–≥–µ c.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ö–æ–¥ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–æ—Ä–æ—Ç–∫–∏–π –∏ –Ω–∞ –º–æ–π –≤–∫—É—Å –ª–æ–≥–∏—á–Ω—ã–π ‚Äì –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   –°–ñ–ü–†–û–ë–ï–õ–´, —Ç–æ–ª—å–∫–æ –∫—Ä—É—á–µ, –∏–ª–∏ –ø—Ä–∏—á—ë–º —Ç—É—Ç Text.SplitAny / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Text.SplitAny

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –≤ —á–∞—Ç–µ —Ä–µ—à–∏–º –æ–¥–Ω—É –∑–∞–¥–∞—á–∫—É. –ò—Ç–∞–∫, –∫–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞, –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –°–ñ–ü–†–û–ë–ï–õ–´ ‚Äì –º—ã —Ä–∞–Ω—å—à–µ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏ –æ—á–∏—Å—Ç–∫—É —Ç–µ–∫—Å—Ç–∞ , –Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ Text.Trim, Text.TrimStart –∏ Text.TrimEnd –Ω–µ —É–¥–∞–ª—è—é—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ç–µ–∫—Å—Ç–∞, –∞ –°–ñ–ü–†–û–ë–ï–õ–´ ‚Äì —É–¥–∞–ª—è–µ—Ç. –ß—Ç–æ –∂, —Ä–µ—à–∏–º —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É:
    let
        tbl = #table({"txt"},{{"   –º–∞–º–∞   –º—ã–ª–∞     —Ä–∞–º—É"},{"   –º–∞–º–∞     #(lf)     –º—ã–ª–∞   #(tab)#(tab)#(lf)  —Ä–∞–º—É"}}),
        to = Table.TransformColumns(tbl,{"txt",(x)=>Text.Combine(List.Select(Text.Split(x," "),(x)=>x<>"")," ")}),
        to1 = Table.TransformColumns(tbl,{"txt",(x)=>Text.Combine(List.Select(Text.SplitAny(x," #(00A0)#(lf)#(tab)"),(x)=>x<>"")," ")}),
        to2 = Table.TransformColumns(tbl,{"txt",(x)=>Text.Combine(List.Select(Text.SplitAny(x,""),(x)=>x<>"")," ")}),
        f = (txt,optional splitby,optional combby)=>Text.Combine(List.Select(Text.SplitAny(txt,""&(splitby??"")),(x)=>x<>""),combby??" "),
        to3 = Table.TransformColumns(tbl,{"txt",f}),
        to4 = Table.TransformColumns(tbl,{"txt",(i)=>f(i," ")}),
        to5 =Table.TransformColumns(tbl,{"txt",(i)=>f(i,null,"#(lf)")})
    in
        to5

    –ü–æ —à–∞–≥–∞–º:
    tbl ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–µ –æ—á–µ–Ω—å —á–∏—Å—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º
    to ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü. –õ–æ–≥–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞—è ‚Äì —Ä–∞–∑–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø–æ –ø—Ä–æ–±–µ–ª—É (Text.Split), –ø—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫, –¥–≤–∞ –ø—Ä–æ–±–µ–ª–∞ –ø–æ–¥—Ä—è–¥ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∏ –≤ —Å–ø–∏—Å–æ–∫ –ø–æ–ø–∞–¥—ë—Ç "" (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞), —É–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ (List.Select) –∏ —Å–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª (Text.Combine). –î–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞, –Ω–æ –≤—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã, —Ç–∞–±—É–ª—è—Ü–∏–∏, –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ ‚Äì –º–æ–∂–Ω–æ –ª–∏ –∏–∑–±–∞–≤–∏—Ç—å—Å—è –∏ –æ—Ç –Ω–∏—Ö —Ç–æ–∂–µ? –ú–æ–∂–Ω–æ:
    to1 ‚Äì –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º Text.SplitAny, –∫–æ—Ç–æ—Ä–æ–π –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ –ø–µ—Ä–µ–¥–∞–¥–∏–º –ø–æ–º–∏–º–æ –ø—Ä–æ–±–µ–ª–∞ –µ—â—ë –∏ –¥—Ä—É–≥–∏–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
    –ù–æ —Å–µ–≥–æ–¥–Ω—è –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ –º–æ–∂–Ω–æ –∏ –ø—Ä–æ—â–µ:
    to2 ‚Äì —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º Text.SplitAny, –ø—Ä–æ—Å—Ç–æ –≤ —ç—Ç–æ—Ç —Ä–∞–∑ –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–µ—Ä–µ–¥–∞—ë–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É ‚Äì –∏ –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –æ–Ω–∞ —Å–∞–º–∞ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –¥–µ–ª–∏—Ç —Ç–µ–∫—Å—Ç –ø–æ –ø—Ä–æ–±–µ–ª—å–Ω—ã–º —Å–∏–º–≤–æ–ª–∞–º –∏ –Ω–µ–ø–µ—á–∞—Ç–Ω—ã–º —Å–∏–º–≤–æ–ª–∞–º, —á—Ç–æ –Ω–∞ –º–æ–π –≤–∫—É—Å —É–¥–æ–±–Ω–æ
    f ‚Äì –Ω—É –∏ –ø–æ–¥—ã—Ç–æ–∂–∏–º –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º —É—Å–ª–æ–≤–Ω–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç txt ‚Äì –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ ‚Äì splitby –∏ combby ‚Äì —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–∞–¥–æ –¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
    to3 ‚Äì –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é
    to4 ‚Äì –¥–µ–ª–∏–º —Ç–æ–ª—å–∫–æ –ø–æ –ø—Ä–æ–±–µ–ª—É
    to5 ‚Äì –¥–µ–ª–∏–º –ø–æ –ø—Ä–æ–±–µ–ª—å–Ω—ã–º –∏ –Ω–µ—á–∏—Ç–∞–µ–º—ã–º —Å–∏–º–≤–æ–ª–∞–º, –∞ —Å–æ–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä—ã–≤ —Å—Ç—Ä–æ–∫–∏ (–æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å ‚Äì –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø–µ—Ä–µ–¥–∞–Ω –∫–∞–∫ null)

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –í—Ä–æ–¥–µ –Ω–µ—Å–ª–æ–∂–Ω–æ, –Ω–æ –ø—Ä–∏—à–ª–æ—Å—å –ø–æ–ø–∏—Å–∞—Ç—å, –∑–∞—Ç–æ –ø–æ–ª—É—á–∏–ª–∞—Å—å –°–ñ–ü–†–û–ë–ï–õ–´ —Å –±–ª–µ–∫–¥–∂–µ–∫–æ–º –∏ ‚Ä¶ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   –î–û–±—ã—á–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ ‚Äì –∫–æ–≤—ã—Ä—è–µ–º—Å—è –≤ xml —á–µ—Ä–µ–∑ M / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Xml.Document

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å–ø–ª—ã–≤–∞–ª –≤–æ–ø—Ä–æ—Å –∫–∞–∫ –≤—ã—Ç–∞—â–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –∏ —É—Ä–æ–≤–Ω–∏ –∏–µ—Ä–∞—Ä—Ö–∏–∏. –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–∏ —ç—Ç–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –≤–∏–¥–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –≤ –≤–∏–¥–µ –æ—Ç—Å—Ç—É–ø–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ –ª–æ–≤–∏—Ç—å (–ø—Ä–∏–≤–µ—Ç 1–°). –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–∞–º –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö –Ω–∞–¥–æ –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ xml-—Ä–∞–∑–º–µ—Ç–∫–∏ –ª–∏—Å—Ç–∞ –∏ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—Ç—É–¥–∞ –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –í –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–µ –ø–æ–¥ –ø–æ—Å—Ç–æ–º –±—É–¥–µ—Ç –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ (–æ–¥–Ω–æ–ª–∏—Å—Ç–æ–≤–∞—è –≤—ã–≥—Ä—É–∑–∫–∞) —Å –æ–±–æ–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏, –ø–æ–ø—Ä–æ–±—É–µ–º –µ–≥–æ —Å–ø–∞—Ä—Å–∏—Ç—å:

    let
        unzip=Expression.Evaluate(Text.FromBinary(Web.Contents("https://raw.githubusercontent.com/buchlotnik/buchlotnik_functions/main/UnZip.pq")),#shared),
        bin = Binary.Buffer(File.Contents("C:\Users\User\Downloads\–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Item_.xlsx")),
        sh=Excel.Workbook(bin,false){0}[Data],
        xml=Xml.Document(unzip(bin){[FileName="xl/worksheets/sheet1.xml"]}[Content]){0}[Value]{[Name="sheetData"]}[Value],
        f=(x)=>x{[Name="outlineLevel"]}?[Value]?,
        g=(x)=> x{0}[Attributes]{[Name="s"]}?[Value]?,
        tr=Table.TransformColumns(xml,{{"Attributes",f},{"Value",g}}),
        lst=List.Sort(List.Distinct(tr[Value]),(x)=>Number.From(x)),
        dict=Record.FromList(List.Positions(lst),lst),
        tr1=Table.TransformColumns(tr,{"Value",(x)=>Record.Field(dict,x)}),
        lst1=Table.ToList(tr1,(x)=>List.LastN(x,2)),
        lst2=Table.ToList(sh,(x)=>x),
        to=Table.FromList(List.Zip({lst2,lst1}),List.Combine,Table.ColumnNames(sh)&{"–≤–µ–ª–∏—á–∏–Ω–∞ –æ—Ç—Å—Ç—É–ø–∞","—É—Ä–æ–≤–µ–Ω—å –∏–µ—Ä–∞—Ä—Ö–∏–∏"})
    in
        to

    –ü–æ —à–∞–≥–∞–º:
    unzip ‚Äì —Ç–∞—â–∏–º —Ñ—É–Ω–∫—Ü–∏—é-—Ä–∞–∑–∞—Ä—Ö–∏–≤–∞—Ç–æ—Ä —Å –º–æ–µ–≥–æ –≥–∏—Ç—Ö–∞–±–∞ (–ø—Ä–∏–Ω—Ü–∏–ø –æ–ø–∏—Å–∞–Ω –∑–¥–µ—Å—å, –∞ –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –¥–µ—Ä–∂–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —É —Å–µ–±—è ‚Äì –∑–∞–±–µ—Ä–∏—Ç–µ –µ—ë —Ç—É—Ç)
    bin ‚Äì –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∏–Ω–∞—Ä–Ω–æ–º—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Ñ–∞–π–ª–∞ –∏ –ø–æ–º–µ—â–∞–µ–º –µ–≥–æ –≤ –±—É—Ñ–µ—Ä. –°—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –Ω–µ–º—É –¥–≤–∞–∂–¥—ã ‚Äì –æ—Ç–¥–µ–ª—å–Ω–æ –∑–∞ –¥–∞–Ω–Ω—ã–º–∏, –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äì –∑–∞ –∏–µ—Ä–∞—Ä—Ö–∏–µ–π
    sh ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å –ª–∏—Å—Ç–∞ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º
    xml ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–º –∂–µ –ª–∏—Å—Ç–µ, –Ω–æ —á–µ—Ä–µ–∑ —Ä–∞–∑–º–µ—Ç–∫—É., –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ sheetdata ‚Äì –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä–æ–∫–∞—Ö ‚Äì —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏ –∞—Ç—Ä–∏–±—É—Ç—ã.

    –¢–µ–ø–µ—Ä—å –Ω–∞–ø–∏—à–µ–º –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ :
    f ‚Äì –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± outlineLevel ‚Äì —ç—Ç–æ –∏ –µ—Å—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–æ–∫–∏ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
    g ‚Äì –∞ –∑–¥–µ—Å—å –ø–æ—Å–ª–æ–∂–Ω–µ–µ, –¥–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ 1–°-—ã–µ –æ—Ç—Å—Ç—É–ø—ã —è–≤–ª—è—é—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç–æ–º –Ω–µ —Å—Ç—Ä–æ–∫–∏, –∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —è—á–µ–π–∫–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º –ø–µ—Ä–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –∑–∞–±–∏—Ä–∞–µ–º –æ—Ç—Ç—É–¥–∞ s ‚Äì –≤–µ–ª–∏—á–∏–Ω—É –æ—Ç—Å—Ç—É–ø–∞ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–µ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∑–∞–º–µ–Ω—è–µ–º {0} –Ω–∞ –¥—Ä—É–≥—É—é –Ω—É–∂–Ω—É—é –ø–æ–∑–∏—Ü–∏—é)
    tr ‚Äì –Ω—É –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º, —Ñ—É–Ω–∫—Ü–∏—é f –∫ –∞—Ç—Ä–∏–±—É—Ç–∞–º —Å—Ç—Ä–æ–∫–∏, –∞ —Ñ—É–Ω–∫—Ü–∏—é g ‚Äì –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º —Å—Ç—Ä–æ–∫–∏ ‚Äì –Ω–∞ –≤—ã—Ö–æ–¥–µ –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.

    –°–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–∏ —à–∞–≥–∞ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏, –Ω–æ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤–µ–ª–∏—á–∏–Ω—É –æ—Ç—Å—Ç—É–ø–∞ –≤ —É—Ä–æ–≤–µ–Ω—å –∏–µ—Ä–∞—Ä—Ö–∏–∏
    lst ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
    dict ‚Äì —Å–æ–±—Ä–∞–ª–∏ –∏–∑ –Ω–µ–≥–æ —Å–ª–æ–≤–∞—Ä—å
    tr1 ‚Äì –∑–∞–º–µ–Ω–∏–ª–∏ –æ—Ç—Å—Ç—É–ø—ã –Ω–∞ —É—Ä–æ–≤–Ω–∏ —á–µ—Ä–µ–∑ —Å–ª–æ–≤–∞—Ä—å

    lst1, lst2, to - –¥–µ–ª–æ –æ—Å—Ç–∞–ª–æ—Å—å –∑–∞ –º–∞–ª—ã–º ‚Äì –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–µ—Ä–∞—Ä—Ö–∏–∏ –Ω–∞–¥–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å - –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å–¥–µ–ª–∞–Ω–æ –Ω–∞ —Å–ø–∏—Å–∫–∞—Ö —á–µ—Ä–µ–∑ –ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π zip

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ü—Ä–∏–º–µ—Ä —É—á–µ–±–Ω—ã–π, –ø–æ—ç—Ç–æ–º—É –º—ã –¥–æ–±—ã–ª–∏ —Å—Ä–∞–∑—É –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–π –≤–∞–º. –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –æ—á–µ–Ω—å –º–∞–ª–æ –Ω–µ—Å–ª–æ–∂–Ω–æ–≥–æ –∫–æ–¥–∞. –ü–æ—ç—Ç–æ–º—É –Ω–µ –±–æ–π—Ç–µ—Å—å xml-—Ä–∞–∑–º–µ—Ç–∫–∏, –∫ –Ω–µ–π –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–æ –Ω–µ–º–Ω–æ–∂–∫–æ –ø—Ä–∏–≤—ã–∫–Ω—É—Ç—å, –∞ –ø–æ—Ç–æ–º –∑–∞—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –ø–æ–ª—å–∑—É.
    ]

[   –î–û–±—ã—á–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ 2 ‚Äì –±–æ—Ä–µ–º—Å—è —Å –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Xml.Document

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –í –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø–æ—Å—Ç–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –ø–æ–¥—Ö–æ–¥ –∫ —á—Ç–µ–Ω–∏—é –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π –Ω–∞—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ xml-—Ä–∞–∑–º–µ—Ç–∫–∏ —Ñ–∞–π–ª–∞. –ü—Ä–∏ —ç—Ç–æ–º –≤–æ–∑–º–æ–∂–Ω–æ 2 –ø—Ä–æ–±–ª–µ–º—ã:
    1 ‚Äì —É –ª—é–±–æ–≥–æ –ª–∏—Å—Ç–∞ –µ—Å—Ç—å –µ–≥–æ dimension (–≤ xml —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ —Ç–∞–∫) ‚Äì –æ–±–ª–∞—Å—Ç—å, –≤ –∫–æ—Ç–æ—Ä–æ–π, –ø–æ –º–Ω–µ–Ω–∏—é Excel, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ (–≤ –ø–µ—Ä–≤–æ–º –∫–∞–º–µ–Ω—Ç–µ –ø—Ä–∏–º–µ—Ä ‚Äì –¥–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å D5, —Ö–æ—Ç—è –∑–¥–æ—Ä–æ–≤–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Å D6) ‚Äì –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ª–∏—Å—Ç—É pq –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —ç—Ç—É –æ–±–ª–∞—Å—Ç—å
    2 ‚Äì –≤ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω—ã –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∏—Ö –≤ —Ä–∞–∑–º–µ—Ç–∫–µ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è

    –ß—Ç–æ –∂, –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ—à–∏–º –∏ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã:
    let
        unzip=Expression.Evaluate(Text.FromBinary(Web.Contents("https://raw.githubusercontent.com/buchlotnik/buchlotnik_functions/main/UnZip.pq")),#shared),
        bin = Binary.Buffer(File.Contents("C:\Users\muzyk\Desktop\–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Item_trouble.xlsx")),
        xml=Xml.Document(unzip(bin){[FileName="xl/worksheets/sheet1.xml"]}[Content]){0}[Value]{[Name="sheetData"]}[Value][Attributes],
        val=List.Transform(xml,(x)=>x{[Name="outlineLevel"]}?[Value]?),
        nms=List.Transform(xml,(x)=>x{[Name="r"]}?[Value]?),
        dict=Record.FromList(val,nms),
        sh = Excel.Workbook(bin,false){0}[Data],
        add = Table.AddIndexColumn(sh, "–£—Ä–æ–≤–µ–Ω—å", Number.From(nms{0}),1),
        to=Table.TransformColumns(add,{"–£—Ä–æ–≤–µ–Ω—å",(x)=>Record.FieldOrDefault(dict,Text.From(x))})
    in
        to

    –ü–æ —à–∞–≥–∞–º:
    unzip, bin ‚Äì –≤—Å—ë –∫–∞–∫ –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑
    xml ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –≤—ã–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Å—Ä–∞–∑—É –∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—É Attributes –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏
    val ‚Äì –ø–æ–ª—É—á–∞–µ–º –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –µ—ë outlineLevel
    nms ‚Äì –ø–æ–ª—É—á–∞–µ–º –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –µ—ë –Ω–æ–º–µ—Ä (–ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç–æ—Ç —à–∞–≥ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ñ–∞–π–ª–∞-–ø—Ä–∏–º–µ—Ä–∞ ‚Äì –º–æ–∂–µ—Ç–µ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω—É–º–µ—Ä–∞—Ü–∏—è –Ω–µ —Å–∫–≤–æ–∑–Ω–∞—è)
    dict ‚Äì —Å–æ–±–µ—Ä–µ–º –∏–∑ –Ω–æ–º–µ—Ä–æ–≤ –∏ —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–≤–∞—Ä—å –Ω–∞ –∑–∞–ø–∏—Å—è—Ö
    sh ‚Äì –∫–∞–∫ –∏ –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Å—Ç–∞
    add ‚Äì –∞ –≤–æ—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫—É –¥–µ–ª–∞–µ–º –ø–æ-–¥—Ä—É–≥–æ–º—É ‚Äì –∞ –∏–º–µ–Ω–Ω–æ ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –∏–Ω–¥–µ–∫—Å–∞, –Ω–æ –Ω–µ —Å 1, –∞ —Å –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ dimension
    to ‚Äì –ø–æ–¥—Ü–µ–ø–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–ª–æ–≤–∞—Ä—è —á–µ—Ä–µ–∑ Record.FieldOrDefault, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–µ –æ–±–æ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫–∞—Ö —É –Ω–∞—Å –∏–º–µ–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë. –ü—Ä–∏–Ω—Ü–∏–ø –Ω–µ –ø–æ–º–µ–Ω—è–ª—Å—è ‚Äì –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Ä–∞–∑–º–µ—Ç–∫–∏, –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏—à–ª–æ—Å—å –Ω–µ–º–Ω–æ–≥–æ –ø–æ-–¥—Ä—É–≥–æ–º—É —Å–æ–±—Ä–∞—Ç—å –∏—Ö –≤–æ–µ–¥–∏–Ω–æ.
    ]

[   –ö–∞—á–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Ñ–∞–π–ª–æ–≤ xlsx / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Xml.Document

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ß—Ç–æ-—Ç–æ —É–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å–ø–ª—ã–≤–∞–ª –≤–æ–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —ç–∫—Å–µ–ª–µ–≤—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞.
    –û–±—â–µ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ ‚Äì –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —Ñ–∞–π–ª—É –æ–Ω —á–∏—Ç–∞–µ—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º, –ø–æ—ç—Ç–æ–º—É —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è, –Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –∏–∑ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –º–æ–∂–Ω–æ, –¥–ª—è —ç—Ç–æ–≥–æ –º—ã —Å–Ω–æ–≤–∞ –ø–æ–ª–µ–∑–µ–º –≤ xml-—Ä–∞–∑–º–µ—Ç–∫—É.

    –í —ç—Ç–æ—Ç —Ä–∞–∑ –Ω–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞:
    (bin)=>
    let
        bin = Binary.Buffer(bin),
        xml=Xml.Document(unzip(bin){[FileName="xl/worksheets/sheet1.xml"]}[Content]){0}[Value]{[Name="sheetData"]}[Value][Attributes],
        val=List.Transform(xml,(x)=>x{[Name="hidden"]}?[Value]?),
        nms=List.Transform(xml,(x)=>x{[Name="r"]}?[Value]?),
        dict=Record.FromList(val,nms),
        sh = Excel.Workbook(bin,false){0}[Data],
        add = Table.AddIndexColumn(sh, "tmp", Number.From(nms{0}),1),
        tbl=Table.TransformColumns(add,{"tmp",(x)=>Record.FieldOrDefault(dict,Text.From(x))}),
        filtr = Table.SelectRows(tbl, each ([tmp] = null)),
        to = Table.RemoveColumns(filtr,{"tmp"})
    in
        to

    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –º—ã –ø–æ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏ —ç—Ç–æ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç –∏ —Ç—É—Ç
    bin ‚Äì –∑–∞–±—É—Ñ–µ—Ä–∏–ª–∏ –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–º—ã –µ–≥–æ —á–∏—Ç–∞–µ–º –¥–≤–∞–∂–¥—ã)
    xml ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ –æ–± –∞—Ç—Ä–∏–±—É—Ç–∞—Ö —Å—Ç—Ä–æ–∫
    val ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–π—Å—Ç–≤–µ hidden
    nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ –Ω–æ–º–µ—Ä–µ —Å—Ç—Ä–æ–∫–∏
    dict ‚Äì —Å–æ–±—Ä–∞–ª–∏ —Å–ª–æ–≤–∞—Ä—å
    sh ‚Äì —Ç–µ–ø–µ—Ä—å –∏–∑ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å —Å–∞–º–æ–≥–æ –ª–∏—Å—Ç–∞
    add ‚Äì –¥–æ–±–∞–≤–∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –∏–Ω–¥–µ–∫—Å–∞ (–Ω–µ –∑–∞–±—ã–ª–∏ —É—á–µ—Å—Ç—å, —á—Ç–æ –Ω—É–º–µ—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Å –µ–¥–∏–Ω–∏—Ü—ã)
    tbl ‚Äì –ø—Ä–∏–º–µ–Ω–∏–ª–∏ —Å–ª–æ–≤–∞—Ä—å –∫ –Ω–∞—à–µ–º—É —Å—Ç–æ–ª–±—Ü—É –∏–Ω–¥–µ–∫—Å–∞, —Ç.–µ. –∑–∞–º–µ–Ω–∏–ª–∏ –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å–∫—Ä—ã—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –Ω–µ—Ç
    filtr ‚Äì –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–µ—Å–∫—Ä—ã—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
    to ‚Äì —É–¥–∞–ª–∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü

    –ü—Ä–∏–º–µ–Ω—è—è —Ç–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫ –±–∏–Ω–∞—Ä–Ω–æ–º—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É —Ñ–∞–π–ª–∞ –º—ã –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è, —á—Ç–æ –≤ —Ñ–∞–π–ª–µ –æ–¥–∏–Ω –ª–∏—Å—Ç).
    –í –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º –∞—Ä—Ö–∏–≤ —Å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–º –∫–µ–π—Å–æ–º –∏–∑ —á–∞—Ç–∞ ‚Äì –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–ø–∫–∏ —Å —Ñ–∞–π–ª–∞–º–∏ –∏ –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—É—á–µ–Ω–∞ –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞, –Ω–æ –≤ –æ–±—â–µ–º –≤–∏–¥–µ –º–æ–∂–Ω–æ –∏ –∏—Å—Ö–æ–¥–Ω—É—é –æ–±–Ω–æ–≤–∏—Ç—å ‚Äì —ç—Ç–æ –º—ã —É–∂–µ —Ç–æ–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ç—É—Ç.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ö–æ–≤—ã—Ä—è–π—Ç–µ xml ‚Äì —Ç–∞–º –º–Ω–æ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ, –ø—Ä–∏—á—ë–º –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —ç–∫—Å–µ–ª–µ–≤—Å–∫–∏—Ö —Ñ–∞–π–ª–∞—Ö.
    ]

[   ListInterpolate ‚Äì –∑–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Å–ø–∏—Å–∫–∞—Ö —Å –ø–æ–º–æ—â—å—é List.Generate / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì CustomFunctions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å–ø–ª—ã–≤–∞–ª–∞ –∑–∞–¥–∞—á–∞ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π: –Ω–∞ –≤—Ö–æ–¥–µ –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –ø–æ —Å—Ç–æ–ª–±—Ü—É, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å, –Ω–æ –Ω–µ —Å –ø–æ–º–æ—â—å—é FillDown –∏–ª–∏ –∑–∞–º–µ–Ω—ã null –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ, –∞ –∏–º–µ–Ω–Ω–æ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–µ–π, —Ç–æ –µ—Å—Ç—å –≤–æ—Ç —Ç–∞–∫–æ–µ:
    {2,null,6,8,9,null,7,null,null,1}
    –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å—Å—è –≤
    {2,4,6,8,9,8,7,5,3,1}
    –¢.–µ. —á–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º, —à–∞–≥ —Ç–æ–∂–µ –∏ –≤–æ—Ç ¬´–Ω–∞–¥–æ –∫–∞–∫-—Ç–æ —Ä–µ—à–∏—Ç—å¬ª.

    –ù–∞—á–Ω—ë–º —Å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞. –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–æ—Ä—É–¥–∏–ª —Ñ—É–Ω–∫—Ü–∏—é ListInterpolate:
    (lst)=>
            [   lst=List.Buffer(lst),
                n = List.Count(lst),
                int=(x,y,z)=>List.Transform({1..x},(i)=>y+i*(z-y)/x),
                gen = List.Generate(
                        ()=>[i=0,l=lst{i},m=0,s=l,o={l}],
                        (x)=>x[i]<n,
                        (x)=>[  i=x[i]+1,l=lst{i},
                                m=if l = null then x[m]+1 else 0,
                                s=if l = null then x[s] else l,
                                o=if l=null then null else if x[m]>0 then int(x[m]+1,x[s],s) else {l}],
                        (x)=>x[o]),
                to = List.Combine(List.RemoveNulls(gen))][to]

    –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–æ–∫.
    –î–∞–ª–µ–µ —Ä–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —à–∞–≥–∞–º:
    lst ‚Äì –∑–∞–±—É—Ñ–µ—Ä–∏–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫
    n ‚Äì –Ω–∞—à–ª–∏ —á–∏—Å–ª–æ –µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚Äì —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    int ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
    x ‚Äì —á–∏—Å–ª–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤,
    y ‚Äì –æ—Ç –∫–∞–∫–æ–≥–æ —á–∏—Å–ª–∞ ,
    z ‚Äì –¥–æ –∫–∞–∫–æ–≥–æ (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ);
    –∑–¥–µ—Å—å –ø–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ—Å—Ç–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–æ–π

    gen ‚Äì –∞ –≤–æ—Ç —Ç–µ–ø–µ—Ä—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä. –ó–¥–µ—Å—å –æ–ø–µ—Ä–∏—Ä—É–µ–º –∑–∞–ø–∏—Å—å—é —Å –ø—è—Ç—å—é –ø–æ–ª—è–º–∏:
    i ‚Äì —Å—á—ë—Ç—á–∏–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ —Å–ø–∏—Å–∫–∞,
    l -i-—ã–π —ç–ª–µ–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ —Å–ø–∏—Å–∫–∞,
    m ‚Äì —Å—á—ë—Ç—á–∏–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏,
    s ‚Äì –ø–æ—Å–ª–µ–¥–Ω–µ–µ –Ω–µ null-–æ–≤–æ–µ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,
    o ‚Äì —Å–ø–∏—Å–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–¥–∞—ë–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
    –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã: –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å–ø–∏—Å–∫–∞, –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è –ª–∏ –Ω–∞–º null, –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è ‚Äì –∑–∞–ø—É—Å–∫–∞–µ–º —Å—á—ë—Ç—á–∏–∫ m –∏ —Å—á–∏—Ç–∞–µ–º —á–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å, –≤—Å—ë —ç—Ç–æ –≤—Ä–µ–º—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ—Ç–¥–∞—ë–º null, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—á–µ—Ä–µ–¥–Ω–æ–π –Ω–µ null ‚Äì –≥–µ–Ω–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫ –∏ –æ–±–Ω—É–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫

    to ‚Äì –æ—á–∏—â–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –≤ —Ö–æ–¥–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–æ–∫ –æ—Ç null, –æ–±—ä–µ–¥–∏–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏.

    –ù—É –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º:
    ListInterpolate({1,null,3,4,null,null,7,null,9})//{1,2,3,4,5,6,7,8,9}
    ListInterpolate({1,2,null,2,null,2,1})//{1,2,2,2,2,2,1}
    ListInterpolate({-1,null,1,null,-1}) //{-1,0,1,0,-1}

    –†–∞–±–æ—Ç–∞–µ—Ç, –∫–∞–∫ –∏ –∑–∞–¥—É–º—ã–≤–∞–ª–æ—Å—å )))
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –≤—Å—ë. –§—É–Ω–∫—Ü–∏—é –º–æ–∂–Ω–æ –±—Ä–∞—Ç—å –≤ —Ä–∞–±–æ—Ç—É, –Ω—É –∞ –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏—è —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º ‚Äì –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —Ä–∞–∑–±–µ—Ä—ë–º –∫–∞–∫ —Å –µ—ë –ø–æ–º–æ—â—å—é –ø–∞—á–∫–æ–π –∑–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ.
    ]

[   TableInterpolate ‚Äì –∑–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏, –Ω–æ —É–∂–µ –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ –ø–∞—á–∫–æ–π / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - CustomFunctions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é ListInterpolate, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Å–ø–∏—Å–∫–µ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–∏. –î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –æ–±—ã—á–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ —Å–æ —Å—á—ë—Ç—á–∏–∫–æ–≤ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏, –ø—Ä–æ–±–µ–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –≤—ã—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–æ–≤, –¥–∞–∂–µ –±–∏—Ä–∂–µ–≤—ã–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏))), –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤. –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –Ω–∞–ø–∏—à–µ–º TableInterpolate:
    (tbl,lst)=>
    let
        nms = List.Buffer(Table.ColumnNames(tbl)),
        tr = List.Transform(lst,(x)=>List.PositionOf(nms,x)),
        col=List.Buffer(Table.ToColumns(tbl)),
        f=(x,y)=>List.ReplaceRange(x,y,1,{ListInterpolate(x{y})}),
        acc=List.Accumulate(tr,col,f),
        to = Table.FromColumns(acc,Value.Type(tbl))
    in
        to

    –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
    tbl ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞,
    lst ‚Äì —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

    –†–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —à–∞–≥–∞–º:
    nms ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã,
    tr ‚Äì —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∏—Ö –ø–æ–∑–∏—Ü–∏–π –≤ —Ç–∞–±–ª–∏—Ü–µ
    col ‚Äì —Å–∞–º—É —Ç–∞–±–ª–∏—Ü—É –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
    f ‚Äì –Ω—É –∏ –Ω–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ ‚Äì –æ–Ω–∞ –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ (–ø–æ –∏–Ω–¥–µ–∫—Å—É) –∏–º –∂–µ, –Ω–æ —Å –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–æ–π ListInterpolate
    acc ‚Äì –∞ —Ç–µ–ø–µ—Ä—å —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –≤—ã—à–µ–Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ —à–∞–≥–∏ –≤ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–µ: –∏–¥–µ–º –ø–æ —Å–ø–∏—Å–∫—É –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏—Ö –Ω–∞—Å –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–∏–º –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ç–æ—Ä
    to ‚Äì –æ—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ —Å–æ–±—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –æ–±—Ä–∞—Ç–Ω–æ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì –¥–∞–Ω–Ω—ã–µ –æ —Ç–∏–ø–∞—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–æ–ª—É—á–∞–µ–º –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã, —Ç.–µ. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞).

    –ù—É –∏ –∫–∞–∫ —ç—Ç–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å:
    let
        tbl = #table(type table [a=date,b=number,c=text,d=number,e=text,f=number],
            {{#date(2023,1,1),1,"–º–∞–º–∞",1,"–ø–∞–ø–∞",1},
            {#date(2023,1,2),null,"–º—ã–ª–∞",null,"–ø–∏–ª",null},
            {#date(2023,1,3),null,"—Ä–∞–º—É",3,"–ø–∏–≤–æ",null},
            {#date(2023,1,4),3,"–º–∞–º–∞",null,"–ø–∞–ø–∞",null},
            {#date(2023,1,5),null,"–º—ã–ª–∞",null,"–ø–∏–ª",3},
            {#date(2023,1,6),5,"—Ä–∞–º—É",5,"–ø–∏–≤–æ",5}}),
        lst = Table.ColumnsOfType(tbl,{type number}),
        to = TableInterpolate(tbl,lst)
    in 
        to
    –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ
    tbl ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
    lst ‚Äì –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã ‚Äì –∑–¥–µ—Å—å —è –ø—Ä–æ—Å—Ç–æ –≤–∑—è–ª –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ; –≤—ã –∂–µ –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ä—É–∫–∞–º–∏ –∏–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å List.Select
    to ‚Äì –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –ø–∞—Ä–∞ –Ω–µ—Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ —Ä–µ—à–µ–Ω–∞ –≤–ø–æ–ª–Ω–µ —Å–µ–±–µ –∑–∞–∫–æ–≤—ã—Ä–∏—Å—Ç–∞—è –∑–∞–¥–∞—á–∞. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   Table.Sort ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ –º–∞–∫—Å–∏–º—É–º—É / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Sort

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í—Å–ø–ª—ã–ª –≤ —á–∞—Ç–µ –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Ç–∞–±–ª–∏—Ü—ã. –ï–∂—É –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Table.Sort. –ó–∞–≥–ª—è–Ω–µ–º –≤ —Å–ø—Ä–∞–≤–∫—É:
    Table.Sort(table as table, comparisonCriteria as any) as table

    –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –∏–º–µ–µ—Ç —Ç–∏–ø any, –∞ –∑–Ω–∞—á–∏—Ç –Ω–∞—Å –∂–¥—ë—Ç —á—Ç–æ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ.
    –í —Ü–µ–ª–æ–º –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ –≤–æ–ø—Ä–æ—Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–ø–∏—Å–∫–∞ –∏ –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –≤–æ –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –º–æ–∂–Ω–æ –∑–∞–ø–∏—Ö–∏–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é. –ù–æ —Ç–æ –±—ã–ª–æ –ø—Ä–æ —Å–ø–∏—Å–∫–∏, –∞ —Ç—É—Ç —Ç–∞–±–ª–∏—Ü–∞. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –º—ã —Ä–∞–∑–±–∏—Ä–∞–ª–∏ Table.Max - –∏ —Ç–∞–º —Ç–æ–∂–µ –≤—ã—è—Å–Ω—è–ª–∏, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ.
    –ö–æ—Ä–æ—á–µ, –∫–∞–∫ –≤ –æ–¥–Ω–æ–º –∞–Ω–µ–∫–¥–æ—Ç–µ: ¬´—É –±–∞–±–æ—á–µ–∫ –∏ —Ü–≤–µ—Ç–æ—á–∫–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ¬ª:

    let 
        from = #table(type table [t=text,d=date,n=number],{{"A-001-2023",#date(2023,1,1),80},{"B-002-2023",#date(2023,1,2),88},{"A-003-2023",#date(2023,1,1),52},{"B-001-2023",#date(2023,1,2),99},{"A-002-2023",#date(2023,1,1),88},{"B-003-2023",#date(2023,1,2),80}}),
        to0 = Table.Sort(from,"d"),
        to1 = Table.Sort(from,{"d",Order.Descending}),
        to2 = Table.Sort(from,{"d","n"}),
        to3 = Table.Sort(from,{"n","d"}), 
        to4 = Table.Sort(from,{"d",{"n",Order.Descending}}),
        to5 = Table.Sort(from,(x)=>x[t]),
        to6 = Table.Sort(from,(x)=>Number.From(Text.Split(x[t],"-"){1})),
        to7 = Table.Sort(from,{(x)=>Number.From(Text.Split(x[t],"-"){1}),"d"}),
        to8 = Table.Sort(from,{{(x)=>Number.From(Text.Split(x[t],"-"){1}),Order.Descending},"d"})
    in 
        to8

    –ü–æ —à–∞–≥–∞–º:
    from ‚Äì –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
    to0 ‚Äì –ø—Ä–æ—Å—Ç–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É d, –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ç.–µ. –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
    to1 ‚Äì —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –ø–æ —É–±—ã–≤–∞–Ω–∏—é ‚Äì –æ–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –º—ã –ø–µ—Ä–µ–¥–∞—ë–º —Å–ø–∏—Å–æ–∫ {–Ω–∞–∑–≤–∞–Ω–∏–µ_—Å—Ç–æ–ª–±—Ü–∞,–ø–æ—Ä—è–¥–æ–∫_—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏}
    to2 ‚Äì —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–∂–Ω–æ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å–Ω–∞—á–∞–ª–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É d, –ø–æ—Ç–æ–º –ø–æ —Å—Ç–æ–ª–±—Ü—É n
    to3 ‚Äì –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –ø–æ—Ä—è–¥–æ–∫ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–Ω–∞—á–∞–ª–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É n, –∞ –ø–æ—Ç–æ–º –ø–æ d
    to4 ‚Äì –Ω—É –∏ –ø—Ä–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å–Ω–∞—á–∞–ª–∞ –ø–æ d –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é, –∞ –∑–∞—Ç–µ–º –ø–æ n –ø–æ —É–±—ã–≤–∞–Ω–∏—é ‚Äì –Ω–µ –∑–∞–ø—É—Ç–∞–π—Ç–µ—Å—å –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö )))

    –ù—É –û–ö, –≤—Å—ë –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ –∏ —Ç–∞–∫ –±—ã–ª–æ –≤ —Å–ø—Ä–∞–≤–∫–µ, –∞ –≤–æ—Ç —á–µ–≥–æ —Ç–∞–º –Ω–µ—Ç:
    to5 ‚Äì –≤–º–µ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é (–º—ã –∂–µ –ø–æ–º–Ω–∏–º, —á—Ç–æ –æ–¥–Ω–æ –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ç–∞–±–ª–∏—Ü ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π), —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ–ª—é t. –û–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
    to6 ‚Äì –Ω—É –∏ —Ä–∞–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∑–Ω–∞—á–∏—Ç –º–æ–∂–Ω–æ –Ω–µ–º–Ω–æ–∂–∫–æ —É—Å–ª–æ–∂–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é ‚Äì –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É –≤ –Ω–æ–º–µ—Ä–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∞ –ø–æ —Å–∞–º–æ–º—É –Ω–æ–º–µ—Ä—É
    to7 ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≤–º–µ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ —Ç–æ—á–Ω–æ —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∞ —Å –¥—Ä—É–≥–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    to8 ‚Äì –∏ —Ç–æ—á–Ω–æ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–æ–¥–Ω–æ –∑–∞–¥–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∏–∑ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–µ t –≤—ã–Ω–∏–º–∞–µ—Ç—Å—è –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é, –∞ –∑–∞—Ç–µ–º –ø–æ —Å—Ç–æ–ª–±—Ü—É d –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é

    –ú–æ–∂–Ω–æ, –∫–æ–Ω–µ—á–Ω–æ, –Ω–µ –≥–æ—Ä–æ–¥–∏—Ç—å –æ–≥–æ—Ä–æ–¥, —Ä–∞–∑–±–∏—Ç—å –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ, –ø–æ—Ç–æ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Ç–æ–º —É–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü, –Ω–æ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –æ–Ω–æ –±—ã–≤–∞–µ—Ç –ø—Ä–æ—â–µ –∏ –∏–∑—è—â–Ω–µ–µ. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   Table.SelectRows + Record.FieldOrDefault –∏–ª–∏ —Å–Ω–æ–≤–∞ —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Record.FieldOrDefault

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –£–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å–ø–ª—ã–≤–∞–ª –≤–æ–ø—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ —Å–ø–∏—Å–∫—É –∑–Ω–∞—á–µ–Ω–∏–π. –ü–æ–∂–∞–ª—É–π, —Å—Ç–æ–∏—Ç –¥–∞—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π. –°—Ä–∞–∑—É –Ω–µ–º–Ω–æ–∂–∫–æ –∫–æ–¥–∞, –∞ –ø–æ—Ç–æ–º —Ä–∞–∑–±–µ—Ä—ë–º:
    let
        from = #table(type table [a=text,b=number,c=number],{{"a",1,1},{"b",2,2},{"c",3,3},{"d",4,4},{"e",5,5},{"f",6,6},{"g",7,7}}),
        lst={"a","c","e","g"},
        to = Table.SelectRows(from,(x)=>List.Contains(lst,x[a])),
        tbl = Table.FromList(lst,(x)=>{x},{"a"}), 
        to1 = Table.Join(from,"a",tbl,"a"),
        dict = Record.FromList(List.Repeat({true},List.Count(lst)),lst),
        to2 = Table.SelectRows(from,(x)=>Record.FieldOrDefault(dict,x[a],false))
    in
        to2

    –ò—Ç–∞–∫, –∏–º–µ–µ–º:
    from ‚Äì —Ñ–∏–ª—å—Ç—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞,
    lst ‚Äì —Å–ø–∏—Å–æ–∫ –∏—Å–∫–æ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    to ‚Äì –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ List.Contains, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –∏ –∑–∞–∫–æ–Ω—á–∏—Ç—å –ø–æ—Å—Ç‚Ä¶ –ù–û, —Ö–æ—Ä–æ—à–æ, –µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –±—É–∫–≤–∞–ª—å–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –∞ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∫–æ–≥–¥–∞ –∏–º–µ–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ—Å—è—Ç–∫–æ–≤ –ø–æ–∑–∏—Ü–∏–π, –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω –∏–ª–∏ –≤–æ–æ–±—â–µ –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –≤ –¥–µ—Å—è—Ç–∫–∏ –∏–ª–∏ —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á —Å—Ç—Ä–æ–∫ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ –¥—Ä—É–≥–æ–π —Ç–∞–±–ª–∏—Ü–µ –≤ –¥–µ—Å—è—Ç–∫–∏ –∏–ª–∏ —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á —Å—Ç—Ä–æ–∫ ‚Äì –∏ –≤–æ—Ç —Ç—É—Ç List.Contains –Ω–∞—á–∏–Ω–∞–µ—Ç ¬´—Ç—É–ø–∏—Ç—å¬ª.

    –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É:
    tbl ‚Äì —Å–æ–±–µ—Ä—ë–º –∏–∑ —Å–ø–∏—Å–∫–∞ —Ç–∞–±–ª–∏—Ü—É –≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü, –ø—Ä–∏—á—ë–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Å—Ç–æ–ª–±—Ü–∞ –≤ —Ñ–∏–ª—å—Ç—Ä—É–µ–º–æ–π —Ç–∞–±–ª–∏—Ü–µ (–µ—Å–ª–∏ —É –≤–∞—Å —Å—Ä–∞–∑—É –Ω–∞ –≤—Ö–æ–¥–µ –Ω—É–∂–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ ‚Äì –ø—Ä–æ—Å—Ç–æ —Ä–∞–¥—É–µ–º—Å—è, –∞ —Ç–∞–∫ –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è Table.RenameColumns)
    to1 ‚Äì –∞ —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ–º Table.Join ‚Äì –ø–æ—Å–∫–æ–ª—å–∫—É –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–æ–≤–ø–∞–¥–∞–ª–∏, –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –≤ —Ç–∞–±–ª–∏—Ü—É –Ω–µ –¥–æ–±–∞–≤–∏–ª–æ—Å—å, –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ —É–∫–∞–∑–∞–Ω, –ø–æ—ç—Ç–æ–º—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é JoinKind.Inner, —Ç.–µ. —Ç–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü, –∫–æ—Ä–æ—á–µ —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –≤–æ–æ–±—â–µ –±–µ–∑ –ª–∏—à–Ω–∏—Ö —Ç–µ–ª–æ–¥–≤–∏–∂–µ–Ω–∏–π. –í –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç –ø—Ä–æ–º–µ—Ä—ã ‚Äì —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ —à—É—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç

    –ù—É –∞ –≤–∏—à–µ–Ω–∫–æ–π –Ω–∞ —Ç–æ—Ä—Ç–µ –±—É–¥–µ –≤–∞—Ä–∏–∞–Ω—Ç, –∑–∞—è–≤–ª–µ–Ω–Ω—ã–π –≤ —Ç–µ–º–µ –ø–æ—Å—Ç–∞ ‚Äì —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö )))
    dict ‚Äì –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –Ω–∞—à —Å–ø–∏—Å–æ–∫ –≤ –∑–∞–ø–∏—Å—å, –≥–¥–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –Ω–∞—Å –∑–Ω–∞—á–µ–Ω–∏—è ‚Äì –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π, –∞ –≤ —Å–∞–º–∏—Ö –ø–æ–ª—è—Ö –Ω–∞–ø–∏—à–µ–º –ø—Ä–æ—Å—Ç–æ true
    to2 ‚Äì –Ω—É –∏ —Ç–µ–ø–µ—Ä—å —Ñ–∏–ª—å—Ç—Ä—É–µ–º —á–µ—Ä–µ–∑ Record.FieldOrDefault, –≥–¥–µ –¥–µ—Ñ–æ–ª—Ç–æ–º –±—É–¥–µ—Ç false ‚Äì –ª–æ–≥–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞—è ‚Äì –µ—Å–ª–∏ –≤ –∑–∞–ø–∏—Å–∏ –µ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ ‚Äì —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä–æ–∫—É, –∏–Ω–∞—á–µ ‚Äì –≤—ã–∫–∏–¥—ã–≤–∞–µ–º. –ù–∞ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–∞—Ö –¥–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì —Å –º–∞–ª–µ–Ω—å–∫–∏–º —Å–ø–∏—Å–∫–æ–º –º–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –ª—é–±–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ –≤–∫—É—Å—É –∏–ª–∏ –∏–Ω—ã–º —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º, –Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–∞—Ö —Å—Ç–æ–∏—Ç –∑–∞–¥—É–º–∞—Ç—å—Å—è –æ–± —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
    ]


[   Expression.Evaluate –∏–ª–∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —è—á–µ–π–∫–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Expression.Evaluate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —Å–≤–æ—ë –≤—Ä–µ–º—è –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é Expression.Evaluate –∏ –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª—è—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤–∏–¥–∞ "123+234+345", —á—Ç–æ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é (x)=>Expression.Evaluate("‚Ä¶x‚Ä¶",[x=x]), –∏ –≤–æ–æ–±—â–µ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ –∫—É—Å–æ–∫ —Ç–µ–∫—Å—Ç–∞ —Å –≥–∏—Ç—Ö–∞–±–∞ –≤ –∫–æ–¥ —Å –ø–æ–º–æ—â—å—é #shared.

    –ù–æ —Ç—É—Ç –≤ —á–∞—Ç–µ –ø–æ–¥–∫–∏–Ω—É–ª–∏ –∑–∞–¥–∞—á–∫—É –Ω–µ–º–Ω–æ–∂–∫–æ –∏–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ ‚Äì –∞ –∏–º–µ–Ω–Ω–æ, –≤—ã—á–∏—Å–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤ —è—á–µ–π–∫–µ, –Ω–æ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π ‚Äì –Ω–∞–∑–≤–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π.
    –û–ö, –¥–∞–≤–∞–π—Ç–µ —Å–º–æ—Ç—Ä–µ—Ç—å:
    let
        from = #table({"–¥–∞—Ç–∞","—Ç–µ–∫—Å—Ç","–≤—ã—Ä–∞–∂–µ–Ω–∏–µ","–ø–æ–ª–µ1","–ø–æ–ª–µ2"},
        {{#date(2023,1,1),"–í–∞—Å—è","-–ø–æ–ª–µ1/–ø–æ–ª–µ2",11,22},
        {#date(2023,2,2),"–ö–æ–ª—è","–ø–æ–ª–µ1-–ø–æ–ª–µ2",0,33},
        {#date(2023,3,3),"–ü–µ—Ç—è","–ø–æ–ª–µ1*–ø–æ–ª–µ2-–ø–æ–ª–µ1",33,44}}),
        f=(rec)=>Expression.Evaluate(rec[–≤—ã—Ä–∞–∂–µ–Ω–∏–µ],rec),
        to=Table.AddColumn(from,"—Ä–µ–∑—É–ª—å—Ç–∞—Ç",f)
    in
        to
    –ò –∫–∞–∫ –±—ã –≤–µ—Å—å –∫–æ–¥ ))). –°—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—é f –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ (rec) –∏ –º—ã –ø—Ä–æ—Å–∏–º –≤—ã—á–∏—Å–ª–∏—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—è (rec[–≤—ã—Ä–∞–∂–µ–Ω–∏–µ]), –∞ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –∏–º–µ–Ω–∞ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–π –∑–∞–ø–∏—Å–∏.

    –ù–æ —è –±—ã –Ω–µ –ø–∏—Å–∞–ª –ø–æ—Å—Ç, –µ—Å–ª–∏ –±—ã –≤—Å—ë –±—ã–ª–æ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —É –Ω–∞—Å –±—ã–ª–∏ null:
    let
        from = #table({"–¥–∞—Ç–∞","—Ç–µ–∫—Å—Ç","–≤—ã—Ä–∞–∂–µ–Ω–∏–µ","–ø–æ–ª–µ1","–ø–æ–ª–µ2"},
        {{#date(2023,1,1),"–í–∞—Å—è","-–ø–æ–ª–µ1/–ø–æ–ª–µ2",11,22},
        {#date(2023,2,2),"–ö–æ–ª—è","–ø–æ–ª–µ1-–ø–æ–ª–µ2",null,33},
        {#date(2023,3,3),"–ü–µ—Ç—è","–ø–æ–ª–µ1*–ø–æ–ª–µ2-–ø–æ–ª–µ1",33,44}}),
        
        nms=List.Buffer(Table.ColumnNames(from)),
        f=(rec)=>[  a=Record.ToList(rec),
                    b=List.Transform(a,(x)=>if x=null then 0 else x),
                    c=Record.FromList(b,nms),
                    d=Expression.Evaluate(rec[–≤—ã—Ä–∞–∂–µ–Ω–∏–µ],c)][d],
        to=Table.AddColumn(from,"—Ä–µ–∑—É–ª—å—Ç–∞—Ç",f)
    in
        to
    –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∫–æ–¥ –≤—ã—à–µ –Ω–µ –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –±—ã –∫–∞–∫ –Ω–∞–¥–æ, –ø–æ—Å–∫–æ–ª—å–∫—É –ª—é–±—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º null –¥–∞—é—Ç null. –ü–æ—ç—Ç–æ–º—É –ø—Ä–∏—à–ª–æ—Å—å –Ω–µ–º–Ω–æ–∂–∫–æ —É—Å–ª–æ–∂–Ω–∏—Ç—å –∫–æ–¥:
    nms ‚Äì –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã ‚Äì –Ω–∞–º —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ ‚Äì –ø–æ—ç—Ç–æ–º—É –Ω–µ –∑–∞–±—ã–ª–∏ List.Buffer
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:
    a ‚Äì –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –≤—Å–µ—Ö –ø–æ–ª–µ–π,
    b ‚Äì –∑–∞–º–µ–Ω–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è null –Ω–∞ 0
    c ‚Äì –∑–∞–Ω–æ–≤–æ —Å–æ–±—Ä–∞–ª–∏ –∑–∞–ø–∏—Å—å, –Ω–æ —É–∂–µ —Å –Ω—É–ª—è–º–∏
    d ‚Äì –æ—Ç–¥–∞–ª–∏ –µ—ë –≤ expression.Evaluate
    to ‚Äì –ø—Ä–∏–º–µ–Ω—è–µ–º –≤–Ω–æ–≤—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫ –Ω–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –ø–æ–ª—É—á–∞–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –í—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç Expression.Evaluate —Å–∏–ª—å–Ω–æ —Ä–∞–∑–≤—è–∑—ã–≤–∞–µ—Ç —Ä—É–∫–∏, –Ω–∞–¥–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ –Ω–µ–≥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∑–∞–ø–∏—Å—å.
    ]

[   Table.ReplaceValue –∏–ª–∏ —Å–∞–º–∞—è –≥–∏–±–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.ReplaceValue

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—Å–ø–ª—ã–≤–∞–ª –≤–æ–ø—Ä–æ—Å –ø–æ Table.ReplaceValue.
    –†–µ–¥–∫–æ –µ–π –ø–æ–ª—å–∑—É—é—Å—å, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ –Ω–µ–º–Ω–æ–∂–∫–æ —Å–æ–≤—Å–µ–º –Ω–µ —à—É—Å—Ç—Ä–∞—è, –∏ –≤ –æ–±—â–µ–º-—Ç–æ –∑–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ—à–µ–Ω—ã –¥—Ä—É–≥–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏.
    –ù–æ, —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —Ñ—É–Ω–∫—Ü–∏—è –≥–∏–±–∫–∞—è, –Ω–µ–º–Ω–æ–∂–∫–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö )))

    –ò—Ç–∞–∫, —Å–ø—Ä–∞–≤–∫–∞ –≥–ª–∞—Å–∏—Ç:
    Table.ReplaceValue(table as table, oldValue as any, newValue as any, replacer as function, columnsToSearch as list)
    table ‚Äì –≤ –∫–∞–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ,
    oldVlue ‚Äì –∫–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,
    newValue ‚Äì –Ω–∞ –∫–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,
    replacer ‚Äì —Å –ø–æ–º–æ—â—å—é –∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏,
    columnsToSearch ‚Äì –≤ –∫–∞–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö –º–µ–Ω—è–µ–º

    –ù—É –ø–æ–µ—Ö–∞–ª–∏:
    let
        from = Table.FromRecords({[a=1,b=1,c="–ø–æ",d="—Ç–æ–ø–æ—Ç",e=null],[a=2,b=null,c="–≥–æ",d="–∑–∞–≥–æ—Ä–æ–¥",e="—Ñ"],[a=3,b=null,c="–¥–∞",d="–¥–∞—Ä",e=null],[a=4,b=2,c="—Ö–æ",d="—Ö–æ—Ä—å",e=null],[a=5,b=null,c="—Ä–æ",d="—Ä–æ—â–∞",e="—ã"],[a=6,b=null,c="—à–∞",d="—à–∞–ø–∫–∞",e=null],[a=7,b=3,c="—Å–µ",d="—Å–µ–≤–µ—Ä",e=null],[a=8,b=null,c="–≥–æ–¥",d="–≥–æ–¥–Ω–æ—Ç–∞",e="–≤"],[a=9,b=null,c="–Ω—è",d="–Ω—è—à–∞",e=null]}),
        to1 = Table.ReplaceValue(from,null,0,Replacer.ReplaceValue,{"b","e"}),
        to2 = Table.ReplaceValue(from,null,each if [e] is text then 0 else [a],Replacer.ReplaceValue,{"b"}),
        to3 = Table.ReplaceValue(from,"–æ","@",Replacer.ReplaceText,{"d"}),
        to4 = Table.ReplaceValue(from,each [c],"@",Replacer.ReplaceText,{"d"}),
        to5 = Table.ReplaceValue(from,each [a],each [b],(x,y,z)=>[x=x,y=y,z=z],{"d"}),
        to6 = Table.ReplaceValue(from,null,null,(x,y,z)=>if x is text then "–∑–¥–µ—Å—å –±—ã–ª —Ç–µ–∫—Å—Ç" else x,Table.ColumnNames(from)),
        to7 = Table.ReplaceValue(from,each [b],null,(x,y,z)=>if y<>null then "-" else x,Table.ColumnNames(from)),
        to8 = Table.ReplaceValue(from,null,each [b],(x,y,z)=>if z<>null then "-" else x,Table.ColumnNames(from)),
        to9 = Table.ReplaceValue(from,each [a],each [b],(x,y,z)=>if y=z then "-" else x,Table.ColumnNames(from)),
        to10 = Table.ReplaceValue(from,(x)=>x,(x)=>x,(x,y,z)=>[x=x,y=y,z=z],Table.ColumnNames(from))
    in
        to10
    from ‚Äì –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    to1 ‚Äì –ø—Ä–æ—Å—Ç–∞—è –∑–∞–º–µ–Ω–∞ null –Ω–∞ 0 –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º b –∏ e, Replacer.ReplaceValue –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–∏–∫–æ–º
    to2 ‚Äì —É—Å–ª–æ–∂–Ω—è–µ–º ‚Äì –≤ newValue –º–æ–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å —É—Å–ª–æ–≤–∏–µ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º–µ–Ω—è–µ–º null –Ω–∞ 0 —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´e¬ª —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è —Ç–µ–∫—Å—Ç
    to3 ‚Äì –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–º–µ–Ω—ã ‚Äì Replacer.ReplaceText, —Ç.–µ. –∑–∞–º–µ–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–µ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º–µ–Ω—è–µ–º ¬´–æ¬ª –Ω–∞ ¬´@¬ª –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´d¬ª
    to4 ‚Äì oldValue —Ç–∞–∫–∂–µ –Ω–µ –æ–±—è–∑–∞–Ω–æ –±—ã—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–∞–º–µ–Ω—É –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´d¬ª, –Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ oldValue –±–µ—Ä–µ–º —Ç–µ–∫—Å—Ç –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ ¬´c¬ª

    –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∏—Ç–æ–≥ ‚Äì oldValue –∏ newValue –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º, –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∏ –¥–∞–∂–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º —É—Å–ª–æ–≤–∏–µ–º.

    –ê —á—Ç–æ –∂–µ —Å Replacer-–æ–º? –ò –≤–æ—Ç —Ç—É—Ç —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ:
    to5 ‚Äì –≤–æ-–ø–µ—Ä–≤—ã—Ö, —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç —Ç—Ä—ë—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ ("–≤ –∫–∞–∫–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏", "—á—Ç–æ","–Ω–∞ —á—Ç–æ –º–µ–Ω—è–µ–º") ‚Äì –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –≤—ã–≤–µ–ª –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
    to6 ‚Äì –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä—è, —Ç–µ–ø–µ—Ä—å —Ç–≤–æ—Ä–∏–º –≤—Å—è–∫–æ–µ ‚Äì –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤–æ–æ–±—â–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã oldValue –∏ newValue, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–º, –ø—Ä–∏—á—ë–º —Å—Ä–∞–∑—É –ø–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º
    to7 ‚Äì –∞ —Ç–∞–∫ –º—ã —Å—Ç–∞–≤–∏–º –ø—Ä–æ—á–µ—Ä–∫–∏ –≤–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö, –µ—Å–ª–∏ —Å—Ç–æ–ª–±–µ—Ü ¬´b¬ª –Ω–µ null
    to8 ‚Äì –ø–æ—á—Ç–∏ —Ç–æ –∂–µ —Å–∞–º–æ–µ, –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ ¬´b¬ª –ø–µ—Ä–µ–¥–∞–ª–∏ –Ω–µ –≤–æ –≤—Ç–æ—Ä–æ–π, –∞ –≤ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äì —è –∂–µ –≥–æ–≤–æ—Ä–∏–ª, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≥–∏–±–∫–∞—è )))
    to9 ‚Äì –Ω—É –∞ –≤–æ—Ç —Ç–∞–∫ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —É—Å–ª–æ–≤–∏–µ –ø–æ –¥–≤—É–º —Å—Ç–æ–ª–±—Ü–∞–º, –ø–µ—Ä–µ–¥–∞–≤ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
    to10 ‚Äì –Ω—É –∏ –Ω–∞ –∑–∞–∫—É—Å–∫—É ‚Äì –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —è –Ω–∞–ø–∏—Å–∞–ª —á–µ—Ä–µ–∑ each, —Ö–æ—Ç—è –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏ –ø–æ–º–Ω—è—Ç, —á—Ç–æ —ç—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –¥–ª—è (x)=>x. –¢.–µ. –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∏ –≤–æ –≤—Ç–æ—Ä–æ–π, –∏ –≤ —Ç—Ä–µ—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤—Å—é —Å—Ç—Ä–æ–∫—É —Ü–µ–ª–∏–∫–æ–º –≤ –≤–∏–¥–µ –∑–∞–ø–∏—Å–∏ ‚Äì —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ª—é–±—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç –ª—é–±–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤, –∞ –ø—è—Ç—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç –Ω–∞—Å –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —è—á–µ–π–∫–∏ –∏ –Ω–∞—à–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–∞–Ω—Ç–∞–∑–∏–µ–π.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –∫—Ä–∞–π–Ω–µ –≥–∏–±–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –Ω–æ –ø–ª–∞—Ç–æ–π –∑–∞ –≥–∏–±–∫–æ—Å—Ç—å —è–≤–ª—è–µ—Ç—Å—è –Ω–µ —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å.
    ]

[   –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å 2 / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì CustomFunctions

    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –ø–æ–≤–æ–¥ —Å–ø–∞—Ä—Å–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞. –¢–µ–º–∞ —É–∂–µ –ø–æ–¥–Ω–∏–º–∞–ª–∞—Å—å –õ—ë—Ö–æ–π, –Ω–æ –∫–æ–¥ –Ω–µ –±—ã–ª –≤—ã–ª–æ–∂–µ–Ω –≤ —Å–∏–ª—É –≥—Ä–æ–º–æ–∑–¥–∫–æ—Å—Ç–∏.
    –ü–æ–¥—É–º–∞–ª, —á—Ç–æ –Ω–∞–¥–æ –±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é )))

    –ü–æ—Å–µ–º—É —Ñ—É–Ω–∫—Ü–∏—è consultant:
    (optional year as nullable number) =>
    [path = "http://www.consultant.ru/law/ref/calendar/proizvodstvennye/",
        yr = year??Date.Year(DateTime.LocalNow()), 
        from = Text.FromBinary(Web.Contents(path&Text.From(yr)&(if yr = 2020 then "b" else ""))),
        splt = List.Skip(Text.Split(from,"#(tab,tab,tab)<td class=")),
        lst=List.Zip({{1..12},splt}),
        f=(x)=>[a=Text.Split(x{1},"<td class="),
                b=List.Select(a,(x)=>not Text.Contains(x,"inactively")),
                c=List.Transform(b,(x)=>List.Range(Text.SplitAny(x,"><"),0,2))][c],
        g=(x,y)=>{#date(yr,x{0},Number.From(y{1})),Text.Remove(y{0},"""")},
        tr=List.TransformMany(lst,f,g),
        tbl=Table.FromList(tr,(x)=>x,type table [Date=date,DateType=text])][tbl]


    ()=> –û–±—Ä–∞—â–∞–µ–º –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
    path ‚Äì –æ—Ç–∫—É–¥–∞ —Ç–∞—â–∏–º
    yr ‚Äì –≥–æ–¥, –∑–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—å - –µ—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω ‚Äì –±–µ—Ä—ë–º —Ç–µ–∫—É—â–∏–π –≥–æ–¥ (—É –∫–æ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ?? –º–µ–Ω—è–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ if year is null then Date.Year(DateTime.LocalNow()) else year)
    from ‚Äì —Ç–∞—â–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Å–∞–π—Ç–∞. –ï—Å—Ç—å –Ω—é–∞–Ω—Å ‚Äì 2020 –±—ã–ª –Ω–µ–ø—Ä–æ—Å—Ç—ã–º –≥–æ–¥–æ–º, –ø–æ—ç—Ç–æ–º—É —Ç–æ–≥–¥–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ø–µ—Ä–µ–∑–∞–ª–∏–≤–∞–ª–∏ –∏ –æ–Ω –ø–æ–ª—É—á–∏–ª –∞–¥—Ä–µ—Å–∞—Ü–∏—é 2020b, —á—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∑–¥–µ—Å—å –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    split ‚Äì —Ö–∏—Ç—Ä–æ –¥–µ–ª–∏–º —Ç–µ–∫—Å—Ç ‚Äì –ø–æ–º–µ—Å—è—á–Ω—ã–µ –±–ª–æ–∫–∏ –æ—Ç–±–∏–≤–∞—é—Ç—Å—è —Ç—Ä–æ–π–Ω—ã–º —Ç–∞–±–æ–º ‚Äì –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –∫–∞–∫ —ç—Ç–æ –∑–∞–ø–∏—Å–∞–Ω–æ, –Ω—É –∏ –ø–µ—Ä–≤—ã–π –∫—É—Å–æ–∫ (–¥–æ –ø–æ–º–µ—Å—è—á–Ω—ã—Ö) –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º
    lst ‚Äì —Å–æ–µ–¥–∏–Ω—è–µ–º –±–ª–æ–∫–∏ —Ç–µ–∫—Å—Ç–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ –º–µ—Å—è—Ü–µ–≤ —á–µ—Ä–µ–∑ List.Zip
    tr ‚Äì –Ω–µ–º–Ω–æ–∂–∫–æ –ø–µ—Ä–µ—Å–∫–æ—á–∏–º ‚Äì –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ List.TransformMany, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–º –Ω—É–∂–Ω—ã –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏:
    f ‚Äì –¥–µ–ª–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ –ø–æ "<td class=", –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –±–µ–∑ "inactively" (—É –Ω–∏—Ö –Ω–∞ —Å–∞–π—Ç–µ –º–µ—Å—è—á–Ω—ã–µ –±–ª–æ–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ 7 –Ω–∞ 6, –∏ —Ç–∞–∫ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã –ø—É—Å—Ç—ã–µ), –∏ –∏—Ö —Å–ø–ª–∏—Ç—É–µ–º –ø–æ ">" –∏ "<", –æ—Å—Ç–∞–≤–∏–≤ –ø–µ—Ä–≤—ã–µ –¥–≤–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ ‚Äì —Å—Ç–∞—Ç—É—Å –∏ –Ω–æ–º–µ—Ä –¥–Ω—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ
    g ‚Äì —Å–æ–±–∏—Ä–∞–µ–º –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç—É –∏ —Å—Ç–∞—Ç—É—Å –¥–∞—Ç—ã –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∫–∞–≤—ã—á–µ–∫

    tbl ‚Äì –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É, —Å—Ä–∞–∑—É –∑–∞–¥–∞–≤ —Ç–∏–ø–∏–∑–∞—Ü–∏—é
    –ö–∞–∫ –±—ã –≤—Å—ë)))

    –ö–∞–∫ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:
    consultant() // –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥
    consultant(2024) //–∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≥–æ–¥
    Table.Combine(List.Transform({2010..2024},consultant)) //–∫–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞ –ø–µ—Ä–∏–æ–¥ –ª–µ—Ç
    ]

[   Table.TransformColumnTypes 1 ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö –ø–∞—á–∫–æ–π –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∏–º–µ–Ω–∞–º / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.TransformColumnTypes

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –û—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –≤—Å–ø–ª—ã–ª –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Ç–∏–ø–∏–∑–∞—Ü–∏—é —Å—Ç–æ–ª–±—Ü–æ–≤. –ö—Ç–æ –Ω–µ –≤ –∫—É—Ä—Å–µ –Ω–∞–ø–æ–º–Ω—é —Å—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã ‚Äì –º–æ–∂–Ω–æ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö, —á—Ç–æ–±—ã —Ç–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª—è–ª–∏—Å—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–∞–±–ª–∏—Ü—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –º–æ–∂–Ω–æ —É–∂–µ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É ¬´–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö¬ª - –∏ –≤—Å—ë –±—É–¥–µ—Ç –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ‚Ä¶ –ù–û! –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤ —Ö–æ–¥–µ –¥–∞–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ PQ —Å–æ–∑–¥–∞—ë—Ç —à–∞–≥, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏—é Table.TransformColumnTypes –∏ –≤–æ –≤—Ç–æ—Ä–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Ç–∏–ø–∞–º–∏. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—Ç–æ–ª–±—Ü—ã ‚Äì –æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ –Ω–µ –±—É–¥—É—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è, –∞ –µ—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ —Å—Ç–æ–ª–±–µ—Ü –±—É–¥–µ—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –∏–ª–∏ —É–¥–∞–ª—ë–Ω, —Ç–æ –≤–æ–æ–±—â–µ –≤—ã–ª–µ–∑–µ—Ç –æ—à–∏–±–∫–∞.

    –ü–æ—Å–µ–º—É –∑–∞–¥–∞—á–∞ ‚Äì —É–π—Ç–∏ –æ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∏ —Å–æ–æ—Ä—É–¥–∏—Ç—å –≤—Å—ë –∫–æ–¥–æ–º. –ü–æ–µ—Ö–∞–ª–∏:
    let
        from = #table({"a".."e"},{{123,"–º–∞–º–∞",12.34,#date(2023,1,1),#time(1,2,3)},{234,"–º—ã–ª–∞",23.45,#date(2023,2,2),#time(2,3,4)},{345,"—Ä–∞–º—É",34.56,#date(2023,3,3),#time(3,4,5)}}),
        lst = List.Transform(Record.FieldValues(from{0}),Value.Type),
        tr = List.Zip({Table.ColumnNames(from),lst}),
        to = Table.TransformColumnTypes(from,tr)
    in
        to

    from - –≤ –ø—Ä–æ—Å—Ç–µ–π—à–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ —É –Ω–∞—Å –∫—Ä–∞—Å–∏–≤–∞—è —Ç–∞–±–ª–∏—á–∫–∞ –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤
    lst ‚Äì –ø–æ—ç—Ç–æ–º—É –±–µ—Ä–µ–º –ø–µ—Ä–≤—É—é —Å—Ç–æ–∫—É, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –µ—ë –≤ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏—Ö —Ç–∏–ø—ã
    tr ‚Äì —Å–æ–µ–¥–∏–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —á–µ—Ä–µ–∑ List.Zip
    to ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç–æ–ª–±—Ü—ã

    –ü—Ä–∞–≤–¥–∞, –µ—Å–ª–∏ –± –≤—Å—ë –±—ã–ª–æ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –Ω–µ –±—ã–ª–æ –±—ã –ø–æ—Å—Ç–∞‚Ä¶ –í –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏:


    let
        from = #table({"a".."e"},{{123,null,12.34,#date(2023,1,1),null},{null,"–º—ã–ª–∞",null,#date(2023,2,2),#time(2,3,4)},{345,"—Ä–∞–º—É",34.56,null,#time(3,4,5)}}),
        lst=List.Transform(Table.ToColumns(Table.Range(from,0,10)),f),
        f=(x)=>List.Mode(List.Transform(List.RemoveNulls(x),Value.Type)),

        tr = List.Zip({Table.ColumnNames(from),lst}),
        to = Table.TransformColumnTypes(from,tr)
    in
        to


    from ‚Äì —É–∂–µ –º–µ–Ω–µ–µ –∫—Ä–∞—Å–∏–≤–∞—è —Ç–∞–±–ª–∏—á–∫–∞
    lst ‚Äì –ø–æ—ç—Ç–æ–º—É –º—ã –Ω–µ –º–æ–∂–µ–º –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É, –∞ –±–µ—Ä–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ 10 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–≤–æ–π 1000), —Ä–∞–∑–±–∏–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –Ω–∞ —Å–ø–∏—Å–∫–∏ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –∏ –∫ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É —Å–ø–∏—Å–∫—É –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é f
    f ‚Äì —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª—è–µ—Ç null-—ã, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–Ω–∞—á–µ–Ω–∏–π –∏ –±–µ—Ä—ë—Ç –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–π—Å—è (List.Mode)
    tr –∏ to ‚Äì –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–µ—Ä–≤–æ–º—É —Å–ª—É—á–∞—é ‚Äì —Å–æ–±—Ä–∞–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏.

    –í—É–∞–ª—è, –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞!

    –ü—Ä–∞–≤–¥–∞ –µ—Å–ª–∏ –±—ã –æ–Ω–∞ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞ –Ω–µ –±—ã–ª–æ –±—ã –Ω–æ–º–µ—Ä–∞ 1‚Ä¶
    –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —É –Ω–∞—Å –µ—â—ë –æ—Å—Ç–∞—é—Ç—Å—è ‚Äì –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª—ã–µ –∏–ª–∏ –¥—Ä–æ–±–Ω—ã–µ —á–∏—Å–ª–∞ —É –Ω–∞—Å –≤ —Å—Ç–æ–ª–±—Ü–µ, –¥–∞—Ç–∞–≤—Ä–µ–º—è –∏–ª–∏ –¥–∞—Ç–∞, –¥–∞—Ç—ã/–≤—Ä–µ–º—è/–¥–∞—Ç–∞–≤—Ä–µ–º—è –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ (–ø—Ä–∏–≤–µ—Ç 1–°) –∏ —Ç.–ø. –ò —ç—Ç–∏–º –º—ã –∑–∞–π–º–µ–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Å—Ç–µ )))
    ]

[   List.Generate, –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞, —Å–ø–∏—Å–∫–∏, –∑–∞–ø–∏—Å–∏ –∏ –∫–∞–∫–∏–µ-—Ç–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Generate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —Å–≤–æ—ë –≤—Ä–µ–º—è –º—ã —É–∂–µ —Ä–∞–∑–±–∏—Ä–∞–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ List.Generate –∏ —Å—á–∏—Ç–∞–ª–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É.
    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞—Å—á—ë—Ç –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ (–æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å–º–æ—Ç—Ä–∏–º –ø–æ —Å—Å—ã–ª–∫–µ):
    let
        lst = List.Buffer({1..250000}),
        n=List.Count(lst),
        gen = List.Generate(()=>[i=0,s=lst{i}],
                            (x)=>x[i]<n,
                            (x)=>[i=x[i]+1,s=x[s]+lst{i}],
                            (x)=>x[s])
    in
        gen


    –ò —Ç—É—Ç –±—ã–ª –∑–∞–¥–∞–Ω –≤–æ–ø—Ä–æ—Å ‚Äì –∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å (record) –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏?
    –ù—É –≤–æ–æ–±—â–µ-—Ç–æ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∏–º–æ—Ç–∞–µ–º —Å–ø–∏—Å–∫–∏:
    let
        lst = List.Buffer({1..250000}),
        n=List.Count(lst),
        gen = List.Generate(()=>{0,lst{0}},
                            (x)=>x{0}<n,
                            (x)=>{x{0}+1,x{1}+lst{x{0}+1}},
                            (x)=>x{1})
    in
        gen

    —Ç.–µ. –≤–º–µ—Å—Ç–æ –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç–∞—â–∏–º —Å–ø–∏—Å–æ–∫ –∏–∑ –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –¥–≤–∞–∂–¥—ã –≤—ã—á–∏—Å–ª—è—Ç—å —Å—á—ë—Ç—á–∏–∫, –Ω–æ –≤ —Ü–µ–ª–æ–º —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.

    –û–¥–Ω–∞–∫–æ, –ø–æ–∫–∞ –ø–∏—Å–∞–ª –æ—Ç–≤–µ—Ç, –≤–æ–∑–Ω–∏–∫–ª–∞ –¥—Ä—É–≥–∞—è –º—ã—Å–ª—å ‚Äì –∞ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∏–º–æ—Ç–∞–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:
    let
        lst = List.Buffer({1..250000}),
        n = List.Count(lst),
        gen = List.Generate(()=>0 meta [s=lst{0}],
                            (x)=>x<n,
                            (x)=>Value.ReplaceMetadata(x+1,[s=Value.Metadata(x)[s]+lst{x+1}]),
                            (x)=>Value.Metadata(x)[s])
    in
        gen

    —Ç.–µ. –≤–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –∑–∞–ø–∏—Ö–∏–≤–∞–µ–º –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é —Å—É–º–º—É –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–∞—à–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Value.Metadata –∏ Value.ReplaceMetadata, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä–æ–º–æ–∑–¥–∫–∏–º, –∑–∞—Ç–æ —Å–º. –ø—Ä–æ–º–µ—Ä—ã –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –ø–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ –ø–æ—Å—Ç–æ–º ‚Äì —ç—Ç–æ –≤–ø–æ–ª–Ω–µ —Å–µ–±–µ —à—É—Å—Ç—Ä–æ.

    –ü–æ—ç—Ç–æ–º—É –¥–µ–ª–∞–µ–º –≤—ã–≤–æ–¥—ã: –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ ‚Äì —ç—Ç–æ —Ç–æ—Ç —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ –ù–ê –ó–ê–ü–ò–°–Ø–• –±—ã—Å—Ç—Ä–µ–µ, –∞ –≤–∞—Ä–∏–∞–Ω—Ç —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏, –ø—É—Å—Ç—å —á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –∑–∞—Ç–æ –≤–µ—Å—å–º–∞ —ç–∫–∑–æ—Ç–∏—á–µ–Ω.
    –†–µ—à–∞–π—Ç–µ –∑–∞–¥–∞—á–∏ —Ä–∞–∑–Ω—ã–º–∏ –ø—É—Ç—è–º–∏ ‚Äì —ç—Ç–æ –±—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ üòâ
    ]

[   –ß–ò–°–¢–í–ù–î–û–• –Ω–∞ –ú ‚Äì –∞ –ø–æ—á–µ–º—É –±—ã –∏ –Ω–µ—Ç? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì CustomFunctions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç –∑–∞–∫–∏–Ω—É–ª–∏ –∑–∞–¥–∞—á–∫—É ‚Äì –º–æ–∂–Ω–æ –ª–∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å —ç–∫—Å–µ–ª–µ–≤—Å–∫—É—é –ß–ò–°–¢–í–ù–î–û–• —á–µ—Ä–µ–∑ PQ?
    –ù—É –±—ã–ª–æ –±—ã –Ω–µ–ª—å–∑—è, –Ω–µ –±—ã–ª–æ –±—ã –ø–æ—Å—Ç–∞ )))

    –ù–∞ –≤—Ö–æ–¥ –Ω–∞–º –ø–æ–¥–∞—é—Ç —Å–ø–∏—Å–æ–∫ –¥–∞—Ç –∏ —Å–ø–∏—Å–æ–∫ –ø–æ—Ç–æ–∫–æ–≤, –≤—ã—á–∏—Å–ª–∏—Ç—å –Ω—É–∂–Ω–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç–∞–≤–∫—É –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏, —á—Ç–æ –≤ –ø–µ—Ä–µ–≤–æ–¥–µ –Ω–∞ —Ä—É—Å—Å–∫–∏–π –æ–∑–Ω–∞—á–∞–µ—Ç —á–∏—Å–ª–µ–Ω–Ω–æ —Ä–µ—à–∏—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ.
    –ü–æ–ª—É—á–∏–ª—Å—è —Ç–∞–∫–æ–π –∫–æ–¥:
    –ß–ò–°–¢–í–ù–î–û–• =(–¥–∞—Ç—ã as list,–ø–æ—Ç–æ–∫–∏ as list) as number =>
    [   sum=(x)=>List.Sum(List.Transform(lst,(y)=>y{1}/Number.Power(1+x,y{0}))),
        min = List.Min(–¥–∞—Ç—ã),
        zip= List.Zip({–¥–∞—Ç—ã,–ø–æ—Ç–æ–∫–∏}),
        lst = List.Buffer(List.Transform(zip,(x)=>{Duration.TotalDays(x{0}-min)/365,x{1}})),
        base = Number.Sign(sum(0)),
        gen=List.Generate( ()=>[i=0,a=0,b=100,p=(a+b)/2,s=sum(p),t=Number.Sign(s), f=t=base],
                            (x)=>x[i]<100 and x[b]-x[a]>0.0000001,
                            (x)=>[  i=x[i]+1,
                                    a=if x[f] then x[p] else x[a],
                                    b=if x[f] then x[b] else x[p],
                                    p=(a+b)/2,
                                    s=sum(p),
                                    t=Number.Sign(s), 
                                    f=t=base],
                            (x)=>x[p]),
        to = List.Last(gen)][to]

    –ì–¥–µ
    sum ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã—á–∏—Å–ª—è—é—â–∞—è —Å—É–º–º—É, –∫–æ—Ç–æ—Ä—É—é –º—ã –¥–æ–ª–∂–Ω—ã –æ–±–Ω—É–ª–∏—Ç—å
    min ‚Äì —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –¥–∞—Ç–∞
    zip, lst ‚Äì –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è sum ‚Äì –ø–æ –∫–∞–∂–¥–æ–π –¥–∞—Ç–µ –ø–æ–ª—É—á–∞–µ–º –ø–µ—Ä–∏–æ–¥ –≤ –≥–æ–¥–∞—Ö –∏ —Å–∞–º –ø–æ—Ç–æ–∫
    base ‚Äì –∑–Ω–∞–∫ –∏—Å—Ö–æ–¥–Ω–æ–π —Å—É–º–º—ã (–Ω–∞–º —ç—Ç–æ –∑–Ω–∞–Ω–∏–µ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ª–æ–≤–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ –Ω–æ–ª—å)
    gen ‚Äì –Ω—É –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä ‚Äì –æ–±—ã—á–Ω—ã–π –º–µ—Ç–æ–¥ –ø–æ–ª–æ–≤–∏–Ω–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è (–∫—Ä–∞–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –∑–∞–¥–∞–ª –≤—Ä—É—á–Ω—É—é, –∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–ª–∏ –≤–æ–æ–±—â–µ –≤—ã—á–∏—Å–ª–∏—Ç—å)
    to ‚Äì —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏ –µ—Å—Ç—å –∏—Å–∫–æ–º–æ–µ.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì —Ç—É—Ç –º–∞–ª–æ –ú, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —á–∏—Å–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã.
    –ö–æ–º—É –∫–æ–¥ –ø–æ–∫–∞–∂–µ—Ç—Å—è –≥—Ä–æ–º–æ–∑–¥–∫–∏–º ‚Äì –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –Ω–∞ —Ä–µ–∫—É—Ä—Å–∏—é:
    –ß–ò–°–¢–í–ù–î–û–• =(–¥–∞—Ç—ã as list,–ø–æ—Ç–æ–∫–∏ as list) as number =>
    [   sum=(x)=>List.Sum(List.Transform(lst,(y)=>y{1}/Number.Power(1+x,y{0}))),
        min = List.Min(–¥–∞—Ç—ã),
        zip= List.Zip({–¥–∞—Ç—ã,–ø–æ—Ç–æ–∫–∏}),
        lst = List.Buffer(List.Transform(zip,(x)=>{Duration.TotalDays(x{0}-min)/365,x{1}})),
        base = Number.Sign(sum(0)),
        func=(i,a,b)=> [   p=(a+b)/2, s=sum(p), t=Number.Sign(s), f=t=base,
                            out =if i<100 and (b-a)>0.0000001 
                                    then if f 
                                            then @func(i+1,p,b) 
                                            else @func(i+1,a,p) else p ][out],
        to = func(0,0,100)][to]

    –¢–∞–∫ –Ω–µ–º–Ω–æ–∂–∫–æ –ª–∞–∫–æ–Ω–∏—á–Ω–µ–µ, —Å—É—Ç—å —Ç–∞ –∂–µ, –∫–∞–∫ –≤ –æ–±—â–µ–º –∏ —Å–∫–æ—Ä–æ—Å—Ç—å.
    –ù—É –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
    let
        from = #table({"–î–∞—Ç—ã","–ü–æ—Ç–æ–∫–∏"},{{#date(2019,1,1),-1090},{#date(2019,12,31),123},{#date(2020,12,31),123},{#date(2021,12,31),123},{#date(2022,12,31),123},{#date(2023,12,31),1353}}),
        to = –ß–ò–°–¢–í–ù–î–û–•(from[–î–∞—Ç—ã],from[–ü–æ—Ç–æ–∫–∏])
    in
        to //0.13257

    –í—Ä–æ–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–∞–∂–µ –Ω–µ –≤–µ—à–∞–µ—Ç –∫–æ–º–ø, –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   1–°.–†–∞–∑–±–∏—Ä–∞–µ–º –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —à–∞–ø–∫—É /  #1C - —à–∞–ø–∫–∞
    
    –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —à–∞–ø–∫–∏ —Ç–∞–±–ª–∏—Ü, –≤—ã–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑ 1–° –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç —Å—á–∞—Å—Ç—å—è (–ü—Ä–∏–º–µ—Ä—ã —Ç–∞–∫–∏—Ö —Ç–∞–±–ª–∏—Ü –Ω–∞–π–¥–µ—Ç–µ –≤ –ü–µ—Ä–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç—É.)
    –ó–∞—á–∞—Å—Ç—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç ¬´—Ä—É–∫–∞–º–∏¬ª –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å —à–∞–ø–∫—É —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã –ø—Ä–∏–≤–µ—Å—Ç–∏ –µ–µ –≤ —É–¥–æ–±–Ω—É—é —Ñ–æ—Ä–º—É –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã.
    –°–æ —Å–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–µ–¥–ª–æ–∂–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –≤ –ø–æ–º–æ—â—å:
    1. –î–ª—è –ø—Ä–æ—Å—Ç–æ–π –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —à–∞–ø–∫–∏ —Ç–∞–±–ª–∏—Ü—ã, –∫–æ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ–ª–µ–π (—Å–º. –ü—Ä–∏–º–µ—Ä1 –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏) –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ç–∞–∫–æ–µ:
    from=–ò—Å—Ç–æ—á–Ω–∏–∫–î–∞–Ω–Ω—ã—Ö,
        t=Table.Transpose(from),
        mergecol = Table.CombineColumns(t,{"Column1", "Column2"},Combiner.CombineTextByDelimiter(".", QuoteStyle.None),"Headers"),
        tr=Table.Transpose(mergecol),
        to=Table.PromoteHeaders(tr)


    –ö–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ –ø–æ–¥—Ö–æ–¥: –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É, –∫–æ–º–±–∞–π–Ω–∏–º —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å , —Å–Ω–æ–≤–∞ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ–º –∏ –ø–æ–¥–Ω–∏–º–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏. –î–∞–ª–µ–µ —Ç–∞–±–ª–∏—Ü—É –º–æ–∂–Ω–æ —Å–≤–µ—Ä–Ω—É—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–≤–æ–¥–Ω–æ–π: Table.UnpivotOtherColumns ()

    2. –î–ª—è —à–∞–ø–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω–µ –≤—Å–µ –ø–æ–ª—è (—Å–º. –ü—Ä–∏–º–µ—Ä 2) –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–¥–æ–º:
        from = –ò—Å—Ç–æ—á–Ω–∏–∫–î–∞–Ω–Ω—ã—Ö,
        lst=Table.ToColumns(Table.Range(from,0,2)),    
        newl=Table.ToList(Table.FillDown(Table.FromList(lst,(x)=>x),{"Column1"}),(x)=>x),    
        tr=List.Transform(newl,(x)=>Text.Combine(x,".")),    
        to=Table.RenameColumns(Table.Range(from,2),List.Zip({Table.ColumnNames(from),tr}))

    –ü–æ–¥—Ö–æ–¥ —Ç–∞–∫ –∂–µ –Ω–µ —Å–ª–æ–∂–Ω—ã–π: ¬´–û—Ç–∫—É—Å–∏–ª–∏¬ª —à–∞–ø–∫—É, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –∏ –ø—Ä–∏—Å—Ç–∞–≤–∏–ª–∏ –∑–∞–Ω–æ–≤–æ –∫ —Ç–µ–ª—É —Ç–∞–±–ª–∏—Ü—ã.

    –ù–æ —á—Ç–æ –µ—Å–ª–∏ —É—Ä–æ–≤–Ω–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç—Ä–∏ –∏ –±–æ–ª–µ–µ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —à–∞–ø–∫–∏ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ç–∞–±–ª–∏—Ü—É –≤ –ü—Ä–∏–º–µ—Ä–µ 3 ?

    3. –ù–∞ –ø–æ–º–æ—â—å –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —à–∞–ø–∫—É —Ç–∞–±–ª–∏—Ü—ã –≤ ¬´–ø–ª–æ—Å–∫–∏–π¬ª —Ñ–æ—Ä–º–∞—Ç:
    fnParsHead=(table,num,optional delim,optional fill)=>
        [ lst = List.Buffer(Table.ToColumns(Table.Range(table,0,num))), 
            delim = if delim=null then " " else delim,
            f=(x,y)=>List.Accumulate(   List.Zip({x,y}),
                                        [i=false,j={}],
                                        (s,c)=>[i=s[i]=true or c{0}<>null,j=if i then s[j]&{c{0}} else s[j]&{c{0}??c{1}}]
                                    )[j],
            g=(x)=>if fill=null then Text.Combine(x,delim) else Text.Combine(List.ReplaceValue(x,null,fill,Replacer.ReplaceValue),delim), 
            gen = List.Generate(    ()=>[i=0,l=lst{i},o=l],
                                    (x)=>x[i]<List.Count(lst),
                                    (x)=>[i=x[i]+1,l=lst{i},o=f(l,x[o])],
                                    (x)=>g(x[o])
                                ),
            out = Table.RenameColumns(Table.Range(table,num),List.Zip({Table.ColumnNames(table),gen}))][out],
        from=–ò—Å—Ç–æ—á–Ω–∏–∫–î–∞–Ω–Ω—ã—Ö,
        to=fnParsHead(from,3,".")

    –†–∞–∑–±–µ—Ä–µ–º –¥–∞–Ω–Ω—ã–π –∫–æ–¥.
    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã table, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ num, –¥–∞–ª–µ–µ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –∏–¥—ë—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ delim. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä fill –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –Ω–∏–∂–Ω–∏—Ö —É—Ä–æ–≤–Ω–µ–π –≤ —Å–ª—É—á–∞–µ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≤ –¥–∞–Ω–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ.
    lst: –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã —Å —à–∞–ø–∫–æ–π
    delim: –û–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—Ö–æ–¥—è—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏ –ø—Ä–∏ –µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–±–µ–ª
    g: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ fill –∏ –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ–Ω—É–ª–µ–≤–æ–µ, —Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –∑–Ω–∞—á–µ–Ω–∏—é –ø–æ–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ —Ñ—É–Ω–∫—Ü–∏—é fnParshead.
    f: –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ–º –¥–≤–∞ —Å–ø–∏—Å–∫–∞, —Å–≤—è–∑—ã–≤–∞–µ–º –ø–æ–ø–∞—Ä–Ω–æ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º.
    gen: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ –∫–æ–º–ø–ª–µ–∫—Å–µ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ f –∏ g.

    –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∫–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥. –ò –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –æ–∫–∞–∂–µ—Ç—Å—è –ø–æ–ª–µ–∑–Ω—ã–º ‚Äì –∑–Ω–∞—á–∏—Ç –≤—Å–µ –±—ã–ª–æ –Ω–µ –∑—Ä—è.

    –í –±–æ–ª—å—à–µ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ—Å—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—â–∏—Ö –∏–∑—É—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ö–æ—Ç—è –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã, –Ω–∞–¥–µ—é—Å—å, —Å–º–æ–≥—É—Ç –Ω–∞–π—Ç–∏ —Ç—É—Ç –¥–ª—è —Å–µ–±—è —á—Ç–æ-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ.
    –ü—Ä–∏–º–µ—Ä—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –Ω–∞—Å—É—â–Ω—É—é –∑–∞–¥–∞—á—É –ø–æ —Ä–∞–∑–±–æ—Ä—É –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —à–∞–ø–∫–∏. –¢–∞–∫ –∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–µ—à–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã, –Ω–µ –ø—Ä–∏–±–µ–≥–∞—è –∫ –∫–æ–¥—É:
    (–º—ã—à–∫–æ–∫–ª–∞—Ü–µ–º) ‚Äì —á—Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è?
    ]

[   Table.CombineColumns –∏–ª–∏ –≥–¥–µ –æ–∫–∞–∂–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Å—Ç–æ–ª–±–µ—Ü? / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.CombineColumns

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–∏–ª–∏–ª –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–∞—á–∫—É –∏ –≤—Å–ø–æ–º–Ω–∏–ª –æ–¥–∏–Ω –ø—Ä–∏—ë–º, –∫–æ—Ç–æ—Ä—ã–º –∏ —Ö–æ—á—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è.
    –ò—Ç–∞–∫, –∏–º–µ–µ–º —Ç–∞–±–ª–∏—Ü—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å ‚Äì –≤ –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å—É–º–º—É –∏ –∑–∞–ø–∏—Ö–Ω—É—Ç—å –µ—ë –≤ —Å—Ç–æ–ª–±–µ—Ü "sum". –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ ‚Äì –ø–∏—à–µ–º –∫–æ–¥:
    let
        from = #table({"a".."f"},{{1..6},{2..7},{3..8}}),
        to = Table.CombineColumns(from,{"a","c","e"},List.Sum,"sum"),//{"b","d","sum","f"}
        to1 = Table.CombineColumns(from,{"a","e","c"},List.Sum,"sum"),//{"b","sum","d","f"}
        to2 = Table.CombineColumns(from,{"c","e","a"},List.Sum,"sum")//{"sum","b","d","f"}
    in
    to2

    from ‚Äì —Ç–∞–±–ª–∏—Ü–∞,
    to ‚Äì –æ–±—ä–µ–¥–∏–Ω—è–µ–º —Å—Ç–æ–ª–±—Ü—ã {"a","c","e"} –∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å–ª–µ–¥—É—é—â–∏–º –ø–æ—Ä—è–¥–∫–æ–º —Å—Ç–æ–ª–±—Ü–æ–≤ - {"b","d","sum","f"} ‚Äì –∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π —á–∏—Ç–∞—Ç–µ–ª—å –∑–∞–º–µ—Ç–∏—Ç, —á—Ç–æ —Å—É–º–º–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–∞ –º–µ—Å—Ç–µ —Å—Ç–æ–ª–±—Ü–∞ "e", —Ç.–µ. –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤ –Ω–∞—à–µ–º —Å–ø–∏—Å–∫–µ.
    –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –¥–∞–≤–∞–π—Ç–µ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–µ–º:
    to1 ‚Äì –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å—Ç–æ–ª–±–µ—Ü "c" –∏ —Ç–µ–ø–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–∫–∞–∑–∞–ª—Å—è –Ω–∞ –µ–≥–æ –º–µ—Å—Ç–µ
    to2 ‚Äì –∞ —Ç–µ–ø–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–æ–±—â–µ –≤–Ω–∞—á–∞–ª–µ, –Ω–∞ –º–µ—Å—Ç–µ —Å—Ç–æ–ª–±—Ü–∞ "a", –ø–æ—Å–∫–æ–ª—å–∫—É –∏–º–µ–Ω–Ω–æ –µ–≥–æ –º—ã —É–∫–∞–∑–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º.

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì –¥–ª—è CombineColumns –≤–∞–∂–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –∏–º—ë–Ω –≤ —Å–ø–∏—Å–∫–µ –æ–±—ä–µ–¥–∏–Ω—è–µ–º—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ ‚Äì —Ç–∞–∫ –º—ã –º–æ–∂–µ–º —Å—Ä–∞–∑—É —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å, –≥–¥–µ –æ–∫–∞–∂–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
    ]

[   buchOfficePack ‚Äì fxUnzip ‚Äì —á–∞—Å—Ç—å 1 —è–¥—Ä–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - buchOfficePack

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù—É —á—Ç–æ –∂ ‚Äì –Ω–∞—á–∞–ª–æ—Å—å ‚Äì –ø–∏–ª–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –Ω–∞ –∫–∞–º–µ—Ä—É.
    –í–∏–¥–æ—Å —É–∂–µ –Ω–∞ –Æ—Ç—É–±–µ
    –ö–æ–¥ –¥–ª—è —Å—Ç—Ä–∞–∂–¥—É—â–∏—Ö —Ç—É—Ç:
    (ZIP)=>
        [
        u16 =BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger16,ByteOrder.LittleEndian),
        u32 =BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger32,ByteOrder.LittleEndian),
        get=(x)=>BinaryFormat.Record(
            if Binary.Range(x,0,4)=#binary({0x50,0x4b,0x03,0x04})
            then [  Name=BinaryFormat.Text(u16(Binary.Range(x,26,2))),
                    Extr=BinaryFormat.Binary(u16(Binary.Range(x,28,2))),
                    Value=BinaryFormat.Transform(BinaryFormat.Binary(u32(Binary.Range(x,18,4))),(x)=>Binary.Decompress(x,Compression.Deflate)),
                    flag=true]
            else [flag=false]
        ),
        lst = BinaryFormat.List(BinaryFormat.Choice(BinaryFormat.Binary(30),get),(x)=>x[flag]=true)(ZIP),
    to = Table.FromRecords(List.RemoveLastN(lst,1),type table [Name=text,Value=binary])][to]
    ]

[   buchOfficePack ‚Äì fxUnzip ‚Äì —á–∞—Å—Ç—å 2 –æ–±–≤–µ—Å/ #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - buchOfficePack

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø–∏–ª–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É. –í–∏–¥–æ—Å —É–∂–µ –Ω–∞ –Æ—Ç—É–±–µ

    –î–æ–±–∞–≤–∏–ª–∏ –≤—Å—ë –ø–æ –∫—Ä–∞—Å–æ—Ç–µ ‚Äì –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–ø—Ä–∞–≤–∫—É –∏ –∑–∞–ª–∏–ª–∏ –Ω–∞ –≥–∏—Ç—Ö–∞–±.
    –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–¥ –Ω–∏–∂–µ, –≤—Å–µ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –≤–∏–¥–æ—Å–µ.

    fxUnzip=[func=(ZIP, optional options)=>
        [
        encod = [a=options[Encoding]?,b=if a = null then 866 else a][b],
        compr = (x)=> if x =0 then Compression.None else Compression.Deflate,

        u16 =BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger16,ByteOrder.LittleEndian),
        u32 =BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger32,ByteOrder.LittleEndian),

        get=(x)=>BinaryFormat.Record(
            if Binary.Range(x,0,4)=#binary({0x50,0x4b,0x03,0x04})
            then [  Name=BinaryFormat.Text(u16(Binary.Range(x,26,2)),encod),
                    Extr=BinaryFormat.Binary(u16(Binary.Range(x,28,2))),
                    Value=BinaryFormat.Transform(BinaryFormat.Binary(u32(Binary.Range(x,18,4))),(y)=>Binary.Decompress(y,compr(u16(Binary.Range(x,8,2)))))]
            else []
        ),

        lst = BinaryFormat.List(BinaryFormat.Choice(BinaryFormat.Binary(30),get),(x)=>x<>[])(ZIP),
        to = Table.FromRecords(List.RemoveLastN(lst,1),type table [Name=text,Value=binary])][to],

    typ =type function (ZIP as (type binary meta [Documentation.FieldCaption="ZIP - –±–∏–Ω–∞—Ä–æ–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (zip, xlsx, docx, pptx –∏ —Ç.–¥.)"]), optional options as record) as table meta 
                [Documentation.Name = "fxUnzip (@buchlotnik)",
                Documentation.LongDescription ="—Ñ—É–Ω–∫—Ü–∏—è —Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä—Ö–∏–≤–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–ª—è–º–∏:<p> <b>Name</b> - –∏–º—è —Ñ–∞–π–ª–∞ (—Å –ø—É—Ç—ë–º –∫ —Ñ–∞–π–ª—É) <p><b>Value</b> - –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞. <p>–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç <b>options</b> –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è: <p>1) <b>Encoding</b> - —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è –Ω–µ –ª–∞—Ç–∏–Ω—Å–∫–∏—Ö –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é <b>866 - –∫–∏—Ä–∏–ª–ª–∏—Ü–∞</b>)"],

    result = Value.ReplaceType(func,typ)][result]
    ]

[   buchOfficePack - fxExcelGetRowsAttributes - —á–∞—Å—Ç—å 1 - —è–¥—Ä–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - buchOfficePack
    ]

[   buchOfficePack - fxExcelGetRowsAttributes - —á–∞—Å—Ç—å 2 - –æ–±–≤–µ—Å –∏ –Ω–µ —Ç–æ–ª—å–∫–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - buchOfficePack
    ]

[   buchOfficePack - fxTableRemoveEmptyColumns ‚Äì —É–¥–∞–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤ —Ç–∞–±–ª–∏—Ü–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - buchOfficePack

    –°–∞–º–æ —Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –±—ã–ª–æ –Ω–∞ –∫–∞–Ω–∞–ª–µ, –Ω–æ –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–¥–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å 2016 –ø—Ä–∏—à–ª–æ—Å—å –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ Table.Profile. –í –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–µ–Ω–∏–µ –≤ —Ç—Ä–∏ —Å—Ç—Ä–æ—á–∫–∏ )))
        fxTableRemoveEmptyColumns=[func =(table, optional options)=>
            [tbl = Table.Buffer(Table.Profile(table)),
            lst = Table.SelectRows(tbl,(r)=>r[Count]=r[NullCount])[Column],
            to = Table.RemoveColumns(table,lst)][to],
        typ=type function (table as table, optional options as record) as table meta 
            [Documentation.Name="fxTableRemoveEmptyColumns (@buchlotnik)",
            Documentation.LongDescription="—Ñ—É–Ω–∫—Ü–∏—è, —É–¥–∞–ª—è—é—â–∞—è –ø—É—Å—Ç—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã"],
            result = Value.ReplaceType(func,typ)
        ][result]
    ]

[   fxGetMCode ‚Äì –ø–æ–ª—É—á–∞–µ–º –∫–æ–¥ –ú, –∏—Å–ø–æ–ª—å–∑—É—è –ú / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì buchOfficePack

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –î–æ—à–ª–∏ —Ä—É–∫–∏ –¥–æ –≤—ã–Ω–∏–º–∞–Ω–∏—è –∫–æ–¥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤. –í —Ü–µ–ª–æ–º, –ø–æ—Å–ª–µ fxUnZip —ç—Ç–æ —É–∂–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Å–æ–±–æ —Å–ª–æ–∂–Ω—ã–º. –ü—Ä–æ—Å—Ç–æ –Ω–∞–¥–æ –µ—â—ë –Ω–µ–º–Ω–æ–∂–∫–æ –ø–æ—á–∏—Ç–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é.
    –ê —Ç–∞–º, –∫–∞–∫ –≤—Å–µ–≥–¥–∞, –≤—Å—ë –Ω–∞–ø–∏—Å–∞–Ω–æ –∏ –ø–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Ñ—É–Ω–∫—Ü–∏—è (–æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –ø–æ—ç—Ç–æ–º—É —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ fxUnZip —É –≤–∞—Å –∏–º–µ–µ—Ç—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏):
    fxGetMCode=(file)=>
        [u32 = BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger32,ByteOrder.LittleEndian),
        f=(x)=>[a=Text.Split(x," = "),b={Text.Trim(Text.Replace(a{0},"shared","")),Text.Combine(List.Skip(a)," = ")}][b],
        from = fxUnzip(file){[Name="customXml/item1.xml"]}?[Value]?,
        bin = Binary.FromText(Xml.Document(from){0}[Value],BinaryEncoding.Base64),
        data = BinaryFormat.Choice(BinaryFormat.Binary(8),(x)=>BinaryFormat.Binary(u32(Binary.Range(x,4,4))))(bin),
        unz = fxUnzip(data){[Name="Formulas/Section1.m"]}[Value],
        txt = Text.FromBinary(unz)&"#(cr,lf)",
        splt = Text.Split(txt,";#(cr,lf)"),
        lst = List.Range(splt,1,List.Count(splt)-2),
        tbl = Table.FromList(lst,f,{"Name","Value"}),
        to = if from=null then #table({"Name","Value"},{{null,null}}) else tbl][to]

    –ü–æ —à–∞–≥–∞–º
    u32     ‚Äì –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è 4-–±–∞–π—Ç–Ω–æ–≥–æ –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–≥–æ —Ü–µ–ª–æ–≥–æ (—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞)
    f       ‚Äì –µ—â—ë –æ–¥–Ω–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è ‚Äì –æ—Ç—Ä–µ–∑–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–¥–∞ –∑–∞–ø—Ä–æ—Å–∞

    –ê —Ç–µ–ø–µ—Ä—å –æ—Å–Ω–æ–≤–Ω–æ–µ —Ç–µ–ª–æ
    from    ‚Äì –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –∫–∞–∫ –∞—Ä—Ö–∏–≤ –∏ –≤—ã–Ω–∏–º–∞–µ–º customXml/item1.xml ‚Äì –∫–æ–¥ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–∞–º
    bin     ‚Äì –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ xml –ª–µ–∂–∏—Ç –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ —Å–∂–∞—Ç—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ (DataMashup) ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–º—É –ø–µ—Ä–≤–æ–∑–¥–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π –≤–∏–¥
    data    ‚Äì –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—ã–µ 4 –±–∞–π—Ç–∞, –∞ –≤—Ç–æ—Ä—ã–µ 4 —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –∫–æ–¥ - —á–∏—Ç–∞–µ–º
    unz     ‚Äì –∏ –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ—Ç –º–∞—Å—Å–∏–≤ –µ—â—ë –∏ —Å–∂–∞—Ç—ã–π ‚Äì —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º fxUnZip –∏ –≤—ã–Ω–∏–º–∞–µ–º Formulas/Section1.m ‚Äì —Ñ–∞–π–ª —Å –∫–æ–¥–æ–º
    txt     ‚Äì –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –±–∏–Ω–∞—Ä–∫—É –≤ —Ç–µ–∫—Å—Ç –∏ –¥–æ–ø–∏—Å—ã–≤–∞–µ–º –≤ –∫–æ–Ω—Ü–µ –ø–µ—Ä–µ–≤–æ–¥ –∫–∞—Ä–µ—Ç–∫–∏ —Å —Ä–∞–∑—Ä—ã–≤–æ–º —Å—Ç—Ä–æ–∫–∏ (—Ç–∞–º –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç–¥–µ–ª–µ–Ω—ã —Ç–æ—á–∫–æ–π —Å –∑–∞–ø—è—Ç–æ–π —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø–µ—Ä–µ–≤–æ–¥–æ–º –∫–∞—Ä–µ—Ç–∫–∏, –Ω–æ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ –∏–¥—ë—Ç –ø—Ä–æ—Å—Ç–æ —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π ‚Äì –∫–æ—Ä–æ—á–µ –¥–æ–±–∏–≤–∞–µ–º—Å—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è)
    splt    ‚Äì —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∏–º –æ–±—â–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    lst     ‚Äì –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º –ª–∏—à–Ω–∏–µ –ø–µ—Ä–≤—ã–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
    tbl     ‚Äì —Å–æ–±–∏—Ä–∞–µ–º –≤ —Ç–∞–±–ª–∏—á–∫—É, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ—Ç–¥–µ–ª—è—è –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –µ–≥–æ –∫–æ–¥–∞
    to      ‚Äì –Ω—É –∏ –Ω–∞ –≤—ã—Ö–æ–¥ –ø–æ–¥–∞—ë–º –ª–∏–±–æ —Ç–∞–±–ª–∏—á–∫—É, –ª–∏–±–æ –ø—É—Å—Ç—É—é —Ç–∞–±–ª–∏—á–∫—É, –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ñ–∞–π–ª–µ –Ω–µ –æ–∫–∞–∑–∞–ª–æ—Å—å.

    –ö–∞–∫ –æ–±—ã—á–Ω–æ, –∫–æ–¥ –∫–æ—Ä–æ—á–µ —Å–≤–æ–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è ))) –í–∏–¥–æ—Å —Å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–º —Ä–∞–∑–±–æ—Ä–æ–º –±—É–¥–µ—Ç, –Ω–æ —É–∂–µ –≤ –Ω–æ–≤–æ–º –≥–æ–¥—É. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!
    ]

[   fxDistribute ‚Äì –Ω–µ–º–Ω–æ–∂–∫–æ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –ú / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì custom

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –Ø —É–ø–æ—Ä–Ω–æ –Ω–µ –ø—ã—Ç–∞—é—Å—å —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –ú, –Ω–æ –æ–Ω–∏ —É–ø–æ—Ä–Ω–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –≤ —á–∞—Ç–µ. –ü–æ—ç—Ç–æ–º—É, —Ä–∞–∑ —É–∂ –ø–æ–¥–¥–µ—Ä–∂–∞–ª–∏ –ø–æ—Å—Ç, —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É:
    –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞—ë—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∏–∑ N –ø–æ–∑–∏—Ü–∏–π —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Ö ¬´–≤–µ—Å–∞¬ª, —Å–ø–∏—Å–æ–∫ –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ M —Ä–∞–≤–Ω—ã—Ö (–ø–æ—á—Ç–∏ —Ä–∞–≤–Ω—ã—Ö –µ—Å–ª–∏ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ) –≥—Ä—É–ø–ø —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–∞–≤–Ω–æ–π —Å—É–º–º–æ–π –≤–µ—Å–æ–≤. –û–∫, —É –º–µ–Ω—è –≤—ã—à–ª–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
    (lst,num)=>
    let
        n=Number.RoundUp(List.Count(lst)/num)*num,
        sort = List.Sort(lst&List.Repeat({0},n-List.Count(lst))),
        av=List.Average(sort),
        tr=List.Transform(sort,(x)=>x-av),
        zip = List.Zip(List.Split(tr,num)),
        
        f=(base)=>
            [tst=List.Buffer(List.Sort(base,(x)=>List.Sum(x))),
            last=List.Last(tst),
            sum1=Number.Abs(List.Sum(tst{0})),
            sum2=Number.Abs(List.Sum(last)),
            lst1=if sum2>sum1 then tst{0} else last,
            lst2=if sum2>sum1 then last else tst{0},
            cr=List.Sum(lst2),
            lst=List.TransformMany(lst2,(x)=>lst1,(x,y)=>{x,y,cr-x+y}),
            slct=   if cr <0 
                    then List.Max(List.Select(lst,(x)=>x{2}<0),null,(x)=>x{2})
                    else List.Min(List.Select(lst,(x)=>x{2}>0),null,(x)=>x{2}),
            f=(x,y,z)=>List.ReplaceRange(x,List.PositionOf(x,y),1,{z}),
            new={f(lst2,slct{0},slct{1})}&List.Range(tst,1,num-2)&{f(lst1,slct{1},slct{0})}][new],
    gen=List.Generate(()=>[i=0,l=zip,s=List.Sum(List.Transform(l,(x)=>Number.Abs(List.Sum(x)))),fl=true],(x)=>x[fl],
    (x)=>[i=x[i]+1,l=f(x[l]),s=List.Sum(List.Transform(l,(x)=>Number.Abs(List.Sum(x)))),fl=s<x[s]],
                            (x)=>x[l]),
        tbl = Table.FromColumns(List.Last(gen)),
        to=Table.TransformColumns(tbl,{},(x)=>x+av)
    in
    to

    –ü–æ —à–∞–≥–∞–º:
    n ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—â—É—é –¥–ª–∏–Ω—É —Å–ø–∏—Å–∫–∞, —á—Ç–æ–±—ã –¥–µ–ª–∏–ª–æ—Å—å –ø–æ—Ä–æ–≤–Ω—É
    sort ‚Äì –¥–æ–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã –Ω—É–ª—è–º–∏ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º
    av ‚Äì –Ω–∞—Ö–æ–¥–∏–º —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —Å–ø–∏—Å–∫—É
    tr ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ—Å–∞ –≤ –≤–µ–ª–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
    zip ‚Äì –Ω–∞—Ä–µ–∑–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ N —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–ª—É—á–∞–µ–º M –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≥—Ä—É–ø–ø ‚Äì –æ–ø–æ—Ä–Ω—ã–π –ø–ª–∞–Ω

    —Ç–µ–ø–µ—Ä—å –Ω–µ–º–Ω–æ–∂–∫–æ –ø–µ—Ä–µ—Å–∫–æ—á–∏–º
    gen ‚Äì –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º —Å–ø–∏—Å–∫–∞–º —Ñ—É–Ω–∫—Ü–∏—é f –∏ —Å–ª–µ–¥–∏–º –∑–∞ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Å—É–º–º–æ–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π ‚Äì –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø–æ–∫–∞ –æ–Ω–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
    tbl -—Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É
    to ‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ–º ¬´–≤–µ—Å–∞–º¬ª –∏—Ö –ø–µ—Ä–≤–æ–∑–¥–∞–Ω–Ω—ã–π –≤–∏–¥

    –¢–µ–ø–µ—Ä—å –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ f ‚Äì —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –∏—â–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º ‚Äì —ç—Ç–æ –≤–∞–∂–Ω–æ, –ø–æ—Ç–æ–º—É –∫–∞–∫ —Ä–µ—à–∏–ª –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å –∂–∏–∑–Ω—å –Ω–∏ —Å–µ–±–µ, –Ω–∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–µ.
    tst, last, sum1, sum2,l st1, lst2 ‚Äì –Ω–∞—Ö–æ–¥–∏–º –≥—Ä—É–ø–ø—ã —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π) –∏ –Ω–∞–∏–º–µ–Ω—å—à–µ–π (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π) —Å—É–º–º–∞–º–∏
    cr, lst ‚Äì –Ω–∞—Ö–æ–¥–∏–º –≤—Å–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —ç—Ç–∏—Ö –¥–≤—É—Ö –≥—Ä—É–ø–ø –∏ –∫–∞–∫ –∏—Ö –æ–±–º–µ–Ω –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    slct ‚Äì –≤—ã–±–∏—Ä–∞–µ–º –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –ø–∞—Ä—É
    new ‚Äì –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ–º –æ–±–º–µ–Ω —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏

    –ö–∞–∫-—Ç–æ —Ç–∞–∫. –ü–æ–∏—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–ø—Ç–∏–º–∞–ª–µ–Ω, –∑–∞—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —à—É—Å—Ç—Ä–æ –∏ –ø–∏—à–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ )))
    ]

[   fxColNumFromText ‚Äì –Ω–æ–º–µ—Ä —Å—Ç–æ–ª–±—Ü–∞ –ø–æ –∞–¥—Ä–µ—Å—É —è—á–µ–π–∫–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì custom

    –í —ç—Ç–æ—Ç —Ä–∞–∑ —Ä–µ—à–∞–µ–º —á–∞—Å—Ç–Ω—É—é –∑–∞–¥–∞—á—É ‚Äì –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–æ–º–µ—Ä —Å—Ç–æ–ª–±—Ü–∞ –ø–æ –µ–≥–æ –±—É–∫–≤–µ–Ω–Ω–æ–º—É –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—é. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ —Ç–æ, —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –µ—Å—Ç—å –µ–≥–æ —á–∏—Å–ª–æ–≤–æ–π –∫–æ–¥, –Ω—É –∏ –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏—Å—á–∏—Å–ª–µ–Ω–∏—è. –ö–æ–¥ –≤—ã—à–µ–ª –≤–µ—Å—å–º–∞ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π:
    f=(x)=>[a = List.Transform(List.Reverse(Text.ToList(Text.SplitAny(x,"0123456789"){0})),(x)=>Character.ToNumber(x)-64),
                b = List.Sum(List.Transform(List.Zip({a,List.Positions(a)}),(x)=>x{0}*Number.Power(26,x{1})))][b]
    ]

[   fxGetMCode ‚Äì –ø–æ–ª—É—á–∞–µ–º –∫–æ–¥ –ú, –∏—Å–ø–æ–ª—å–∑—É—è –ú / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì buchOfficePack / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì custom

    –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–∞–ø–∫–∏
    
    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –Ω–∞ –∫–∞–Ω–∞–ª–µ –µ—Å—Ç—å fxUnzip, –µ—Å—Ç—å fxGetMCode –∏ –µ—Å—Ç—å –ø–æ—Å—Ç –ø—Ä–æ Folder.Files.
    –ú–Ω–µ –∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–±—Ä–∞—Ç—å –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–∞–ø–∫–µ –∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë. –ù–æ –æ–∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ —è –ø—Ä–æ—Å—Ç–æ –ø–∏—à—É –Ω–µ—Ä–∞–±–æ—á–∏–π –∫–æ–¥ –∏ –≤—Å—ë –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ ¬´–Ω–µ –≤–∑–ª–µ—Ç–∞–µ—Ç¬ª. –û–ö, –Ω–∞–ø–∏—à–µ–º –∫–æ–¥ —Ü–µ–ª–∏–∫–æ–º:
    let
        lst={"QueryName","Value"},
        //—Ñ—É–Ω–∫—Ü–∏—è
        func=(file)=>[
        u16 =BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger16,ByteOrder.LittleEndian),
        u32 =BinaryFormat.ByteOrder(BinaryFormat.UnsignedInteger32,ByteOrder.LittleEndian),
        f=(x)=>[a=Text.Split(x," = "),b={Text.Trim(Text.Replace(a{0},"shared","")),Text.Combine(List.Skip(a)," = ")}][b],
        fxUnzip=(ZIP)=>
            [   get=(x)=>BinaryFormat.Record(if Binary.Range(x,0,4)=#binary({0x50,0x4b,0x03,0x04})
                    then [  Name=BinaryFormat.Text(u16(Binary.Range(x,26,2))),
                            Extr=BinaryFormat.Binary(u16(Binary.Range(x,28,2))),
                            Value=BinaryFormat.Transform(BinaryFormat.Binary(u32(Binary.Range(x,18,4))),(y)=>Binary.Decompress(y,Compression.Deflate))]
                    else []),
                lst = BinaryFormat.List(BinaryFormat.Choice(BinaryFormat.Binary(30),get),(x)=>x<>[])(ZIP),
                to = Table.FromRecords(List.RemoveLastN(lst,1),type table [Name=text,Value=binary])][to],
        from = fxUnzip(file){[Name="customXml/item1.xml"]}?[Value]?,
        bin = Binary.FromText(Xml.Document(from){0}[Value],BinaryEncoding.Base64),
        data = BinaryFormat.Choice(BinaryFormat.Binary(8),(x)=>BinaryFormat.Binary(u32(Binary.Range(x,4,4))))(bin),
        unz = fxUnzip(data){[Name="Formulas/Section1.m"]}[Value],
        splt = Text.Split(Text.FromBinary(unz)&"#(cr,lf)",";#(cr,lf)"),
        tbl = Table.FromList(List.Range(splt,1,List.Count(splt)-2),f,lst),
        to = if from=null then #table(lst,{{null,null}}) else tbl][to],
        //—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–∞–ø–∫–µ
        from = Folder.Files("–ü–£–¢–¨ –ö –ü–ê–ü–ö–ï –í–í–ï–°–¢–ò –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û"),
        filtr = Table.SelectRows(from, (r)=> (r[Extension] = ".xlsm" or r[Extension] = ".xlsx")),
        rem = Table.SelectColumns(filtr,{"Name", "Content"}),
        tr = Table.TransformColumns(rem,{"Content",func}),
        to = Table.ExpandTableColumn(tr,"Content",lst)
    in
        to

    –≥–¥–µ
    func ‚Äì —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–Ω–∏–º–∞–Ω–∏—è –∫–æ–¥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (fxUnzip –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤–Ω—É—Ç—Ä—å ¬´–≤–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ¬ª)
    from ‚Äì –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–∞–ø–∫–µ (—É–≤—ã, —è –∑–∞—Ä–∞–Ω–µ–µ –Ω–µ –∑–Ω–∞—é –ø—É—Ç—å –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–µ ‚Äì –µ–≥–æ –ø—Ä–∏–¥—ë—Ç—Å—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–≤–æ–π, —Ä—É—á–∫–∞–º–∏ ‚Äì –µ—Å–ª–∏ –¥–∞–∂–µ —ç—Ç–æ —Å—Ç–∞–Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º–æ–π ‚Äì –º–æ–∏ –ø–æ–ª–Ω–æ–º–æ—á–∏—è –≤—Å—ë)
    filtr, rem ‚Äì –æ—Å—Ç–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ —ç–∫—Å–µ–ª—å–∫–∏ –∏ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
    tr,to ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –±–∏–Ω–∞—Ä–∫–∏ —Ñ–∞–π–ª–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—ã –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª–∏ –∏—Ö

    –ò –≤—Å—ë. –ö—Ç–æ –Ω–∞–π–¥—ë—Ç –≤ –∫–æ–¥–µ –≤—ã—à–µ File.Contents, –±–µ–∑ –∫–æ—Ç–æ—Ä–æ–π —è–∫–æ–±—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äì –ø—É—Å—Ç—å –ø–µ—Ä–≤—ã–º –±—Ä–æ—Å–∏—Ç –≤ –º–µ–Ω—è –∫–∞–º–µ–Ω—å. –ë–æ–ª—å—à–∞—è –ø—Ä–æ—Å—å–±–∞ –¥—É–º–∞—Ç—å –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø–∏—Å–∞—Ç—å, —á—Ç–æ —á—Ç–æ-—Ç–æ ¬´–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç¬ª.
    ]

[   –†–∞—Å–∫–∏–¥—ã–≤–∞–µ–º –∏–µ—Ä–∞—Ä—Ö–∏—é —á–µ—Ä–µ–∑ List.Generate / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Generate

    –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤–æ–ø—Ä–æ—Å –≤—Å–ø–ª—ã–≤–∞–ª –≤ —á–∞—Ç–µ –∏ —è —É–∂–µ –¥–∞–≤–∞–ª –æ–±—Ä–∞–∑—á–∏–∫–∏ –∫–æ–¥–∞, –Ω–æ –∑–∞—Ö–æ—Ç–µ–ª–æ—Å—å –∑–∞–ø–∏—Å–∞—Ç—å –≤–∏–¥–æ—Å ‚Äì –∫–∞–∫ –≤—Å–µ–≥–¥–∞, –Ω–∞ –Æ—Ç—É–±–µ.

    –ö–æ–¥ –≤—ã—à–µ–ª –Ω–µ—Å–ª–æ–∂–Ω—ã–π, —Å–∫–ª–∞–¥—ã–≤–∞—é —Å—é–¥–∞, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–∏—Å–∫–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—å
    let
        from = Excel.CurrentWorkbook(){[Name="–ò—Å—Ç–æ—á–Ω–∏–∫"]}[Content],
        lst = List.Buffer(Table.ToList(from,(x)=>x)),
        max = List.Max(from[—É—Ä–æ–≤–µ–Ω—å]),
        n = List.Count(lst),
        
        gen=List.Generate(
            ()=>[i=0,j=lst{i},l=List.ReplaceRange(List.Repeat({null},max),j{0}-1,1,{j{1}})&List.Skip(j,2)],
            (x)=>x[i]<n,
            (x)=>[i=x[i]+1,j=lst{i},l=List.FirstN(x[l],j{0}-1)&{j{1}}&List.Repeat({null},max-j{0})&List.Skip(j,2)],
            (x)=>if (lst{x[i]+1}?{0}? ?? 0)>x[j]{0} then null else x[l]
        ),

        nms = List.Transform({1..max},(x)=>"–∑–∞–≥–æ–ª–æ–≤–æ–∫ "&Text.From(x))&List.Skip(Table.ColumnNames(from),2),
        to=Table.FromList(List.RemoveNulls(gen),(x)=>x,nms)
    in
        to
    ]

[   !!! –ü–æ–ª—É—á–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø–∏—Å–∫–∞ –ø–æ –∏—Ö –Ω–æ–º–µ—Ä–∞–º / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Transform

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –£–∂–µ –Ω–µ–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –ø–æ–¥–Ω–∏–º–∞–ª—Å—è –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø–∏—Å–∫–∞ –ø–æ –∏—Ö –Ω–æ–º–µ—Ä–∞–º. –°–º–æ—Ç—Ä–∏–º –∫–æ–¥:
    let
        from = {"a".."z"},
        /*to = from{1,4,8} - —Ç–∞–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!*/
        to = List.Transform({1,4,8},(x)=>from{x-1})
    in
    to

    –í—Å—ë –ø—Ä–æ—Å—Ç–æ ‚Äì –ù–ï–õ–¨–ó–Ø –ø–∏—Å–∞—Ç—å —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö ‚Äì —Ç–∞–∫ –Ω–∞—Å –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç.
    –ê –≤–æ—Ç —á–µ—Ä–µ–∑ List.Transform ‚Äì –≤—Å—ë –æ—á–µ–Ω—å –¥–∞–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ì–ª–∞–≤–Ω–æ–µ, –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω—É–º–µ—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –Ω—É–ª—è, –∞ –Ω–µ —Å –µ–¥–∏–Ω–∏—Ü—ã.
    ]

[   –†–∞—Å–∫–∏–¥—ã–≤–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Split

    –ü–æ–¥–æ–≥–Ω–∞–ª–∏ –º–Ω–µ –Ω–∞ –¥–Ω—è—Ö —Å—Å—ã–ª–∫—É –Ω–∞ –æ–¥–Ω–æ –≤–∏–¥–µ–æ‚Ä¶ –ì–æ—Ä–∏—Ç –¥–æ —Å–∏—Ö –ø–æ—Ä —Ç–∞–∫, —á—Ç–æ –∞–∂ –∑–∞–ø–∏—Å–∞–ª –≤–∏–¥–µ–æ. –†–µ—á—å –∏–¥—ë—Ç –æ–± –∞—Ä—Ö–∏—Å–ª–æ–∂–Ω–æ–º –∫–æ–¥–µ:
    let
        from = Excel.CurrentWorkbook(){[Name="–ò—Å—Ç–æ—á–Ω–∏–∫2"]}[Content][–°–¥–µ–ª–∫–∏],
        to = Table.FromList(List.Split(from,9),(x)=>List.FirstN(x,6))
    in
    to

    –ö–∞–∫ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ ‚Äì —ç—Ç–æ –∫–∞–∫ –ù–ê–î–û –¥–µ–ª–∞—Ç—å, –∞ –∫–∞–∫ –Ω–µ –Ω–∞–¥–æ —è –¥–∞–∂–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç—É—Ç –Ω–µ –±—É–¥—É. –û–±—â–∞—è –º—ã—Å–ª—å ‚Äì –∏–∑—É—á–∞—Ç—å –ú –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞—Ç—å —Ä–æ–≤–Ω–æ —Ç–æ, —á—Ç–æ –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏. –ë–µ–∑ –∏–∑—ã—Å–∫–æ–≤ –∏ –ø–æ–¥–≤—ã–ø–µ—Ä–¥–æ–≤.
    ]

[   –ü–æ–ª—É—á–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ Word –∏–∑ –ø–∞–ø–∫–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Folder.Files, fxUnzip

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ –∑–∞–¥–∞—á–∫—É ‚Äì –≤—ã—Ç–∞—â–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ .docx –≤ –ø–∞–ø–∫–µ.
    –ß—Ç–æ –∂ ‚Äì —ç—Ç–æ –ø–æ–≤–æ–¥ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è buchOfficePack.
    –ö–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç—É—Ç:
    let
        f=(x)=>[a=unzip(x){[Name="docProps/app.xml"]}[Value],
                b=Number.From(Xml.Tables(a){0}[Pages])][b],
        
        unzip = Expression.Evaluate(Text.FromBinary(Web.Contents("https://raw.githubusercontent.com/buchlotnik/buchlotnik_functions/main/buchOfficePack")),#shared)[fxUnzip],
        from=Folder.Files("–ø—É—Ç—å –∫ –ø–∞–ø–∫–µ"),
        filtr=Table.SelectRows(from,(r)=>r[Extension]=".docx" and not Text.Contains(r[Name],"~")),
        tbl=Table.SelectColumns(filtr,{"Name","Content"}),
        tr=Table.TransformColumns(tbl,{"Content",f})
    in
        tr
    ]

[   #sections ‚Äì —Å–æ–±–∏—Ä–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

    –í –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑ –≤ —á–∞—Ç –ø—Ä–∏—à–ª–∏ —Å –≤–æ–ø—Ä–æ—Å–æ–º ‚Äì –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—á–∫—É? –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Å–∏—Ç—É–∞—Ü–∏—è –æ—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è —Ç–µ–º —Ñ–∞–∫—Ç–æ–º, —á—Ç–æ —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è (—á–∞—â–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ).
    –ß—Ç–æ –∂ ‚Äì —ç—Ç–æ –Ω–µ—Å–ª–æ–∂–Ω–æ. –ö–æ–¥ —Å–∫–ª–∞–¥—ã–≤–∞—é —Ç—É—Ç:

    let
        from = Record.ToTable(Record.RemoveFields(#sections[Section1],"Result")),
        nms = List.Distinct(List.Combine(List.Transform(from[Value],Table.ColumnNames))),
        to = Table.ExpandTableColumn(from,"Value",nms)
    in
        to
    ]

[   –ï–ß–ò–°–õ–û, –ï–¢–ï–ö–°–¢ –∏ –ø—Ä–æ—á–∏–µ —Ä–∞–¥–æ—Å—Ç–∏ —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º is / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - –æ—Å–Ω–æ–≤—ã

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í—Ä–æ–¥–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–±—Å—É–∂–¥–∞–ª–∏ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å ‚Äì –∏ —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–æ–≥–æ, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ç–∏–ø—É (–µ—Å–ª–∏ –±—ã—Ç—å —Ç–æ—á–Ω—ã–º ‚Äì —Å–æ–≤–º–µ—Å—Ç–∏–º –ª–∏ —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —Ç–∏–ø–æ–º).
    –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –∫–æ–¥:
    let
        from = #table({"val"},{{null},{1.23},{"—Ç–µ–∫—Å—Ç"},{false},{#date(2024,2,3)},{#datetime(2024,2,3,12,34,56)},{{1..3}},{[a=1]},{#table({},{})},{(x)=>x}}),
        lst={   {"–ï–ü–£–°–¢–û",(x)=>x=null}, //–º–æ–∂–Ω–æ –∏ x is null
                {"–ï–ß–ò–°–õ–û",(x)=>x is number},
                {"–ï–¢–ï–ö–°–¢",(x)=>x is text},
                {"–ï–õ–û–ì–ò–ß",(x)=>x is logical},
                {"–ï–î–ê–¢–ê",(x)=>x is date},
                {"–ï–î–ê–¢–ê–í–†–ï–ú–Ø",(x)=>x is datetime},
                {"–ï–°–ü–ò–°–û–ö",(x)=>x is list},
                {"–ï–ó–ê–ü–ò–°–¨",(x)=>x is record},
                {"–ï–¢–ê–ë–õ–ò–¶–ê",(x)=>x is table},
                {"–ï–§–£–ù–ö–¶–ò–Ø",(x)=>x is function},
                {"–ï–ß–¢–û–£–ì–û–î–ù–û",(x)=>x is any},
                {"–ï–í–û–û–ë–©–ï–ù–ò–ß–ï–ì–û",(x)=>x is none}},
        to=List.Accumulate(lst,from,(s,c)=>Table.AddColumn(s,c{0},(r)=>c{1}(Record.Field(r,"val"))))
    in
        to
    –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –∫—Ä–æ–º–µ –∫–æ–¥–∞ —Ç—É—Ç –∏ –≥–æ–≤–æ—Ä–∏—Ç—å –ø–æ—á—Ç–∏ –Ω–µ—á–µ–≥–æ ‚Äì –æ–ø–µ—Ä–∞—Ç–æ—Ä is –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É, —Å–æ–≤–º–µ—Å—Ç–∏–º –ª–∏ —Ç–∏–ø –∑–Ω–∞—á–µ–Ω–∏—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø—Ä–∏–º–∏—Ç–∏–≤–æ–º, —Ç.–µ. –≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —á–∏—Å–ª–æ–º, —Ç–µ–∫—Å—Ç–æ–º, —Ç–∞–±–ª–∏—Ü–µ–π –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–µ–π. –ó–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏, –±–µ–∑ –æ–±–∏–¥, –æ—Ç–ø—Ä–∞–≤–ª—è—é –≤ —Å–ø—Ä–∞–≤–∫—É. –ê –∑–¥–µ—Å—å, —á–∏—Å—Ç–æ –¥–ª—è –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏, –ø—Ä–æ—à—É –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –¥–≤–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–∞ ‚Äì –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å any (–≤—Å–µ –æ–Ω–∏ —á–µ–º-—Ç–æ –¥–∞ —è–≤–ª—è—é—Ç—Å—è) –∏ –Ω–∏ –æ–¥–Ω–æ –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å none (—Ç.–µ. –¥–∞–∂–µ null –±–æ–ª—å—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ –Ω–∏—á–µ–≥–æ).

    –ö–∞–∫-—Ç–æ —Ç–∞–∫ ‚Äì —Å—É–≥—É–±–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–æ—Å—Ç, —á—Ç–æ–±—ã –±—ã–ª–æ –Ω–∞ —á—Ç–æ –¥–∞–≤–∞—Ç—å —Å—Å—ã–ª–∫—É)))
    ]

[   Table.Group+GroupKind.Local ‚Äì –ª–æ–∫–∞–ª—å–Ω–æ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –ø–∞—á–∫–æ–π / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.Group

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç –∑–∞–∫–∏–Ω—É–ª–∏ –ø—Ä–æ—Å—Ç—É—é, –Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∑–∞–¥–∞—á–∫—É –Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É. –ü–æ—ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É —Å–∫–ª–∞–¥—ã–≤–∞—é —Å—é–¥–∞ –∫–æ–¥:
    let
        from =  Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        nms  =  List.Transform(
                    List.Skip(Table.ColumnNames(from),2),
                    (x)=>{x, (t)=>Text.Combine(Table.Column(t,x)," "), type text}
                ),
        gr   =  Table.Group(from,
                    {"–ò–Ω–¥–µ–∫—Å","Index"},
                    nms,
                    GroupKind.Local,
                    (s,c)=>Number.From(c[Index]=4)
                )
    in  gr
    ]

[   –ó–∞–º–µ–Ω–∞ null –Ω–∞ –Ω–æ–ª—å –ø–∞—á–∫–æ–π –ø–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.ReplaceValue, Table.TransformColumns

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í—Ä–æ–¥–µ —Ç—ã—Å—è—á—É —Ä–∞–∑ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏, –Ω–æ –≤—Å–ø–ª—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ö ‚Äì –∫–∞–∫ –º–∞—Å—Å–æ–≤–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω—É–ª–ª—ã –Ω–∞ –Ω—É–ª–∏ –≤–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö —Ç–∞–±–ª–∏—Ü—ã.
    –ï—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã:
    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        to = Table.ReplaceValue(from,null,null,(x,y,z)=>if x=null then 0 else x,Table.ColumnNames(from))
    in
        to

    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        f=(x)=>if x=null then 0 else x,
        nms=List.Transform(Table.ColumnNames(from),(x)=>{x,f}),
        to = Table.TransformColumns(from,nms)
    in
        to

    let
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        to = Table.TransformColumns(from,{},(x)=>if x=null then 0 else x)
    in
        to
    –ú–Ω–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π, –Ω–æ —ç—Ç–æ –¥–µ–ª–æ –≤–∫—É—Å–∞.
    ]

[   Table.ColumnNames + Record.SelectFields - –≤—ã–Ω–∏–º–∞–µ–º –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Record.SelectFields

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –Ω–µ—Å–ª–æ–∂–Ω—É—é –∑–∞–¥–∞—á–∫—É –ø–æ –≤—ã–Ω–∏–º–∞–Ω–∏—é –ø–æ–ª–µ–π —Å —Ü–µ–Ω–∞–º–∏ –∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—é –º–∞–∫—Å–∏–º—É–º–∞ —Å—Ä–µ–¥–∏ –Ω–∏—Ö.
    –ï—Å—Ç—å –∫–æ–¥ –ø–æ–ø—Ä–æ—â–µ
    let
        from = Excel.CurrentWorkbook(){[Name="–û–±—ã—á–Ω–∞—è"]}[Content],
        f=(x)=>List.Max(List.Alternate(List.Skip(Record.ToList(x),4),2,1)),
        to = Table.AddColumn(from,"max",f)
    in
        to

    –ê –µ—Å—Ç—å –ø–æ—Å–ª–æ–∂–Ω–µ–µ, –Ω–æ –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω–µ–µ:
    
    let
        from = Excel.CurrentWorkbook(){[Name="–ê–î"]}[Content],
        lst  = List.Buffer(List.Select(Table.ColumnNames(from),(x)=>Text.Contains(x,"–¶–µ–Ω–∞"))),
        f=(x)=>List.Max(Record.ToList(Record.SelectFields(x,lst))),
        to   = Table.AddColumn(from,"max",f)
    in
        to

    –ß—Ç–æ —Ç—É—Ç –∫ —á–µ–º—É —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ–æ –Ω–∞ –Æ—Ç—É–±–µ
    ]

[   List.Split + List.Zip + List.Combine = —Ç–∞–±–ª–∏—Ü–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

    –í —á–∞—Ç –ø—Ä–∏–Ω–µ—Å–ª–∏ –ø—Ä–∏–∫–æ–ª—å–Ω—É—é –∑–∞–¥–∞—á–∫—É –Ω–∞ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–Ω–æ–≥–æ –∫—É—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É.
    –ü—Ä–∏—à–ª–æ—Å—å —Ä–µ–∑–∞—Ç—å, –∫—Ä—É—Ç–∏—Ç—å, —à–∏—Ç—å –∏ –≤–æ–æ–±—â–µ –¥–µ–ª–∞—Ç—å –≤—Å—è–∫–æ–µ. –ö–æ–¥–∞ –≤—ã—à–ª–æ –Ω–µ–º–Ω–æ–≥–æ:
    let
        f=(x)=>[a=Number.From(Text.Split(x{0}[Column1]," "){4}),
                b=List.Combine(Table.ToList(Table.Skip(x,2),(x)=>List.Split(x,2))),
                c=List.Transform(b,(x)=>{a}&x)][c],
        
        from = Excel.CurrentWorkbook(){[Name="TData"]}[Content],
        gr = Table.Group(from,"Column2",{"tmp",f},GroupKind.Local,(s,c)=>Number.From(c=null)),
        to = Table.FromList(List.Zip(gr[tmp]),List.Combine)
    in
        to
    ]

[   Table.Group + List.Generate = —Å–ª–æ–∂–Ω–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì Table.Group

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

    –ó–∞–ø–∏—Å–∞–ª –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑–±–æ—Ä –∑–∞–¥–∞—á–∫–∏ –∏–∑ —á–∞—Ç–∞ ‚Äì –ø–æ–ª—É—á–∏–ª–æ—Å—å –Ω–µ–º–Ω–æ–∂–∫–æ –¥–æ–ª–≥–æ, –ø–æ—Ç–æ–º—É –∫–∞–∫ –∑–∞–¥–∞—á–∫–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è, –Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–±–µ–∑—ã–Ω—Ç–µ—Ä–µ—Å–Ω–æ. –ö–æ–¥ —Ç—É—Ç:
    let
        f=(x)=>[a=List.Transform(nms2,(i)=>List.Sum(Table.Column(x,i))),
                b=List.Min(x[–ü–µ—Ä–∏–æ–¥ —Å]),
                c=List.Max(x[–ü–µ—Ä–∏–æ–¥ –ø–æ]),
                gen=List.Generate(  ()=>b,
                                    (x)=>x<Date.EndOfMonth(c),
                                    (x)=>Date.AddMonths(x,1),
                                    (x)=>{Date.StartOfMonth(x),Date.EndOfMonth(x),Date.StartOfMonth(x)}),
                n=List.Count(gen)-1,
                tr=List.ReplaceRange(gen,n,1,{{gen{n}{0},c,gen{n}{0}}}),
                tr1=List.ReplaceRange(tr,0,1,{{b,tr{0}{1},tr{0}{2}}&a})][tr1],
        
        from = Excel.CurrentWorkbook(){[Name="–ú3"]}[Content],
        nms1 ={"–ü–µ—Ä–∏–æ–¥ —Å","–ü–µ—Ä–∏–æ–¥ –ø–æ","–ü–µ–∏—Ä–æ–¥ –º–µ—Å—è—Ü"},
        nms2 = {"–°—É–º–º–∞ —Å –ù–î–°","–°—É–º–º–∞ –±–µ–∑ –ù–î–°","–°—É–º–º–∞ –ù–î–°"},
        gr=Table.Group(from,"–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç",{{"–ü–ª–æ—â–∞–¥–∫–∞",(t)=>Text.Combine(List.Distinct(t[–ü–ª–æ—â–∞–¥–∫–∞]),", ")},{"tmp",f}}),
        sort=Table.Sort(gr,"–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç"),
        exp=Table.ExpandListColumn(sort,"tmp"),
        splt=Table.SplitColumn(exp,"tmp",(x)=>x,nms1&nms2),
        to=Table.TransformColumnTypes(splt,List.Transform(nms1,(x)=>{x,type date})&List.Transform(nms2,(x)=>{x,type number}))
    in
        to
    ]

[   List.Accumulate vs List.Zip - –∏–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∑–∞–º–µ–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–µ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì List.Accumulate

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í —á–∞—Ç –ø—Ä–∏–Ω–µ—Å–ª–∏ –∑–∞–¥–∞—á–∫—É –ø–æ –∑–∞–º–µ–Ω–µ –≤ —Ç–µ–∫—Å—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–ª–∏–Ω–Ω—ã—Ö —Ç–∏—Ä–µ –Ω–∞ —Å–ª–µ—à. –ü–æ—Å–∫–æ–ª—å–∫—É –æ–±—ã—á–Ω—ã–µ —Ç—Ä–∏–º—ã —Å —Ä–µ–ø–ª–µ–π—Å–∞–º–∏ –≤ —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –ø—Ä–∏—à–ª–æ—Å—å –ø–æ–∫–æ–ª–¥–æ–≤–∞—Ç—å. –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–æ—Å—Ç–æ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ö:
    let
        f=(x)=>[lst = Text.ToList(x),
                zip = Text.Replace(Text.Combine(List.Transform(List.Select(List.Zip({lst,List.Skip(lst)}),(x)=>x<>{"‚Äî","‚Äî"}),(x)=>x{0})),"‚Äî","/")][zip],
        
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        to = Table.TransformColumns(from,{"txt",f})
    in
    to

    –í–∞—Ä–∏–∞–Ω—Ç —Å if then else:
    let
        f=(x)=>[lst = Text.ToList(x),
                zip = Text.Combine(List.Transform(List.Zip({lst,List.Skip(lst)}),(x)=>if x{0}<>"‚Äî" then x{0} else if x{1}="‚Äî" then "" else "/"))][zip],
        
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        to = Table.TransformColumns(from,{"txt",f})
    in
        to

    –ò –≤–∞—Ä–∏–∞–Ω—Ç —Å –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–æ–º:
    let
        f=(x)=>List.Accumulate(Text.ToList(x),"",(s,c)=>if c<>"‚Äî" then s&c else if Text.EndsWith(s,"/") then s else s&"/"),
        
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        to = Table.TransformColumns(from,{"txt",f})
    in
        to
    –ù—É –∞ –æ —Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–µ–¥–ª–µ–Ω–Ω—ã–π –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä –∏–ª–∏ –∫–æ—Ä–æ—á–µ=–±—ã—Å—Ç—Ä–µ–µ, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –∫–∞–∫ –æ–±—ã—á–Ω–æ, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Æ—Ç—É–±–µ
    ]

[   Table.Group, ListAnyTrue –∏ –ø—Ä–æ—á–∏–µ Splitter.SplitTextByCharacterTransition / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - —é—Ç—É–±

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –ø—Ä–∏–∫–æ–ª—å–Ω—É—é –∑–∞–¥–∞—á–∫—É –≤ —á–∞—Ç - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, —Å–ª–æ–≤–∞—Ä–∏, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è ‚Äì –ø–æ–ª—É—á–∏–ª —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ, –∑–∞–ø–∏—Å–∞–ª —Ä–∞–±–æ—Ä.
    –ö–æ–¥ —Å–∫–ª–∞–¥—ã–≤–∞—é —Ç—É—Ç:
    let
        lst=List.Buffer({"0".."9"}),
        
        dict = Record.FromTable(Excel.CurrentWorkbook(){[Name="—Å–ø—Ä–°—É–±—ä–µ–∫—Ç—ã2"]}[Content]),
        f=(x)=>if List.AnyTrue(List.Transform({"R","UA","UB","UC", "UD", "UE", "UF", "UG", "UH", "UI"},(y)=>Text.StartsWith(x,y)))
                then Record.Field(dict,Text.Start(Splitter.SplitTextByCharacterTransition((i)=>not List.Contains(lst,i),lst)(x){1},2))
                else null,
        g=(x)=>if x{0}[reg]=null 
                then Table.AddColumn(x,"–û–±–ª–∞—Å—Ç—å",(r)=>null)
                else Table.TransformColumns(Table.AddIndexColumn(Table.Sort(x,{"Date","Time"}),"–û–±–ª–∞—Å—Ç—å",1),{"–û–±–ª–∞—Å—Ç—å",(x)=>if x=1 then 1 else 0}),


        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞"]}[Content],
        add = Table.AddColumn(from,"reg",(r)=>f(r[HisCall])),
        gr = Table.Group(add,{"MyCall","Band","reg"},{"tmp",g}),
        tbl = Table.Combine(gr[tmp]),
        to = Table.RemoveColumns(tbl,"reg")
    in
        to
    ]

[   List.Skip, List.FirstN, List.Positions ‚Äì –ø—Ä–∏–∫–æ–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ —Å–ø–∏—Å–∫–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Skip, List.FirstN, List.Positions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –∑–∞–¥–∞—á–∫—É –Ω–∞ —Å–±–æ—Ä–∫—É —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –±—É–∫–≤ —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞.
    –†–µ—à–∏–ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å - –¥–æ–±–∞–≤–∏–ª –Å, –Ω—É –∏ –Ω–∞–ø–∏—Å–∞–ª –≤—Å—ë –ø–æ-—Ö—É–ª–∏–≥–∞–Ω—Å–∫–∏:
    
    [ a =   List.Buffer({"–ê".."–ï","–Å","–ñ".."–Ø"}),
      b =   Table.FromList(
                List.Positions(a),
                (b)=>List.Skip(a,b) & List.FirstN(a,b) & {a{b} },
                {" "} & a
            )
    ][b]

    –ù—É –∞ —á—Ç–æ —Ç—É—Ç –∫ —á–µ–º—É, –∫–∞–∫ –æ–±—ã—á–Ω–æ, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Æ—Ç—É–±–µ
    ]

[   Number.Mod, List.Positions –∏–ª–∏ —Ä–µ–∞–ª–∏–∑—É–µ–º –∫–æ–¥ –í–∏–∂–∏–Ω–µ—Ä–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Number.Mod, List.Positions

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –í—á–µ—Ä–∞ —Ä–µ—à–∞–ª–∏ –∑–∞–¥–∞—á—É –ø–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é —Ç–∞–±–ª–∏—Ü—ã —Å–æ —Å–¥–≤–∏–≥–∞–º–∏, –Ω–æ –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ —ç—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –¢–∞–∫ –≤–æ—Ç ‚Äì –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü–∞ –≤–æ–æ–±—â–µ –Ω–µ –Ω—É–∂–Ω–∞, –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä–∞, –æ—Å—Ç–∞—Ç–∫–∏ –∏ –≤—Å—è–∫–æ–µ —Ç–∞–∫–æ–µ. –ü–æ—ç—Ç–æ–º—É –≤–æ—Ç –∫–æ–¥:
    (tbl,key,cr)=>
    let
        lst=List.Buffer({"–ê".."–ï","–Å","–ñ".."–Ø","–∞".."–µ","—ë","–∂".."—è","A".."Z","a".."z","0".."9"," ",",",".",":","-"}),
        c=if cr=0 then 1 else -1,

        d=Record.FromList(List.Positions(lst),lst),
        e=List.Buffer(List.Transform(Text.ToList(key),(x)=>Record.Field(d,x))),
        n=List.Count(lst),

        f=(x)=>if x is text then [a=Text.ToList(x),b=Text.Combine(List.Transform(List.Zip({a,List.Positions(a)}),g))][b] else x,
        g=(x)=>lst{Number.Mod(n+Record.Field(d,x{0})+c*(e{Number.Mod(x{1},List.Count(e))}+1),n)},
        
        to=Table.TransformColumns(tbl,{},f)
    in
        to
    –í–∞–∂–Ω–æ ‚Äì –ø–æ–º–µ–Ω—è–ª –≤ –∫–æ–¥–µ –ø—Ä–æ–≤–µ—Ä–∫—É —É—Å–ª–æ–≤–∏—è ‚Äì –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ null, –∞ –∏–º–µ–Ω–Ω–æ –Ω–∞–ª–∏—á–∏–µ —Ç–µ–∫—Å—Ç–∞.
    ]

[   –†–µ–∫—É—Ä—Å–∏—è, if then else –∏–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∑–∞–¥–∞—á–∫–∞ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì —Ä–µ–∫—É—Ä—Å–∏—è

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ó–∞–ø–∏—Å–∞–ª —Ä–∞–∑–±–æ—Ä –æ—á–µ—Ä–µ–¥–Ω–æ–π –∑–∞–¥–∞—á–∫–∏ –∏–∑ —á–∞—Ç–∞ ‚Äì –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –º—É—á–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤.
    –ö–æ–¥:
    let
        a = PP_—Ç–∏—Ç—É–ª—å–Ω–∏–∫[tol],
        b = Table.ToList(PostgreSQL_–±–ª–æ–∫–∏,(x)=>x),
        c = List.Count(a),
        d = List.Buffer({List.Repeat({null},Table.ColumnCount(PostgreSQL_–±–ª–æ–∫–∏))&{"fail"}}),
        f=(x,y,z,w)=>[k=a{x},l=b{x+y},m=b{x+y+1}?,
                    n = if x = c then z
                    else if w then @f(x+1,y,z&d,w)
                    else if k = l{0} then @f(x+1,y,z&{l&{"no"}},w)
                    else if k = m{0}? then @f(x+1,y+1,z&{m&{"yes: "&l{0}}},w)
                    else @f(x+1,y,z&d,true)][n],


        e = Table.FromList(f(0,0,{},false),(x)=>x)
    in
    ]

[   –†–µ–∫—É—Ä—Å–∏—è, Folder.Contents –∏–ª–∏ –ø–æ–±–µ–∂–¥–∞–µ–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Folder.Contents

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!

    –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ç–µ–º—É —Ä–µ–∫—É—Ä—Å–∏–∏. –°–µ–≥–æ–¥–Ω—è –ø–æ–±–µ–∂–¥–∞–µ–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤, –∞ –¥–ª—è —ç—Ç–æ–≥–æ –≤–º–µ—Å—Ç–æ Folder.Files –∏—Å–ø–æ–ª—å–∑—É–µ–º Folder.Contents –∏ –ø–∏—à–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ.
    let
        from = Folder.Contents("C:\Users\muzyk\Desktop\–ø–∞–ø–∫–∞1"),
        f=(x)=>[a=Table.SelectRows(x,(r)=>r[Extension]<>""),
                b=Table.SelectRows(x,(r)=>r[Extension]="")[Content],
                c=if b={} then x else @f(List.Accumulate(b,a,(s,c)=>[a=try Table.RowCount(c) otherwise 0,
                                                                        b=if a=0 then s else s&c][b]))][c],
        to=f(from)
    in
        to
    ]

[   –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ä–º–∞—Ç—ã –¥–ª—è —è—á–µ–µ–∫ - –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç, –∂—ë–ª—Ç–∞—è –∑–∞–ª–∏–≤–∫–∞ –∏ —Ç.–¥. / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Xml.Tables, Xml.Document

    –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
    –ü—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å - –º–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –∏–∑ —è—á–µ–µ–∫, –∑–∞–ª–∏—Ç—ã—Ö –∂—ë–ª—Ç—ã–º, –∏–ª–∏ —Å –∫—Ä–∞—Å–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º, –∏–ª–∏ –∂–∏—Ä–Ω—ã–º –∏ —Ç.–ø. –ì–ª–æ–±–∞–ª—å–Ω–æ ‚Äì –º–æ–∂–Ω–æ., –Ω–æ‚Ä¶
    –ü–æ–ª—É—á–∏–ª–æ—Å—å –¥–æ–ª–≥–æ, –ø–æ—Ç–æ–º—É –∫–∞–∫ —Ç–∞–º –≤—Å—ë –Ω–µ–ø—Ä–æ—Å—Ç–æ - —Ç–∞–∫ —á—Ç–æ —Ä–µ—à–∞–π—Ç–µ —Å–∞–º–∏, –Ω–∞–¥–æ –ª–∏ –≤–∞–º –æ–Ω–æ )))
    –í–æ—Ç –∫–æ–¥:
    let
        file = File.Contents("–ø—É—Ç—å/—Ñ–∞–π–ª.xlsx"),
        unz = fxUnzip(file),
        book = Table.SelectRows(Excel.Workbook(file,false),(r)=>r[Kind]="Sheet"),
        style = Xml.Tables(unz{[Name="xl/styles.xml"]}[Value]),
        cellstyle=Table.Buffer(style{[Name="cellXfs"]}[Table]{0}[xf]),
        font=style{[Name="fonts"]}[Table]{0}[font],
        fill=style{[Name="fills"]}[Table]{0}[fill],
        n=1,
        sheet=book{n-1}[Data],
        sheetdata=Xml.Document(unz{[Name="xl/worksheets/sheet"&Text.From(n)&".xml"]}[Value]){0}[Value]{[Name="sheetData"]}[Value],
        f=(x)=>Number.From(x{0}[Attributes]{[Name="s"]}?[Value]?),
        tr=Table.TransformColumns(sheetdata,{{"Attributes",(x)=>x{[Name="r"]}[Value]},{"Value",f}}),
        dict=Record.FromList(tr[Value],tr[Attributes]),
        min=List.Min(List.Transform(tr[Attributes],Number.From)),
        add=Table.AddIndexColumn(sheet,"row",min),

        tr1=Table.TransformColumns(add,{"row",(x)=>Record.FieldOrDefault(dict,Text.From(x))}),
        tr2=Table.TransformColumns(tr1,{"row",(x)=>if x=null then null else cellstyle{x}}),
        tr3=Table.TransformColumns(tr2,{"row",(x)=>[a=Number.From(x[#"Attribute:fontId"]?),b=if a=null then null else font{a}[b]][b]}),
        skip = Table.PromoteHeaders(Table.Skip(tr3,(r)=>r[Column7]=null)),
        to = Table.SelectRows(skip, each ([Column8] = ""))
        /*—Ü–≤–µ—Ç —à—Ä–∏—Ñ—Ç–∞ - tr3=Table.TransformColumns(tr2,{"row",(x)=>[a=Number.From(x[#"Attribute:fontId"]?),b=if a=null then null else font{a}[color]{0}[#"Attribute:rgb"]?][b]}) 
        —Ü–≤–µ—Ç –∑–∞–ª–∏–≤–∫–∏ - tr3=Table.TransformColumns(tr2,{"row",(x)=>[a=Number.From(x[#"Attribute:fillId"]?),b=if a=null then null else fill{a}[patternFill][fgColor]?{0}?{0}?[#"Attribute:rgb"]?][b]})*/
    in
        to
    ]
[   MCMLXXXVIII=1988 –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä–∏–º—Å–∫—É—é –∑–∞–ø–∏—Å—å —á–∏—Å–ª–∞ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—É—é / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - List.Zip
    
    –†–µ—à–∏–ª —Ä–∞–∑–æ–±—Ä–∞—Ç—å –∑–∞–¥–∞—á–∫—É –Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–∏–º—Å–∫–æ–π –∑–∞–ø–∏—Å–∏ —á–∏—Å–ª–∞ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é. –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ –∑–∞–Ω—è—Ç–∏–µ —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω–æ–µ, –Ω–æ –≤–æ–æ–±—â–µ —ç—Ç–æ –Ω–µ–ø–ª–æ—Ö–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ —Å–ø–∏—Å–∫–∏.
    –ü–æ—ç—Ç–æ–º—É –∫–æ–¥:
    let
        unroman=(txt)=>[
        dct=[I=1,V=5,X=10,L=50,C=100,D=500,M=1000],
        lst=Text.ToList(txt),
        tr=List.Transform(lst,(x)=>Record.Field(dct,x)),
        zip=List.Zip({tr,List.Skip(tr)&{0}}),
        tr2=List.Transform(zip,(x)=>if x{0}<x{1} then -x{0} else x{0}),
        to = List.Sum(tr2)][to],
        
        from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content],
        to = Table.AddColumn(from,"arab",(r)=>unroman(r[r]))
    in
        to

    // Table.ReplaceRows –∏ —Å–ª–∏—è–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π ‚Äì –∏–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ
    #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Table.ReplaceRows

    –ü–æ–¥–∫–∏–Ω—É–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –∑–∞–¥–∞—á–∫—É –Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É ‚Äì –Ω–∏—á–µ–≥–æ —Å–ª–æ–∂–Ω–æ–≥–æ, –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ —É—Å–ª–æ–≤–∏—é –∏ —Ä–∞–∑–Ω–æ–µ –¥–ª—è –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫. –ß–µ–≥–æ-—Ç–æ –Ω–∞–∫–∞—Ç–∏–ª–æ —Å–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ Table.ReplaceRows. –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –∫–æ–¥:
    let
        from = Excel.CurrentWorkbook(){[Name="headcount"]}[Content],
        f=(x)=>[a=Table.Sort(x,{"headcount_–°—Ç–∞–≤–∫–∏, –µ–¥ –∏–∑–º",Order.Descending}),
                b=Table.TransformColumns(a,{"–°—Ç–∞–≤–∫–∏_–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ—Å—Ç–æ",(x)=>"–Ω–µ—Ç,–≤–Ω–µ—à–Ω–∏–π"}),
                c=Table.ReplaceRows(b,0,1,{b{0}&[–°—Ç–∞–≤–∫–∏_–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ—Å—Ç–æ="–¥–∞,–≤–Ω–µ—à–Ω–∏–π"]}),
                d=if List.Contains(x[–°—Ç–∞–≤–∫–∏_–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ—Å—Ç–æ],"–¥–∞") then x else c][d],
        gr = Table.Group(from,{"–°—Ç–∞–≤–∫–∏_–ü–æ–∑–∏—Ü–∏—è","–ü–µ—Ä–∏–æ–¥_int","–ì–æ—Ä–∏–∑–æ–Ω—Ç_–º–∞—Ä–∫–µ—Ä"},{"tmp",f}),
        to=Table.Combine(gr[tmp])
    in
        to
    ]
    
[   Record.HasFields –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∑–∞—â–∏—Ç—ã –ª–∏—Å—Ç–æ–≤ –∫–Ω–∏–≥–∏ / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π - Record.HasFields
    
    –ü–æ—Å–∫–æ–ª—å–∫—É –º–Ω–µ —É–∂–µ –Ω–µ–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –∑–∞–¥–∞–ª–∏ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –ø–∏—à—É —Ä–∞–∑–±–æ—Ä. –ò—Ç–∞–∫ –∑–∞–¥–∞—á–∞: –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –≤—Å–µ—Ö –ª–∏ –ª–∏—Å—Ç–∞—Ö –≤ —Ñ–∞–π–ª–∞—Ö –ø–∞–ø–∫–∏ —Å—Ç–æ–∏—Ç ¬´–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è¬ª –∑–∞—â–∏—Ç–∞. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–±—è –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø–∞—Ä–æ–ª—è –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫ ‚Äì –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –Ω–µ–≥–æ–¥–Ω–∏–∫–æ–≤.
    –ù—É –û–ö, –≤–æ—Ç –∫–æ–¥:
    let
        f=(x)=>[
        file = Binary.Buffer(x),
        book = Table.SelectRows(Excel.Workbook(file,false),(r)=>r[Kind]="Sheet"),
        xml = Table.SelectRows(fxUnzip(file),(r)=>Text.Contains(r[Name],"xl/worksheets/sheet"))[Value],
        f=(x)=>Record.HasFields(Xml.Tables(x){[Name="sheetProtection"]}?[Table]?{0}? ?? [],{"Attribute:hashValue","Attribute:sheet","Attribute:sort","Attribute:autoFilter"}),
        lst = List.Transform(xml,f),
        tbl = Table.FromColumns(Table.ToColumns(book)&{lst},Table.ColumnNames(book)&{"protection"})][tbl],
        folder=Folder.Files("–ø—É—Ç—å –∫ –ø–∞–ø–∫–µ")[[Folder Path],[Name],[Content]],
        tr = Table.TransformColumns(folder,{"Content",f}),
        exp = Table.ExpandTableColumn(tr,"Content",{"Item","protection"}),
        to = Table.SelectRows(exp,(r)=>r[protection]=false)
    in
        to
    ]

[   –°–ª–æ–≤–∞—Ä–∏ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö –ø—Ä–æ—Ç–∏–≤ Table.Buffer / #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –ø—Ä–∏—ë–º—ã

        –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
        –ú–Ω–µ –æ–ø—è—Ç—å –ø–æ–ø–∞–ª–æ—Å—å –Ω–∞ –≥–ª–∞–∑–∞ —Å—Ç—Ä–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ. –ï—â—ë —Ä–∞–∑ —É–±–µ–¥–∏–ª—Å—è, —á—Ç–æ –Ω–µ –∑—Ä—è –Ω–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ä–µ–∫–ª–∞–º—É —é—Ç—É–±-–∫–∞–Ω–∞–ª–æ–≤ –≤ —á–∞—Ç–µ.
        –ü–æ–∫–∞ —É –º–µ–Ω—è –ø—Ä–∏–≥–æ—Ä–∞–ª–æ –∑–∞–ø–∏—Å–∞–ª –≤–∏–¥–æ—Å.
        –ò–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ—Å—è –Ω–∞–π–¥—É—Ç —Ç–∞–º –ø—Ä–æ Table.Buffer, —è—Ä–∫–∏–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ (x)=> –≤–º–µ—Å—Ç–æ each _ –∏ –¥–∞–∂–µ –ø—Ä–æ DateTime.ToText –≤–º–µ—Å—Ç–æ –¥–∞–∂–µ –Ω–µ –±—É–¥—É –≥–æ–≤–æ—Ä–∏—Ç—å —á–µ–≥–æ.
        –ê –≤–æ–æ–±—â–µ –∑–∞–¥–∞—á–∫–∞ –ø—Ä–æ –Ω–∞ —Å–ª–æ–≤–∞—Ä–∏ –Ω–∞ –∑–∞–ø–∏—Å—è—Ö (–Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ, –ø—Ä–∞–≤–¥–∞?).
        –°–≤–æ–π –∫–æ–¥ –ø—Ä–∏–≤–æ–∂—É:
        let
            tbl  = Excel.CurrentWorkbook(){[Name="–¥–∞—Ç—ã"]}[Content],
            tr   = Table.TransformColumns(tbl,{"month",(x) as text=>DateTime.ToText(x,"yyyy MMMM")}),
            f=(x)=>List.Transform({0..Duration.Days(x{2}-x{1})},(y)=>Text.From(Date.From(Number.From(x{1})+y))),
            cmb  = Table.CombineColumns(tr,List.Skip(Table.ColumnNames(tr)),f,"tmp"),
            exp  = Table.ExpandListColumn(cmb,"tmp"),
            dict = Record.FromList(exp[month],exp[tmp]),
            from = Excel.CurrentWorkbook(){[Name="–±–∞–∑–∞"]}[Content],
            to   = Table.AddColumn(from,"month",(x)=>Record.Field(dict,Text.From(Date.From(x[–î–∞—Ç–∞]))))
        in
            to
    ]

[   #–ê–Ω–∞—Ç–æ–º–∏—è–§—É–Ω–∫—Ü–∏–π ‚Äì –ø—Ä–∏—ë–º—ã / Splitter-—ã 

        –í —á–∞—Ç–µ —É–∂–µ –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ —è —Ä–µ—à–∏–ª –ø–æ–º—É—á–∏—Ç—å —Å–µ–±—è –∏ –æ–∫—Ä—É–∂–∞—é—â–∏—Ö —Ç–µ–º–æ–π Splitter-–æ–≤.
        –ü–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –≤–∏–¥–æ—Å. –í–æ—Ç –∫–æ–¥:
        let
            lst=List.Buffer({"0".."9"," "}),
            from = Excel.CurrentWorkbook(){[Name="–¢–∞–±–ª–∏—Ü–∞1"]}[Content][Custom],
            f=(x)=>[a = Splitter.SplitTextByEachDelimiter({"/"},null,true)(x),
                    b = Splitter.SplitTextByEachDelimiter({" "},null,true)(a{0}),
                    c = Splitter.SplitTextByCharacterTransition((x)=>not List.Contains(lst,x),lst)(b{0}),
                    d = Combiner.CombineTextByDelimiter("")(Splitter.SplitTextByDelimiter(" ")(List.Last(c))),
                    z = {x, b{1} & "/c", Number.From(d)}][z],
            to = Table.FromList(from,f)
        in
            to
    ]